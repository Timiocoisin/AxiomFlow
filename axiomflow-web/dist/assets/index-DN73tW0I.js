var l1=Object.defineProperty;var Gm=i=>{throw TypeError(i)};var c1=(i,t,e)=>t in i?l1(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e;var pt=(i,t,e)=>c1(i,typeof t!="symbol"?t+"":t,e),Xf=(i,t,e)=>t.has(i)||Gm("Cannot "+e);var l=(i,t,e)=>(Xf(i,t,"read from private field"),e?e.call(i):t.get(i)),y=(i,t,e)=>t.has(i)?Gm("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(i):t.set(i,e),g=(i,t,e,s)=>(Xf(i,t,"write to private field"),s?s.call(i,e):t.set(i,e),e),w=(i,t,e)=>(Xf(i,t,"access private method"),e);var ms=(i,t,e,s)=>({set _(n){g(i,t,n,e)},get _(){return l(i,t,s)}});(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function e(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerPolicy&&(r.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?r.credentials="include":n.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(n){if(n.ep)return;n.ep=!0;const r=e(n);fetch(n.href,r)}})();/**
* @vue/shared v3.5.27
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function tm(i){const t=Object.create(null);for(const e of i.split(","))t[e]=1;return e=>e in t}const oe={},Ja=[],mn=()=>{},Sb=()=>!1,_f=i=>i.charCodeAt(0)===111&&i.charCodeAt(1)===110&&(i.charCodeAt(2)>122||i.charCodeAt(2)<97),em=i=>i.startsWith("onUpdate:"),De=Object.assign,sm=(i,t)=>{const e=i.indexOf(t);e>-1&&i.splice(e,1)},u1=Object.prototype.hasOwnProperty,Qt=(i,t)=>u1.call(i,t),At=Array.isArray,Qa=i=>Oh(i)==="[object Map]",fc=i=>Oh(i)==="[object Set]",zm=i=>Oh(i)==="[object Date]",Rt=i=>typeof i=="function",Se=i=>typeof i=="string",Fi=i=>typeof i=="symbol",re=i=>i!==null&&typeof i=="object",xb=i=>(re(i)||Rt(i))&&Rt(i.then)&&Rt(i.catch),Cb=Object.prototype.toString,Oh=i=>Cb.call(i),h1=i=>Oh(i).slice(8,-1),Eb=i=>Oh(i)==="[object Object]",Af=i=>Se(i)&&i!=="NaN"&&i[0]!=="-"&&""+parseInt(i,10)===i,jc=tm(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Sf=i=>{const t=Object.create(null);return e=>t[e]||(t[e]=i(e))},d1=/-\w/g,mi=Sf(i=>i.replace(d1,t=>t.slice(1).toUpperCase())),f1=/\B([A-Z])/g,oo=Sf(i=>i.replace(f1,"-$1").toLowerCase()),xf=Sf(i=>i.charAt(0).toUpperCase()+i.slice(1)),Kf=Sf(i=>i?`on${xf(i)}`:""),Zr=(i,t)=>!Object.is(i,t),sd=(i,...t)=>{for(let e=0;e<i.length;e++)i[e](...t)},kb=(i,t,e,s=!1)=>{Object.defineProperty(i,t,{configurable:!0,enumerable:!1,writable:s,value:e})},Cf=i=>{const t=parseFloat(i);return isNaN(t)?i:t},p1=i=>{const t=Se(i)?Number(i):NaN;return isNaN(t)?i:t};let Wm;const Ef=()=>Wm||(Wm=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function Js(i){if(At(i)){const t={};for(let e=0;e<i.length;e++){const s=i[e],n=Se(s)?b1(s):Js(s);if(n)for(const r in n)t[r]=n[r]}return t}else if(Se(i)||re(i))return i}const g1=/;(?![^(]*\))/g,m1=/:([^]+)/,v1=/\/\*[^]*?\*\//g;function b1(i){const t={};return i.replace(v1,"").split(g1).forEach(e=>{if(e){const s=e.split(m1);s.length>1&&(t[s[0].trim()]=s[1].trim())}}),t}function Yt(i){let t="";if(Se(i))t=i;else if(At(i))for(let e=0;e<i.length;e++){const s=Yt(i[e]);s&&(t+=s+" ")}else if(re(i))for(const e in i)i[e]&&(t+=e+" ");return t.trim()}const y1="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",w1=tm(y1);function Tb(i){return!!i||i===""}function _1(i,t){if(i.length!==t.length)return!1;let e=!0;for(let s=0;e&&s<i.length;s++)e=Ta(i[s],t[s]);return e}function Ta(i,t){if(i===t)return!0;let e=zm(i),s=zm(t);if(e||s)return e&&s?i.getTime()===t.getTime():!1;if(e=Fi(i),s=Fi(t),e||s)return i===t;if(e=At(i),s=At(t),e||s)return e&&s?_1(i,t):!1;if(e=re(i),s=re(t),e||s){if(!e||!s)return!1;const n=Object.keys(i).length,r=Object.keys(t).length;if(n!==r)return!1;for(const o in i){const a=i.hasOwnProperty(o),c=t.hasOwnProperty(o);if(a&&!c||!a&&c||!Ta(i[o],t[o]))return!1}}return String(i)===String(t)}function im(i,t){return i.findIndex(e=>Ta(e,t))}const Pb=i=>!!(i&&i.__v_isRef===!0),mt=i=>Se(i)?i:i==null?"":At(i)||re(i)&&(i.toString===Cb||!Rt(i.toString))?Pb(i)?mt(i.value):JSON.stringify(i,Rb,2):String(i),Rb=(i,t)=>Pb(t)?Rb(i,t.value):Qa(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((e,[s,n],r)=>(e[Yf(s,r)+" =>"]=n,e),{})}:fc(t)?{[`Set(${t.size})`]:[...t.values()].map(e=>Yf(e))}:Fi(t)?Yf(t):re(t)&&!At(t)&&!Eb(t)?String(t):t,Yf=(i,t="")=>{var e;return Fi(i)?`Symbol(${(e=i.description)!=null?e:t})`:i};/**
* @vue/reactivity v3.5.27
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let us;class Mb{constructor(t=!1){this.detached=t,this._active=!0,this._on=0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=us,!t&&us&&(this.index=(us.scopes||(us.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let t,e;if(this.scopes)for(t=0,e=this.scopes.length;t<e;t++)this.scopes[t].pause();for(t=0,e=this.effects.length;t<e;t++)this.effects[t].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let t,e;if(this.scopes)for(t=0,e=this.scopes.length;t<e;t++)this.scopes[t].resume();for(t=0,e=this.effects.length;t<e;t++)this.effects[t].resume()}}run(t){if(this._active){const e=us;try{return us=this,t()}finally{us=e}}}on(){++this._on===1&&(this.prevScope=us,us=this)}off(){this._on>0&&--this._on===0&&(us=this.prevScope,this.prevScope=void 0)}stop(t){if(this._active){this._active=!1;let e,s;for(e=0,s=this.effects.length;e<s;e++)this.effects[e].stop();for(this.effects.length=0,e=0,s=this.cleanups.length;e<s;e++)this.cleanups[e]();if(this.cleanups.length=0,this.scopes){for(e=0,s=this.scopes.length;e<s;e++)this.scopes[e].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!t){const n=this.parent.scopes.pop();n&&n!==this&&(this.parent.scopes[this.index]=n,n.index=this.index)}this.parent=void 0}}}function Ib(i){return new Mb(i)}function Lb(){return us}function A1(i,t=!1){us&&us.cleanups.push(i)}let ce;const Jf=new WeakSet;class Db{constructor(t){this.fn=t,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,us&&us.active&&us.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,Jf.has(this)&&(Jf.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||Nb(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,qm(this),Fb(this);const t=ce,e=Oi;ce=this,Oi=!0;try{return this.fn()}finally{$b(this),ce=t,Oi=e,this.flags&=-3}}stop(){if(this.flags&1){for(let t=this.deps;t;t=t.nextDep)om(t);this.deps=this.depsTail=void 0,qm(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?Jf.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){Ap(this)&&this.run()}get dirty(){return Ap(this)}}let Ob=0,Vc,Uc;function Nb(i,t=!1){if(i.flags|=8,t){i.next=Uc,Uc=i;return}i.next=Vc,Vc=i}function nm(){Ob++}function rm(){if(--Ob>0)return;if(Uc){let t=Uc;for(Uc=void 0;t;){const e=t.next;t.next=void 0,t.flags&=-9,t=e}}let i;for(;Vc;){let t=Vc;for(Vc=void 0;t;){const e=t.next;if(t.next=void 0,t.flags&=-9,t.flags&1)try{t.trigger()}catch(s){i||(i=s)}t=e}}if(i)throw i}function Fb(i){for(let t=i.deps;t;t=t.nextDep)t.version=-1,t.prevActiveLink=t.dep.activeLink,t.dep.activeLink=t}function $b(i){let t,e=i.depsTail,s=e;for(;s;){const n=s.prevDep;s.version===-1?(s===e&&(e=n),om(s),S1(s)):t=s,s.dep.activeLink=s.prevActiveLink,s.prevActiveLink=void 0,s=n}i.deps=t,i.depsTail=e}function Ap(i){for(let t=i.deps;t;t=t.nextDep)if(t.dep.version!==t.version||t.dep.computed&&(Bb(t.dep.computed)||t.dep.version!==t.version))return!0;return!!i._dirty}function Bb(i){if(i.flags&4&&!(i.flags&16)||(i.flags&=-17,i.globalVersion===Qc)||(i.globalVersion=Qc,!i.isSSR&&i.flags&128&&(!i.deps&&!i._dirty||!Ap(i))))return;i.flags|=2;const t=i.dep,e=ce,s=Oi;ce=i,Oi=!0;try{Fb(i);const n=i.fn(i._value);(t.version===0||Zr(n,i._value))&&(i.flags|=128,i._value=n,t.version++)}catch(n){throw t.version++,n}finally{ce=e,Oi=s,$b(i),i.flags&=-3}}function om(i,t=!1){const{dep:e,prevSub:s,nextSub:n}=i;if(s&&(s.nextSub=n,i.prevSub=void 0),n&&(n.prevSub=s,i.nextSub=void 0),e.subs===i&&(e.subs=s,!s&&e.computed)){e.computed.flags&=-5;for(let r=e.computed.deps;r;r=r.nextDep)om(r,!0)}!t&&!--e.sc&&e.map&&e.map.delete(e.key)}function S1(i){const{prevDep:t,nextDep:e}=i;t&&(t.nextDep=e,i.prevDep=void 0),e&&(e.prevDep=t,i.nextDep=void 0)}let Oi=!0;const Hb=[];function or(){Hb.push(Oi),Oi=!1}function ar(){const i=Hb.pop();Oi=i===void 0?!0:i}function qm(i){const{cleanup:t}=i;if(i.cleanup=void 0,t){const e=ce;ce=void 0;try{t()}finally{ce=e}}}let Qc=0;class x1{constructor(t,e){this.sub=t,this.dep=e,this.version=e.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class am{constructor(t){this.computed=t,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0,this.__v_skip=!0}track(t){if(!ce||!Oi||ce===this.computed)return;let e=this.activeLink;if(e===void 0||e.sub!==ce)e=this.activeLink=new x1(ce,this),ce.deps?(e.prevDep=ce.depsTail,ce.depsTail.nextDep=e,ce.depsTail=e):ce.deps=ce.depsTail=e,jb(e);else if(e.version===-1&&(e.version=this.version,e.nextDep)){const s=e.nextDep;s.prevDep=e.prevDep,e.prevDep&&(e.prevDep.nextDep=s),e.prevDep=ce.depsTail,e.nextDep=void 0,ce.depsTail.nextDep=e,ce.depsTail=e,ce.deps===e&&(ce.deps=s)}return e}trigger(t){this.version++,Qc++,this.notify(t)}notify(t){nm();try{for(let e=this.subs;e;e=e.prevSub)e.sub.notify()&&e.sub.dep.notify()}finally{rm()}}}function jb(i){if(i.dep.sc++,i.sub.flags&4){const t=i.dep.computed;if(t&&!i.dep.subs){t.flags|=20;for(let s=t.deps;s;s=s.nextDep)jb(s)}const e=i.dep.subs;e!==i&&(i.prevSub=e,e&&(e.nextSub=i)),i.dep.subs=i}}const $d=new WeakMap,Ca=Symbol(""),Sp=Symbol(""),Zc=Symbol("");function ds(i,t,e){if(Oi&&ce){let s=$d.get(i);s||$d.set(i,s=new Map);let n=s.get(e);n||(s.set(e,n=new am),n.map=s,n.key=e),n.track()}}function Zn(i,t,e,s,n,r){const o=$d.get(i);if(!o){Qc++;return}const a=c=>{c&&c.trigger()};if(nm(),t==="clear")o.forEach(a);else{const c=At(i),u=c&&Af(e);if(c&&e==="length"){const h=Number(s);o.forEach((d,f)=>{(f==="length"||f===Zc||!Fi(f)&&f>=h)&&a(d)})}else switch((e!==void 0||o.has(void 0))&&a(o.get(e)),u&&a(o.get(Zc)),t){case"add":c?u&&a(o.get("length")):(a(o.get(Ca)),Qa(i)&&a(o.get(Sp)));break;case"delete":c||(a(o.get(Ca)),Qa(i)&&a(o.get(Sp)));break;case"set":Qa(i)&&a(o.get(Ca));break}}rm()}function C1(i,t){const e=$d.get(i);return e&&e.get(t)}function $a(i){const t=Gt(i);return t===i?t:(ds(t,"iterate",Zc),ti(i)?t:t.map($i))}function kf(i){return ds(i=Gt(i),"iterate",Zc),i}function vr(i,t){return lr(i)?lc(ir(i)?$i(t):t):$i(t)}const E1={__proto__:null,[Symbol.iterator](){return Qf(this,Symbol.iterator,i=>vr(this,i))},concat(...i){return $a(this).concat(...i.map(t=>At(t)?$a(t):t))},entries(){return Qf(this,"entries",i=>(i[1]=vr(this,i[1]),i))},every(i,t){return yn(this,"every",i,t,void 0,arguments)},filter(i,t){return yn(this,"filter",i,t,e=>e.map(s=>vr(this,s)),arguments)},find(i,t){return yn(this,"find",i,t,e=>vr(this,e),arguments)},findIndex(i,t){return yn(this,"findIndex",i,t,void 0,arguments)},findLast(i,t){return yn(this,"findLast",i,t,e=>vr(this,e),arguments)},findLastIndex(i,t){return yn(this,"findLastIndex",i,t,void 0,arguments)},forEach(i,t){return yn(this,"forEach",i,t,void 0,arguments)},includes(...i){return Zf(this,"includes",i)},indexOf(...i){return Zf(this,"indexOf",i)},join(i){return $a(this).join(i)},lastIndexOf(...i){return Zf(this,"lastIndexOf",i)},map(i,t){return yn(this,"map",i,t,void 0,arguments)},pop(){return mc(this,"pop")},push(...i){return mc(this,"push",i)},reduce(i,...t){return Xm(this,"reduce",i,t)},reduceRight(i,...t){return Xm(this,"reduceRight",i,t)},shift(){return mc(this,"shift")},some(i,t){return yn(this,"some",i,t,void 0,arguments)},splice(...i){return mc(this,"splice",i)},toReversed(){return $a(this).toReversed()},toSorted(i){return $a(this).toSorted(i)},toSpliced(...i){return $a(this).toSpliced(...i)},unshift(...i){return mc(this,"unshift",i)},values(){return Qf(this,"values",i=>vr(this,i))}};function Qf(i,t,e){const s=kf(i),n=s[t]();return s!==i&&!ti(i)&&(n._next=n.next,n.next=()=>{const r=n._next();return r.done||(r.value=e(r.value)),r}),n}const k1=Array.prototype;function yn(i,t,e,s,n,r){const o=kf(i),a=o!==i&&!ti(i),c=o[t];if(c!==k1[t]){const d=c.apply(i,r);return a?$i(d):d}let u=e;o!==i&&(a?u=function(d,f){return e.call(this,vr(i,d),f,i)}:e.length>2&&(u=function(d,f){return e.call(this,d,f,i)}));const h=c.call(o,u,s);return a&&n?n(h):h}function Xm(i,t,e,s){const n=kf(i);let r=e;return n!==i&&(ti(i)?e.length>3&&(r=function(o,a,c){return e.call(this,o,a,c,i)}):r=function(o,a,c){return e.call(this,o,vr(i,a),c,i)}),n[t](r,...s)}function Zf(i,t,e){const s=Gt(i);ds(s,"iterate",Zc);const n=s[t](...e);return(n===-1||n===!1)&&Tf(e[0])?(e[0]=Gt(e[0]),s[t](...e)):n}function mc(i,t,e=[]){or(),nm();const s=Gt(i)[t].apply(i,e);return rm(),ar(),s}const T1=tm("__proto__,__v_isRef,__isVue"),Vb=new Set(Object.getOwnPropertyNames(Symbol).filter(i=>i!=="arguments"&&i!=="caller").map(i=>Symbol[i]).filter(Fi));function P1(i){Fi(i)||(i=String(i));const t=Gt(this);return ds(t,"has",i),t.hasOwnProperty(i)}class Ub{constructor(t=!1,e=!1){this._isReadonly=t,this._isShallow=e}get(t,e,s){if(e==="__v_skip")return t.__v_skip;const n=this._isReadonly,r=this._isShallow;if(e==="__v_isReactive")return!n;if(e==="__v_isReadonly")return n;if(e==="__v_isShallow")return r;if(e==="__v_raw")return s===(n?r?B1:qb:r?Wb:zb).get(t)||Object.getPrototypeOf(t)===Object.getPrototypeOf(s)?t:void 0;const o=At(t);if(!n){let c;if(o&&(c=E1[e]))return c;if(e==="hasOwnProperty")return P1}const a=Reflect.get(t,e,Ae(t)?t:s);if((Fi(e)?Vb.has(e):T1(e))||(n||ds(t,"get",e),r))return a;if(Ae(a)){const c=o&&Af(e)?a:a.value;return n&&re(c)?Cp(c):c}return re(a)?n?Cp(a):Nh(a):a}}class Gb extends Ub{constructor(t=!1){super(!1,t)}set(t,e,s,n){let r=t[e];const o=At(t)&&Af(e);if(!this._isShallow){const u=lr(r);if(!ti(s)&&!lr(s)&&(r=Gt(r),s=Gt(s)),!o&&Ae(r)&&!Ae(s))return u||(r.value=s),!0}const a=o?Number(e)<t.length:Qt(t,e),c=Reflect.set(t,e,s,Ae(t)?t:n);return t===Gt(n)&&(a?Zr(s,r)&&Zn(t,"set",e,s):Zn(t,"add",e,s)),c}deleteProperty(t,e){const s=Qt(t,e);t[e];const n=Reflect.deleteProperty(t,e);return n&&s&&Zn(t,"delete",e,void 0),n}has(t,e){const s=Reflect.has(t,e);return(!Fi(e)||!Vb.has(e))&&ds(t,"has",e),s}ownKeys(t){return ds(t,"iterate",At(t)?"length":Ca),Reflect.ownKeys(t)}}class R1 extends Ub{constructor(t=!1){super(!0,t)}set(t,e){return!0}deleteProperty(t,e){return!0}}const M1=new Gb,I1=new R1,L1=new Gb(!0);const xp=i=>i,Wh=i=>Reflect.getPrototypeOf(i);function D1(i,t,e){return function(...s){const n=this.__v_raw,r=Gt(n),o=Qa(r),a=i==="entries"||i===Symbol.iterator&&o,c=i==="keys"&&o,u=n[i](...s),h=e?xp:t?lc:$i;return!t&&ds(r,"iterate",c?Sp:Ca),De(Object.create(u),{next(){const{value:d,done:f}=u.next();return f?{value:d,done:f}:{value:a?[h(d[0]),h(d[1])]:h(d),done:f}}})}}function qh(i){return function(...t){return i==="delete"?!1:i==="clear"?void 0:this}}function O1(i,t){const e={get(n){const r=this.__v_raw,o=Gt(r),a=Gt(n);i||(Zr(n,a)&&ds(o,"get",n),ds(o,"get",a));const{has:c}=Wh(o),u=t?xp:i?lc:$i;if(c.call(o,n))return u(r.get(n));if(c.call(o,a))return u(r.get(a));r!==o&&r.get(n)},get size(){const n=this.__v_raw;return!i&&ds(Gt(n),"iterate",Ca),n.size},has(n){const r=this.__v_raw,o=Gt(r),a=Gt(n);return i||(Zr(n,a)&&ds(o,"has",n),ds(o,"has",a)),n===a?r.has(n):r.has(n)||r.has(a)},forEach(n,r){const o=this,a=o.__v_raw,c=Gt(a),u=t?xp:i?lc:$i;return!i&&ds(c,"iterate",Ca),a.forEach((h,d)=>n.call(r,u(h),u(d),o))}};return De(e,i?{add:qh("add"),set:qh("set"),delete:qh("delete"),clear:qh("clear")}:{add(n){!t&&!ti(n)&&!lr(n)&&(n=Gt(n));const r=Gt(this);return Wh(r).has.call(r,n)||(r.add(n),Zn(r,"add",n,n)),this},set(n,r){!t&&!ti(r)&&!lr(r)&&(r=Gt(r));const o=Gt(this),{has:a,get:c}=Wh(o);let u=a.call(o,n);u||(n=Gt(n),u=a.call(o,n));const h=c.call(o,n);return o.set(n,r),u?Zr(r,h)&&Zn(o,"set",n,r):Zn(o,"add",n,r),this},delete(n){const r=Gt(this),{has:o,get:a}=Wh(r);let c=o.call(r,n);c||(n=Gt(n),c=o.call(r,n)),a&&a.call(r,n);const u=r.delete(n);return c&&Zn(r,"delete",n,void 0),u},clear(){const n=Gt(this),r=n.size!==0,o=n.clear();return r&&Zn(n,"clear",void 0,void 0),o}}),["keys","values","entries",Symbol.iterator].forEach(n=>{e[n]=D1(n,i,t)}),e}function lm(i,t){const e=O1(i,t);return(s,n,r)=>n==="__v_isReactive"?!i:n==="__v_isReadonly"?i:n==="__v_raw"?s:Reflect.get(Qt(e,n)&&n in s?e:s,n,r)}const N1={get:lm(!1,!1)},F1={get:lm(!1,!0)},$1={get:lm(!0,!1)};const zb=new WeakMap,Wb=new WeakMap,qb=new WeakMap,B1=new WeakMap;function H1(i){switch(i){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function j1(i){return i.__v_skip||!Object.isExtensible(i)?0:H1(h1(i))}function Nh(i){return lr(i)?i:cm(i,!1,M1,N1,zb)}function Xb(i){return cm(i,!1,L1,F1,Wb)}function Cp(i){return cm(i,!0,I1,$1,qb)}function cm(i,t,e,s,n){if(!re(i)||i.__v_raw&&!(t&&i.__v_isReactive))return i;const r=j1(i);if(r===0)return i;const o=n.get(i);if(o)return o;const a=new Proxy(i,r===2?s:e);return n.set(i,a),a}function ir(i){return lr(i)?ir(i.__v_raw):!!(i&&i.__v_isReactive)}function lr(i){return!!(i&&i.__v_isReadonly)}function ti(i){return!!(i&&i.__v_isShallow)}function Tf(i){return i?!!i.__v_raw:!1}function Gt(i){const t=i&&i.__v_raw;return t?Gt(t):i}function um(i){return!Qt(i,"__v_skip")&&Object.isExtensible(i)&&kb(i,"__v_skip",!0),i}const $i=i=>re(i)?Nh(i):i,lc=i=>re(i)?Cp(i):i;function Ae(i){return i?i.__v_isRef===!0:!1}function tt(i){return Kb(i,!1)}function V1(i){return Kb(i,!0)}function Kb(i,t){return Ae(i)?i:new U1(i,t)}class U1{constructor(t,e){this.dep=new am,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=e?t:Gt(t),this._value=e?t:$i(t),this.__v_isShallow=e}get value(){return this.dep.track(),this._value}set value(t){const e=this._rawValue,s=this.__v_isShallow||ti(t)||lr(t);t=s?t:Gt(t),Zr(t,e)&&(this._rawValue=t,this._value=s?t:$i(t),this.dep.trigger())}}function He(i){return Ae(i)?i.value:i}const G1={get:(i,t,e)=>t==="__v_raw"?i:He(Reflect.get(i,t,e)),set:(i,t,e,s)=>{const n=i[t];return Ae(n)&&!Ae(e)?(n.value=e,!0):Reflect.set(i,t,e,s)}};function Yb(i){return ir(i)?i:new Proxy(i,G1)}function z1(i){const t=At(i)?new Array(i.length):{};for(const e in i)t[e]=q1(i,e);return t}class W1{constructor(t,e,s){this._object=t,this._key=e,this._defaultValue=s,this.__v_isRef=!0,this._value=void 0,this._raw=Gt(t);let n=!0,r=t;if(!At(t)||!Af(String(e)))do n=!Tf(r)||ti(r);while(n&&(r=r.__v_raw));this._shallow=n}get value(){let t=this._object[this._key];return this._shallow&&(t=He(t)),this._value=t===void 0?this._defaultValue:t}set value(t){if(this._shallow&&Ae(this._raw[this._key])){const e=this._object[this._key];if(Ae(e)){e.value=t;return}}this._object[this._key]=t}get dep(){return C1(this._raw,this._key)}}function q1(i,t,e){return new W1(i,t,e)}class X1{constructor(t,e,s){this.fn=t,this.setter=e,this._value=void 0,this.dep=new am(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=Qc-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!e,this.isSSR=s}notify(){if(this.flags|=16,!(this.flags&8)&&ce!==this)return Nb(this,!0),!0}get value(){const t=this.dep.track();return Bb(this),t&&(t.version=this.dep.version),this._value}set value(t){this.setter&&this.setter(t)}}function K1(i,t,e=!1){let s,n;return Rt(i)?s=i:(s=i.get,n=i.set),new X1(s,n,e)}const Xh={},Bd=new WeakMap;let fo;function Y1(i,t=!1,e=fo){if(e){let s=Bd.get(e);s||Bd.set(e,s=[]),s.push(i)}}function J1(i,t,e=oe){const{immediate:s,deep:n,once:r,scheduler:o,augmentJob:a,call:c}=e,u=C=>n?C:ti(C)||n===!1||n===0?tr(C,1):tr(C);let h,d,f,p,m=!1,v=!1;if(Ae(i)?(d=()=>i.value,m=ti(i)):ir(i)?(d=()=>u(i),m=!0):At(i)?(v=!0,m=i.some(C=>ir(C)||ti(C)),d=()=>i.map(C=>{if(Ae(C))return C.value;if(ir(C))return u(C);if(Rt(C))return c?c(C,2):C()})):Rt(i)?t?d=c?()=>c(i,2):i:d=()=>{if(f){or();try{f()}finally{ar()}}const C=fo;fo=h;try{return c?c(i,3,[p]):i(p)}finally{fo=C}}:d=mn,t&&n){const C=d,T=n===!0?1/0:n;d=()=>tr(C(),T)}const _=Lb(),b=()=>{h.stop(),_&&_.active&&sm(_.effects,h)};if(r&&t){const C=t;t=(...T)=>{C(...T),b()}}let A=v?new Array(i.length).fill(Xh):Xh;const x=C=>{if(!(!(h.flags&1)||!h.dirty&&!C))if(t){const T=h.run();if(n||m||(v?T.some((D,P)=>Zr(D,A[P])):Zr(T,A))){f&&f();const D=fo;fo=h;try{const P=[T,A===Xh?void 0:v&&A[0]===Xh?[]:A,p];A=T,c?c(t,3,P):t(...P)}finally{fo=D}}}else h.run()};return a&&a(x),h=new Db(d),h.scheduler=o?()=>o(x,!1):x,p=C=>Y1(C,!1,h),f=h.onStop=()=>{const C=Bd.get(h);if(C){if(c)c(C,4);else for(const T of C)T();Bd.delete(h)}},t?s?x(!0):A=h.run():o?o(x.bind(null,!0),!0):h.run(),b.pause=h.pause.bind(h),b.resume=h.resume.bind(h),b.stop=b,b}function tr(i,t=1/0,e){if(t<=0||!re(i)||i.__v_skip||(e=e||new Map,(e.get(i)||0)>=t))return i;if(e.set(i,t),t--,Ae(i))tr(i.value,t,e);else if(At(i))for(let s=0;s<i.length;s++)tr(i[s],t,e);else if(fc(i)||Qa(i))i.forEach(s=>{tr(s,t,e)});else if(Eb(i)){for(const s in i)tr(i[s],t,e);for(const s of Object.getOwnPropertySymbols(i))Object.prototype.propertyIsEnumerable.call(i,s)&&tr(i[s],t,e)}return i}/**
* @vue/runtime-core v3.5.27
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function Fh(i,t,e,s){try{return s?i(...s):i()}catch(n){Pf(n,t,e)}}function Bi(i,t,e,s){if(Rt(i)){const n=Fh(i,t,e,s);return n&&xb(n)&&n.catch(r=>{Pf(r,t,e)}),n}if(At(i)){const n=[];for(let r=0;r<i.length;r++)n.push(Bi(i[r],t,e,s));return n}}function Pf(i,t,e,s=!0){const n=t?t.vnode:null,{errorHandler:r,throwUnhandledErrorInProduction:o}=t&&t.appContext.config||oe;if(t){let a=t.parent;const c=t.proxy,u=`https://vuejs.org/error-reference/#runtime-${e}`;for(;a;){const h=a.ec;if(h){for(let d=0;d<h.length;d++)if(h[d](i,c,u)===!1)return}a=a.parent}if(r){or(),Fh(r,null,10,[i,c,u]),ar();return}}Q1(i,e,n,s,o)}function Q1(i,t,e,s=!0,n=!1){if(n)throw i;console.error(i)}const Cs=[];let Yi=-1;const Za=[];let br=null,Ha=0;const Jb=Promise.resolve();let Hd=null;function $h(i){const t=Hd||Jb;return i?t.then(this?i.bind(this):i):t}function Z1(i){let t=Yi+1,e=Cs.length;for(;t<e;){const s=t+e>>>1,n=Cs[s],r=tu(n);r<i||r===i&&n.flags&2?t=s+1:e=s}return t}function hm(i){if(!(i.flags&1)){const t=tu(i),e=Cs[Cs.length-1];!e||!(i.flags&2)&&t>=tu(e)?Cs.push(i):Cs.splice(Z1(t),0,i),i.flags|=1,Qb()}}function Qb(){Hd||(Hd=Jb.then(t0))}function t_(i){At(i)?Za.push(...i):br&&i.id===-1?br.splice(Ha+1,0,i):i.flags&1||(Za.push(i),i.flags|=1),Qb()}function Km(i,t,e=Yi+1){for(;e<Cs.length;e++){const s=Cs[e];if(s&&s.flags&2){if(i&&s.id!==i.uid)continue;Cs.splice(e,1),e--,s.flags&4&&(s.flags&=-2),s(),s.flags&4||(s.flags&=-2)}}}function Zb(i){if(Za.length){const t=[...new Set(Za)].sort((e,s)=>tu(e)-tu(s));if(Za.length=0,br){br.push(...t);return}for(br=t,Ha=0;Ha<br.length;Ha++){const e=br[Ha];e.flags&4&&(e.flags&=-2),e.flags&8||e(),e.flags&=-2}br=null,Ha=0}}const tu=i=>i.id==null?i.flags&2?-1:1/0:i.id;function t0(i){try{for(Yi=0;Yi<Cs.length;Yi++){const t=Cs[Yi];t&&!(t.flags&8)&&(t.flags&4&&(t.flags&=-2),Fh(t,t.i,t.i?15:14),t.flags&4||(t.flags&=-2))}}finally{for(;Yi<Cs.length;Yi++){const t=Cs[Yi];t&&(t.flags&=-2)}Yi=-1,Cs.length=0,Zb(),Hd=null,(Cs.length||Za.length)&&t0()}}let ss=null,e0=null;function jd(i){const t=ss;return ss=i,e0=i&&i.type.__scopeId||null,t}function zt(i,t=ss,e){if(!t||i._n)return i;const s=(...n)=>{s._d&&Gd(-1);const r=jd(t);let o;try{o=i(...n)}finally{jd(r),s._d&&Gd(1)}return o};return s._n=!0,s._c=!0,s._d=!0,s}function pe(i,t){if(ss===null)return i;const e=Of(ss),s=i.dirs||(i.dirs=[]);for(let n=0;n<t.length;n++){let[r,o,a,c=oe]=t[n];r&&(Rt(r)&&(r={mounted:r,updated:r}),r.deep&&tr(o),s.push({dir:r,instance:e,value:o,oldValue:void 0,arg:a,modifiers:c}))}return i}function co(i,t,e,s){const n=i.dirs,r=t&&t.dirs;for(let o=0;o<n.length;o++){const a=n[o];r&&(a.oldValue=r[o].value);let c=a.dir[s];c&&(or(),Bi(c,e,8,[i.el,a,i,t]),ar())}}function id(i,t){if(ps){let e=ps.provides;const s=ps.parent&&ps.parent.provides;s===e&&(e=ps.provides=Object.create(s)),e[i]=t}}function fi(i,t,e=!1){const s=Df();if(s||Ea){let n=Ea?Ea._context.provides:s?s.parent==null||s.ce?s.vnode.appContext&&s.vnode.appContext.provides:s.parent.provides:void 0;if(n&&i in n)return n[i];if(arguments.length>1)return e&&Rt(t)?t.call(s&&s.proxy):t}}function e_(){return!!(Df()||Ea)}const s_=Symbol.for("v-scx"),i_=()=>fi(s_);function Ni(i,t,e){return s0(i,t,e)}function s0(i,t,e=oe){const{immediate:s,deep:n,flush:r,once:o}=e,a=De({},e),c=t&&s||!t&&r!=="post";let u;if(ru){if(r==="sync"){const p=i_();u=p.__watcherHandles||(p.__watcherHandles=[])}else if(!c){const p=()=>{};return p.stop=mn,p.resume=mn,p.pause=mn,p}}const h=ps;a.call=(p,m,v)=>Bi(p,h,m,v);let d=!1;r==="post"?a.scheduler=p=>{Ss(p,h&&h.suspense)}:r!=="sync"&&(d=!0,a.scheduler=(p,m)=>{m?p():hm(p)}),a.augmentJob=p=>{t&&(p.flags|=4),d&&(p.flags|=2,h&&(p.id=h.uid,p.i=h))};const f=J1(i,t,a);return ru&&(u?u.push(f):c&&f()),f}function n_(i,t,e){const s=this.proxy,n=Se(i)?i.includes(".")?i0(s,i):()=>s[i]:i.bind(s,s);let r;Rt(t)?r=t:(r=t.handler,e=t);const o=Bh(this),a=s0(n,r.bind(s),e);return o(),a}function i0(i,t){const e=t.split(".");return()=>{let s=i;for(let n=0;n<e.length&&s;n++)s=s[e[n]];return s}}const n0=Symbol("_vte"),r0=i=>i.__isTeleport,Gc=i=>i&&(i.disabled||i.disabled===""),Ym=i=>i&&(i.defer||i.defer===""),Jm=i=>typeof SVGElement<"u"&&i instanceof SVGElement,Qm=i=>typeof MathMLElement=="function"&&i instanceof MathMLElement,Ep=(i,t)=>{const e=i&&i.to;return Se(e)?t?t(e):null:e},o0={name:"Teleport",__isTeleport:!0,process(i,t,e,s,n,r,o,a,c,u){const{mc:h,pc:d,pbc:f,o:{insert:p,querySelector:m,createText:v,createComment:_}}=u,b=Gc(t.props);let{shapeFlag:A,children:x,dynamicChildren:C}=t;if(i==null){const T=t.el=v(""),D=t.anchor=v("");p(T,e,s),p(D,e,s);const P=(L,$)=>{A&16&&h(x,L,$,n,r,o,a,c)},j=()=>{const L=t.target=Ep(t.props,m),$=a0(L,t,v,p);L&&(o!=="svg"&&Jm(L)?o="svg":o!=="mathml"&&Qm(L)&&(o="mathml"),n&&n.isCE&&(n.ce._teleportTargets||(n.ce._teleportTargets=new Set)).add(L),b||(P(L,$),nd(t,!1)))};b&&(P(e,D),nd(t,!0)),Ym(t.props)?(t.el.__isMounted=!1,Ss(()=>{j(),delete t.el.__isMounted},r)):j()}else{if(Ym(t.props)&&i.el.__isMounted===!1){Ss(()=>{o0.process(i,t,e,s,n,r,o,a,c,u)},r);return}t.el=i.el,t.targetStart=i.targetStart;const T=t.anchor=i.anchor,D=t.target=i.target,P=t.targetAnchor=i.targetAnchor,j=Gc(i.props),L=j?e:D,$=j?T:P;if(o==="svg"||Jm(D)?o="svg":(o==="mathml"||Qm(D))&&(o="mathml"),C?(f(i.dynamicChildren,C,L,n,r,o,a),mm(i,t,!0)):c||d(i,t,L,$,n,r,o,a,!1),b)j?t.props&&i.props&&t.props.to!==i.props.to&&(t.props.to=i.props.to):Kh(t,e,T,u,1);else if((t.props&&t.props.to)!==(i.props&&i.props.to)){const N=t.target=Ep(t.props,m);N&&Kh(t,N,null,u,0)}else j&&Kh(t,D,P,u,1);nd(t,b)}},remove(i,t,e,{um:s,o:{remove:n}},r){const{shapeFlag:o,children:a,anchor:c,targetStart:u,targetAnchor:h,target:d,props:f}=i;if(d&&(n(u),n(h)),r&&n(c),o&16){const p=r||!Gc(f);for(let m=0;m<a.length;m++){const v=a[m];s(v,t,e,p,!!v.dynamicChildren)}}},move:Kh,hydrate:r_};function Kh(i,t,e,{o:{insert:s},m:n},r=2){r===0&&s(i.targetAnchor,t,e);const{el:o,anchor:a,shapeFlag:c,children:u,props:h}=i,d=r===2;if(d&&s(o,t,e),(!d||Gc(h))&&c&16)for(let f=0;f<u.length;f++)n(u[f],t,e,2);d&&s(a,t,e)}function r_(i,t,e,s,n,r,{o:{nextSibling:o,parentNode:a,querySelector:c,insert:u,createText:h}},d){function f(v,_,b,A){_.anchor=d(o(v),_,a(v),e,s,n,r),_.targetStart=b,_.targetAnchor=A}const p=t.target=Ep(t.props,c),m=Gc(t.props);if(p){const v=p._lpa||p.firstChild;if(t.shapeFlag&16)if(m)f(i,t,v,v&&o(v));else{t.anchor=o(i);let _=v;for(;_;){if(_&&_.nodeType===8){if(_.data==="teleport start anchor")t.targetStart=_;else if(_.data==="teleport anchor"){t.targetAnchor=_,p._lpa=t.targetAnchor&&o(t.targetAnchor);break}}_=o(_)}t.targetAnchor||a0(p,t,h,u),d(v&&o(v),t,p,e,s,n,r)}nd(t,m)}else m&&t.shapeFlag&16&&f(i,t,i,o(i));return t.anchor&&o(t.anchor)}const Zm=o0;function nd(i,t){const e=i.ctx;if(e&&e.ut){let s,n;for(t?(s=i.el,n=i.anchor):(s=i.targetStart,n=i.targetAnchor);s&&s!==n;)s.nodeType===1&&s.setAttribute("data-v-owner",e.uid),s=s.nextSibling;e.ut()}}function a0(i,t,e,s){const n=t.targetStart=e(""),r=t.targetAnchor=e("");return n[n0]=r,i&&(s(n,i),s(r,i)),r}const kn=Symbol("_leaveCb"),Yh=Symbol("_enterCb");function l0(){const i={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return Hi(()=>{i.isMounted=!0}),fm(()=>{i.isUnmounting=!0}),i}const si=[Function,Array],c0={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:si,onEnter:si,onAfterEnter:si,onEnterCancelled:si,onBeforeLeave:si,onLeave:si,onAfterLeave:si,onLeaveCancelled:si,onBeforeAppear:si,onAppear:si,onAfterAppear:si,onAppearCancelled:si},u0=i=>{const t=i.subTree;return t.component?u0(t.component):t},o_={name:"BaseTransition",props:c0,setup(i,{slots:t}){const e=Df(),s=l0();return()=>{const n=t.default&&dm(t.default(),!0);if(!n||!n.length)return;const r=h0(n),o=Gt(i),{mode:a}=o;if(s.isLeaving)return tp(r);const c=tv(r);if(!c)return tp(r);let u=eu(c,o,s,e,d=>u=d);c.type!==fs&&Pa(c,u);let h=e.subTree&&tv(e.subTree);if(h&&h.type!==fs&&!vo(h,c)&&u0(e).type!==fs){let d=eu(h,o,s,e);if(Pa(h,d),a==="out-in"&&c.type!==fs)return s.isLeaving=!0,d.afterLeave=()=>{s.isLeaving=!1,e.job.flags&8||e.update(),delete d.afterLeave,h=void 0},tp(r);a==="in-out"&&c.type!==fs?d.delayLeave=(f,p,m)=>{const v=d0(s,h);v[String(h.key)]=h,f[kn]=()=>{p(),f[kn]=void 0,delete u.delayedLeave,h=void 0},u.delayedLeave=()=>{m(),delete u.delayedLeave,h=void 0}}:h=void 0}else h&&(h=void 0);return r}}};function h0(i){let t=i[0];if(i.length>1){for(const e of i)if(e.type!==fs){t=e;break}}return t}const a_=o_;function d0(i,t){const{leavingVNodes:e}=i;let s=e.get(t.type);return s||(s=Object.create(null),e.set(t.type,s)),s}function eu(i,t,e,s,n){const{appear:r,mode:o,persisted:a=!1,onBeforeEnter:c,onEnter:u,onAfterEnter:h,onEnterCancelled:d,onBeforeLeave:f,onLeave:p,onAfterLeave:m,onLeaveCancelled:v,onBeforeAppear:_,onAppear:b,onAfterAppear:A,onAppearCancelled:x}=t,C=String(i.key),T=d0(e,i),D=(L,$)=>{L&&Bi(L,s,9,$)},P=(L,$)=>{const N=$[1];D(L,$),At(L)?L.every(I=>I.length<=1)&&N():L.length<=1&&N()},j={mode:o,persisted:a,beforeEnter(L){let $=c;if(!e.isMounted)if(r)$=_||c;else return;L[kn]&&L[kn](!0);const N=T[C];N&&vo(i,N)&&N.el[kn]&&N.el[kn](),D($,[L])},enter(L){let $=u,N=h,I=d;if(!e.isMounted)if(r)$=b||u,N=A||h,I=x||d;else return;let F=!1;const Q=L[Yh]=J=>{F||(F=!0,J?D(I,[L]):D(N,[L]),j.delayedLeave&&j.delayedLeave(),L[Yh]=void 0)};$?P($,[L,Q]):Q()},leave(L,$){const N=String(i.key);if(L[Yh]&&L[Yh](!0),e.isUnmounting)return $();D(f,[L]);let I=!1;const F=L[kn]=Q=>{I||(I=!0,$(),Q?D(v,[L]):D(m,[L]),L[kn]=void 0,T[N]===i&&delete T[N])};T[N]=i,p?P(p,[L,F]):F()},clone(L){const $=eu(L,t,e,s,n);return n&&n($),$}};return j}function tp(i){if(Rf(i))return i=eo(i),i.children=null,i}function tv(i){if(!Rf(i))return r0(i.type)&&i.children?h0(i.children):i;if(i.component)return i.component.subTree;const{shapeFlag:t,children:e}=i;if(e){if(t&16)return e[0];if(t&32&&Rt(e.default))return e.default()}}function Pa(i,t){i.shapeFlag&6&&i.component?(i.transition=t,Pa(i.component.subTree,t)):i.shapeFlag&128?(i.ssContent.transition=t.clone(i.ssContent),i.ssFallback.transition=t.clone(i.ssFallback)):i.transition=t}function dm(i,t=!1,e){let s=[],n=0;for(let r=0;r<i.length;r++){let o=i[r];const a=e==null?o.key:String(e)+String(o.key!=null?o.key:r);o.type===me?(o.patchFlag&128&&n++,s=s.concat(dm(o.children,t,a))):(t||o.type!==fs)&&s.push(a!=null?eo(o,{key:a}):o)}if(n>1)for(let r=0;r<s.length;r++)s[r].patchFlag=-2;return s}function Gi(i,t){return Rt(i)?De({name:i.name},t,{setup:i}):i}function f0(i){i.ids=[i.ids[0]+i.ids[2]+++"-",0,0]}const Vd=new WeakMap;function zc(i,t,e,s,n=!1){if(At(i)){i.forEach((m,v)=>zc(m,t&&(At(t)?t[v]:t),e,s,n));return}if(tl(s)&&!n){s.shapeFlag&512&&s.type.__asyncResolved&&s.component.subTree.component&&zc(i,t,e,s.component.subTree);return}const r=s.shapeFlag&4?Of(s.component):s.el,o=n?null:r,{i:a,r:c}=i,u=t&&t.r,h=a.refs===oe?a.refs={}:a.refs,d=a.setupState,f=Gt(d),p=d===oe?Sb:m=>Qt(f,m);if(u!=null&&u!==c){if(ev(t),Se(u))h[u]=null,p(u)&&(d[u]=null);else if(Ae(u)){u.value=null;const m=t;m.k&&(h[m.k]=null)}}if(Rt(c))Fh(c,a,12,[o,h]);else{const m=Se(c),v=Ae(c);if(m||v){const _=()=>{if(i.f){const b=m?p(c)?d[c]:h[c]:c.value;if(n)At(b)&&sm(b,r);else if(At(b))b.includes(r)||b.push(r);else if(m)h[c]=[r],p(c)&&(d[c]=h[c]);else{const A=[r];c.value=A,i.k&&(h[i.k]=A)}}else m?(h[c]=o,p(c)&&(d[c]=o)):v&&(c.value=o,i.k&&(h[i.k]=o))};if(o){const b=()=>{_(),Vd.delete(i)};b.id=-1,Vd.set(i,b),Ss(b,e)}else ev(i),_()}}}function ev(i){const t=Vd.get(i);t&&(t.flags|=8,Vd.delete(i))}Ef().requestIdleCallback;Ef().cancelIdleCallback;const tl=i=>!!i.type.__asyncLoader,Rf=i=>i.type.__isKeepAlive;function l_(i,t){p0(i,"a",t)}function c_(i,t){p0(i,"da",t)}function p0(i,t,e=ps){const s=i.__wdc||(i.__wdc=()=>{let n=e;for(;n;){if(n.isDeactivated)return;n=n.parent}return i()});if(Mf(t,s,e),e){let n=e.parent;for(;n&&n.parent;)Rf(n.parent.vnode)&&u_(s,t,e,n),n=n.parent}}function u_(i,t,e,s){const n=Mf(t,i,s,!0);ao(()=>{sm(s[t],n)},e)}function Mf(i,t,e=ps,s=!1){if(e){const n=e[i]||(e[i]=[]),r=t.__weh||(t.__weh=(...o)=>{or();const a=Bh(e),c=Bi(t,e,i,o);return a(),ar(),c});return s?n.unshift(r):n.push(r),r}}const hr=i=>(t,e=ps)=>{(!ru||i==="sp")&&Mf(i,(...s)=>t(...s),e)},h_=hr("bm"),Hi=hr("m"),d_=hr("bu"),g0=hr("u"),fm=hr("bum"),ao=hr("um"),f_=hr("sp"),p_=hr("rtg"),g_=hr("rtc");function m_(i,t=ps){Mf("ec",i,t)}const v_="components";function sv(i,t){return y_(v_,i,!0,t)||i}const b_=Symbol.for("v-ndc");function y_(i,t,e=!0,s=!1){const n=ss||ps;if(n){const r=n.type;{const a=iA(r,!1);if(a&&(a===t||a===mi(t)||a===xf(mi(t))))return r}const o=iv(n[i]||r[i],t)||iv(n.appContext[i],t);return!o&&s?r:o}}function iv(i,t){return i&&(i[t]||i[mi(t)]||i[xf(mi(t))])}function Qr(i,t,e,s){let n;const r=e,o=At(i);if(o||Se(i)){const a=o&&ir(i);let c=!1,u=!1;a&&(c=!ti(i),u=lr(i),i=kf(i)),n=new Array(i.length);for(let h=0,d=i.length;h<d;h++)n[h]=t(c?u?lc($i(i[h])):$i(i[h]):i[h],h,void 0,r)}else if(typeof i=="number"){n=new Array(i);for(let a=0;a<i;a++)n[a]=t(a+1,a,void 0,r)}else if(re(i))if(i[Symbol.iterator])n=Array.from(i,(a,c)=>t(a,c,void 0,r));else{const a=Object.keys(i);n=new Array(a.length);for(let c=0,u=a.length;c<u;c++){const h=a[c];n[c]=t(i[h],h,c,r)}}else n=[];return n}function m0(i,t,e={},s,n){if(ss.ce||ss.parent&&tl(ss.parent)&&ss.parent.ce){const u=Object.keys(e).length>0;return G(),vn(me,null,[kt("slot",e,s)],u?-2:64)}let r=i[t];r&&r._c&&(r._d=!1),G();const o=r&&v0(r(e)),a=e.key||o&&o.key,c=vn(me,{key:(a&&!Fi(a)?a:`_${t}`)+(!o&&s?"_fb":"")},o||[],o&&i._===1?64:-2);return r&&r._c&&(r._d=!0),c}function v0(i){return i.some(t=>iu(t)?!(t.type===fs||t.type===me&&!v0(t.children)):!0)?i:null}const kp=i=>i?O0(i)?Of(i):kp(i.parent):null,Wc=De(Object.create(null),{$:i=>i,$el:i=>i.vnode.el,$data:i=>i.data,$props:i=>i.props,$attrs:i=>i.attrs,$slots:i=>i.slots,$refs:i=>i.refs,$parent:i=>kp(i.parent),$root:i=>kp(i.root),$host:i=>i.ce,$emit:i=>i.emit,$options:i=>y0(i),$forceUpdate:i=>i.f||(i.f=()=>{hm(i.update)}),$nextTick:i=>i.n||(i.n=$h.bind(i.proxy)),$watch:i=>n_.bind(i)}),ep=(i,t)=>i!==oe&&!i.__isScriptSetup&&Qt(i,t),w_={get({_:i},t){if(t==="__v_skip")return!0;const{ctx:e,setupState:s,data:n,props:r,accessCache:o,type:a,appContext:c}=i;if(t[0]!=="$"){const f=o[t];if(f!==void 0)switch(f){case 1:return s[t];case 2:return n[t];case 4:return e[t];case 3:return r[t]}else{if(ep(s,t))return o[t]=1,s[t];if(n!==oe&&Qt(n,t))return o[t]=2,n[t];if(Qt(r,t))return o[t]=3,r[t];if(e!==oe&&Qt(e,t))return o[t]=4,e[t];Tp&&(o[t]=0)}}const u=Wc[t];let h,d;if(u)return t==="$attrs"&&ds(i.attrs,"get",""),u(i);if((h=a.__cssModules)&&(h=h[t]))return h;if(e!==oe&&Qt(e,t))return o[t]=4,e[t];if(d=c.config.globalProperties,Qt(d,t))return d[t]},set({_:i},t,e){const{data:s,setupState:n,ctx:r}=i;return ep(n,t)?(n[t]=e,!0):s!==oe&&Qt(s,t)?(s[t]=e,!0):Qt(i.props,t)||t[0]==="$"&&t.slice(1)in i?!1:(r[t]=e,!0)},has({_:{data:i,setupState:t,accessCache:e,ctx:s,appContext:n,props:r,type:o}},a){let c;return!!(e[a]||i!==oe&&a[0]!=="$"&&Qt(i,a)||ep(t,a)||Qt(r,a)||Qt(s,a)||Qt(Wc,a)||Qt(n.config.globalProperties,a)||(c=o.__cssModules)&&c[a])},defineProperty(i,t,e){return e.get!=null?i._.accessCache[t]=0:Qt(e,"value")&&this.set(i,t,e.value,null),Reflect.defineProperty(i,t,e)}};function nv(i){return At(i)?i.reduce((t,e)=>(t[e]=null,t),{}):i}let Tp=!0;function __(i){const t=y0(i),e=i.proxy,s=i.ctx;Tp=!1,t.beforeCreate&&rv(t.beforeCreate,i,"bc");const{data:n,computed:r,methods:o,watch:a,provide:c,inject:u,created:h,beforeMount:d,mounted:f,beforeUpdate:p,updated:m,activated:v,deactivated:_,beforeDestroy:b,beforeUnmount:A,destroyed:x,unmounted:C,render:T,renderTracked:D,renderTriggered:P,errorCaptured:j,serverPrefetch:L,expose:$,inheritAttrs:N,components:I,directives:F,filters:Q}=t;if(u&&A_(u,s,null),o)for(const V in o){const Z=o[V];Rt(Z)&&(s[V]=Z.bind(e))}if(n){const V=n.call(e,e);re(V)&&(i.data=Nh(V))}if(Tp=!0,r)for(const V in r){const Z=r[V],St=Rt(Z)?Z.bind(e,e):Rt(Z.get)?Z.get.bind(e,e):mn,wt=!Rt(Z)&&Rt(Z.set)?Z.set.bind(e):mn,_t=jt({get:St,set:wt});Object.defineProperty(s,V,{enumerable:!0,configurable:!0,get:()=>_t.value,set:Pt=>_t.value=Pt})}if(a)for(const V in a)b0(a[V],s,e,V);if(c){const V=Rt(c)?c.call(e):c;Reflect.ownKeys(V).forEach(Z=>{id(Z,V[Z])})}h&&rv(h,i,"c");function H(V,Z){At(Z)?Z.forEach(St=>V(St.bind(e))):Z&&V(Z.bind(e))}if(H(h_,d),H(Hi,f),H(d_,p),H(g0,m),H(l_,v),H(c_,_),H(m_,j),H(g_,D),H(p_,P),H(fm,A),H(ao,C),H(f_,L),At($))if($.length){const V=i.exposed||(i.exposed={});$.forEach(Z=>{Object.defineProperty(V,Z,{get:()=>e[Z],set:St=>e[Z]=St,enumerable:!0})})}else i.exposed||(i.exposed={});T&&i.render===mn&&(i.render=T),N!=null&&(i.inheritAttrs=N),I&&(i.components=I),F&&(i.directives=F),L&&f0(i)}function A_(i,t,e=mn){At(i)&&(i=Pp(i));for(const s in i){const n=i[s];let r;re(n)?"default"in n?r=fi(n.from||s,n.default,!0):r=fi(n.from||s):r=fi(n),Ae(r)?Object.defineProperty(t,s,{enumerable:!0,configurable:!0,get:()=>r.value,set:o=>r.value=o}):t[s]=r}}function rv(i,t,e){Bi(At(i)?i.map(s=>s.bind(t.proxy)):i.bind(t.proxy),t,e)}function b0(i,t,e,s){let n=s.includes(".")?i0(e,s):()=>e[s];if(Se(i)){const r=t[i];Rt(r)&&Ni(n,r)}else if(Rt(i))Ni(n,i.bind(e));else if(re(i))if(At(i))i.forEach(r=>b0(r,t,e,s));else{const r=Rt(i.handler)?i.handler.bind(e):t[i.handler];Rt(r)&&Ni(n,r,i)}}function y0(i){const t=i.type,{mixins:e,extends:s}=t,{mixins:n,optionsCache:r,config:{optionMergeStrategies:o}}=i.appContext,a=r.get(t);let c;return a?c=a:!n.length&&!e&&!s?c=t:(c={},n.length&&n.forEach(u=>Ud(c,u,o,!0)),Ud(c,t,o)),re(t)&&r.set(t,c),c}function Ud(i,t,e,s=!1){const{mixins:n,extends:r}=t;r&&Ud(i,r,e,!0),n&&n.forEach(o=>Ud(i,o,e,!0));for(const o in t)if(!(s&&o==="expose")){const a=S_[o]||e&&e[o];i[o]=a?a(i[o],t[o]):t[o]}return i}const S_={data:ov,props:av,emits:av,methods:Sc,computed:Sc,beforeCreate:vs,created:vs,beforeMount:vs,mounted:vs,beforeUpdate:vs,updated:vs,beforeDestroy:vs,beforeUnmount:vs,destroyed:vs,unmounted:vs,activated:vs,deactivated:vs,errorCaptured:vs,serverPrefetch:vs,components:Sc,directives:Sc,watch:C_,provide:ov,inject:x_};function ov(i,t){return t?i?function(){return De(Rt(i)?i.call(this,this):i,Rt(t)?t.call(this,this):t)}:t:i}function x_(i,t){return Sc(Pp(i),Pp(t))}function Pp(i){if(At(i)){const t={};for(let e=0;e<i.length;e++)t[i[e]]=i[e];return t}return i}function vs(i,t){return i?[...new Set([].concat(i,t))]:t}function Sc(i,t){return i?De(Object.create(null),i,t):t}function av(i,t){return i?At(i)&&At(t)?[...new Set([...i,...t])]:De(Object.create(null),nv(i),nv(t??{})):t}function C_(i,t){if(!i)return t;if(!t)return i;const e=De(Object.create(null),i);for(const s in t)e[s]=vs(i[s],t[s]);return e}function w0(){return{app:null,config:{isNativeTag:Sb,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let E_=0;function k_(i,t){return function(s,n=null){Rt(s)||(s=De({},s)),n!=null&&!re(n)&&(n=null);const r=w0(),o=new WeakSet,a=[];let c=!1;const u=r.app={_uid:E_++,_component:s,_props:n,_container:null,_context:r,_instance:null,version:rA,get config(){return r.config},set config(h){},use(h,...d){return o.has(h)||(h&&Rt(h.install)?(o.add(h),h.install(u,...d)):Rt(h)&&(o.add(h),h(u,...d))),u},mixin(h){return r.mixins.includes(h)||r.mixins.push(h),u},component(h,d){return d?(r.components[h]=d,u):r.components[h]},directive(h,d){return d?(r.directives[h]=d,u):r.directives[h]},mount(h,d,f){if(!c){const p=u._ceVNode||kt(s,n);return p.appContext=r,f===!0?f="svg":f===!1&&(f=void 0),i(p,h,f),c=!0,u._container=h,h.__vue_app__=u,Of(p.component)}},onUnmount(h){a.push(h)},unmount(){c&&(Bi(a,u._instance,16),i(null,u._container),delete u._container.__vue_app__)},provide(h,d){return r.provides[h]=d,u},runWithContext(h){const d=Ea;Ea=u;try{return h()}finally{Ea=d}}};return u}}let Ea=null;const T_=(i,t)=>t==="modelValue"||t==="model-value"?i.modelModifiers:i[`${t}Modifiers`]||i[`${mi(t)}Modifiers`]||i[`${oo(t)}Modifiers`];function P_(i,t,...e){if(i.isUnmounted)return;const s=i.vnode.props||oe;let n=e;const r=t.startsWith("update:"),o=r&&T_(s,t.slice(7));o&&(o.trim&&(n=e.map(h=>Se(h)?h.trim():h)),o.number&&(n=e.map(Cf)));let a,c=s[a=Kf(t)]||s[a=Kf(mi(t))];!c&&r&&(c=s[a=Kf(oo(t))]),c&&Bi(c,i,6,n);const u=s[a+"Once"];if(u){if(!i.emitted)i.emitted={};else if(i.emitted[a])return;i.emitted[a]=!0,Bi(u,i,6,n)}}const R_=new WeakMap;function _0(i,t,e=!1){const s=e?R_:t.emitsCache,n=s.get(i);if(n!==void 0)return n;const r=i.emits;let o={},a=!1;if(!Rt(i)){const c=u=>{const h=_0(u,t,!0);h&&(a=!0,De(o,h))};!e&&t.mixins.length&&t.mixins.forEach(c),i.extends&&c(i.extends),i.mixins&&i.mixins.forEach(c)}return!r&&!a?(re(i)&&s.set(i,null),null):(At(r)?r.forEach(c=>o[c]=null):De(o,r),re(i)&&s.set(i,o),o)}function If(i,t){return!i||!_f(t)?!1:(t=t.slice(2).replace(/Once$/,""),Qt(i,t[0].toLowerCase()+t.slice(1))||Qt(i,oo(t))||Qt(i,t))}function lv(i){const{type:t,vnode:e,proxy:s,withProxy:n,propsOptions:[r],slots:o,attrs:a,emit:c,render:u,renderCache:h,props:d,data:f,setupState:p,ctx:m,inheritAttrs:v}=i,_=jd(i);let b,A;try{if(e.shapeFlag&4){const C=n||s,T=C;b=gn(u.call(T,C,h,d,p,f,m)),A=a}else{const C=t;b=gn(C.length>1?C(d,{attrs:a,slots:o,emit:c}):C(d,null)),A=t.props?a:M_(a)}}catch(C){qc.length=0,Pf(C,i,1),b=kt(fs)}let x=b;if(A&&v!==!1){const C=Object.keys(A),{shapeFlag:T}=x;C.length&&T&7&&(r&&C.some(em)&&(A=I_(A,r)),x=eo(x,A,!1,!0))}return e.dirs&&(x=eo(x,null,!1,!0),x.dirs=x.dirs?x.dirs.concat(e.dirs):e.dirs),e.transition&&Pa(x,e.transition),b=x,jd(_),b}const M_=i=>{let t;for(const e in i)(e==="class"||e==="style"||_f(e))&&((t||(t={}))[e]=i[e]);return t},I_=(i,t)=>{const e={};for(const s in i)(!em(s)||!(s.slice(9)in t))&&(e[s]=i[s]);return e};function L_(i,t,e){const{props:s,children:n,component:r}=i,{props:o,children:a,patchFlag:c}=t,u=r.emitsOptions;if(t.dirs||t.transition)return!0;if(e&&c>=0){if(c&1024)return!0;if(c&16)return s?cv(s,o,u):!!o;if(c&8){const h=t.dynamicProps;for(let d=0;d<h.length;d++){const f=h[d];if(o[f]!==s[f]&&!If(u,f))return!0}}}else return(n||a)&&(!a||!a.$stable)?!0:s===o?!1:s?o?cv(s,o,u):!0:!!o;return!1}function cv(i,t,e){const s=Object.keys(t);if(s.length!==Object.keys(i).length)return!0;for(let n=0;n<s.length;n++){const r=s[n];if(t[r]!==i[r]&&!If(e,r))return!0}return!1}function D_({vnode:i,parent:t},e){for(;t;){const s=t.subTree;if(s.suspense&&s.suspense.activeBranch===i&&(s.el=i.el),s===i)(i=t.vnode).el=e,t=t.parent;else break}}const A0={},S0=()=>Object.create(A0),x0=i=>Object.getPrototypeOf(i)===A0;function O_(i,t,e,s=!1){const n={},r=S0();i.propsDefaults=Object.create(null),C0(i,t,n,r);for(const o in i.propsOptions[0])o in n||(n[o]=void 0);e?i.props=s?n:Xb(n):i.type.props?i.props=n:i.props=r,i.attrs=r}function N_(i,t,e,s){const{props:n,attrs:r,vnode:{patchFlag:o}}=i,a=Gt(n),[c]=i.propsOptions;let u=!1;if((s||o>0)&&!(o&16)){if(o&8){const h=i.vnode.dynamicProps;for(let d=0;d<h.length;d++){let f=h[d];if(If(i.emitsOptions,f))continue;const p=t[f];if(c)if(Qt(r,f))p!==r[f]&&(r[f]=p,u=!0);else{const m=mi(f);n[m]=Rp(c,a,m,p,i,!1)}else p!==r[f]&&(r[f]=p,u=!0)}}}else{C0(i,t,n,r)&&(u=!0);let h;for(const d in a)(!t||!Qt(t,d)&&((h=oo(d))===d||!Qt(t,h)))&&(c?e&&(e[d]!==void 0||e[h]!==void 0)&&(n[d]=Rp(c,a,d,void 0,i,!0)):delete n[d]);if(r!==a)for(const d in r)(!t||!Qt(t,d))&&(delete r[d],u=!0)}u&&Zn(i.attrs,"set","")}function C0(i,t,e,s){const[n,r]=i.propsOptions;let o=!1,a;if(t)for(let c in t){if(jc(c))continue;const u=t[c];let h;n&&Qt(n,h=mi(c))?!r||!r.includes(h)?e[h]=u:(a||(a={}))[h]=u:If(i.emitsOptions,c)||(!(c in s)||u!==s[c])&&(s[c]=u,o=!0)}if(r){const c=Gt(e),u=a||oe;for(let h=0;h<r.length;h++){const d=r[h];e[d]=Rp(n,c,d,u[d],i,!Qt(u,d))}}return o}function Rp(i,t,e,s,n,r){const o=i[e];if(o!=null){const a=Qt(o,"default");if(a&&s===void 0){const c=o.default;if(o.type!==Function&&!o.skipFactory&&Rt(c)){const{propsDefaults:u}=n;if(e in u)s=u[e];else{const h=Bh(n);s=u[e]=c.call(null,t),h()}}else s=c;n.ce&&n.ce._setProp(e,s)}o[0]&&(r&&!a?s=!1:o[1]&&(s===""||s===oo(e))&&(s=!0))}return s}const F_=new WeakMap;function E0(i,t,e=!1){const s=e?F_:t.propsCache,n=s.get(i);if(n)return n;const r=i.props,o={},a=[];let c=!1;if(!Rt(i)){const h=d=>{c=!0;const[f,p]=E0(d,t,!0);De(o,f),p&&a.push(...p)};!e&&t.mixins.length&&t.mixins.forEach(h),i.extends&&h(i.extends),i.mixins&&i.mixins.forEach(h)}if(!r&&!c)return re(i)&&s.set(i,Ja),Ja;if(At(r))for(let h=0;h<r.length;h++){const d=mi(r[h]);uv(d)&&(o[d]=oe)}else if(r)for(const h in r){const d=mi(h);if(uv(d)){const f=r[h],p=o[d]=At(f)||Rt(f)?{type:f}:De({},f),m=p.type;let v=!1,_=!0;if(At(m))for(let b=0;b<m.length;++b){const A=m[b],x=Rt(A)&&A.name;if(x==="Boolean"){v=!0;break}else x==="String"&&(_=!1)}else v=Rt(m)&&m.name==="Boolean";p[0]=v,p[1]=_,(v||Qt(p,"default"))&&a.push(d)}}const u=[o,a];return re(i)&&s.set(i,u),u}function uv(i){return i[0]!=="$"&&!jc(i)}const pm=i=>i==="_"||i==="_ctx"||i==="$stable",gm=i=>At(i)?i.map(gn):[gn(i)],$_=(i,t,e)=>{if(t._n)return t;const s=zt((...n)=>gm(t(...n)),e);return s._c=!1,s},k0=(i,t,e)=>{const s=i._ctx;for(const n in i){if(pm(n))continue;const r=i[n];if(Rt(r))t[n]=$_(n,r,s);else if(r!=null){const o=gm(r);t[n]=()=>o}}},T0=(i,t)=>{const e=gm(t);i.slots.default=()=>e},P0=(i,t,e)=>{for(const s in t)(e||!pm(s))&&(i[s]=t[s])},B_=(i,t,e)=>{const s=i.slots=S0();if(i.vnode.shapeFlag&32){const n=t._;n?(P0(s,t,e),e&&kb(s,"_",n,!0)):k0(t,s)}else t&&T0(i,t)},H_=(i,t,e)=>{const{vnode:s,slots:n}=i;let r=!0,o=oe;if(s.shapeFlag&32){const a=t._;a?e&&a===1?r=!1:P0(n,t,e):(r=!t.$stable,k0(t,n)),o=t}else t&&(T0(i,t),o={default:1});if(r)for(const a in n)!pm(a)&&o[a]==null&&delete n[a]},Ss=z_;function j_(i){return V_(i)}function V_(i,t){const e=Ef();e.__VUE__=!0;const{insert:s,remove:n,patchProp:r,createElement:o,createText:a,createComment:c,setText:u,setElementText:h,parentNode:d,nextSibling:f,setScopeId:p=mn,insertStaticContent:m}=i,v=(E,k,O,z=null,X=null,W=null,rt=void 0,it=null,et=!!k.dynamicChildren)=>{if(E===k)return;E&&!vo(E,k)&&(z=U(E),Pt(E,X,W,!0),E=null),k.patchFlag===-2&&(et=!1,k.dynamicChildren=null);const{type:K,ref:yt,shapeFlag:ct}=k;switch(K){case Lf:_(E,k,O,z);break;case fs:b(E,k,O,z);break;case rd:E==null&&A(k,O,z,rt);break;case me:I(E,k,O,z,X,W,rt,it,et);break;default:ct&1?T(E,k,O,z,X,W,rt,it,et):ct&6?F(E,k,O,z,X,W,rt,it,et):(ct&64||ct&128)&&K.process(E,k,O,z,X,W,rt,it,et,ht)}yt!=null&&X?zc(yt,E&&E.ref,W,k||E,!k):yt==null&&E&&E.ref!=null&&zc(E.ref,null,W,E,!0)},_=(E,k,O,z)=>{if(E==null)s(k.el=a(k.children),O,z);else{const X=k.el=E.el;k.children!==E.children&&u(X,k.children)}},b=(E,k,O,z)=>{E==null?s(k.el=c(k.children||""),O,z):k.el=E.el},A=(E,k,O,z)=>{[E.el,E.anchor]=m(E.children,k,O,z,E.el,E.anchor)},x=({el:E,anchor:k},O,z)=>{let X;for(;E&&E!==k;)X=f(E),s(E,O,z),E=X;s(k,O,z)},C=({el:E,anchor:k})=>{let O;for(;E&&E!==k;)O=f(E),n(E),E=O;n(k)},T=(E,k,O,z,X,W,rt,it,et)=>{if(k.type==="svg"?rt="svg":k.type==="math"&&(rt="mathml"),E==null)D(k,O,z,X,W,rt,it,et);else{const K=E.el&&E.el._isVueCE?E.el:null;try{K&&K._beginPatch(),L(E,k,X,W,rt,it,et)}finally{K&&K._endPatch()}}},D=(E,k,O,z,X,W,rt,it)=>{let et,K;const{props:yt,shapeFlag:ct,transition:Y,dirs:R}=E;if(et=E.el=o(E.type,W,yt&&yt.is,yt),ct&8?h(et,E.children):ct&16&&j(E.children,et,null,z,X,sp(E,W),rt,it),R&&co(E,null,z,"created"),P(et,E,E.scopeId,rt,z),yt){for(const gt in yt)gt!=="value"&&!jc(gt)&&r(et,gt,null,yt[gt],W,z);"value"in yt&&r(et,"value",null,yt.value,W),(K=yt.onVnodeBeforeMount)&&zi(K,z,E)}R&&co(E,null,z,"beforeMount");const st=U_(X,Y);st&&Y.beforeEnter(et),s(et,k,O),((K=yt&&yt.onVnodeMounted)||st||R)&&Ss(()=>{K&&zi(K,z,E),st&&Y.enter(et),R&&co(E,null,z,"mounted")},X)},P=(E,k,O,z,X)=>{if(O&&p(E,O),z)for(let W=0;W<z.length;W++)p(E,z[W]);if(X){let W=X.subTree;if(k===W||I0(W.type)&&(W.ssContent===k||W.ssFallback===k)){const rt=X.vnode;P(E,rt,rt.scopeId,rt.slotScopeIds,X.parent)}}},j=(E,k,O,z,X,W,rt,it,et=0)=>{for(let K=et;K<E.length;K++){const yt=E[K]=it?yr(E[K]):gn(E[K]);v(null,yt,k,O,z,X,W,rt,it)}},L=(E,k,O,z,X,W,rt)=>{const it=k.el=E.el;let{patchFlag:et,dynamicChildren:K,dirs:yt}=k;et|=E.patchFlag&16;const ct=E.props||oe,Y=k.props||oe;let R;if(O&&uo(O,!1),(R=Y.onVnodeBeforeUpdate)&&zi(R,O,k,E),yt&&co(k,E,O,"beforeUpdate"),O&&uo(O,!0),(ct.innerHTML&&Y.innerHTML==null||ct.textContent&&Y.textContent==null)&&h(it,""),K?$(E.dynamicChildren,K,it,O,z,sp(k,X),W):rt||Z(E,k,it,null,O,z,sp(k,X),W,!1),et>0){if(et&16)N(it,ct,Y,O,X);else if(et&2&&ct.class!==Y.class&&r(it,"class",null,Y.class,X),et&4&&r(it,"style",ct.style,Y.style,X),et&8){const st=k.dynamicProps;for(let gt=0;gt<st.length;gt++){const Ct=st[gt],Vt=ct[Ct],Ce=Y[Ct];(Ce!==Vt||Ct==="value")&&r(it,Ct,Vt,Ce,X,O)}}et&1&&E.children!==k.children&&h(it,k.children)}else!rt&&K==null&&N(it,ct,Y,O,X);((R=Y.onVnodeUpdated)||yt)&&Ss(()=>{R&&zi(R,O,k,E),yt&&co(k,E,O,"updated")},z)},$=(E,k,O,z,X,W,rt)=>{for(let it=0;it<k.length;it++){const et=E[it],K=k[it],yt=et.el&&(et.type===me||!vo(et,K)||et.shapeFlag&198)?d(et.el):O;v(et,K,yt,null,z,X,W,rt,!0)}},N=(E,k,O,z,X)=>{if(k!==O){if(k!==oe)for(const W in k)!jc(W)&&!(W in O)&&r(E,W,k[W],null,X,z);for(const W in O){if(jc(W))continue;const rt=O[W],it=k[W];rt!==it&&W!=="value"&&r(E,W,it,rt,X,z)}"value"in O&&r(E,"value",k.value,O.value,X)}},I=(E,k,O,z,X,W,rt,it,et)=>{const K=k.el=E?E.el:a(""),yt=k.anchor=E?E.anchor:a("");let{patchFlag:ct,dynamicChildren:Y,slotScopeIds:R}=k;R&&(it=it?it.concat(R):R),E==null?(s(K,O,z),s(yt,O,z),j(k.children||[],O,yt,X,W,rt,it,et)):ct>0&&ct&64&&Y&&E.dynamicChildren&&E.dynamicChildren.length===Y.length?($(E.dynamicChildren,Y,O,X,W,rt,it),(k.key!=null||X&&k===X.subTree)&&mm(E,k,!0)):Z(E,k,O,yt,X,W,rt,it,et)},F=(E,k,O,z,X,W,rt,it,et)=>{k.slotScopeIds=it,E==null?k.shapeFlag&512?X.ctx.activate(k,O,z,rt,et):Q(k,O,z,X,W,rt,et):J(E,k,et)},Q=(E,k,O,z,X,W,rt)=>{const it=E.component=Q_(E,z,X);if(Rf(E)&&(it.ctx.renderer=ht),Z_(it,!1,rt),it.asyncDep){if(X&&X.registerDep(it,H,rt),!E.el){const et=it.subTree=kt(fs);b(null,et,k,O),E.placeholder=et.el}}else H(it,E,k,O,X,W,rt)},J=(E,k,O)=>{const z=k.component=E.component;if(L_(E,k,O))if(z.asyncDep&&!z.asyncResolved){V(z,k,O);return}else z.next=k,z.update();else k.el=E.el,z.vnode=k},H=(E,k,O,z,X,W,rt)=>{const it=()=>{if(E.isMounted){let{next:ct,bu:Y,u:R,parent:st,vnode:gt}=E;{const Re=R0(E);if(Re){ct&&(ct.el=gt.el,V(E,ct,rt)),Re.asyncDep.then(()=>{E.isUnmounted||it()});return}}let Ct=ct,Vt;uo(E,!1),ct?(ct.el=gt.el,V(E,ct,rt)):ct=gt,Y&&sd(Y),(Vt=ct.props&&ct.props.onVnodeBeforeUpdate)&&zi(Vt,st,ct,gt),uo(E,!0);const Ce=lv(E),Xe=E.subTree;E.subTree=Ce,v(Xe,Ce,d(Xe.el),U(Xe),E,X,W),ct.el=Ce.el,Ct===null&&D_(E,Ce.el),R&&Ss(R,X),(Vt=ct.props&&ct.props.onVnodeUpdated)&&Ss(()=>zi(Vt,st,ct,gt),X)}else{let ct;const{el:Y,props:R}=k,{bm:st,m:gt,parent:Ct,root:Vt,type:Ce}=E,Xe=tl(k);uo(E,!1),st&&sd(st),!Xe&&(ct=R&&R.onVnodeBeforeMount)&&zi(ct,Ct,k),uo(E,!0);{Vt.ce&&Vt.ce._def.shadowRoot!==!1&&Vt.ce._injectChildStyle(Ce);const Re=E.subTree=lv(E);v(null,Re,O,z,E,X,W),k.el=Re.el}if(gt&&Ss(gt,X),!Xe&&(ct=R&&R.onVnodeMounted)){const Re=k;Ss(()=>zi(ct,Ct,Re),X)}(k.shapeFlag&256||Ct&&tl(Ct.vnode)&&Ct.vnode.shapeFlag&256)&&E.a&&Ss(E.a,X),E.isMounted=!0,k=O=z=null}};E.scope.on();const et=E.effect=new Db(it);E.scope.off();const K=E.update=et.run.bind(et),yt=E.job=et.runIfDirty.bind(et);yt.i=E,yt.id=E.uid,et.scheduler=()=>hm(yt),uo(E,!0),K()},V=(E,k,O)=>{k.component=E;const z=E.vnode.props;E.vnode=k,E.next=null,N_(E,k.props,z,O),H_(E,k.children,O),or(),Km(E),ar()},Z=(E,k,O,z,X,W,rt,it,et=!1)=>{const K=E&&E.children,yt=E?E.shapeFlag:0,ct=k.children,{patchFlag:Y,shapeFlag:R}=k;if(Y>0){if(Y&128){wt(K,ct,O,z,X,W,rt,it,et);return}else if(Y&256){St(K,ct,O,z,X,W,rt,it,et);return}}R&8?(yt&16&&qt(K,X,W),ct!==K&&h(O,ct)):yt&16?R&16?wt(K,ct,O,z,X,W,rt,it,et):qt(K,X,W,!0):(yt&8&&h(O,""),R&16&&j(ct,O,z,X,W,rt,it,et))},St=(E,k,O,z,X,W,rt,it,et)=>{E=E||Ja,k=k||Ja;const K=E.length,yt=k.length,ct=Math.min(K,yt);let Y;for(Y=0;Y<ct;Y++){const R=k[Y]=et?yr(k[Y]):gn(k[Y]);v(E[Y],R,O,null,X,W,rt,it,et)}K>yt?qt(E,X,W,!0,!1,ct):j(k,O,z,X,W,rt,it,et,ct)},wt=(E,k,O,z,X,W,rt,it,et)=>{let K=0;const yt=k.length;let ct=E.length-1,Y=yt-1;for(;K<=ct&&K<=Y;){const R=E[K],st=k[K]=et?yr(k[K]):gn(k[K]);if(vo(R,st))v(R,st,O,null,X,W,rt,it,et);else break;K++}for(;K<=ct&&K<=Y;){const R=E[ct],st=k[Y]=et?yr(k[Y]):gn(k[Y]);if(vo(R,st))v(R,st,O,null,X,W,rt,it,et);else break;ct--,Y--}if(K>ct){if(K<=Y){const R=Y+1,st=R<yt?k[R].el:z;for(;K<=Y;)v(null,k[K]=et?yr(k[K]):gn(k[K]),O,st,X,W,rt,it,et),K++}}else if(K>Y)for(;K<=ct;)Pt(E[K],X,W,!0),K++;else{const R=K,st=K,gt=new Map;for(K=st;K<=Y;K++){const M=k[K]=et?yr(k[K]):gn(k[K]);M.key!=null&&gt.set(M.key,K)}let Ct,Vt=0;const Ce=Y-st+1;let Xe=!1,Re=0;const vi=new Array(Ce);for(K=0;K<Ce;K++)vi[K]=0;for(K=R;K<=ct;K++){const M=E[K];if(Vt>=Ce){Pt(M,X,W,!0);continue}let lt;if(M.key!=null)lt=gt.get(M.key);else for(Ct=st;Ct<=Y;Ct++)if(vi[Ct-st]===0&&vo(M,k[Ct])){lt=Ct;break}lt===void 0?Pt(M,X,W,!0):(vi[lt-st]=K+1,lt>=Re?Re=lt:Xe=!0,v(M,k[lt],O,null,X,W,rt,it,et),Vt++)}const B=Xe?G_(vi):Ja;for(Ct=B.length-1,K=Ce-1;K>=0;K--){const M=st+K,lt=k[M],Ee=k[M+1],Ps=M+1<yt?Ee.el||M0(Ee):z;vi[K]===0?v(null,lt,O,Ps,X,W,rt,it,et):Xe&&(Ct<0||K!==B[Ct]?_t(lt,O,Ps,2):Ct--)}}},_t=(E,k,O,z,X=null)=>{const{el:W,type:rt,transition:it,children:et,shapeFlag:K}=E;if(K&6){_t(E.component.subTree,k,O,z);return}if(K&128){E.suspense.move(k,O,z);return}if(K&64){rt.move(E,k,O,ht);return}if(rt===me){s(W,k,O);for(let ct=0;ct<et.length;ct++)_t(et[ct],k,O,z);s(E.anchor,k,O);return}if(rt===rd){x(E,k,O);return}if(z!==2&&K&1&&it)if(z===0)it.beforeEnter(W),s(W,k,O),Ss(()=>it.enter(W),X);else{const{leave:ct,delayLeave:Y,afterLeave:R}=it,st=()=>{E.ctx.isUnmounted?n(W):s(W,k,O)},gt=()=>{W._isLeaving&&W[kn](!0),ct(W,()=>{st(),R&&R()})};Y?Y(W,st,gt):gt()}else s(W,k,O)},Pt=(E,k,O,z=!1,X=!1)=>{const{type:W,props:rt,ref:it,children:et,dynamicChildren:K,shapeFlag:yt,patchFlag:ct,dirs:Y,cacheIndex:R}=E;if(ct===-2&&(X=!1),it!=null&&(or(),zc(it,null,O,E,!0),ar()),R!=null&&(k.renderCache[R]=void 0),yt&256){k.ctx.deactivate(E);return}const st=yt&1&&Y,gt=!tl(E);let Ct;if(gt&&(Ct=rt&&rt.onVnodeBeforeUnmount)&&zi(Ct,k,E),yt&6)xe(E.component,O,z);else{if(yt&128){E.suspense.unmount(O,z);return}st&&co(E,null,k,"beforeUnmount"),yt&64?E.type.remove(E,k,O,ht,z):K&&!K.hasOnce&&(W!==me||ct>0&&ct&64)?qt(K,k,O,!1,!0):(W===me&&ct&384||!X&&yt&16)&&qt(et,k,O),z&&Mt(E)}(gt&&(Ct=rt&&rt.onVnodeUnmounted)||st)&&Ss(()=>{Ct&&zi(Ct,k,E),st&&co(E,null,k,"unmounted")},O)},Mt=E=>{const{type:k,el:O,anchor:z,transition:X}=E;if(k===me){Ht(O,z);return}if(k===rd){C(E);return}const W=()=>{n(O),X&&!X.persisted&&X.afterLeave&&X.afterLeave()};if(E.shapeFlag&1&&X&&!X.persisted){const{leave:rt,delayLeave:it}=X,et=()=>rt(O,W);it?it(E.el,W,et):et()}else W()},Ht=(E,k)=>{let O;for(;E!==k;)O=f(E),n(E),E=O;n(k)},xe=(E,k,O)=>{const{bum:z,scope:X,job:W,subTree:rt,um:it,m:et,a:K}=E;hv(et),hv(K),z&&sd(z),X.stop(),W&&(W.flags|=8,Pt(rt,E,k,O)),it&&Ss(it,k),Ss(()=>{E.isUnmounted=!0},k)},qt=(E,k,O,z=!1,X=!1,W=0)=>{for(let rt=W;rt<E.length;rt++)Pt(E[rt],k,O,z,X)},U=E=>{if(E.shapeFlag&6)return U(E.component.subTree);if(E.shapeFlag&128)return E.suspense.next();const k=f(E.anchor||E.el),O=k&&k[n0];return O?f(O):k};let nt=!1;const ot=(E,k,O)=>{let z;E==null?k._vnode&&(Pt(k._vnode,null,null,!0),z=k._vnode.component):v(k._vnode||null,E,k,null,null,null,O),k._vnode=E,nt||(nt=!0,Km(z),Zb(),nt=!1)},ht={p:v,um:Pt,m:_t,r:Mt,mt:Q,mc:j,pc:Z,pbc:$,n:U,o:i};return{render:ot,hydrate:void 0,createApp:k_(ot)}}function sp({type:i,props:t},e){return e==="svg"&&i==="foreignObject"||e==="mathml"&&i==="annotation-xml"&&t&&t.encoding&&t.encoding.includes("html")?void 0:e}function uo({effect:i,job:t},e){e?(i.flags|=32,t.flags|=4):(i.flags&=-33,t.flags&=-5)}function U_(i,t){return(!i||i&&!i.pendingBranch)&&t&&!t.persisted}function mm(i,t,e=!1){const s=i.children,n=t.children;if(At(s)&&At(n))for(let r=0;r<s.length;r++){const o=s[r];let a=n[r];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=n[r]=yr(n[r]),a.el=o.el),!e&&a.patchFlag!==-2&&mm(o,a)),a.type===Lf&&(a.patchFlag!==-1?a.el=o.el:a.__elIndex=r+(i.type===me?1:0)),a.type===fs&&!a.el&&(a.el=o.el)}}function G_(i){const t=i.slice(),e=[0];let s,n,r,o,a;const c=i.length;for(s=0;s<c;s++){const u=i[s];if(u!==0){if(n=e[e.length-1],i[n]<u){t[s]=n,e.push(s);continue}for(r=0,o=e.length-1;r<o;)a=r+o>>1,i[e[a]]<u?r=a+1:o=a;u<i[e[r]]&&(r>0&&(t[s]=e[r-1]),e[r]=s)}}for(r=e.length,o=e[r-1];r-- >0;)e[r]=o,o=t[o];return e}function R0(i){const t=i.subTree.component;if(t)return t.asyncDep&&!t.asyncResolved?t:R0(t)}function hv(i){if(i)for(let t=0;t<i.length;t++)i[t].flags|=8}function M0(i){if(i.placeholder)return i.placeholder;const t=i.component;return t?M0(t.subTree):null}const I0=i=>i.__isSuspense;function z_(i,t){t&&t.pendingBranch?At(i)?t.effects.push(...i):t.effects.push(i):t_(i)}const me=Symbol.for("v-fgt"),Lf=Symbol.for("v-txt"),fs=Symbol.for("v-cmt"),rd=Symbol.for("v-stc"),qc=[];let Zs=null;function G(i=!1){qc.push(Zs=i?null:[])}function W_(){qc.pop(),Zs=qc[qc.length-1]||null}let su=1;function Gd(i,t=!1){su+=i,i<0&&Zs&&t&&(Zs.hasOnce=!0)}function L0(i){return i.dynamicChildren=su>0?Zs||Ja:null,W_(),su>0&&Zs&&Zs.push(i),i}function q(i,t,e,s,n,r){return L0(S(i,t,e,s,n,r,!0))}function vn(i,t,e,s,n){return L0(kt(i,t,e,s,n,!0))}function iu(i){return i?i.__v_isVNode===!0:!1}function vo(i,t){return i.type===t.type&&i.key===t.key}const D0=({key:i})=>i??null,od=({ref:i,ref_key:t,ref_for:e})=>(typeof i=="number"&&(i=""+i),i!=null?Se(i)||Ae(i)||Rt(i)?{i:ss,r:i,k:t,f:!!e}:i:null);function S(i,t=null,e=null,s=0,n=null,r=i===me?0:1,o=!1,a=!1){const c={__v_isVNode:!0,__v_skip:!0,type:i,props:t,key:t&&D0(t),ref:t&&od(t),scopeId:e0,slotScopeIds:null,children:e,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:r,patchFlag:s,dynamicProps:n,dynamicChildren:null,appContext:null,ctx:ss};return a?(vm(c,e),r&128&&i.normalize(c)):e&&(c.shapeFlag|=Se(e)?8:16),su>0&&!o&&Zs&&(c.patchFlag>0||r&6)&&c.patchFlag!==32&&Zs.push(c),c}const kt=q_;function q_(i,t=null,e=null,s=0,n=null,r=!1){if((!i||i===b_)&&(i=fs),iu(i)){const a=eo(i,t,!0);return e&&vm(a,e),su>0&&!r&&Zs&&(a.shapeFlag&6?Zs[Zs.indexOf(i)]=a:Zs.push(a)),a.patchFlag=-2,a}if(nA(i)&&(i=i.__vccOpts),t){t=X_(t);let{class:a,style:c}=t;a&&!Se(a)&&(t.class=Yt(a)),re(c)&&(Tf(c)&&!At(c)&&(c=De({},c)),t.style=Js(c))}const o=Se(i)?1:I0(i)?128:r0(i)?64:re(i)?4:Rt(i)?2:0;return S(i,t,e,s,n,o,r,!0)}function X_(i){return i?Tf(i)||x0(i)?De({},i):i:null}function eo(i,t,e=!1,s=!1){const{props:n,ref:r,patchFlag:o,children:a,transition:c}=i,u=t?K_(n||{},t):n,h={__v_isVNode:!0,__v_skip:!0,type:i.type,props:u,key:u&&D0(u),ref:t&&t.ref?e&&r?At(r)?r.concat(od(t)):[r,od(t)]:od(t):r,scopeId:i.scopeId,slotScopeIds:i.slotScopeIds,children:a,target:i.target,targetStart:i.targetStart,targetAnchor:i.targetAnchor,staticCount:i.staticCount,shapeFlag:i.shapeFlag,patchFlag:t&&i.type!==me?o===-1?16:o|16:o,dynamicProps:i.dynamicProps,dynamicChildren:i.dynamicChildren,appContext:i.appContext,dirs:i.dirs,transition:c,component:i.component,suspense:i.suspense,ssContent:i.ssContent&&eo(i.ssContent),ssFallback:i.ssFallback&&eo(i.ssFallback),placeholder:i.placeholder,el:i.el,anchor:i.anchor,ctx:i.ctx,ce:i.ce};return c&&s&&Pa(h,c.clone(h)),h}function Nt(i=" ",t=0){return kt(Lf,null,i,t)}function nu(i,t){const e=kt(rd,null,i);return e.staticCount=t,e}function Et(i="",t=!1){return t?(G(),vn(fs,null,i)):kt(fs,null,i)}function gn(i){return i==null||typeof i=="boolean"?kt(fs):At(i)?kt(me,null,i.slice()):iu(i)?yr(i):kt(Lf,null,String(i))}function yr(i){return i.el===null&&i.patchFlag!==-1||i.memo?i:eo(i)}function vm(i,t){let e=0;const{shapeFlag:s}=i;if(t==null)t=null;else if(At(t))e=16;else if(typeof t=="object")if(s&65){const n=t.default;n&&(n._c&&(n._d=!1),vm(i,n()),n._c&&(n._d=!0));return}else{e=32;const n=t._;!n&&!x0(t)?t._ctx=ss:n===3&&ss&&(ss.slots._===1?t._=1:(t._=2,i.patchFlag|=1024))}else Rt(t)?(t={default:t,_ctx:ss},e=32):(t=String(t),s&64?(e=16,t=[Nt(t)]):e=8);i.children=t,i.shapeFlag|=e}function K_(...i){const t={};for(let e=0;e<i.length;e++){const s=i[e];for(const n in s)if(n==="class")t.class!==s.class&&(t.class=Yt([t.class,s.class]));else if(n==="style")t.style=Js([t.style,s.style]);else if(_f(n)){const r=t[n],o=s[n];o&&r!==o&&!(At(r)&&r.includes(o))&&(t[n]=r?[].concat(r,o):o)}else n!==""&&(t[n]=s[n])}return t}function zi(i,t,e,s=null){Bi(i,t,7,[e,s])}const Y_=w0();let J_=0;function Q_(i,t,e){const s=i.type,n=(t?t.appContext:i.appContext)||Y_,r={uid:J_++,vnode:i,type:s,parent:t,appContext:n,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new Mb(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(n.provides),ids:t?t.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:E0(s,n),emitsOptions:_0(s,n),emit:null,emitted:null,propsDefaults:oe,inheritAttrs:s.inheritAttrs,ctx:oe,data:oe,props:oe,attrs:oe,slots:oe,refs:oe,setupState:oe,setupContext:null,suspense:e,suspenseId:e?e.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return r.ctx={_:r},r.root=t?t.root:r,r.emit=P_.bind(null,r),i.ce&&i.ce(r),r}let ps=null;const Df=()=>ps||ss;let zd,Mp;{const i=Ef(),t=(e,s)=>{let n;return(n=i[e])||(n=i[e]=[]),n.push(s),r=>{n.length>1?n.forEach(o=>o(r)):n[0](r)}};zd=t("__VUE_INSTANCE_SETTERS__",e=>ps=e),Mp=t("__VUE_SSR_SETTERS__",e=>ru=e)}const Bh=i=>{const t=ps;return zd(i),i.scope.on(),()=>{i.scope.off(),zd(t)}},dv=()=>{ps&&ps.scope.off(),zd(null)};function O0(i){return i.vnode.shapeFlag&4}let ru=!1;function Z_(i,t=!1,e=!1){t&&Mp(t);const{props:s,children:n}=i.vnode,r=O0(i);O_(i,s,r,t),B_(i,n,e||t);const o=r?tA(i,t):void 0;return t&&Mp(!1),o}function tA(i,t){const e=i.type;i.accessCache=Object.create(null),i.proxy=new Proxy(i.ctx,w_);const{setup:s}=e;if(s){or();const n=i.setupContext=s.length>1?sA(i):null,r=Bh(i),o=Fh(s,i,0,[i.props,n]),a=xb(o);if(ar(),r(),(a||i.sp)&&!tl(i)&&f0(i),a){if(o.then(dv,dv),t)return o.then(c=>{fv(i,c)}).catch(c=>{Pf(c,i,0)});i.asyncDep=o}else fv(i,o)}else N0(i)}function fv(i,t,e){Rt(t)?i.type.__ssrInlineRender?i.ssrRender=t:i.render=t:re(t)&&(i.setupState=Yb(t)),N0(i)}function N0(i,t,e){const s=i.type;i.render||(i.render=s.render||mn);{const n=Bh(i);or();try{__(i)}finally{ar(),n()}}}const eA={get(i,t){return ds(i,"get",""),i[t]}};function sA(i){const t=e=>{i.exposed=e||{}};return{attrs:new Proxy(i.attrs,eA),slots:i.slots,emit:i.emit,expose:t}}function Of(i){return i.exposed?i.exposeProxy||(i.exposeProxy=new Proxy(Yb(um(i.exposed)),{get(t,e){if(e in t)return t[e];if(e in Wc)return Wc[e](i)},has(t,e){return e in t||e in Wc}})):i.proxy}function iA(i,t=!0){return Rt(i)?i.displayName||i.name:i.name||t&&i.__name}function nA(i){return Rt(i)&&"__vccOpts"in i}const jt=(i,t)=>K1(i,t,ru);function bm(i,t,e){try{Gd(-1);const s=arguments.length;return s===2?re(t)&&!At(t)?iu(t)?kt(i,null,[t]):kt(i,t):kt(i,null,t):(s>3?e=Array.prototype.slice.call(arguments,2):s===3&&iu(e)&&(e=[e]),kt(i,t,e))}finally{Gd(1)}}const rA="3.5.27";/**
* @vue/runtime-dom v3.5.27
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Ip;const pv=typeof window<"u"&&window.trustedTypes;if(pv)try{Ip=pv.createPolicy("vue",{createHTML:i=>i})}catch{}const F0=Ip?i=>Ip.createHTML(i):i=>i,oA="http://www.w3.org/2000/svg",aA="http://www.w3.org/1998/Math/MathML",xn=typeof document<"u"?document:null,gv=xn&&xn.createElement("template"),lA={insert:(i,t,e)=>{t.insertBefore(i,e||null)},remove:i=>{const t=i.parentNode;t&&t.removeChild(i)},createElement:(i,t,e,s)=>{const n=t==="svg"?xn.createElementNS(oA,i):t==="mathml"?xn.createElementNS(aA,i):e?xn.createElement(i,{is:e}):xn.createElement(i);return i==="select"&&s&&s.multiple!=null&&n.setAttribute("multiple",s.multiple),n},createText:i=>xn.createTextNode(i),createComment:i=>xn.createComment(i),setText:(i,t)=>{i.nodeValue=t},setElementText:(i,t)=>{i.textContent=t},parentNode:i=>i.parentNode,nextSibling:i=>i.nextSibling,querySelector:i=>xn.querySelector(i),setScopeId(i,t){i.setAttribute(t,"")},insertStaticContent(i,t,e,s,n,r){const o=e?e.previousSibling:t.lastChild;if(n&&(n===r||n.nextSibling))for(;t.insertBefore(n.cloneNode(!0),e),!(n===r||!(n=n.nextSibling)););else{gv.innerHTML=F0(s==="svg"?`<svg>${i}</svg>`:s==="mathml"?`<math>${i}</math>`:i);const a=gv.content;if(s==="svg"||s==="mathml"){const c=a.firstChild;for(;c.firstChild;)a.appendChild(c.firstChild);a.removeChild(c)}t.insertBefore(a,e)}return[o?o.nextSibling:t.firstChild,e?e.previousSibling:t.lastChild]}},dr="transition",vc="animation",cc=Symbol("_vtc"),$0={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},B0=De({},c0,$0),cA=i=>(i.displayName="Transition",i.props=B0,i),ip=cA((i,{slots:t})=>bm(a_,H0(i),t)),ho=(i,t=[])=>{At(i)?i.forEach(e=>e(...t)):i&&i(...t)},mv=i=>i?At(i)?i.some(t=>t.length>1):i.length>1:!1;function H0(i){const t={};for(const I in i)I in $0||(t[I]=i[I]);if(i.css===!1)return t;const{name:e="v",type:s,duration:n,enterFromClass:r=`${e}-enter-from`,enterActiveClass:o=`${e}-enter-active`,enterToClass:a=`${e}-enter-to`,appearFromClass:c=r,appearActiveClass:u=o,appearToClass:h=a,leaveFromClass:d=`${e}-leave-from`,leaveActiveClass:f=`${e}-leave-active`,leaveToClass:p=`${e}-leave-to`}=i,m=uA(n),v=m&&m[0],_=m&&m[1],{onBeforeEnter:b,onEnter:A,onEnterCancelled:x,onLeave:C,onLeaveCancelled:T,onBeforeAppear:D=b,onAppear:P=A,onAppearCancelled:j=x}=t,L=(I,F,Q,J)=>{I._enterCancelled=J,pr(I,F?h:a),pr(I,F?u:o),Q&&Q()},$=(I,F)=>{I._isLeaving=!1,pr(I,d),pr(I,p),pr(I,f),F&&F()},N=I=>(F,Q)=>{const J=I?P:A,H=()=>L(F,I,Q);ho(J,[F,H]),vv(()=>{pr(F,I?c:r),Xi(F,I?h:a),mv(J)||bv(F,s,v,H)})};return De(t,{onBeforeEnter(I){ho(b,[I]),Xi(I,r),Xi(I,o)},onBeforeAppear(I){ho(D,[I]),Xi(I,c),Xi(I,u)},onEnter:N(!1),onAppear:N(!0),onLeave(I,F){I._isLeaving=!0;const Q=()=>$(I,F);Xi(I,d),I._enterCancelled?(Xi(I,f),Lp(I)):(Lp(I),Xi(I,f)),vv(()=>{I._isLeaving&&(pr(I,d),Xi(I,p),mv(C)||bv(I,s,_,Q))}),ho(C,[I,Q])},onEnterCancelled(I){L(I,!1,void 0,!0),ho(x,[I])},onAppearCancelled(I){L(I,!0,void 0,!0),ho(j,[I])},onLeaveCancelled(I){$(I),ho(T,[I])}})}function uA(i){if(i==null)return null;if(re(i))return[np(i.enter),np(i.leave)];{const t=np(i);return[t,t]}}function np(i){return p1(i)}function Xi(i,t){t.split(/\s+/).forEach(e=>e&&i.classList.add(e)),(i[cc]||(i[cc]=new Set)).add(t)}function pr(i,t){t.split(/\s+/).forEach(s=>s&&i.classList.remove(s));const e=i[cc];e&&(e.delete(t),e.size||(i[cc]=void 0))}function vv(i){requestAnimationFrame(()=>{requestAnimationFrame(i)})}let hA=0;function bv(i,t,e,s){const n=i._endId=++hA,r=()=>{n===i._endId&&s()};if(e!=null)return setTimeout(r,e);const{type:o,timeout:a,propCount:c}=j0(i,t);if(!o)return s();const u=o+"end";let h=0;const d=()=>{i.removeEventListener(u,f),r()},f=p=>{p.target===i&&++h>=c&&d()};setTimeout(()=>{h<c&&d()},a+1),i.addEventListener(u,f)}function j0(i,t){const e=window.getComputedStyle(i),s=m=>(e[m]||"").split(", "),n=s(`${dr}Delay`),r=s(`${dr}Duration`),o=yv(n,r),a=s(`${vc}Delay`),c=s(`${vc}Duration`),u=yv(a,c);let h=null,d=0,f=0;t===dr?o>0&&(h=dr,d=o,f=r.length):t===vc?u>0&&(h=vc,d=u,f=c.length):(d=Math.max(o,u),h=d>0?o>u?dr:vc:null,f=h?h===dr?r.length:c.length:0);const p=h===dr&&/\b(?:transform|all)(?:,|$)/.test(s(`${dr}Property`).toString());return{type:h,timeout:d,propCount:f,hasTransform:p}}function yv(i,t){for(;i.length<t.length;)i=i.concat(i);return Math.max(...t.map((e,s)=>wv(e)+wv(i[s])))}function wv(i){return i==="auto"?0:Number(i.slice(0,-1).replace(",","."))*1e3}function Lp(i){return(i?i.ownerDocument:document).body.offsetHeight}function dA(i,t,e){const s=i[cc];s&&(t=(t?[t,...s]:[...s]).join(" ")),t==null?i.removeAttribute("class"):e?i.setAttribute("class",t):i.className=t}const _v=Symbol("_vod"),fA=Symbol("_vsh"),pA=Symbol(""),gA=/(?:^|;)\s*display\s*:/;function mA(i,t,e){const s=i.style,n=Se(e);let r=!1;if(e&&!n){if(t)if(Se(t))for(const o of t.split(";")){const a=o.slice(0,o.indexOf(":")).trim();e[a]==null&&ad(s,a,"")}else for(const o in t)e[o]==null&&ad(s,o,"");for(const o in e)o==="display"&&(r=!0),ad(s,o,e[o])}else if(n){if(t!==e){const o=s[pA];o&&(e+=";"+o),s.cssText=e,r=gA.test(e)}}else t&&i.removeAttribute("style");_v in i&&(i[_v]=r?s.display:"",i[fA]&&(s.display="none"))}const Av=/\s*!important$/;function ad(i,t,e){if(At(e))e.forEach(s=>ad(i,t,s));else if(e==null&&(e=""),t.startsWith("--"))i.setProperty(t,e);else{const s=vA(i,t);Av.test(e)?i.setProperty(oo(s),e.replace(Av,""),"important"):i[s]=e}}const Sv=["Webkit","Moz","ms"],rp={};function vA(i,t){const e=rp[t];if(e)return e;let s=mi(t);if(s!=="filter"&&s in i)return rp[t]=s;s=xf(s);for(let n=0;n<Sv.length;n++){const r=Sv[n]+s;if(r in i)return rp[t]=r}return t}const xv="http://www.w3.org/1999/xlink";function Cv(i,t,e,s,n,r=w1(t)){s&&t.startsWith("xlink:")?e==null?i.removeAttributeNS(xv,t.slice(6,t.length)):i.setAttributeNS(xv,t,e):e==null||r&&!Tb(e)?i.removeAttribute(t):i.setAttribute(t,r?"":Fi(e)?String(e):e)}function Ev(i,t,e,s,n){if(t==="innerHTML"||t==="textContent"){e!=null&&(i[t]=t==="innerHTML"?F0(e):e);return}const r=i.tagName;if(t==="value"&&r!=="PROGRESS"&&!r.includes("-")){const a=r==="OPTION"?i.getAttribute("value")||"":i.value,c=e==null?i.type==="checkbox"?"on":"":String(e);(a!==c||!("_value"in i))&&(i.value=c),e==null&&i.removeAttribute(t),i._value=e;return}let o=!1;if(e===""||e==null){const a=typeof i[t];a==="boolean"?e=Tb(e):e==null&&a==="string"?(e="",o=!0):a==="number"&&(e=0,o=!0)}try{i[t]=e}catch{}o&&i.removeAttribute(n||t)}function er(i,t,e,s){i.addEventListener(t,e,s)}function bA(i,t,e,s){i.removeEventListener(t,e,s)}const kv=Symbol("_vei");function yA(i,t,e,s,n=null){const r=i[kv]||(i[kv]={}),o=r[t];if(s&&o)o.value=s;else{const[a,c]=wA(t);if(s){const u=r[t]=SA(s,n);er(i,a,u,c)}else o&&(bA(i,a,o,c),r[t]=void 0)}}const Tv=/(?:Once|Passive|Capture)$/;function wA(i){let t;if(Tv.test(i)){t={};let s;for(;s=i.match(Tv);)i=i.slice(0,i.length-s[0].length),t[s[0].toLowerCase()]=!0}return[i[2]===":"?i.slice(3):oo(i.slice(2)),t]}let op=0;const _A=Promise.resolve(),AA=()=>op||(_A.then(()=>op=0),op=Date.now());function SA(i,t){const e=s=>{if(!s._vts)s._vts=Date.now();else if(s._vts<=e.attached)return;Bi(xA(s,e.value),t,5,[s])};return e.value=i,e.attached=AA(),e}function xA(i,t){if(At(t)){const e=i.stopImmediatePropagation;return i.stopImmediatePropagation=()=>{e.call(i),i._stopped=!0},t.map(s=>n=>!n._stopped&&s&&s(n))}else return t}const Pv=i=>i.charCodeAt(0)===111&&i.charCodeAt(1)===110&&i.charCodeAt(2)>96&&i.charCodeAt(2)<123,CA=(i,t,e,s,n,r)=>{const o=n==="svg";t==="class"?dA(i,s,o):t==="style"?mA(i,e,s):_f(t)?em(t)||yA(i,t,e,s,r):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):EA(i,t,s,o))?(Ev(i,t,s),!i.tagName.includes("-")&&(t==="value"||t==="checked"||t==="selected")&&Cv(i,t,s,o,r,t!=="value")):i._isVueCE&&(/[A-Z]/.test(t)||!Se(s))?Ev(i,mi(t),s,r,t):(t==="true-value"?i._trueValue=s:t==="false-value"&&(i._falseValue=s),Cv(i,t,s,o))};function EA(i,t,e,s){if(s)return!!(t==="innerHTML"||t==="textContent"||t in i&&Pv(t)&&Rt(e));if(t==="spellcheck"||t==="draggable"||t==="translate"||t==="autocorrect"||t==="sandbox"&&i.tagName==="IFRAME"||t==="form"||t==="list"&&i.tagName==="INPUT"||t==="type"&&i.tagName==="TEXTAREA")return!1;if(t==="width"||t==="height"){const n=i.tagName;if(n==="IMG"||n==="VIDEO"||n==="CANVAS"||n==="SOURCE")return!1}return Pv(t)&&Se(e)?!1:t in i}const V0=new WeakMap,U0=new WeakMap,Wd=Symbol("_moveCb"),Rv=Symbol("_enterCb"),kA=i=>(delete i.props.mode,i),TA=kA({name:"TransitionGroup",props:De({},B0,{tag:String,moveClass:String}),setup(i,{slots:t}){const e=Df(),s=l0();let n,r;return g0(()=>{if(!n.length)return;const o=i.moveClass||`${i.name||"v"}-move`;if(!LA(n[0].el,e.vnode.el,o)){n=[];return}n.forEach(RA),n.forEach(MA);const a=n.filter(IA);Lp(e.vnode.el),a.forEach(c=>{const u=c.el,h=u.style;Xi(u,o),h.transform=h.webkitTransform=h.transitionDuration="";const d=u[Wd]=f=>{f&&f.target!==u||(!f||f.propertyName.endsWith("transform"))&&(u.removeEventListener("transitionend",d),u[Wd]=null,pr(u,o))};u.addEventListener("transitionend",d)}),n=[]}),()=>{const o=Gt(i),a=H0(o);let c=o.tag||me;if(n=[],r)for(let u=0;u<r.length;u++){const h=r[u];h.el&&h.el instanceof Element&&(n.push(h),Pa(h,eu(h,a,s,e)),V0.set(h,{left:h.el.offsetLeft,top:h.el.offsetTop}))}r=t.default?dm(t.default()):[];for(let u=0;u<r.length;u++){const h=r[u];h.key!=null&&Pa(h,eu(h,a,s,e))}return kt(c,null,r)}}}),PA=TA;function RA(i){const t=i.el;t[Wd]&&t[Wd](),t[Rv]&&t[Rv]()}function MA(i){U0.set(i,{left:i.el.offsetLeft,top:i.el.offsetTop})}function IA(i){const t=V0.get(i),e=U0.get(i),s=t.left-e.left,n=t.top-e.top;if(s||n){const r=i.el.style;return r.transform=r.webkitTransform=`translate(${s}px,${n}px)`,r.transitionDuration="0s",i}}function LA(i,t,e){const s=i.cloneNode(),n=i[cc];n&&n.forEach(a=>{a.split(/\s+/).forEach(c=>c&&s.classList.remove(c))}),e.split(/\s+/).forEach(a=>a&&s.classList.add(a)),s.style.display="none";const r=t.nodeType===1?t:t.parentNode;r.appendChild(s);const{hasTransform:o}=j0(s);return r.removeChild(s),o}const so=i=>{const t=i.props["onUpdate:modelValue"]||!1;return At(t)?e=>sd(t,e):t};function DA(i){i.target.composing=!0}function Mv(i){const t=i.target;t.composing&&(t.composing=!1,t.dispatchEvent(new Event("input")))}const pi=Symbol("_assign");function Iv(i,t,e){return t&&(i=i.trim()),e&&(i=Cf(i)),i}const es={created(i,{modifiers:{lazy:t,trim:e,number:s}},n){i[pi]=so(n);const r=s||n.props&&n.props.type==="number";er(i,t?"change":"input",o=>{o.target.composing||i[pi](Iv(i.value,e,r))}),(e||r)&&er(i,"change",()=>{i.value=Iv(i.value,e,r)}),t||(er(i,"compositionstart",DA),er(i,"compositionend",Mv),er(i,"change",Mv))},mounted(i,{value:t}){i.value=t??""},beforeUpdate(i,{value:t,oldValue:e,modifiers:{lazy:s,trim:n,number:r}},o){if(i[pi]=so(o),i.composing)return;const a=(r||i.type==="number")&&!/^0\d/.test(i.value)?Cf(i.value):i.value,c=t??"";a!==c&&(document.activeElement===i&&i.type!=="range"&&(s&&t===e||n&&i.value.trim()===c)||(i.value=c))}},ka={deep:!0,created(i,t,e){i[pi]=so(e),er(i,"change",()=>{const s=i._modelValue,n=uc(i),r=i.checked,o=i[pi];if(At(s)){const a=im(s,n),c=a!==-1;if(r&&!c)o(s.concat(n));else if(!r&&c){const u=[...s];u.splice(a,1),o(u)}}else if(fc(s)){const a=new Set(s);r?a.add(n):a.delete(n),o(a)}else o(z0(i,r))})},mounted:Lv,beforeUpdate(i,t,e){i[pi]=so(e),Lv(i,t,e)}};function Lv(i,{value:t,oldValue:e},s){i._modelValue=t;let n;if(At(t))n=im(t,s.props.value)>-1;else if(fc(t))n=t.has(s.props.value);else{if(t===e)return;n=Ta(t,z0(i,!0))}i.checked!==n&&(i.checked=n)}const OA={created(i,{value:t},e){i.checked=Ta(t,e.props.value),i[pi]=so(e),er(i,"change",()=>{i[pi](uc(i))})},beforeUpdate(i,{value:t,oldValue:e},s){i[pi]=so(s),t!==e&&(i.checked=Ta(t,s.props.value))}},G0={deep:!0,created(i,{value:t,modifiers:{number:e}},s){const n=fc(t);er(i,"change",()=>{const r=Array.prototype.filter.call(i.options,o=>o.selected).map(o=>e?Cf(uc(o)):uc(o));i[pi](i.multiple?n?new Set(r):r:r[0]),i._assigning=!0,$h(()=>{i._assigning=!1})}),i[pi]=so(s)},mounted(i,{value:t}){Dv(i,t)},beforeUpdate(i,t,e){i[pi]=so(e)},updated(i,{value:t}){i._assigning||Dv(i,t)}};function Dv(i,t){const e=i.multiple,s=At(t);if(!(e&&!s&&!fc(t))){for(let n=0,r=i.options.length;n<r;n++){const o=i.options[n],a=uc(o);if(e)if(s){const c=typeof a;c==="string"||c==="number"?o.selected=t.some(u=>String(u)===String(a)):o.selected=im(t,a)>-1}else o.selected=t.has(a);else if(Ta(uc(o),t)){i.selectedIndex!==n&&(i.selectedIndex=n);return}}!e&&i.selectedIndex!==-1&&(i.selectedIndex=-1)}}function uc(i){return"_value"in i?i._value:i.value}function z0(i,t){const e=t?"_trueValue":"_falseValue";return e in i?i[e]:t}const Ov={created(i,t,e){Jh(i,t,e,null,"created")},mounted(i,t,e){Jh(i,t,e,null,"mounted")},beforeUpdate(i,t,e,s){Jh(i,t,e,s,"beforeUpdate")},updated(i,t,e,s){Jh(i,t,e,s,"updated")}};function NA(i,t){switch(i){case"SELECT":return G0;case"TEXTAREA":return es;default:switch(t){case"checkbox":return ka;case"radio":return OA;default:return es}}}function Jh(i,t,e,s,n){const o=NA(i.tagName,e.props&&e.props.type)[n];o&&o(i,t,e,s)}const FA=["ctrl","shift","alt","meta"],$A={stop:i=>i.stopPropagation(),prevent:i=>i.preventDefault(),self:i=>i.target!==i.currentTarget,ctrl:i=>!i.ctrlKey,shift:i=>!i.shiftKey,alt:i=>!i.altKey,meta:i=>!i.metaKey,left:i=>"button"in i&&i.button!==0,middle:i=>"button"in i&&i.button!==1,right:i=>"button"in i&&i.button!==2,exact:(i,t)=>FA.some(e=>i[`${e}Key`]&&!t.includes(e))},Li=(i,t)=>{const e=i._withMods||(i._withMods={}),s=t.join(".");return e[s]||(e[s]=(n,...r)=>{for(let o=0;o<t.length;o++){const a=$A[t[o]];if(a&&a(n,t))return}return i(n,...r)})},BA={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},bi=(i,t)=>{const e=i._withKeys||(i._withKeys={}),s=t.join(".");return e[s]||(e[s]=n=>{if(!("key"in n))return;const r=oo(n.key);if(t.some(o=>o===r||BA[o]===r))return i(n)})},HA=De({patchProp:CA},lA);let Nv;function jA(){return Nv||(Nv=j_(HA))}const VA=(...i)=>{const t=jA().createApp(...i),{mount:e}=t;return t.mount=s=>{const n=GA(s);if(!n)return;const r=t._component;!Rt(r)&&!r.render&&!r.template&&(r.template=n.innerHTML),n.nodeType===1&&(n.textContent="");const o=e(n,!1,UA(n));return n instanceof Element&&(n.removeAttribute("v-cloak"),n.setAttribute("data-v-app","")),o},t};function UA(i){if(i instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&i instanceof MathMLElement)return"mathml"}function GA(i){return Se(i)?document.querySelector(i):i}/*!
 * pinia v2.3.1
 * (c) 2025 Eduardo San Martin Morote
 * @license MIT
 */let W0;const Nf=i=>W0=i,q0=Symbol();function Dp(i){return i&&typeof i=="object"&&Object.prototype.toString.call(i)==="[object Object]"&&typeof i.toJSON!="function"}var Xc;(function(i){i.direct="direct",i.patchObject="patch object",i.patchFunction="patch function"})(Xc||(Xc={}));function zA(){const i=Ib(!0),t=i.run(()=>tt({}));let e=[],s=[];const n=um({install(r){Nf(n),n._a=r,r.provide(q0,n),r.config.globalProperties.$pinia=n,s.forEach(o=>e.push(o)),s=[]},use(r){return this._a?e.push(r):s.push(r),this},_p:e,_a:null,_e:i,_s:new Map,state:t});return n}const X0=()=>{};function Fv(i,t,e,s=X0){i.push(t);const n=()=>{const r=i.indexOf(t);r>-1&&(i.splice(r,1),s())};return!e&&Lb()&&A1(n),n}function Ba(i,...t){i.slice().forEach(e=>{e(...t)})}const WA=i=>i(),$v=Symbol(),ap=Symbol();function Op(i,t){i instanceof Map&&t instanceof Map?t.forEach((e,s)=>i.set(s,e)):i instanceof Set&&t instanceof Set&&t.forEach(i.add,i);for(const e in t){if(!t.hasOwnProperty(e))continue;const s=t[e],n=i[e];Dp(n)&&Dp(s)&&i.hasOwnProperty(e)&&!Ae(s)&&!ir(s)?i[e]=Op(n,s):i[e]=s}return i}const qA=Symbol();function XA(i){return!Dp(i)||!i.hasOwnProperty(qA)}const{assign:gr}=Object;function KA(i){return!!(Ae(i)&&i.effect)}function YA(i,t,e,s){const{state:n,actions:r,getters:o}=t,a=e.state.value[i];let c;function u(){a||(e.state.value[i]=n?n():{});const h=z1(e.state.value[i]);return gr(h,r,Object.keys(o||{}).reduce((d,f)=>(d[f]=um(jt(()=>{Nf(e);const p=e._s.get(i);return o[f].call(p,p)})),d),{}))}return c=K0(i,u,t,e,s,!0),c}function K0(i,t,e={},s,n,r){let o;const a=gr({actions:{}},e),c={deep:!0};let u,h,d=[],f=[],p;const m=s.state.value[i];!r&&!m&&(s.state.value[i]={});let v;function _(j){let L;u=h=!1,typeof j=="function"?(j(s.state.value[i]),L={type:Xc.patchFunction,storeId:i,events:p}):(Op(s.state.value[i],j),L={type:Xc.patchObject,payload:j,storeId:i,events:p});const $=v=Symbol();$h().then(()=>{v===$&&(u=!0)}),h=!0,Ba(d,L,s.state.value[i])}const b=r?function(){const{state:L}=e,$=L?L():{};this.$patch(N=>{gr(N,$)})}:X0;function A(){o.stop(),d=[],f=[],s._s.delete(i)}const x=(j,L="")=>{if($v in j)return j[ap]=L,j;const $=function(){Nf(s);const N=Array.from(arguments),I=[],F=[];function Q(V){I.push(V)}function J(V){F.push(V)}Ba(f,{args:N,name:$[ap],store:T,after:Q,onError:J});let H;try{H=j.apply(this&&this.$id===i?this:T,N)}catch(V){throw Ba(F,V),V}return H instanceof Promise?H.then(V=>(Ba(I,V),V)).catch(V=>(Ba(F,V),Promise.reject(V))):(Ba(I,H),H)};return $[$v]=!0,$[ap]=L,$},C={_p:s,$id:i,$onAction:Fv.bind(null,f),$patch:_,$reset:b,$subscribe(j,L={}){const $=Fv(d,j,L.detached,()=>N()),N=o.run(()=>Ni(()=>s.state.value[i],I=>{(L.flush==="sync"?h:u)&&j({storeId:i,type:Xc.direct,events:p},I)},gr({},c,L)));return $},$dispose:A},T=Nh(C);s._s.set(i,T);const P=(s._a&&s._a.runWithContext||WA)(()=>s._e.run(()=>(o=Ib()).run(()=>t({action:x}))));for(const j in P){const L=P[j];if(Ae(L)&&!KA(L)||ir(L))r||(m&&XA(L)&&(Ae(L)?L.value=m[j]:Op(L,m[j])),s.state.value[i][j]=L);else if(typeof L=="function"){const $=x(L,j);P[j]=$,a.actions[j]=L}}return gr(T,P),gr(Gt(T),P),Object.defineProperty(T,"$state",{get:()=>s.state.value[i],set:j=>{_(L=>{gr(L,j)})}}),s._p.forEach(j=>{gr(T,o.run(()=>j({store:T,app:s._a,pinia:s,options:a})))}),m&&r&&e.hydrate&&e.hydrate(T.$state,m),u=!0,h=!0,T}/*! #__NO_SIDE_EFFECTS__ */function JA(i,t,e){let s,n;const r=typeof t=="function";s=i,n=r?e:t;function o(a,c){const u=e_();return a=a||(u?fi(q0,null):null),a&&Nf(a),a=W0,a._s.has(s)||(r?K0(s,t,n,a):YA(s,n,a)),a._s.get(s)}return o.$id=s,o}const ym="/icons/favicon.svg";/*!
 * vue-router v4.6.4
 * (c) 2025 Eduardo San Martin Morote
 * @license MIT
 */const ja=typeof document<"u";function Y0(i){return typeof i=="object"||"displayName"in i||"props"in i||"__vccOpts"in i}function QA(i){return i.__esModule||i[Symbol.toStringTag]==="Module"||i.default&&Y0(i.default)}const Jt=Object.assign;function lp(i,t){const e={};for(const s in t){const n=t[s];e[s]=ji(n)?n.map(i):i(n)}return e}const Kc=()=>{},ji=Array.isArray;function Bv(i,t){const e={};for(const s in i)e[s]=s in t?t[s]:i[s];return e}const J0=/#/g,ZA=/&/g,tS=/\//g,eS=/=/g,sS=/\?/g,Q0=/\+/g,iS=/%5B/g,nS=/%5D/g,Z0=/%5E/g,rS=/%60/g,ty=/%7B/g,oS=/%7C/g,ey=/%7D/g,aS=/%20/g;function wm(i){return i==null?"":encodeURI(""+i).replace(oS,"|").replace(iS,"[").replace(nS,"]")}function lS(i){return wm(i).replace(ty,"{").replace(ey,"}").replace(Z0,"^")}function Np(i){return wm(i).replace(Q0,"%2B").replace(aS,"+").replace(J0,"%23").replace(ZA,"%26").replace(rS,"`").replace(ty,"{").replace(ey,"}").replace(Z0,"^")}function cS(i){return Np(i).replace(eS,"%3D")}function uS(i){return wm(i).replace(J0,"%23").replace(sS,"%3F")}function hS(i){return uS(i).replace(tS,"%2F")}function ou(i){if(i==null)return null;try{return decodeURIComponent(""+i)}catch{}return""+i}const dS=/\/$/,fS=i=>i.replace(dS,"");function cp(i,t,e="/"){let s,n={},r="",o="";const a=t.indexOf("#");let c=t.indexOf("?");return c=a>=0&&c>a?-1:c,c>=0&&(s=t.slice(0,c),r=t.slice(c,a>0?a:t.length),n=i(r.slice(1))),a>=0&&(s=s||t.slice(0,a),o=t.slice(a,t.length)),s=vS(s??t,e),{fullPath:s+r+o,path:s,query:n,hash:ou(o)}}function pS(i,t){const e=t.query?i(t.query):"";return t.path+(e&&"?")+e+(t.hash||"")}function Hv(i,t){return!t||!i.toLowerCase().startsWith(t.toLowerCase())?i:i.slice(t.length)||"/"}function gS(i,t,e){const s=t.matched.length-1,n=e.matched.length-1;return s>-1&&s===n&&hc(t.matched[s],e.matched[n])&&sy(t.params,e.params)&&i(t.query)===i(e.query)&&t.hash===e.hash}function hc(i,t){return(i.aliasOf||i)===(t.aliasOf||t)}function sy(i,t){if(Object.keys(i).length!==Object.keys(t).length)return!1;for(var e in i)if(!mS(i[e],t[e]))return!1;return!0}function mS(i,t){return ji(i)?jv(i,t):ji(t)?jv(t,i):(i==null?void 0:i.valueOf())===(t==null?void 0:t.valueOf())}function jv(i,t){return ji(t)?i.length===t.length&&i.every((e,s)=>e===t[s]):i.length===1&&i[0]===t}function vS(i,t){if(i.startsWith("/"))return i;if(!i)return t;const e=t.split("/"),s=i.split("/"),n=s[s.length-1];(n===".."||n===".")&&s.push("");let r=e.length-1,o,a;for(o=0;o<s.length;o++)if(a=s[o],a!==".")if(a==="..")r>1&&r--;else break;return e.slice(0,r).join("/")+"/"+s.slice(o).join("/")}const fr={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0};let Fp=function(i){return i.pop="pop",i.push="push",i}({}),up=function(i){return i.back="back",i.forward="forward",i.unknown="",i}({});function bS(i){if(!i)if(ja){const t=document.querySelector("base");i=t&&t.getAttribute("href")||"/",i=i.replace(/^\w+:\/\/[^\/]+/,"")}else i="/";return i[0]!=="/"&&i[0]!=="#"&&(i="/"+i),fS(i)}const yS=/^[^#]+#/;function wS(i,t){return i.replace(yS,"#")+t}function _S(i,t){const e=document.documentElement.getBoundingClientRect(),s=i.getBoundingClientRect();return{behavior:t.behavior,left:s.left-e.left-(t.left||0),top:s.top-e.top-(t.top||0)}}const Ff=()=>({left:window.scrollX,top:window.scrollY});function AS(i){let t;if("el"in i){const e=i.el,s=typeof e=="string"&&e.startsWith("#"),n=typeof e=="string"?s?document.getElementById(e.slice(1)):document.querySelector(e):e;if(!n)return;t=_S(n,i)}else t=i;"scrollBehavior"in document.documentElement.style?window.scrollTo(t):window.scrollTo(t.left!=null?t.left:window.scrollX,t.top!=null?t.top:window.scrollY)}function Vv(i,t){return(history.state?history.state.position-t:-1)+i}const $p=new Map;function SS(i,t){$p.set(i,t)}function xS(i){const t=$p.get(i);return $p.delete(i),t}function CS(i){return typeof i=="string"||i&&typeof i=="object"}function iy(i){return typeof i=="string"||typeof i=="symbol"}let _e=function(i){return i[i.MATCHER_NOT_FOUND=1]="MATCHER_NOT_FOUND",i[i.NAVIGATION_GUARD_REDIRECT=2]="NAVIGATION_GUARD_REDIRECT",i[i.NAVIGATION_ABORTED=4]="NAVIGATION_ABORTED",i[i.NAVIGATION_CANCELLED=8]="NAVIGATION_CANCELLED",i[i.NAVIGATION_DUPLICATED=16]="NAVIGATION_DUPLICATED",i}({});const ny=Symbol("");_e.MATCHER_NOT_FOUND+"",_e.NAVIGATION_GUARD_REDIRECT+"",_e.NAVIGATION_ABORTED+"",_e.NAVIGATION_CANCELLED+"",_e.NAVIGATION_DUPLICATED+"";function dc(i,t){return Jt(new Error,{type:i,[ny]:!0},t)}function wn(i,t){return i instanceof Error&&ny in i&&(t==null||!!(i.type&t))}const ES=["params","query","hash"];function kS(i){if(typeof i=="string")return i;if(i.path!=null)return i.path;const t={};for(const e of ES)e in i&&(t[e]=i[e]);return JSON.stringify(t,null,2)}function TS(i){const t={};if(i===""||i==="?")return t;const e=(i[0]==="?"?i.slice(1):i).split("&");for(let s=0;s<e.length;++s){const n=e[s].replace(Q0," "),r=n.indexOf("="),o=ou(r<0?n:n.slice(0,r)),a=r<0?null:ou(n.slice(r+1));if(o in t){let c=t[o];ji(c)||(c=t[o]=[c]),c.push(a)}else t[o]=a}return t}function Uv(i){let t="";for(let e in i){const s=i[e];if(e=cS(e),s==null){s!==void 0&&(t+=(t.length?"&":"")+e);continue}(ji(s)?s.map(n=>n&&Np(n)):[s&&Np(s)]).forEach(n=>{n!==void 0&&(t+=(t.length?"&":"")+e,n!=null&&(t+="="+n))})}return t}function PS(i){const t={};for(const e in i){const s=i[e];s!==void 0&&(t[e]=ji(s)?s.map(n=>n==null?null:""+n):s==null?s:""+s)}return t}const RS=Symbol(""),Gv=Symbol(""),$f=Symbol(""),_m=Symbol(""),Bp=Symbol("");function bc(){let i=[];function t(s){return i.push(s),()=>{const n=i.indexOf(s);n>-1&&i.splice(n,1)}}function e(){i=[]}return{add:t,list:()=>i.slice(),reset:e}}function wr(i,t,e,s,n,r=o=>o()){const o=s&&(s.enterCallbacks[n]=s.enterCallbacks[n]||[]);return()=>new Promise((a,c)=>{const u=f=>{f===!1?c(dc(_e.NAVIGATION_ABORTED,{from:e,to:t})):f instanceof Error?c(f):CS(f)?c(dc(_e.NAVIGATION_GUARD_REDIRECT,{from:t,to:f})):(o&&s.enterCallbacks[n]===o&&typeof f=="function"&&o.push(f),a())},h=r(()=>i.call(s&&s.instances[n],t,e,u));let d=Promise.resolve(h);i.length<3&&(d=d.then(u)),d.catch(f=>c(f))})}function hp(i,t,e,s,n=r=>r()){const r=[];for(const o of i)for(const a in o.components){let c=o.components[a];if(!(t!=="beforeRouteEnter"&&!o.instances[a]))if(Y0(c)){const u=(c.__vccOpts||c)[t];u&&r.push(wr(u,e,s,o,a,n))}else{let u=c();r.push(()=>u.then(h=>{if(!h)throw new Error(`Couldn't resolve component "${a}" at "${o.path}"`);const d=QA(h)?h.default:h;o.mods[a]=h,o.components[a]=d;const f=(d.__vccOpts||d)[t];return f&&wr(f,e,s,o,a,n)()}))}}return r}function MS(i,t){const e=[],s=[],n=[],r=Math.max(t.matched.length,i.matched.length);for(let o=0;o<r;o++){const a=t.matched[o];a&&(i.matched.find(u=>hc(u,a))?s.push(a):e.push(a));const c=i.matched[o];c&&(t.matched.find(u=>hc(u,c))||n.push(c))}return[e,s,n]}/*!
 * vue-router v4.6.4
 * (c) 2025 Eduardo San Martin Morote
 * @license MIT
 */let IS=()=>location.protocol+"//"+location.host;function ry(i,t){const{pathname:e,search:s,hash:n}=t,r=i.indexOf("#");if(r>-1){let o=n.includes(i.slice(r))?i.slice(r).length:1,a=n.slice(o);return a[0]!=="/"&&(a="/"+a),Hv(a,"")}return Hv(e,i)+s+n}function LS(i,t,e,s){let n=[],r=[],o=null;const a=({state:f})=>{const p=ry(i,location),m=e.value,v=t.value;let _=0;if(f){if(e.value=p,t.value=f,o&&o===m){o=null;return}_=v?f.position-v.position:0}else s(p);n.forEach(b=>{b(e.value,m,{delta:_,type:Fp.pop,direction:_?_>0?up.forward:up.back:up.unknown})})};function c(){o=e.value}function u(f){n.push(f);const p=()=>{const m=n.indexOf(f);m>-1&&n.splice(m,1)};return r.push(p),p}function h(){if(document.visibilityState==="hidden"){const{history:f}=window;if(!f.state)return;f.replaceState(Jt({},f.state,{scroll:Ff()}),"")}}function d(){for(const f of r)f();r=[],window.removeEventListener("popstate",a),window.removeEventListener("pagehide",h),document.removeEventListener("visibilitychange",h)}return window.addEventListener("popstate",a),window.addEventListener("pagehide",h),document.addEventListener("visibilitychange",h),{pauseListeners:c,listen:u,destroy:d}}function zv(i,t,e,s=!1,n=!1){return{back:i,current:t,forward:e,replaced:s,position:window.history.length,scroll:n?Ff():null}}function DS(i){const{history:t,location:e}=window,s={value:ry(i,e)},n={value:t.state};n.value||r(s.value,{back:null,current:s.value,forward:null,position:t.length-1,replaced:!0,scroll:null},!0);function r(c,u,h){const d=i.indexOf("#"),f=d>-1?(e.host&&document.querySelector("base")?i:i.slice(d))+c:IS()+i+c;try{t[h?"replaceState":"pushState"](u,"",f),n.value=u}catch(p){console.error(p),e[h?"replace":"assign"](f)}}function o(c,u){r(c,Jt({},t.state,zv(n.value.back,c,n.value.forward,!0),u,{position:n.value.position}),!0),s.value=c}function a(c,u){const h=Jt({},n.value,t.state,{forward:c,scroll:Ff()});r(h.current,h,!0),r(c,Jt({},zv(s.value,c,null),{position:h.position+1},u),!1),s.value=c}return{location:s,state:n,push:a,replace:o}}function OS(i){i=bS(i);const t=DS(i),e=LS(i,t.state,t.location,t.replace);function s(r,o=!0){o||e.pauseListeners(),history.go(r)}const n=Jt({location:"",base:i,go:s,createHref:wS.bind(null,i)},t,e);return Object.defineProperty(n,"location",{enumerable:!0,get:()=>t.location.value}),Object.defineProperty(n,"state",{enumerable:!0,get:()=>t.state.value}),n}let wo=function(i){return i[i.Static=0]="Static",i[i.Param=1]="Param",i[i.Group=2]="Group",i}({});var Oe=function(i){return i[i.Static=0]="Static",i[i.Param=1]="Param",i[i.ParamRegExp=2]="ParamRegExp",i[i.ParamRegExpEnd=3]="ParamRegExpEnd",i[i.EscapeNext=4]="EscapeNext",i}(Oe||{});const NS={type:wo.Static,value:""},FS=/[a-zA-Z0-9_]/;function $S(i){if(!i)return[[]];if(i==="/")return[[NS]];if(!i.startsWith("/"))throw new Error(`Invalid path "${i}"`);function t(p){throw new Error(`ERR (${e})/"${u}": ${p}`)}let e=Oe.Static,s=e;const n=[];let r;function o(){r&&n.push(r),r=[]}let a=0,c,u="",h="";function d(){u&&(e===Oe.Static?r.push({type:wo.Static,value:u}):e===Oe.Param||e===Oe.ParamRegExp||e===Oe.ParamRegExpEnd?(r.length>1&&(c==="*"||c==="+")&&t(`A repeatable param (${u}) must be alone in its segment. eg: '/:ids+.`),r.push({type:wo.Param,value:u,regexp:h,repeatable:c==="*"||c==="+",optional:c==="*"||c==="?"})):t("Invalid state to consume buffer"),u="")}function f(){u+=c}for(;a<i.length;){if(c=i[a++],c==="\\"&&e!==Oe.ParamRegExp){s=e,e=Oe.EscapeNext;continue}switch(e){case Oe.Static:c==="/"?(u&&d(),o()):c===":"?(d(),e=Oe.Param):f();break;case Oe.EscapeNext:f(),e=s;break;case Oe.Param:c==="("?e=Oe.ParamRegExp:FS.test(c)?f():(d(),e=Oe.Static,c!=="*"&&c!=="?"&&c!=="+"&&a--);break;case Oe.ParamRegExp:c===")"?h[h.length-1]=="\\"?h=h.slice(0,-1)+c:e=Oe.ParamRegExpEnd:h+=c;break;case Oe.ParamRegExpEnd:d(),e=Oe.Static,c!=="*"&&c!=="?"&&c!=="+"&&a--,h="";break;default:t("Unknown state");break}}return e===Oe.ParamRegExp&&t(`Unfinished custom RegExp for param "${u}"`),d(),o(),n}const Wv="[^/]+?",BS={sensitive:!1,strict:!1,start:!0,end:!0};var xs=function(i){return i[i._multiplier=10]="_multiplier",i[i.Root=90]="Root",i[i.Segment=40]="Segment",i[i.SubSegment=30]="SubSegment",i[i.Static=40]="Static",i[i.Dynamic=20]="Dynamic",i[i.BonusCustomRegExp=10]="BonusCustomRegExp",i[i.BonusWildcard=-50]="BonusWildcard",i[i.BonusRepeatable=-20]="BonusRepeatable",i[i.BonusOptional=-8]="BonusOptional",i[i.BonusStrict=.7000000000000001]="BonusStrict",i[i.BonusCaseSensitive=.25]="BonusCaseSensitive",i}(xs||{});const HS=/[.+*?^${}()[\]/\\]/g;function jS(i,t){const e=Jt({},BS,t),s=[];let n=e.start?"^":"";const r=[];for(const u of i){const h=u.length?[]:[xs.Root];e.strict&&!u.length&&(n+="/");for(let d=0;d<u.length;d++){const f=u[d];let p=xs.Segment+(e.sensitive?xs.BonusCaseSensitive:0);if(f.type===wo.Static)d||(n+="/"),n+=f.value.replace(HS,"\\$&"),p+=xs.Static;else if(f.type===wo.Param){const{value:m,repeatable:v,optional:_,regexp:b}=f;r.push({name:m,repeatable:v,optional:_});const A=b||Wv;if(A!==Wv){p+=xs.BonusCustomRegExp;try{`${A}`}catch(C){throw new Error(`Invalid custom RegExp for param "${m}" (${A}): `+C.message)}}let x=v?`((?:${A})(?:/(?:${A}))*)`:`(${A})`;d||(x=_&&u.length<2?`(?:/${x})`:"/"+x),_&&(x+="?"),n+=x,p+=xs.Dynamic,_&&(p+=xs.BonusOptional),v&&(p+=xs.BonusRepeatable),A===".*"&&(p+=xs.BonusWildcard)}h.push(p)}s.push(h)}if(e.strict&&e.end){const u=s.length-1;s[u][s[u].length-1]+=xs.BonusStrict}e.strict||(n+="/?"),e.end?n+="$":e.strict&&!n.endsWith("/")&&(n+="(?:/|$)");const o=new RegExp(n,e.sensitive?"":"i");function a(u){const h=u.match(o),d={};if(!h)return null;for(let f=1;f<h.length;f++){const p=h[f]||"",m=r[f-1];d[m.name]=p&&m.repeatable?p.split("/"):p}return d}function c(u){let h="",d=!1;for(const f of i){(!d||!h.endsWith("/"))&&(h+="/"),d=!1;for(const p of f)if(p.type===wo.Static)h+=p.value;else if(p.type===wo.Param){const{value:m,repeatable:v,optional:_}=p,b=m in u?u[m]:"";if(ji(b)&&!v)throw new Error(`Provided param "${m}" is an array but it is not repeatable (* or + modifiers)`);const A=ji(b)?b.join("/"):b;if(!A)if(_)f.length<2&&(h.endsWith("/")?h=h.slice(0,-1):d=!0);else throw new Error(`Missing required param "${m}"`);h+=A}}return h||"/"}return{re:o,score:s,keys:r,parse:a,stringify:c}}function VS(i,t){let e=0;for(;e<i.length&&e<t.length;){const s=t[e]-i[e];if(s)return s;e++}return i.length<t.length?i.length===1&&i[0]===xs.Static+xs.Segment?-1:1:i.length>t.length?t.length===1&&t[0]===xs.Static+xs.Segment?1:-1:0}function oy(i,t){let e=0;const s=i.score,n=t.score;for(;e<s.length&&e<n.length;){const r=VS(s[e],n[e]);if(r)return r;e++}if(Math.abs(n.length-s.length)===1){if(qv(s))return 1;if(qv(n))return-1}return n.length-s.length}function qv(i){const t=i[i.length-1];return i.length>0&&t[t.length-1]<0}const US={strict:!1,end:!0,sensitive:!1};function GS(i,t,e){const s=jS($S(i.path),e),n=Jt(s,{record:i,parent:t,children:[],alias:[]});return t&&!n.record.aliasOf==!t.record.aliasOf&&t.children.push(n),n}function zS(i,t){const e=[],s=new Map;t=Bv(US,t);function n(d){return s.get(d)}function r(d,f,p){const m=!p,v=Kv(d);v.aliasOf=p&&p.record;const _=Bv(t,d),b=[v];if("alias"in d){const C=typeof d.alias=="string"?[d.alias]:d.alias;for(const T of C)b.push(Kv(Jt({},v,{components:p?p.record.components:v.components,path:T,aliasOf:p?p.record:v})))}let A,x;for(const C of b){const{path:T}=C;if(f&&T[0]!=="/"){const D=f.record.path,P=D[D.length-1]==="/"?"":"/";C.path=f.record.path+(T&&P+T)}if(A=GS(C,f,_),p?p.alias.push(A):(x=x||A,x!==A&&x.alias.push(A),m&&d.name&&!Yv(A)&&o(d.name)),ay(A)&&c(A),v.children){const D=v.children;for(let P=0;P<D.length;P++)r(D[P],A,p&&p.children[P])}p=p||A}return x?()=>{o(x)}:Kc}function o(d){if(iy(d)){const f=s.get(d);f&&(s.delete(d),e.splice(e.indexOf(f),1),f.children.forEach(o),f.alias.forEach(o))}else{const f=e.indexOf(d);f>-1&&(e.splice(f,1),d.record.name&&s.delete(d.record.name),d.children.forEach(o),d.alias.forEach(o))}}function a(){return e}function c(d){const f=XS(d,e);e.splice(f,0,d),d.record.name&&!Yv(d)&&s.set(d.record.name,d)}function u(d,f){let p,m={},v,_;if("name"in d&&d.name){if(p=s.get(d.name),!p)throw dc(_e.MATCHER_NOT_FOUND,{location:d});_=p.record.name,m=Jt(Xv(f.params,p.keys.filter(x=>!x.optional).concat(p.parent?p.parent.keys.filter(x=>x.optional):[]).map(x=>x.name)),d.params&&Xv(d.params,p.keys.map(x=>x.name))),v=p.stringify(m)}else if(d.path!=null)v=d.path,p=e.find(x=>x.re.test(v)),p&&(m=p.parse(v),_=p.record.name);else{if(p=f.name?s.get(f.name):e.find(x=>x.re.test(f.path)),!p)throw dc(_e.MATCHER_NOT_FOUND,{location:d,currentLocation:f});_=p.record.name,m=Jt({},f.params,d.params),v=p.stringify(m)}const b=[];let A=p;for(;A;)b.unshift(A.record),A=A.parent;return{name:_,path:v,params:m,matched:b,meta:qS(b)}}i.forEach(d=>r(d));function h(){e.length=0,s.clear()}return{addRoute:r,resolve:u,removeRoute:o,clearRoutes:h,getRoutes:a,getRecordMatcher:n}}function Xv(i,t){const e={};for(const s of t)s in i&&(e[s]=i[s]);return e}function Kv(i){const t={path:i.path,redirect:i.redirect,name:i.name,meta:i.meta||{},aliasOf:i.aliasOf,beforeEnter:i.beforeEnter,props:WS(i),children:i.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in i?i.components||null:i.component&&{default:i.component}};return Object.defineProperty(t,"mods",{value:{}}),t}function WS(i){const t={},e=i.props||!1;if("component"in i)t.default=e;else for(const s in i.components)t[s]=typeof e=="object"?e[s]:e;return t}function Yv(i){for(;i;){if(i.record.aliasOf)return!0;i=i.parent}return!1}function qS(i){return i.reduce((t,e)=>Jt(t,e.meta),{})}function XS(i,t){let e=0,s=t.length;for(;e!==s;){const r=e+s>>1;oy(i,t[r])<0?s=r:e=r+1}const n=KS(i);return n&&(s=t.lastIndexOf(n,s-1)),s}function KS(i){let t=i;for(;t=t.parent;)if(ay(t)&&oy(i,t)===0)return t}function ay({record:i}){return!!(i.name||i.components&&Object.keys(i.components).length||i.redirect)}function Jv(i){const t=fi($f),e=fi(_m),s=jt(()=>{const c=He(i.to);return t.resolve(c)}),n=jt(()=>{const{matched:c}=s.value,{length:u}=c,h=c[u-1],d=e.matched;if(!h||!d.length)return-1;const f=d.findIndex(hc.bind(null,h));if(f>-1)return f;const p=Qv(c[u-2]);return u>1&&Qv(h)===p&&d[d.length-1].path!==p?d.findIndex(hc.bind(null,c[u-2])):f}),r=jt(()=>n.value>-1&&tx(e.params,s.value.params)),o=jt(()=>n.value>-1&&n.value===e.matched.length-1&&sy(e.params,s.value.params));function a(c={}){if(ZS(c)){const u=t[He(i.replace)?"replace":"push"](He(i.to)).catch(Kc);return i.viewTransition&&typeof document<"u"&&"startViewTransition"in document&&document.startViewTransition(()=>u),u}return Promise.resolve()}return{route:s,href:jt(()=>s.value.href),isActive:r,isExactActive:o,navigate:a}}function YS(i){return i.length===1?i[0]:i}const JS=Gi({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"},viewTransition:Boolean},useLink:Jv,setup(i,{slots:t}){const e=Nh(Jv(i)),{options:s}=fi($f),n=jt(()=>({[Zv(i.activeClass,s.linkActiveClass,"router-link-active")]:e.isActive,[Zv(i.exactActiveClass,s.linkExactActiveClass,"router-link-exact-active")]:e.isExactActive}));return()=>{const r=t.default&&YS(t.default(e));return i.custom?r:bm("a",{"aria-current":e.isExactActive?i.ariaCurrentValue:null,href:e.href,onClick:e.navigate,class:n.value},r)}}}),QS=JS;function ZS(i){if(!(i.metaKey||i.altKey||i.ctrlKey||i.shiftKey)&&!i.defaultPrevented&&!(i.button!==void 0&&i.button!==0)){if(i.currentTarget&&i.currentTarget.getAttribute){const t=i.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(t))return}return i.preventDefault&&i.preventDefault(),!0}}function tx(i,t){for(const e in t){const s=t[e],n=i[e];if(typeof s=="string"){if(s!==n)return!1}else if(!ji(n)||n.length!==s.length||s.some((r,o)=>r.valueOf()!==n[o].valueOf()))return!1}return!0}function Qv(i){return i?i.aliasOf?i.aliasOf.path:i.path:""}const Zv=(i,t,e)=>i??t??e,ex=Gi({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(i,{attrs:t,slots:e}){const s=fi(Bp),n=jt(()=>i.route||s.value),r=fi(Gv,0),o=jt(()=>{let u=He(r);const{matched:h}=n.value;let d;for(;(d=h[u])&&!d.components;)u++;return u}),a=jt(()=>n.value.matched[o.value]);id(Gv,jt(()=>o.value+1)),id(RS,a),id(Bp,n);const c=tt();return Ni(()=>[c.value,a.value,i.name],([u,h,d],[f,p,m])=>{h&&(h.instances[d]=u,p&&p!==h&&u&&u===f&&(h.leaveGuards.size||(h.leaveGuards=p.leaveGuards),h.updateGuards.size||(h.updateGuards=p.updateGuards))),u&&h&&(!p||!hc(h,p)||!f)&&(h.enterCallbacks[d]||[]).forEach(v=>v(u))},{flush:"post"}),()=>{const u=n.value,h=i.name,d=a.value,f=d&&d.components[h];if(!f)return tb(e.default,{Component:f,route:u});const p=d.props[h],m=p?p===!0?u.params:typeof p=="function"?p(u):p:null,_=bm(f,Jt({},m,t,{onVnodeUnmounted:b=>{b.component.isUnmounted&&(d.instances[h]=null)},ref:c}));return tb(e.default,{Component:_,route:u})||_}}});function tb(i,t){if(!i)return null;const e=i(t);return e.length===1?e[0]:e}const sx=ex;function ix(i){const t=zS(i.routes,i),e=i.parseQuery||TS,s=i.stringifyQuery||Uv,n=i.history,r=bc(),o=bc(),a=bc(),c=V1(fr);let u=fr;ja&&i.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const h=lp.bind(null,U=>""+U),d=lp.bind(null,hS),f=lp.bind(null,ou);function p(U,nt){let ot,ht;return iy(U)?(ot=t.getRecordMatcher(U),ht=nt):ht=U,t.addRoute(ht,ot)}function m(U){const nt=t.getRecordMatcher(U);nt&&t.removeRoute(nt)}function v(){return t.getRoutes().map(U=>U.record)}function _(U){return!!t.getRecordMatcher(U)}function b(U,nt){if(nt=Jt({},nt||c.value),typeof U=="string"){const O=cp(e,U,nt.path),z=t.resolve({path:O.path},nt),X=n.createHref(O.fullPath);return Jt(O,z,{params:f(z.params),hash:ou(O.hash),redirectedFrom:void 0,href:X})}let ot;if(U.path!=null)ot=Jt({},U,{path:cp(e,U.path,nt.path).path});else{const O=Jt({},U.params);for(const z in O)O[z]==null&&delete O[z];ot=Jt({},U,{params:d(O)}),nt.params=d(nt.params)}const ht=t.resolve(ot,nt),Ft=U.hash||"";ht.params=h(f(ht.params));const E=pS(s,Jt({},U,{hash:lS(Ft),path:ht.path})),k=n.createHref(E);return Jt({fullPath:E,hash:Ft,query:s===Uv?PS(U.query):U.query||{}},ht,{redirectedFrom:void 0,href:k})}function A(U){return typeof U=="string"?cp(e,U,c.value.path):Jt({},U)}function x(U,nt){if(u!==U)return dc(_e.NAVIGATION_CANCELLED,{from:nt,to:U})}function C(U){return P(U)}function T(U){return C(Jt(A(U),{replace:!0}))}function D(U,nt){const ot=U.matched[U.matched.length-1];if(ot&&ot.redirect){const{redirect:ht}=ot;let Ft=typeof ht=="function"?ht(U,nt):ht;return typeof Ft=="string"&&(Ft=Ft.includes("?")||Ft.includes("#")?Ft=A(Ft):{path:Ft},Ft.params={}),Jt({query:U.query,hash:U.hash,params:Ft.path!=null?{}:U.params},Ft)}}function P(U,nt){const ot=u=b(U),ht=c.value,Ft=U.state,E=U.force,k=U.replace===!0,O=D(ot,ht);if(O)return P(Jt(A(O),{state:typeof O=="object"?Jt({},Ft,O.state):Ft,force:E,replace:k}),nt||ot);const z=ot;z.redirectedFrom=nt;let X;return!E&&gS(s,ht,ot)&&(X=dc(_e.NAVIGATION_DUPLICATED,{to:z,from:ht}),_t(ht,ht,!0,!1)),(X?Promise.resolve(X):$(z,ht)).catch(W=>wn(W)?wn(W,_e.NAVIGATION_GUARD_REDIRECT)?W:wt(W):Z(W,z,ht)).then(W=>{if(W){if(wn(W,_e.NAVIGATION_GUARD_REDIRECT))return P(Jt({replace:k},A(W.to),{state:typeof W.to=="object"?Jt({},Ft,W.to.state):Ft,force:E}),nt||z)}else W=I(z,ht,!0,k,Ft);return N(z,ht,W),W})}function j(U,nt){const ot=x(U,nt);return ot?Promise.reject(ot):Promise.resolve()}function L(U){const nt=Ht.values().next().value;return nt&&typeof nt.runWithContext=="function"?nt.runWithContext(U):U()}function $(U,nt){let ot;const[ht,Ft,E]=MS(U,nt);ot=hp(ht.reverse(),"beforeRouteLeave",U,nt);for(const O of ht)O.leaveGuards.forEach(z=>{ot.push(wr(z,U,nt))});const k=j.bind(null,U,nt);return ot.push(k),qt(ot).then(()=>{ot=[];for(const O of r.list())ot.push(wr(O,U,nt));return ot.push(k),qt(ot)}).then(()=>{ot=hp(Ft,"beforeRouteUpdate",U,nt);for(const O of Ft)O.updateGuards.forEach(z=>{ot.push(wr(z,U,nt))});return ot.push(k),qt(ot)}).then(()=>{ot=[];for(const O of E)if(O.beforeEnter)if(ji(O.beforeEnter))for(const z of O.beforeEnter)ot.push(wr(z,U,nt));else ot.push(wr(O.beforeEnter,U,nt));return ot.push(k),qt(ot)}).then(()=>(U.matched.forEach(O=>O.enterCallbacks={}),ot=hp(E,"beforeRouteEnter",U,nt,L),ot.push(k),qt(ot))).then(()=>{ot=[];for(const O of o.list())ot.push(wr(O,U,nt));return ot.push(k),qt(ot)}).catch(O=>wn(O,_e.NAVIGATION_CANCELLED)?O:Promise.reject(O))}function N(U,nt,ot){a.list().forEach(ht=>L(()=>ht(U,nt,ot)))}function I(U,nt,ot,ht,Ft){const E=x(U,nt);if(E)return E;const k=nt===fr,O=ja?history.state:{};ot&&(ht||k?n.replace(U.fullPath,Jt({scroll:k&&O&&O.scroll},Ft)):n.push(U.fullPath,Ft)),c.value=U,_t(U,nt,ot,k),wt()}let F;function Q(){F||(F=n.listen((U,nt,ot)=>{if(!xe.listening)return;const ht=b(U),Ft=D(ht,xe.currentRoute.value);if(Ft){P(Jt(Ft,{replace:!0,force:!0}),ht).catch(Kc);return}u=ht;const E=c.value;ja&&SS(Vv(E.fullPath,ot.delta),Ff()),$(ht,E).catch(k=>wn(k,_e.NAVIGATION_ABORTED|_e.NAVIGATION_CANCELLED)?k:wn(k,_e.NAVIGATION_GUARD_REDIRECT)?(P(Jt(A(k.to),{force:!0}),ht).then(O=>{wn(O,_e.NAVIGATION_ABORTED|_e.NAVIGATION_DUPLICATED)&&!ot.delta&&ot.type===Fp.pop&&n.go(-1,!1)}).catch(Kc),Promise.reject()):(ot.delta&&n.go(-ot.delta,!1),Z(k,ht,E))).then(k=>{k=k||I(ht,E,!1),k&&(ot.delta&&!wn(k,_e.NAVIGATION_CANCELLED)?n.go(-ot.delta,!1):ot.type===Fp.pop&&wn(k,_e.NAVIGATION_ABORTED|_e.NAVIGATION_DUPLICATED)&&n.go(-1,!1)),N(ht,E,k)}).catch(Kc)}))}let J=bc(),H=bc(),V;function Z(U,nt,ot){wt(U);const ht=H.list();return ht.length?ht.forEach(Ft=>Ft(U,nt,ot)):console.error(U),Promise.reject(U)}function St(){return V&&c.value!==fr?Promise.resolve():new Promise((U,nt)=>{J.add([U,nt])})}function wt(U){return V||(V=!U,Q(),J.list().forEach(([nt,ot])=>U?ot(U):nt()),J.reset()),U}function _t(U,nt,ot,ht){const{scrollBehavior:Ft}=i;if(!ja||!Ft)return Promise.resolve();const E=!ot&&xS(Vv(U.fullPath,0))||(ht||!ot)&&history.state&&history.state.scroll||null;return $h().then(()=>Ft(U,nt,E)).then(k=>k&&AS(k)).catch(k=>Z(k,U,nt))}const Pt=U=>n.go(U);let Mt;const Ht=new Set,xe={currentRoute:c,listening:!0,addRoute:p,removeRoute:m,clearRoutes:t.clearRoutes,hasRoute:_,getRoutes:v,resolve:b,options:i,push:C,replace:T,go:Pt,back:()=>Pt(-1),forward:()=>Pt(1),beforeEach:r.add,beforeResolve:o.add,afterEach:a.add,onError:H.add,isReady:St,install(U){U.component("RouterLink",QS),U.component("RouterView",sx),U.config.globalProperties.$router=xe,Object.defineProperty(U.config.globalProperties,"$route",{enumerable:!0,get:()=>He(c)}),ja&&!Mt&&c.value===fr&&(Mt=!0,C(n.location).catch(ht=>{}));const nt={};for(const ht in fr)Object.defineProperty(nt,ht,{get:()=>c.value[ht],enumerable:!0});U.provide($f,xe),U.provide(_m,Xb(nt)),U.provide(Bp,c);const ot=U.unmount;Ht.add(U),U.unmount=function(){Ht.delete(U),Ht.size<1&&(u=fr,F&&F(),F=null,c.value=fr,Mt=!1,V=!1),ot()}}};function qt(U){return U.reduce((nt,ot)=>nt.then(()=>L(ot)),Promise.resolve())}return xe}function Hh(){return fi($f)}function Bf(i){return fi(_m)}const Am=JA("user",()=>{const i=tt(null),t=tt(localStorage.getItem("auth_token")||sessionStorage.getItem("auth_token")),e=jt(()=>!!i.value&&!!t.value),s=(o,a,c=!0)=>{i.value=o,t.value=a,c?(localStorage.setItem("auth_token",a),localStorage.setItem("user",JSON.stringify(o)),sessionStorage.removeItem("auth_token"),sessionStorage.removeItem("user")):(sessionStorage.setItem("auth_token",a),sessionStorage.setItem("user",JSON.stringify(o)),localStorage.removeItem("auth_token"),localStorage.removeItem("user"))},n=()=>{i.value=null,t.value=null,localStorage.removeItem("auth_token"),localStorage.removeItem("user"),sessionStorage.removeItem("auth_token"),sessionStorage.removeItem("user")},r=()=>{const o=localStorage.getItem("user")||sessionStorage.getItem("user");if(o&&!t.value){localStorage.removeItem("user"),sessionStorage.removeItem("user"),i.value=null;return}if(o&&t.value)try{i.value=JSON.parse(o)}catch(a){console.error("Failed to parse user from storage",a),n()}};return t.value&&r(),{user:i,token:t,isLoggedIn:e,login:s,logout:n,loadUserFromStorage:r}}),nx={class:"toast-icon"},rx={key:0,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},ox={key:1,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},ax={key:2,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},lx={key:3,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},cx={class:"toast-content"},ux={class:"toast-title"},hx={key:0,class:"toast-message"},dx=["onClick"],fx=Gi({__name:"Toast",setup(i,{expose:t}){const e=tt([]);let s=0;const n=c=>{const u=`toast-${++s}`,h={id:u,duration:4e3,...c};e.value.push(h),h.duration&&h.duration>0&&setTimeout(()=>{r(u)},h.duration)},r=c=>{const u=e.value.findIndex(h=>h.id===c);u>-1&&e.value.splice(u,1)},o=c=>{n(c)};t({showToast:o,addToast:n,removeToast:r});let a=null;return Hi(()=>{a=document.createElement("div"),a.id="toast-global-container",document.body.appendChild(a),window.addEventListener("show-toast",c=>{n(c.detail)})}),ao(()=>{a&&document.body.contains(a)&&document.body.removeChild(a),window.removeEventListener("show-toast",()=>{})}),window.showToast=o,(c,u)=>(G(),vn(PA,{name:"toast",tag:"div",class:"toast-container"},{default:zt(()=>[(G(!0),q(me,null,Qr(e.value,h=>(G(),q("div",{key:h.id,class:Yt(["toast",`toast-${h.type}`])},[S("div",nx,[h.type==="success"?(G(),q("svg",rx,[...u[0]||(u[0]=[S("path",{d:"M20 6L9 17l-5-5",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},null,-1)])])):h.type==="error"?(G(),q("svg",ox,[...u[1]||(u[1]=[S("path",{d:"M18 6L6 18M6 6l12 12",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},null,-1)])])):h.type==="warning"?(G(),q("svg",ax,[...u[2]||(u[2]=[S("path",{d:"M12 9v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},null,-1)])])):(G(),q("svg",lx,[...u[3]||(u[3]=[S("path",{d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},null,-1)])]))]),S("div",cx,[S("div",ux,mt(h.title),1),h.message?(G(),q("div",hx,mt(h.message),1)):Et("",!0)]),S("button",{class:"toast-close",onClick:d=>r(h.id)},[...u[4]||(u[4]=[S("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[S("path",{d:"M18 6L6 18M6 6l12 12",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)])],8,dx)],2))),128))]),_:1}))}}),pc=(i,t)=>{const e=i.__vccOpts||i;for(const[s,n]of t)e[s]=n;return e},px=pc(fx,[["__scopeId","data-v-7cb7d822"]]),gx={class:"app-shell"},mx={class:"app-header"},vx={class:"nav-links"},bx={key:1,class:"user-menu-wrapper"},yx=["src","alt"],wx={key:1,class:"user-avatar-text"},_x={key:0,class:"user-menu"},Ax={class:"user-menu-header"},Sx={class:"user-menu-avatar"},xx=["src","alt"],Cx={key:1},Ex={class:"user-menu-info"},kx={class:"user-menu-name"},Tx={class:"user-menu-email"},Px=Gi({__name:"App",setup(i){const t=Bf(),e=Hh(),s=Am(),n=jt(()=>t.path==="/"),r=tt(!1),o=()=>{const u=t.path==="/"?"/":t.fullPath;e.push(`/auth?redirect=${encodeURIComponent(u)}`)},a=()=>{s.logout(),r.value=!1,e.replace("/auth?redirect=/")},c=u=>{u.target.closest(".user-menu-wrapper")||(r.value=!1)};return Hi(()=>{document.addEventListener("click",c),s.loadUserFromStorage()}),ao(()=>{document.removeEventListener("click",c)}),Ni(n,u=>{u?document.body.classList.add("landing-page"):document.body.classList.remove("landing-page")},{immediate:!0}),(u,h)=>{var p,m,v,_,b,A,x,C,T,D,P;const d=sv("RouterLink"),f=sv("RouterView");return G(),q("div",gx,[S("header",mx,[h[7]||(h[7]=S("div",{class:"logo"},[S("img",{src:ym,alt:"AxiomFlow",class:"logo-image"}),S("span",{class:"logo-text"},"AxiomFlow")],-1)),S("nav",vx,[kt(d,{to:"/",class:"nav-link-item"},{default:zt(()=>[...h[1]||(h[1]=[S("svg",{class:"nav-icon",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[S("path",{d:"M3 9L12 2L21 9V20C21 20.5304 20.7893 21.0391 20.4142 21.4142C20.0391 21.7893 19.5304 22 19 22H5C4.46957 22 3.96086 21.7893 3.58579 21.4142C3.21071 21.0391 3 20.5304 3 20V9Z",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}),S("path",{d:"M9 22V12H15V22",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1),S("span",null,"",-1)])]),_:1}),kt(d,{to:"/app",class:"nav-link-item"},{default:zt(()=>[...h[2]||(h[2]=[S("svg",{class:"nav-icon",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[S("path",{d:"M14 2H6C5.46957 2 4.96086 2.21071 4.58579 2.58579C4.21071 2.96086 4 3.46957 4 4V20C4 20.5304 4.21071 21.0391 4.58579 21.4142C4.96086 21.7893 5.46957 22 6 22H18C18.5304 22 19.0391 21.7893 19.4142 21.4142C19.7893 21.0391 20 20.5304 20 20V8L14 2Z",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}),S("path",{d:"M14 2V8H20",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}),S("path",{d:"M16 13H8",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}),S("path",{d:"M16 17H8",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}),S("path",{d:"M10 9H9H8",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1),S("span",null,"",-1)])]),_:1}),kt(d,{to:"/settings",class:"nav-link-item"},{default:zt(()=>[...h[3]||(h[3]=[S("svg",{class:"nav-icon",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[S("path",{d:"M12 15C13.6569 15 15 13.6569 15 12C15 10.3431 13.6569 9 12 9C10.3431 9 9 10.3431 9 12C9 13.6569 10.3431 15 12 15Z",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}),S("path",{d:"M19.4 15C19.2669 15.3016 19.2272 15.6362 19.286 15.9606C19.3448 16.285 19.4995 16.5843 19.73 16.82L19.79 16.88C19.976 17.0657 20.1235 17.2863 20.2241 17.5291C20.3248 17.7719 20.3766 18.0322 20.3766 18.295C20.3766 18.5578 20.3248 18.8181 20.2241 19.0609C20.1235 19.3037 19.976 19.5243 19.79 19.71C19.6043 19.896 19.3837 20.0435 19.1409 20.1441C18.8981 20.2448 18.6378 20.2966 18.375 20.2966C18.1122 20.2966 17.8519 20.2448 17.6091 20.1441C17.3663 20.0435 17.1457 19.896 16.96 19.71L16.9 19.65C16.6643 19.4195 16.365 19.2648 16.0406 19.206C15.7162 19.1472 15.3816 19.1869 15.08 19.32C14.7842 19.4468 14.532 19.6572 14.3543 19.9255C14.1766 20.1938 14.0813 20.5082 14.08 20.83V21C14.08 21.5304 13.8693 22.0391 13.4942 22.4142C13.1191 22.7893 12.6104 23 12.08 23C11.5496 23 11.0409 22.7893 10.6658 22.4142C10.2907 22.0391 10.08 21.5304 10.08 21V20.91C10.0723 20.579 9.96512 20.258 9.77251 19.9887C9.5799 19.7194 9.31074 19.5143 9 19.4C8.69838 19.2669 8.36381 19.2272 8.03941 19.286C7.71502 19.3448 7.41568 19.4995 7.18 19.73L7.12 19.79C6.93425 19.976 6.71368 20.1235 6.47088 20.2241C6.22808 20.3248 5.96783 20.3766 5.705 20.3766C5.44217 20.3766 5.18192 20.3248 4.93912 20.2241C4.69632 20.1235 4.47575 19.976 4.29 19.79C4.10405 19.6043 3.95653 19.3837 3.85588 19.1409C3.75523 18.8981 3.70343 18.6378 3.70343 18.375C3.70343 18.1122 3.75523 17.8519 3.85588 17.6091C3.95653 17.3663 4.10405 17.1457 4.29 16.96L4.35 16.9C4.58054 16.6643 4.73519 16.365 4.794 16.0406C4.85282 15.7162 4.81312 15.3816 4.68 15.08C4.55324 14.7842 4.34276 14.532 4.07447 14.3543C3.80618 14.1766 3.49179 14.0813 3.17 14.08H3C2.46957 14.08 1.96086 13.8693 1.58579 13.4942C1.21071 13.1191 1 12.6104 1 12.08C1 11.5496 1.21071 11.0409 1.58579 10.6658C1.96086 10.2907 2.46957 10.08 3 10.08H3.09C3.42099 10.0723 3.742 9.96512 4.01131 9.77251C4.28062 9.5799 4.48568 9.31074 4.6 9C4.73312 8.69838 4.77282 8.36381 4.714 8.03941C4.65519 7.71502 4.50054 7.41568 4.27 7.18L4.21 7.12C4.02405 6.93425 3.87653 6.71368 3.77588 6.47088C3.67523 6.22808 3.62343 5.96783 3.62343 5.705C3.62343 5.44217 3.67523 5.18192 3.77588 4.93912C3.87653 4.69632 4.02405 4.47575 4.21 4.29C4.39575 4.10405 4.61632 3.95653 4.85912 3.85588C5.10192 3.75523 5.36217 3.70343 5.625 3.70343C5.88783 3.70343 6.14808 3.75523 6.39088 3.85588C6.63368 3.95653 6.85425 4.10405 7.04 4.29L7.1 4.35C7.33568 4.58054 7.63502 4.73519 7.95941 4.794C8.28381 4.85282 8.61838 4.81312 8.92 4.68H9C9.29577 4.55324 9.54802 4.34276 9.72569 4.07447C9.90337 3.80618 9.99872 3.49179 10 3.17V3C10 2.46957 10.2107 1.96086 10.5858 1.58579C10.9609 1.21071 11.4696 1 12 1C12.5304 1 13.0391 1.21071 13.4142 1.58579C13.7893 1.96086 14 2.46957 14 3V3.09C14.0013 3.41179 14.0966 3.72618 14.2743 3.99447C14.452 4.26276 14.7042 4.47324 15 4.6C15.3016 4.73312 15.6362 4.77282 15.9606 4.714C16.285 4.65519 16.5843 4.50054 16.82 4.27L16.88 4.21C17.0657 4.02405 17.2863 3.87653 17.5291 3.77588C17.7719 3.67523 18.0322 3.62343 18.295 3.62343C18.5578 3.62343 18.8181 3.67523 19.0609 3.77588C19.3037 3.87653 19.5243 4.02405 19.71 4.21C19.896 4.39575 20.0435 4.61632 20.1441 4.85912C20.2448 5.10192 20.2966 5.36217 20.2966 5.625C20.2966 5.88783 20.2448 6.14808 20.1441 6.39088C20.0435 6.63368 19.896 6.85425 19.71 7.04L19.65 7.1C19.4195 7.33568 19.2648 7.63502 19.206 7.95941C19.1472 8.28381 19.1869 8.61838 19.32 8.92V9C19.4468 9.29577 19.6572 9.54802 19.9255 9.72569C20.1938 9.90337 20.5082 9.99872 20.83 10H21C21.5304 10 22.0391 10.2107 22.4142 10.5858C22.7893 10.9609 23 11.4696 23 12C23 12.5304 22.7893 13.0391 22.4142 13.4142C22.0391 13.7893 21.5304 14 21 14H20.91C20.5882 14.0013 20.2738 14.0966 20.0055 14.2743C19.7372 14.452 19.5268 14.7042 19.4 15Z",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1),S("span",null,"",-1)])]),_:1}),He(s).isLoggedIn?(G(),q("div",bx,[S("button",{class:Yt(["user-avatar-button",{"has-avatar":(p=He(s).user)==null?void 0:p.avatar}]),onClick:h[0]||(h[0]=j=>r.value=!r.value)},[(m=He(s).user)!=null&&m.avatar?(G(),q("img",{key:0,src:He(s).user.avatar,alt:((v=He(s).user)==null?void 0:v.name)||"User",class:"user-avatar-image"},null,8,yx)):(G(),q("span",wx,mt(((b=(_=He(s).user)==null?void 0:_.name)==null?void 0:b.charAt(0).toUpperCase())||"U"),1))],2),r.value?(G(),q("div",_x,[S("div",Ax,[S("div",Sx,[(A=He(s).user)!=null&&A.avatar?(G(),q("img",{key:0,src:He(s).user.avatar,alt:((x=He(s).user)==null?void 0:x.name)||"User",class:"user-menu-avatar-image"},null,8,xx)):(G(),q("span",Cx,mt(((T=(C=He(s).user)==null?void 0:C.name)==null?void 0:T.charAt(0).toUpperCase())||"U"),1))]),S("div",Ex,[S("div",kx,mt(((D=He(s).user)==null?void 0:D.name)||""),1),S("div",Tx,mt((P=He(s).user)==null?void 0:P.email),1)])]),h[6]||(h[6]=S("div",{class:"user-menu-divider"},null,-1)),S("button",{class:"user-menu-item",onClick:a},[...h[5]||(h[5]=[S("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[S("path",{d:"M9 21H5C4.46957 21 3.96086 20.7893 3.58579 20.4142C3.21071 20.0391 3 19.5304 3 19V5C3 4.46957 3.21071 3.96086 3.58579 3.58579C3.96086 3.21071 4.46957 3 5 3H9",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}),S("path",{d:"M16 17L21 12L16 7",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}),S("path",{d:"M21 12H9",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1),S("span",null,"",-1)])])])):Et("",!0)])):(G(),q("button",{key:0,class:"user-avatar-button",onClick:o,title:""},[...h[4]||(h[4]=[S("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[S("path",{d:"M20 21V19C20 17.9391 19.5786 16.9217 18.8284 16.1716C18.0783 15.4214 17.0609 15 16 15H8C6.93913 15 5.92172 15.4214 5.17157 16.1716C4.42143 16.9217 4 17.9391 4 19V21",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}),S("circle",{cx:"12",cy:"7",r:"4",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)])]))])]),S("main",{class:Yt(["app-main",{"landing-page":n.value}])},[kt(f)],2),kt(px)])}}}),Rx={class:"landing"},Mx={class:"landing-hero glass-card"},Ix=Gi({__name:"LandingView",setup(i){const t=Hh(),e=Am(),s=tt(null),n=tt(!1),r=()=>{var d;if(!e.isLoggedIn){t.push(`/auth?redirect=${encodeURIComponent("/")}`);return}(d=s.value)==null||d.click()},o=d=>{if(!e.isLoggedIn){d.preventDefault();return}n.value=!0,d.dataTransfer.dropEffect="copy"},a=()=>{n.value=!1},c=async d=>{var m;if(n.value=!1,!e.isLoggedIn){d.preventDefault(),t.push(`/auth?redirect=${encodeURIComponent("/")}`);return}const p=Array.from(((m=d.dataTransfer)==null?void 0:m.files)||[]).find(v=>v.name.toLowerCase().endsWith(".pdf"));p?h(p):alert(" PDF ")},u=d=>{var m;if(!e.isLoggedIn){t.push(`/auth?redirect=${encodeURIComponent("/")}`);return}const f=d.target,p=(m=f.files)==null?void 0:m[0];p&&p.name.toLowerCase().endsWith(".pdf")&&h(p),f.value=""},h=d=>{const f=encodeURIComponent(d.name);t.push(`/app?uploading=true&filename=${f}`),window.__pendingUploadFile=d};return(d,f)=>(G(),q("section",Rx,[S("div",Mx,[f[1]||(f[1]=nu('<div class="hero-content"><img src="'+ym+'" alt="AxiomFlow" class="hero-icon"><h1 class="hero-title"><span class="hero-title-main"> PDF </span></h1><p class="hero-description">  AI PDF </p><div class="hero-features"><span class="feature-tag"></span><span class="feature-tag"></span><span class="feature-tag"></span></div></div>',1)),S("div",{class:Yt(["upload-dropzone",{"upload-dropzone--dragover":n.value}]),onClick:r,onDragover:Li(o,["prevent"]),onDragleave:Li(a,["prevent"]),onDrop:Li(c,["prevent"])},[...f[0]||(f[0]=[nu('<div class="upload-content"><div class="upload-placeholder"><svg class="upload-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 15V3M12 3L8 7M12 3L16 7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path><path d="M2 17L2 19C2 20.1046 2.89543 21 4 21L20 21C21.1046 21 22 20.1046 22 19L22 17" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></svg><div class="upload-text"><span class="upload-text-primary"> PDF </span><span class="upload-text-secondary"></span></div></div></div>',1)])],34),S("input",{ref_key:"fileInput",ref:s,type:"file",accept:"application/pdf",style:{display:"none"},onChange:u},null,544)])]))}}),Lx={},Dx={class:"app-card"};function Ox(i,t){return G(),q("div",Dx,[m0(i.$slots,"default",{},void 0)])}const Nx=pc(Lx,[["render",Ox],["__scopeId","data-v-e8b93269"]]),Fx=Gi({__name:"AppButton",props:{primary:{type:Boolean}},setup(i){return(t,e)=>(G(),q("button",{class:Yt(["app-btn",{primary:i.primary}])},[m0(t.$slots,"default",{},void 0)],2))}}),fe=pc(Fx,[["__scopeId","data-v-1cd5a885"]]),se="http://localhost:8000/v1";async function dp(i){const t=new FormData;t.set("name",i);const e=await fetch(`${se}/projects`,{method:"POST",body:t});if(!e.ok)throw new Error(await e.text());return await e.json()}async function $x(i){const t=await fetch(`${se}/projects/${i}/documents`);if(!t.ok){const e=await t.text();throw t.status===404?new Error(` ${i} `):new Error(e||` (${t.status})`)}return await t.json()}async function eb(i){const t=new FormData;t.set("file",i.file),t.set("lang_in",i.lang_in??"en"),t.set("lang_out",i.lang_out??"zh");const e=await fetch(`${se}/projects/${i.project_id}/files`,{method:"POST",body:t});if(!e.ok)throw new Error(await e.text());return await e.json()}async function xc(i){const t=await fetch(`${se}/documents/${i}`);if(!t.ok){const e=await t.text();throw t.status===404?new Error(` ${i} `):new Error(e||` (${t.status})`)}return await t.json()}function Bx(i){return`${se}/documents/${i}/source`}async function Hx(i){const t=await fetch(`${se}/jobs/translate`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({document_id:i.document_id,lang_in:i.lang_in,lang_out:i.lang_out,provider:i.provider??"ollama",use_context:i.use_context,context_window_size:i.context_window_size,use_term_consistency:i.use_term_consistency,use_smart_batching:i.use_smart_batching})});if(!t.ok)throw new Error(await t.text());return await t.json()}async function sb(i){const t=await fetch(`${se}/jobs/${i}`);if(!t.ok)throw new Error(await t.text());return await t.json()}async function jx(i){const t=await fetch(`${se}/jobs/${i}/pause`,{method:"POST"});if(!t.ok)throw new Error(await t.text());return await t.json()}async function Vx(i){const t=await fetch(`${se}/jobs/${i}/resume`,{method:"POST"});if(!t.ok)throw new Error(await t.text());return await t.json()}async function Ux(i){const t=await fetch(`${se}/jobs/${i}/cancel`,{method:"POST"});if(!t.ok)throw new Error(await t.text());return await t.json()}async function Gx(i){const t=await fetch(`${se}/jobs/${i}/retry`,{method:"POST"});if(!t.ok)throw new Error(await t.text());return await t.json()}async function zx(i){const t=await fetch(`${se}/documents/${i.document_id}/blocks/${i.block_id}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({translation:i.translation,apply_all_same_source:i.apply_all_same_source??!1})});if(!t.ok)throw new Error(await t.text());return await t.json()}async function fp(i){const t=await fetch(`${se}/export`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)});if(!t.ok)throw new Error(await t.text());return await t.json()}async function Wx(i){const t=new URL(`${se}/documents/${i.document_id}/terms`);t.searchParams.set("top_k",String(i.top_k));const e=await fetch(t.toString());if(!e.ok)throw new Error(await e.text());return await e.json()}async function qx(i){const t=await fetch(`${se}/projects/${i.project_id}/glossary`);if(!t.ok)throw new Error(await t.text());return await t.json()}async function Xx(i){const t=await fetch(`${se}/projects/${i.project_id}/glossary`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({term:i.term,translation:i.translation})});if(!t.ok)throw new Error(await t.text());return await t.json()}async function Kx(i){const t=new URL(`${se}/projects/${i.project_id}/glossary`);t.searchParams.set("term",i.term);const e=await fetch(t.toString(),{method:"DELETE"});if(!e.ok)throw new Error(await e.text());return await e.json()}async function Yx(i){const t=await fetch(`${se}/documents/${i.document_id}/assets/extract`,{method:"POST"});if(!t.ok)throw new Error(await t.text());return await t.json()}async function Jx(i){const t=new FormData;t.set("project_name",i.project_name),t.set("lang_in",i.lang_in??"en"),t.set("lang_out",i.lang_out??"zh"),t.set("auto_translate","true"),t.set("provider",i.provider??"ollama");for(const s of i.files)t.append("files",s);const e=await fetch(`${se}/batches/upload`,{method:"POST",body:t});if(!e.ok)throw new Error(await e.text());return await e.json()}async function Qx(i){const t=await fetch(`${se}/batches/${i.batch_id}`);if(!t.ok)throw new Error(await t.text());return await t.json()}async function Zx(i){const t=await fetch(`${se}/auth/google`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:i})});if(!t.ok){const e=await t.text();throw new Error(e||`Google (${t.status})`)}return await t.json()}async function tC(){const i=await fetch(`${se}/auth/captcha`);if(!i.ok){const t=await i.text();throw new Error(t||` (${i.status})`)}return await i.json()}async function eC(i){const t=await fetch(`${se}/auth/register`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)});if(!t.ok){const e=await t.text();try{const s=JSON.parse(e);throw new Error(s.detail||e)}catch{throw new Error(e||` (${t.status})`)}}return await t.json()}async function sC(i){const t=await fetch(`${se}/auth/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)});if(!t.ok){const e=await t.text();try{const s=JSON.parse(e);throw new Error(s.detail||e)}catch{throw new Error(e||` (${t.status})`)}}return await t.json()}async function iC(i){const t=await fetch(`${se}/auth/forgot-password`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)});if(!t.ok){const e=await t.text();try{const s=JSON.parse(e);throw new Error(s.detail||e)}catch{throw new Error(e||` (${t.status})`)}}return await t.json()}async function nC(i){const t=await fetch(`${se}/auth/verify-email-code`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)});if(!t.ok){const e=await t.text();try{const s=JSON.parse(e);throw new Error(s.detail||e)}catch{throw new Error(e||` (${t.status})`)}}return await t.json()}async function rC(i){const t=await fetch(`${se}/auth/reset-password`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)});if(!t.ok){const e=await t.text();try{const s=JSON.parse(e);throw new Error(s.detail||e)}catch{throw new Error(e||` (${t.status})`)}}return await t.json()}const oC=()=>se.replace("http://","ws://").replace("https://","wss://");class pp{constructor(t){pt(this,"ws",null);pt(this,"documentId");pt(this,"reconnectAttempts",0);pt(this,"maxReconnectAttempts",5);pt(this,"reconnectDelay",1e3);pt(this,"heartbeatInterval",null);pt(this,"onMessageCallback",null);pt(this,"onErrorCallback",null);pt(this,"onCloseCallback",null);pt(this,"isManuallyClosed",!1);this.documentId=t}connect(){return new Promise((t,e)=>{if(this.isManuallyClosed){e(new Error("WebSocket "));return}try{const n=`${oC()}/ws/documents/${this.documentId}/progress`;console.log(` WebSocket: ${n}`),this.ws=new WebSocket(n),this.ws.onopen=()=>{console.log(`WebSocket : ${this.documentId}`),this.reconnectAttempts=0,t()},this.ws.onmessage=r=>{try{const o=JSON.parse(r.data);if(o.type==="heartbeat")return;console.log(` WebSocket  (${this.documentId}):`,o);const a={type:o.type||"progress",document_id:o.document_id||this.documentId,status:o.status||"parsing",parse_progress:o.parse_progress||0,num_pages:o.num_pages||0,parse_job:o.parse_job,message:o.message};this.onMessageCallback&&this.onMessageCallback(a)}catch(o){console.error(" WebSocket :",o,r.data)}},this.ws.onerror=r=>{console.error("WebSocket :",r),this.onErrorCallback&&this.onErrorCallback(r),e(r)},this.ws.onclose=()=>{if(console.log(`WebSocket : ${this.documentId}, : ${this.isManuallyClosed}`),this.onCloseCallback&&this.onCloseCallback(),!this.isManuallyClosed&&this.reconnectAttempts<this.maxReconnectAttempts){this.reconnectAttempts++;const r=this.reconnectDelay*this.reconnectAttempts;console.log(`${r}ms  (${this.reconnectAttempts}/${this.maxReconnectAttempts})...`),setTimeout(()=>{this.connect().catch(console.error)},r)}else this.isManuallyClosed||console.error("WebSocket ")}}catch(s){e(s)}})}onMessage(t){this.onMessageCallback=t}onError(t){this.onErrorCallback=t}onClose(t){this.onCloseCallback=t}disconnect(){this.isManuallyClosed=!0,this.ws&&(this.ws.close(),this.ws=null),this.heartbeatInterval!==null&&(clearInterval(this.heartbeatInterval),this.heartbeatInterval=null)}isConnected(){return this.ws!==null&&this.ws.readyState===WebSocket.OPEN}}const aC={class:"dashboard"},lC={style:{display:"flex","align-items":"center","justify-content":"space-between",gap:"12px"}},cC={style:{display:"flex",gap:"10px","align-items":"center","flex-wrap":"wrap"}},uC={key:0,class:"card-grid"},hC={class:"doc-header"},dC={class:"doc-info"},fC={class:"doc-meta"},pC={key:0},gC={key:1},mC={key:0},vC={key:2},bC={key:0,class:"doc-progress"},yC={class:"progress-bar"},wC={class:"progress-text"},_C={key:0},AC={key:1},SC={key:1,class:"doc-status-badge"},xC={key:1,class:"empty-state"},CC=Gi({__name:"DashboardView",setup(i){const t=Hh(),e=Bf(),s=tt([]),n=tt(null),r=tt(null),o=tt(""),a=tt(null),c=new Map,u=async b=>{try{const A=await $x(b);s.value=A.documents.map(x=>({document_id:x.document_id,title:x.title,num_pages:x.num_pages,lang_in:x.lang_in,lang_out:x.lang_out,status:x.status==="parsed"?"ready":x.status==="parsing"?"parsing":"ready",progress:x.status==="parsed"?100:0})),a.value=b}catch(A){console.error(":",A),s.value=[]}},h=()=>{var b;return(b=n.value)==null?void 0:b.click()},d=()=>{var b;return(b=r.value)==null?void 0:b.click()},f=async b=>{var T;const A=b.target,x=(T=A.files)==null?void 0:T[0];if(!x)return;const C={document_id:`temp-${Date.now()}`,title:x.name,lang_in:"en",lang_out:"zh",status:"uploading",progress:0};s.value.unshift(C);try{let D=a.value;D||(D=(await dp(o.value||"")).project_id,a.value=D);const P=await eb({project_id:D,file:x,lang_in:"en",lang_out:"zh"});C.document_id=P.document_id,C.num_pages=P.num_pages;const j=Date.now(),L=2e3,$=D,N=(F,Q)=>{const J=F-Q;return Math.abs(J)<1?F:Q+Math.sign(J)*Math.min(Math.abs(J),5)},I=new pp(P.document_id);c.set(P.document_id,I),I.onMessage(async F=>{const Q=Date.now()-j;if(F.status==="uploading"){C.status="uploading";const J=Math.min(F.parse_progress||C.progress,30);C.progress=N(J,C.progress)}else if(F.status==="parsing"){C.status="parsing";let J=30;if(F.parse_job){const H=F.parse_job;H.total&&H.total>0?J=30+(H.done||0)/H.total*70:J=30+(H.progress||0)*70}else J=Math.min(F.parse_progress||30,90);C.progress=N(J,C.progress)}else F.status==="parsed"&&(console.log(` (${P.document_id}): num_pages=${F.num_pages}, elapsed=${Q}ms`),C.status="parsing",C.progress<100?C.progress=N(100,C.progress):C.progress=100,F.num_pages>0?(C.status="ready",C.num_pages=F.num_pages,I.disconnect(),c.delete(P.document_id),$&&await u($)):C.progress>=100&&Q>=L&&(C.status="ready",C.num_pages=F.num_pages||0,I.disconnect(),c.delete(P.document_id),$&&await u($)))}),I.onError(F=>{console.error("WebSocket :",F),C.status="parsing",C.progress=50}),I.onClose(()=>{c.delete(P.document_id)}),I.connect().catch(F=>{console.error("WebSocket :",F),C.status="parsing",C.progress=50})}catch(D){console.error("Upload failed:",D),s.value=s.value.filter(P=>P.document_id!==C.document_id)}A.value=""},p=async b=>{var D;const A=b.target,x=Array.from(A.files??[]);if(x.length===0)return;const C=x.map((P,j)=>({document_id:`temp-${Date.now()}-${j}`,title:P.name,lang_in:"en",lang_out:"zh",status:"uploading",progress:0}));s.value.unshift(...C);const T=C.map(P=>setInterval(()=>{P.progress<40&&(P.progress+=5)},150));try{const P=await Jx({project_name:o.value||"",files:x,lang_in:"en",lang_out:"zh"});T.forEach(clearInterval),(D=P.documents)==null||D.forEach((j,L)=>{C[L]&&(C[L].document_id=j.document_id,C[L].num_pages=j.num_pages,C[L].status="ready",C[L].progress=100)}),a.value&&await u(a.value),t.push(`/batch/${P.batch_id}`)}catch(P){console.error("Batch upload failed:",P),T.forEach(clearInterval),C.forEach(j=>{s.value=s.value.filter(L=>L.document_id!==j.document_id)})}A.value=""},m=b=>{t.push(`/project/${b}`)},v=async()=>{const b=e.query.uploading==="true",A=e.query.filename;if(!b||!A)return;const x=window.__pendingUploadFile;if(!x){t.replace("/app");return}const C=decodeURIComponent(A),T={document_id:`temp-${Date.now()}`,title:C,lang_in:"en",lang_out:"zh",status:"uploading",progress:0};s.value.unshift(T),console.log(`[] : ${T.document_id}, : ${T.progress}%`);try{const{project_id:D}=await dp(""),P=await eb({project_id:D,file:x,lang_in:"en",lang_out:"zh"}),j=s.value.findIndex(F=>F.document_id===T.document_id);j>=0&&(s.value[j]={...s.value[j],document_id:P.document_id,num_pages:P.num_pages}),delete window.__pendingUploadFile,t.replace({query:{document_id:P.document_id,uploading:"true",filename:A}});const L=Date.now(),$=2e3,N=(F,Q)=>{const J=F-Q;if(Math.abs(J)<.5)return F;let H;const V=Math.abs(J);return V>20?H=10:V>5?H=5:H=2,Q+Math.sign(J)*Math.min(V,H)},I=new pp(P.document_id);c.set(P.document_id,I),I.onMessage(F=>{console.log(` (${P.document_id}):`,F);const Q=Date.now()-L,J=s.value.findIndex(V=>V.document_id===P.document_id);if(J<0){console.warn(` ${P.document_id} `);return}const H=s.value[J];if(F.status==="uploading"){const V=Math.min(F.parse_progress||H.progress,30),Z=N(V,H.progress);s.value[J]={...H,status:"uploading",progress:Z},console.log(`[] : ${V}%, : ${Z}%`)}else if(F.status==="parsing"){let V=30;if(F.parse_job){const _t=F.parse_job;if(_t.total&&_t.total>0){const Pt=(_t.done||0)/_t.total;V=30+Pt*70,console.log(`[]  Job : ${_t.done}/${_t.total} = ${Pt}, : ${V}%`)}else V=30+(_t.progress||0)*70,console.log(`[]  Job progress : ${_t.progress}, : ${V}%`)}else if(F.parse_progress!==void 0){const _t=Math.min(F.parse_progress,100)/100;V=30+_t*70,console.log(`[]  parse_progress: ${F.parse_progress}% -> ${_t}, : ${V}%`)}else V=30,console.log("[]  30%");const Z=H.progress;let St;V===30?H.progress>=30?St=H.progress:St=N(30,H.progress):St=V;const wt={...H,status:"parsing",progress:St};F.num_pages!==void 0&&F.num_pages>0&&(wt.num_pages=F.num_pages),s.value[J]=wt,console.log(`[] : ${Z}% -> ${St}% (: ${V}%)${F.num_pages?`, : ${F.num_pages}`:""}`)}else if(F.status==="parsed"){if(console.log(` (${P.document_id}): num_pages=${F.num_pages}, elapsed=${Q}ms`),H.status==="ready"){console.log(" ready ");return}const V=H.progress<100?N(100,H.progress):100;if(s.value[J]={...H,status:"parsing",progress:V},V<99.5){const Z=setInterval(()=>{const St=s.value[J];if(!St||St.status==="ready"){clearInterval(Z);return}const wt=N(100,St.progress);s.value[J]={...St,progress:wt},wt>=99.5&&(clearInterval(Z),setTimeout(async()=>{const _t=s.value[J];_t&&_t.status!=="ready"&&xc(P.document_id).then(async Pt=>{console.log(` (${P.document_id}):`,Pt);const Mt=Pt.document,Ht=s.value[J];Ht&&Ht.status!=="ready"&&(s.value[J]={...Ht,title:Mt.title||Ht.title,num_pages:Mt.num_pages,lang_in:Mt.lang_in||Ht.lang_in,lang_out:Mt.lang_out||Ht.lang_out,status:"ready",progress:100},I.disconnect(),c.delete(P.document_id),a.value&&await u(a.value),t.replace({query:{}}),console.log(` ready (${P.document_id})`))}).catch(async Pt=>{console.error(` (${P.document_id}):`,Pt);const Mt=s.value[J];Mt&&Mt.status!=="ready"&&(s.value[J]={...Mt,num_pages:F.num_pages||Mt.num_pages||0,status:"ready",progress:100},I.disconnect(),c.delete(P.document_id),a.value&&await u(a.value),t.replace({query:{}}),console.log(` ready (${P.document_id})`))})},300))},50)}else setTimeout(async()=>{const Z=s.value[J];Z&&Z.status!=="ready"&&xc(P.document_id).then(async St=>{console.log(` (${P.document_id}):`,St);const wt=St.document,_t=s.value[J];_t&&_t.status!=="ready"&&(s.value[J]={..._t,title:wt.title||_t.title,num_pages:wt.num_pages,lang_in:wt.lang_in||_t.lang_in,lang_out:wt.lang_out||_t.lang_out,status:"ready",progress:100},I.disconnect(),c.delete(P.document_id),a.value&&await u(a.value),t.replace({query:{}}),console.log(` ready (${P.document_id})`))}).catch(async St=>{console.error(` (${P.document_id}):`,St);const wt=s.value[J];wt&&wt.status!=="ready"&&(s.value[J]={...wt,num_pages:F.num_pages||wt.num_pages||0,status:"ready",progress:100},I.disconnect(),c.delete(P.document_id),a.value&&await u(a.value),t.replace({query:{}}),console.log(` ready (${P.document_id})`))})},300)}}),I.onError(F=>{console.error("WebSocket :",F),T.status="parsing",T.progress=50}),I.onClose(()=>{c.delete(P.document_id)}),I.connect().then(()=>{console.log(`WebSocket  (${P.document_id})`)}).catch(F=>{console.error("WebSocket :",F),T.status="parsing",T.progress=50})}catch(D){console.error("Upload failed:",D),alert(""),s.value=s.value.filter(P=>P.document_id!==T.document_id),t.replace("/app"),delete window.__pendingUploadFile}},_=async()=>{const b=e.query.document_id,A=e.query.uploading==="true",x=e.query.filename;if(!b&&A){await v();return}if(!b)return;const C=s.value.find(L=>L.document_id===b);if(C&&C.status==="ready"){t.replace({query:{}});return}let T=C||s.value.find(L=>L.document_id===b);T||(T={document_id:b,title:x?decodeURIComponent(x):"...",lang_in:"en",lang_out:"zh",status:A?"uploading":"parsing",progress:A?0:30},s.value.unshift(T));const D=Date.now(),P=(L,$)=>{const N=L-$;if(Math.abs(N)<.5)return L;let I;const F=Math.abs(N);return F>20?I=10:F>5?I=5:I=2,$+Math.sign(N)*Math.min(F,I)},j=new pp(b);c.set(b,j),j.onMessage(L=>{const $=Date.now()-D;if(!T)return;const N=s.value.findIndex(F=>F.document_id===b);if(N<0){console.warn(` ${b} `);return}const I=s.value[N];if(L.status==="uploading"){const F=Math.min(L.parse_progress||I.progress,30),Q=P(F,I.progress);s.value[N]={...I,status:"uploading",progress:Q},console.log(`[] : ${F}%, : ${Q}%`)}else if(L.status==="parsing"){let F=30;if(L.parse_job){const V=L.parse_job;if(V.total&&V.total>0){const Z=(V.done||0)/V.total;F=30+Z*70,console.log(`[]  Job : ${V.done}/${V.total} = ${Z}, : ${F}%`)}else F=30+(V.progress||0)*70,console.log(`[]  Job progress : ${V.progress}, : ${F}%`)}else if(L.parse_progress!==void 0){const V=Math.min(L.parse_progress,100)/100;F=30+V*70,console.log(`[]  parse_progress: ${L.parse_progress}% -> ${V}, : ${F}%`)}else F=30,console.log("[]  30%");const Q=I.progress;let J;F===30?I.progress>=30?J=I.progress:J=P(30,I.progress):J=F;const H={...I,status:"parsing",progress:J};L.num_pages!==void 0&&L.num_pages>0&&(H.num_pages=L.num_pages),s.value[N]=H,console.log(`[] : ${Q}% -> ${J}% (: ${F}%)${L.num_pages?`, : ${L.num_pages}`:""}`)}else if(L.status==="parsed"){if(console.log(` (${b}): num_pages=${L.num_pages}, elapsed=${$}ms, =${I.status}`),I.status==="ready"){console.log(" ready ");return}const F=I.progress<100?P(100,I.progress):100;if(s.value[N]={...I,status:"parsing",progress:F},F<99.5){const Q=setInterval(()=>{const J=s.value[N];if(!J||J.status==="ready"){clearInterval(Q);return}const H=P(100,J.progress);s.value[N]={...J,progress:H},H>=99.5&&(clearInterval(Q),setTimeout(async()=>{const V=s.value[N];V&&V.status!=="ready"&&xc(b).then(async Z=>{console.log(` (${b}):`,Z);const St=Z.document,wt=s.value[N];wt&&wt.status!=="ready"&&(s.value[N]={...wt,title:St.title||wt.title,num_pages:St.num_pages,lang_in:St.lang_in||wt.lang_in,lang_out:St.lang_out||wt.lang_out,status:"ready",progress:100},a.value&&await u(a.value),t.replace({query:{}}),j.disconnect(),c.delete(b),console.log(` ready (${b})`))}).catch(async Z=>{console.error(` (${b}):`,Z);const St=s.value[N];St&&St.status!=="ready"&&(s.value[N]={...St,num_pages:L.num_pages||St.num_pages||0,status:"ready",progress:100},a.value&&await u(a.value),t.replace({query:{}}),j.disconnect(),c.delete(b),console.log(` ready (${b})`))})},300))},50)}else setTimeout(async()=>{const Q=s.value[N];Q&&Q.status!=="ready"&&xc(b).then(async J=>{console.log(` (${b}):`,J);const H=J.document,V=s.value[N];V&&V.status!=="ready"&&(s.value[N]={...V,title:H.title||V.title,num_pages:H.num_pages,lang_in:H.lang_in||V.lang_in,lang_out:H.lang_out||V.lang_out,status:"ready",progress:100},a.value&&await u(a.value),t.replace({query:{}}),j.disconnect(),c.delete(b),console.log(` ready (${b})`))}).catch(async J=>{console.error(` (${b}):`,J);const H=s.value[N];H&&H.status!=="ready"&&(s.value[N]={...H,num_pages:L.num_pages||H.num_pages||0,status:"ready",progress:100},a.value&&await u(a.value),t.replace({query:{}}),j.disconnect(),c.delete(b),console.log(` ready (${b})`))})},300)}}),j.onError(L=>{console.error("WebSocket :",L),T&&(T.status="parsing",T.progress=50)}),j.onClose(()=>{c.delete(b)}),j.connect().catch(L=>{console.error("WebSocket :",L),T&&(T.status="parsing",T.progress=50)})};return Hi(async()=>{const b=e.query.project_id;if(b)a.value=b,await u(b);else try{const{project_id:A}=await dp(o.value||"");a.value=A,await u(A)}catch(A){console.error(":",A)}await _()}),ao(()=>{c.forEach(b=>b.disconnect()),c.clear()}),(b,A)=>(G(),q("section",aC,[S("div",lC,[A[3]||(A[3]=S("h2",{style:{margin:"0"}},"",-1)),S("div",cC,[pe(S("input",{class:"simple-input","onUpdate:modelValue":A[0]||(A[0]=x=>o.value=x),placeholder:"",style:{width:"220px"}},null,512),[[es,o.value]]),kt(fe,{primary:"",onClick:h},{default:zt(()=>[...A[1]||(A[1]=[Nt("PDF",-1)])]),_:1}),kt(fe,{onClick:d},{default:zt(()=>[...A[2]||(A[2]=[Nt("PDF",-1)])]),_:1}),S("input",{ref_key:"fileInput",ref:n,type:"file",accept:"application/pdf",style:{display:"none"},onChange:f},null,544),S("input",{ref_key:"filesInput",ref:r,type:"file",accept:"application/pdf",multiple:"",style:{display:"none"},onChange:p},null,544)])]),s.value.length>0?(G(),q("div",uC,[(G(!0),q(me,null,Qr(s.value,x=>(G(),vn(Nx,{key:x.document_id,class:Yt(["doc-card",{"doc-card--parsing":x.status==="parsing","doc-card--ready":x.status==="ready"}]),onClick:C=>x.status==="ready"?m(x.document_id):void 0},{default:zt(()=>[S("div",hC,[S("div",{class:Yt(["doc-icon",{"doc-icon--parsing":x.status==="parsing"}])},mt(x.status==="parsing"?"":""),3),S("div",dC,[S("div",{class:Yt(["doc-title",{"doc-title--disabled":x.status==="parsing"}])},mt(x.title),3),S("div",fC,[x.status==="uploading"?(G(),q("span",pC," ... ")):x.status==="parsing"?(G(),q("span",gC,[x.num_pages&&x.num_pages>0?(G(),q("span",mC,mt(x.num_pages)+"   ",1)):Et("",!0),A[4]||(A[4]=Nt("... ",-1))])):(G(),q("span",vC,mt(x.num_pages||"?")+"   "+mt(x.lang_in)+"  "+mt(x.lang_out)+"   ",1))])])]),x.status==="uploading"||x.status==="parsing"?(G(),q("div",bC,[S("div",yC,[S("div",{class:"progress-fill",style:Js({width:`${x.progress||0}%`})},null,4)]),S("div",wC,[x.status==="uploading"?(G(),q("span",_C,"...")):x.status==="parsing"?(G(),q("span",AC,"... "+mt(x.progress||0)+"%",1)):Et("",!0)])])):(G(),q("div",SC,[...A[5]||(A[5]=[S("span",{class:"status-dot status-dot--ready"},null,-1),S("span",null,"",-1)])]))]),_:2},1032,["class","onClick"]))),128))])):(G(),q("div",xC,[...A[6]||(A[6]=[nu('<div class="empty-state-content" data-v-888af15d><div class="empty-state-icon" data-v-888af15d><svg width="64" height="64" viewBox="0 0 64 64" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-888af15d><path d="M18 14C18 12.8954 18.8954 12 20 12H44C45.1046 12 46 12.8954 46 14V42C46 43.1046 45.1046 44 44 44H20C18.8954 44 18 43.1046 18 42V14Z" stroke="url(#emptyGradient)" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round" fill="none" data-v-888af15d></path><path d="M22 20H42M22 26H36M22 32H42" stroke="url(#emptyGradient)" stroke-width="2.5" stroke-linecap="round" data-v-888af15d></path><path d="M22 38H36" stroke="url(#emptyGradient)" stroke-width="2.5" stroke-linecap="round" opacity="0.6" data-v-888af15d></path><circle cx="50" cy="18" r="3" fill="url(#emptyGradient)" opacity="0.8" data-v-888af15d></circle><defs data-v-888af15d><linearGradient id="emptyGradient" x1="0" y1="0" x2="64" y2="64" gradientUnits="userSpaceOnUse" data-v-888af15d><stop offset="0%" stop-color="#3b82f6" data-v-888af15d></stop><stop offset="100%" stop-color="#8b5cf6" data-v-888af15d></stop></linearGradient></defs></svg></div><h3 class="empty-state-title" data-v-888af15d></h3><p class="empty-state-description" data-v-888af15d> PDF </p></div>',1)])]))]))}}),EC=pc(CC,[["__scopeId","data-v-888af15d"]]);var Yc={};Yc.d=(i,t)=>{for(var e in t)Yc.o(t,e)&&!Yc.o(i,e)&&Object.defineProperty(i,e,{enumerable:!0,get:t[e]})};Yc.o=(i,t)=>Object.prototype.hasOwnProperty.call(i,t);var Tt=globalThis.pdfjsLib={};Yc.d(Tt,{AbortException:()=>io,AnnotationEditorLayer:()=>Xg,AnnotationEditorParamsType:()=>Ut,AnnotationEditorType:()=>Lt,AnnotationEditorUIManager:()=>Ma,AnnotationLayer:()=>_2,AnnotationMode:()=>_r,ColorPicker:()=>Qd,DOMSVGFactory:()=>Mm,DrawLayer:()=>Jg,FeatureTest:()=>Es,GlobalWorkerOptions:()=>sr,ImageKind:()=>ld,InvalidPDFException:()=>jp,MissingPDFException:()=>au,OPS:()=>wi,OutputScale:()=>Up,PDFDataRangeTransport:()=>cw,PDFDateString:()=>km,PDFWorker:()=>sl,PasswordResponses:()=>RC,PermissionFlag:()=>PC,PixelsPerInch:()=>no,RenderingCancelledException:()=>Cm,TextLayer:()=>lu,TouchManager:()=>Yd,UnexpectedResponseException:()=>qd,Util:()=>bt,VerbosityLevel:()=>Hf,XfaLayer:()=>hw,build:()=>e2,createValidAbsoluteUrl:()=>DC,fetchData:()=>Gf,getDocument:()=>WE,getFilenameFromUrl:()=>UC,getPdfFilenameFromUrl:()=>GC,getXfaPageViewport:()=>zC,isDataScheme:()=>zf,isPdfFile:()=>Em,noContextMenu:()=>Vi,normalizeUnicode:()=>HC,setLayerDimensions:()=>Ra,shadow:()=>Bt,stopEvent:()=>Qs,version:()=>t2});const gs=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),ly=[1,0,0,1,0,0],Hp=[.001,0,0,.001,0,0],kC=1e7,gp=1.35,Ks={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},_r={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},TC="pdfjs_internal_editor_",Lt={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15},Ut={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_DEFAULT_COLOR:32,HIGHLIGHT_THICKNESS:33,HIGHLIGHT_FREE:34,HIGHLIGHT_SHOW_ALL:35,DRAW_STEP:41},PC={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},is={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},ld={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},Ne={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,WIDGET:20},yc={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},Hf={ERRORS:0,WARNINGS:1,INFOS:5},wi={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93},RC={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let jf=Hf.WARNINGS;function MC(i){Number.isInteger(i)&&(jf=i)}function IC(){return jf}function Vf(i){jf>=Hf.INFOS&&console.log(`Info: ${i}`)}function Dt(i){jf>=Hf.WARNINGS&&console.log(`Warning: ${i}`)}function ae(i){throw new Error(i)}function Ie(i,t){i||ae(t)}function LC(i){switch(i==null?void 0:i.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function DC(i,t=null,e=null){if(!i)return null;try{if(e&&typeof i=="string"){if(e.addDefaultProtocol&&i.startsWith("www.")){const n=i.match(/\./g);(n==null?void 0:n.length)>=2&&(i=`http://${i}`)}if(e.tryConvertEncoding)try{i=BC(i)}catch{}}const s=t?new URL(i,t):new URL(i);if(LC(s))return s}catch{}return null}function Bt(i,t,e,s=!1){return Object.defineProperty(i,t,{value:e,enumerable:!s,configurable:!0,writable:!1}),e}const lo=function(){function t(e,s){this.message=e,this.name=s}return t.prototype=new Error,t.constructor=t,t}();class ib extends lo{constructor(t,e){super(t,"PasswordException"),this.code=e}}class mp extends lo{constructor(t,e){super(t,"UnknownErrorException"),this.details=e}}class jp extends lo{constructor(t){super(t,"InvalidPDFException")}}class au extends lo{constructor(t){super(t,"MissingPDFException")}}class qd extends lo{constructor(t,e){super(t,"UnexpectedResponseException"),this.status=e}}class OC extends lo{constructor(t){super(t,"FormatError")}}class io extends lo{constructor(t){super(t,"AbortException")}}function cy(i){(typeof i!="object"||(i==null?void 0:i.length)===void 0)&&ae("Invalid argument for bytesToString");const t=i.length,e=8192;if(t<e)return String.fromCharCode.apply(null,i);const s=[];for(let n=0;n<t;n+=e){const r=Math.min(n+e,t),o=i.subarray(n,r);s.push(String.fromCharCode.apply(null,o))}return s.join("")}function Uf(i){typeof i!="string"&&ae("Invalid argument for stringToBytes");const t=i.length,e=new Uint8Array(t);for(let s=0;s<t;++s)e[s]=i.charCodeAt(s)&255;return e}function NC(i){return String.fromCharCode(i>>24&255,i>>16&255,i>>8&255,i&255)}function Sm(i){const t=Object.create(null);for(const[e,s]of i)t[e]=s;return t}function FC(){const i=new Uint8Array(4);return i[0]=1,new Uint32Array(i.buffer,0,1)[0]===1}function $C(){try{return new Function(""),!0}catch{return!1}}class Es{static get isLittleEndian(){return Bt(this,"isLittleEndian",FC())}static get isEvalSupported(){return Bt(this,"isEvalSupported",$C())}static get isOffscreenCanvasSupported(){return Bt(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return Bt(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get platform(){return typeof navigator<"u"&&typeof(navigator==null?void 0:navigator.platform)=="string"?Bt(this,"platform",{isMac:navigator.platform.includes("Mac"),isWindows:navigator.platform.includes("Win"),isFirefox:typeof(navigator==null?void 0:navigator.userAgent)=="string"&&navigator.userAgent.includes("Firefox")}):Bt(this,"platform",{isMac:!1,isWindows:!1,isFirefox:!1})}static get isCSSRoundSupported(){var t,e;return Bt(this,"isCSSRoundSupported",(e=(t=globalThis.CSS)==null?void 0:t.supports)==null?void 0:e.call(t,"width: round(1.5px, 1px)"))}}const vp=Array.from(Array(256).keys(),i=>i.toString(16).padStart(2,"0"));var nr,cd,Vp;class bt{static makeHexColor(t,e,s){return`#${vp[t]}${vp[e]}${vp[s]}`}static scaleMinMax(t,e){let s;t[0]?(t[0]<0&&(s=e[0],e[0]=e[2],e[2]=s),e[0]*=t[0],e[2]*=t[0],t[3]<0&&(s=e[1],e[1]=e[3],e[3]=s),e[1]*=t[3],e[3]*=t[3]):(s=e[0],e[0]=e[1],e[1]=s,s=e[2],e[2]=e[3],e[3]=s,t[1]<0&&(s=e[1],e[1]=e[3],e[3]=s),e[1]*=t[1],e[3]*=t[1],t[2]<0&&(s=e[0],e[0]=e[2],e[2]=s),e[0]*=t[2],e[2]*=t[2]),e[0]+=t[4],e[1]+=t[5],e[2]+=t[4],e[3]+=t[5]}static transform(t,e){return[t[0]*e[0]+t[2]*e[1],t[1]*e[0]+t[3]*e[1],t[0]*e[2]+t[2]*e[3],t[1]*e[2]+t[3]*e[3],t[0]*e[4]+t[2]*e[5]+t[4],t[1]*e[4]+t[3]*e[5]+t[5]]}static applyTransform(t,e){const s=t[0]*e[0]+t[1]*e[2]+e[4],n=t[0]*e[1]+t[1]*e[3]+e[5];return[s,n]}static applyInverseTransform(t,e){const s=e[0]*e[3]-e[1]*e[2],n=(t[0]*e[3]-t[1]*e[2]+e[2]*e[5]-e[4]*e[3])/s,r=(-t[0]*e[1]+t[1]*e[0]+e[4]*e[1]-e[5]*e[0])/s;return[n,r]}static getAxialAlignedBoundingBox(t,e){const s=this.applyTransform(t,e),n=this.applyTransform(t.slice(2,4),e),r=this.applyTransform([t[0],t[3]],e),o=this.applyTransform([t[2],t[1]],e);return[Math.min(s[0],n[0],r[0],o[0]),Math.min(s[1],n[1],r[1],o[1]),Math.max(s[0],n[0],r[0],o[0]),Math.max(s[1],n[1],r[1],o[1])]}static inverseTransform(t){const e=t[0]*t[3]-t[1]*t[2];return[t[3]/e,-t[1]/e,-t[2]/e,t[0]/e,(t[2]*t[5]-t[4]*t[3])/e,(t[4]*t[1]-t[5]*t[0])/e]}static singularValueDecompose2dScale(t){const e=[t[0],t[2],t[1],t[3]],s=t[0]*e[0]+t[1]*e[2],n=t[0]*e[1]+t[1]*e[3],r=t[2]*e[0]+t[3]*e[2],o=t[2]*e[1]+t[3]*e[3],a=(s+o)/2,c=Math.sqrt((s+o)**2-4*(s*o-r*n))/2,u=a+c||1,h=a-c||1;return[Math.sqrt(u),Math.sqrt(h)]}static normalizeRect(t){const e=t.slice(0);return t[0]>t[2]&&(e[0]=t[2],e[2]=t[0]),t[1]>t[3]&&(e[1]=t[3],e[3]=t[1]),e}static intersect(t,e){const s=Math.max(Math.min(t[0],t[2]),Math.min(e[0],e[2])),n=Math.min(Math.max(t[0],t[2]),Math.max(e[0],e[2]));if(s>n)return null;const r=Math.max(Math.min(t[1],t[3]),Math.min(e[1],e[3])),o=Math.min(Math.max(t[1],t[3]),Math.max(e[1],e[3]));return r>o?null:[s,r,n,o]}static bezierBoundingBox(t,e,s,n,r,o,a,c,u){return u?(u[0]=Math.min(u[0],t,a),u[1]=Math.min(u[1],e,c),u[2]=Math.max(u[2],t,a),u[3]=Math.max(u[3],e,c)):u=[Math.min(t,a),Math.min(e,c),Math.max(t,a),Math.max(e,c)],w(this,nr,Vp).call(this,t,s,r,a,e,n,o,c,3*(-t+3*(s-r)+a),6*(t-2*s+r),3*(s-t),u),w(this,nr,Vp).call(this,t,s,r,a,e,n,o,c,3*(-e+3*(n-o)+c),6*(e-2*n+o),3*(n-e),u),u}}nr=new WeakSet,cd=function(t,e,s,n,r,o,a,c,u,h){if(u<=0||u>=1)return;const d=1-u,f=u*u,p=f*u,m=d*(d*(d*t+3*u*e)+3*f*s)+p*n,v=d*(d*(d*r+3*u*o)+3*f*a)+p*c;h[0]=Math.min(h[0],m),h[1]=Math.min(h[1],v),h[2]=Math.max(h[2],m),h[3]=Math.max(h[3],v)},Vp=function(t,e,s,n,r,o,a,c,u,h,d,f){if(Math.abs(u)<1e-12){Math.abs(h)>=1e-12&&w(this,nr,cd).call(this,t,e,s,n,r,o,a,c,-d/h,f);return}const p=h**2-4*d*u;if(p<0)return;const m=Math.sqrt(p),v=2*u;w(this,nr,cd).call(this,t,e,s,n,r,o,a,c,(-h+m)/v,f),w(this,nr,cd).call(this,t,e,s,n,r,o,a,c,(-h-m)/v,f)},y(bt,nr);function BC(i){return decodeURIComponent(escape(i))}let bp=null,nb=null;function HC(i){return bp||(bp=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,nb=new Map([["","t"]])),i.replaceAll(bp,(t,e,s)=>e?e.normalize("NFKC"):nb.get(s))}function jC(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const i=new Uint8Array(32);return crypto.getRandomValues(i),cy(i)}const xm="pdfjs_internal_id_";function VC(i){return Uint8Array.prototype.toBase64?i.toBase64():btoa(cy(i))}typeof Promise.try!="function"&&(Promise.try=function(i,...t){return new Promise(e=>{e(i(...t))})});const _n="http://www.w3.org/2000/svg",bo=class bo{};pt(bo,"CSS",96),pt(bo,"PDF",72),pt(bo,"PDF_TO_CSS_UNITS",bo.CSS/bo.PDF);let no=bo;async function Gf(i,t="text"){if(Cc(i,document.baseURI)){const e=await fetch(i);if(!e.ok)throw new Error(e.statusText);switch(t){case"arraybuffer":return e.arrayBuffer();case"blob":return e.blob();case"json":return e.json()}return e.text()}return new Promise((e,s)=>{const n=new XMLHttpRequest;n.open("GET",i,!0),n.responseType=t,n.onreadystatechange=()=>{if(n.readyState===XMLHttpRequest.DONE){if(n.status===200||n.status===0){switch(t){case"arraybuffer":case"blob":case"json":e(n.response);return}e(n.responseText);return}s(new Error(n.statusText))}},n.send(null)})}class jh{constructor({viewBox:t,userUnit:e,scale:s,rotation:n,offsetX:r=0,offsetY:o=0,dontFlip:a=!1}){this.viewBox=t,this.userUnit=e,this.scale=s,this.rotation=n,this.offsetX=r,this.offsetY=o,s*=e;const c=(t[2]+t[0])/2,u=(t[3]+t[1])/2;let h,d,f,p;switch(n%=360,n<0&&(n+=360),n){case 180:h=-1,d=0,f=0,p=1;break;case 90:h=0,d=1,f=1,p=0;break;case 270:h=0,d=-1,f=-1,p=0;break;case 0:h=1,d=0,f=0,p=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}a&&(f=-f,p=-p);let m,v,_,b;h===0?(m=Math.abs(u-t[1])*s+r,v=Math.abs(c-t[0])*s+o,_=(t[3]-t[1])*s,b=(t[2]-t[0])*s):(m=Math.abs(c-t[0])*s+r,v=Math.abs(u-t[1])*s+o,_=(t[2]-t[0])*s,b=(t[3]-t[1])*s),this.transform=[h*s,d*s,f*s,p*s,m-h*s*c-f*s*u,v-d*s*c-p*s*u],this.width=_,this.height=b}get rawDims(){const{userUnit:t,viewBox:e}=this,s=e.map(n=>n*t);return Bt(this,"rawDims",{pageWidth:s[2]-s[0],pageHeight:s[3]-s[1],pageX:s[0],pageY:s[1]})}clone({scale:t=this.scale,rotation:e=this.rotation,offsetX:s=this.offsetX,offsetY:n=this.offsetY,dontFlip:r=!1}={}){return new jh({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:t,rotation:e,offsetX:s,offsetY:n,dontFlip:r})}convertToViewportPoint(t,e){return bt.applyTransform([t,e],this.transform)}convertToViewportRectangle(t){const e=bt.applyTransform([t[0],t[1]],this.transform),s=bt.applyTransform([t[2],t[3]],this.transform);return[e[0],e[1],s[0],s[1]]}convertToPdfPoint(t,e){return bt.applyInverseTransform([t,e],this.transform)}}class Cm extends lo{constructor(t,e=0){super(t,"RenderingCancelledException"),this.extraDelay=e}}function zf(i){const t=i.length;let e=0;for(;e<t&&i[e].trim()==="";)e++;return i.substring(e,e+5).toLowerCase()==="data:"}function Em(i){return typeof i=="string"&&/\.pdf$/i.test(i)}function UC(i){return[i]=i.split(/[#?]/,1),i.substring(i.lastIndexOf("/")+1)}function GC(i,t="document.pdf"){if(typeof i!="string")return t;if(zf(i))return Dt('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),t;const e=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,s=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,n=e.exec(i);let r=s.exec(n[1])||s.exec(n[2])||s.exec(n[3]);if(r&&(r=r[0],r.includes("%")))try{r=s.exec(decodeURIComponent(r))[0]}catch{}return r||t}class rb{constructor(){pt(this,"started",Object.create(null));pt(this,"times",[])}time(t){t in this.started&&Dt(`Timer is already running for ${t}`),this.started[t]=Date.now()}timeEnd(t){t in this.started||Dt(`Timer has not been started for ${t}`),this.times.push({name:t,start:this.started[t],end:Date.now()}),delete this.started[t]}toString(){const t=[];let e=0;for(const{name:s}of this.times)e=Math.max(s.length,e);for(const{name:s,start:n,end:r}of this.times)t.push(`${s.padEnd(e)} ${r-n}ms
`);return t.join("")}}function Cc(i,t){try{const{protocol:e}=t?new URL(i,t):new URL(i);return e==="http:"||e==="https:"}catch{return!1}}function Vi(i){i.preventDefault()}function Qs(i){i.preventDefault(),i.stopPropagation()}var uu;class km{static toDateObject(t){if(!t||typeof t!="string")return null;l(this,uu)||g(this,uu,new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const e=l(this,uu).exec(t);if(!e)return null;const s=parseInt(e[1],10);let n=parseInt(e[2],10);n=n>=1&&n<=12?n-1:0;let r=parseInt(e[3],10);r=r>=1&&r<=31?r:1;let o=parseInt(e[4],10);o=o>=0&&o<=23?o:0;let a=parseInt(e[5],10);a=a>=0&&a<=59?a:0;let c=parseInt(e[6],10);c=c>=0&&c<=59?c:0;const u=e[7]||"Z";let h=parseInt(e[8],10);h=h>=0&&h<=23?h:0;let d=parseInt(e[9],10)||0;return d=d>=0&&d<=59?d:0,u==="-"?(o+=h,a+=d):u==="+"&&(o-=h,a-=d),new Date(Date.UTC(s,n,r,o,a,c))}}uu=new WeakMap,y(km,uu);function zC(i,{scale:t=1,rotation:e=0}){const{width:s,height:n}=i.attributes.style,r=[0,0,parseInt(s),parseInt(n)];return new jh({viewBox:r,userUnit:1,scale:t,rotation:e})}function Tm(i){if(i.startsWith("#")){const t=parseInt(i.slice(1),16);return[(t&16711680)>>16,(t&65280)>>8,t&255]}return i.startsWith("rgb(")?i.slice(4,-1).split(",").map(t=>parseInt(t)):i.startsWith("rgba(")?i.slice(5,-1).split(",").map(t=>parseInt(t)).slice(0,3):(Dt(`Not a valid color format: "${i}"`),[0,0,0])}function WC(i){const t=document.createElement("span");t.style.visibility="hidden",document.body.append(t);for(const e of i.keys()){t.style.color=e;const s=window.getComputedStyle(t).color;i.set(e,Tm(s))}t.remove()}function de(i){const{a:t,b:e,c:s,d:n,e:r,f:o}=i.getTransform();return[t,e,s,n,r,o]}function Wi(i){const{a:t,b:e,c:s,d:n,e:r,f:o}=i.getTransform().invertSelf();return[t,e,s,n,r,o]}function Ra(i,t,e=!1,s=!0){if(t instanceof jh){const{pageWidth:n,pageHeight:r}=t.rawDims,{style:o}=i,a=Es.isCSSRoundSupported,c=`var(--scale-factor) * ${n}px`,u=`var(--scale-factor) * ${r}px`,h=a?`round(down, ${c}, var(--scale-round-x, 1px))`:`calc(${c})`,d=a?`round(down, ${u}, var(--scale-round-y, 1px))`:`calc(${u})`;!e||t.rotation%180===0?(o.width=h,o.height=d):(o.width=d,o.height=h)}s&&i.setAttribute("data-main-rotation",t.rotation)}class Up{constructor(){const t=window.devicePixelRatio||1;this.sx=t,this.sy=t}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}}var Ar,_o,_i,Ao,hu,du,ef,uy,ks,hy,dy,ud,fy,zp;const Cn=class Cn{constructor(t){y(this,ks);y(this,Ar,null);y(this,_o,null);y(this,_i);y(this,Ao,null);y(this,hu,null);g(this,_i,t),l(Cn,du)||g(Cn,du,Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button"}))}render(){const t=g(this,Ar,document.createElement("div"));t.classList.add("editToolbar","hidden"),t.setAttribute("role","toolbar");const e=l(this,_i)._uiManager._signal;t.addEventListener("contextmenu",Vi,{signal:e}),t.addEventListener("pointerdown",w(Cn,ef,uy),{signal:e});const s=g(this,Ao,document.createElement("div"));s.className="buttons",t.append(s);const n=l(this,_i).toolbarPosition;if(n){const{style:r}=t,o=l(this,_i)._uiManager.direction==="ltr"?1-n[0]:n[0];r.insetInlineEnd=`${100*o}%`,r.top=`calc(${100*n[1]}% + var(--editor-toolbar-vert-offset))`}return w(this,ks,fy).call(this),t}get div(){return l(this,Ar)}hide(){var t;l(this,Ar).classList.add("hidden"),(t=l(this,_o))==null||t.hideDropdown()}show(){var t;l(this,Ar).classList.remove("hidden"),(t=l(this,hu))==null||t.shown()}async addAltText(t){const e=await t.render();w(this,ks,ud).call(this,e),l(this,Ao).prepend(e,l(this,ks,zp)),g(this,hu,t)}addColorPicker(t){g(this,_o,t);const e=t.renderButton();w(this,ks,ud).call(this,e),l(this,Ao).prepend(e,l(this,ks,zp))}remove(){var t;l(this,Ar).remove(),(t=l(this,_o))==null||t.destroy(),g(this,_o,null)}};Ar=new WeakMap,_o=new WeakMap,_i=new WeakMap,Ao=new WeakMap,hu=new WeakMap,du=new WeakMap,ef=new WeakSet,uy=function(t){t.stopPropagation()},ks=new WeakSet,hy=function(t){l(this,_i)._focusEventsAllowed=!1,Qs(t)},dy=function(t){l(this,_i)._focusEventsAllowed=!0,Qs(t)},ud=function(t){const e=l(this,_i)._uiManager._signal;t.addEventListener("focusin",w(this,ks,hy).bind(this),{capture:!0,signal:e}),t.addEventListener("focusout",w(this,ks,dy).bind(this),{capture:!0,signal:e}),t.addEventListener("contextmenu",Vi,{signal:e})},fy=function(){const{editorType:t,_uiManager:e}=l(this,_i),s=document.createElement("button");s.className="delete",s.tabIndex=0,s.setAttribute("data-l10n-id",l(Cn,du)[t]),w(this,ks,ud).call(this,s),s.addEventListener("click",n=>{e.delete()},{signal:e._signal}),l(this,Ao).append(s)},zp=function(){const t=document.createElement("div");return t.className="divider",t},y(Cn,ef),y(Cn,du,null);let Gp=Cn;var fu,So,xo,ro,py,gy,my;class qC{constructor(t){y(this,ro);y(this,fu,null);y(this,So,null);y(this,xo);g(this,xo,t)}show(t,e,s){const[n,r]=w(this,ro,gy).call(this,e,s),{style:o}=l(this,So)||g(this,So,w(this,ro,py).call(this));t.append(l(this,So)),o.insetInlineEnd=`${100*n}%`,o.top=`calc(${100*r}% + var(--editor-toolbar-vert-offset))`}hide(){l(this,So).remove()}}fu=new WeakMap,So=new WeakMap,xo=new WeakMap,ro=new WeakSet,py=function(){const t=g(this,So,document.createElement("div"));t.className="editToolbar",t.setAttribute("role","toolbar"),t.addEventListener("contextmenu",Vi,{signal:l(this,xo)._signal});const e=g(this,fu,document.createElement("div"));return e.className="buttons",t.append(e),w(this,ro,my).call(this),t},gy=function(t,e){let s=0,n=0;for(const r of t){const o=r.y+r.height;if(o<s)continue;const a=r.x+(e?r.width:0);if(o>s){n=a,s=o;continue}e?a>n&&(n=a):a<n&&(n=a)}return[e?1-n:n,s]},my=function(){const t=document.createElement("button");t.className="highlightButton",t.tabIndex=0,t.setAttribute("data-l10n-id","pdfjs-highlight-floating-button1");const e=document.createElement("span");t.append(e),e.className="visuallyHidden",e.setAttribute("data-l10n-id","pdfjs-highlight-floating-button-label");const s=l(this,xo)._signal;t.addEventListener("contextmenu",Vi,{signal:s}),t.addEventListener("click",()=>{l(this,xo).highlightSelection("floating_button")},{signal:s}),l(this,fu).append(t)};function Xd(i,t,e){for(const s of e)t.addEventListener(s,i[s].bind(i))}var sf;class XC{constructor(){y(this,sf,0)}get id(){return`${TC}${ms(this,sf)._++}`}}sf=new WeakMap;var il,pu,os,nl,hd;const Dm=class Dm{constructor(){y(this,nl);y(this,il,jC());y(this,pu,0);y(this,os,null)}static get _isSVGFittingCanvas(){const t='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',s=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),n=new Image;n.src=t;const r=n.decode().then(()=>(s.drawImage(n,0,0,1,1,0,0,1,3),new Uint32Array(s.getImageData(0,0,1,1).data.buffer)[0]===0));return Bt(this,"_isSVGFittingCanvas",r)}async getFromFile(t){const{lastModified:e,name:s,size:n,type:r}=t;return w(this,nl,hd).call(this,`${e}_${s}_${n}_${r}`,t)}async getFromUrl(t){return w(this,nl,hd).call(this,t,t)}async getFromBlob(t,e){const s=await e;return w(this,nl,hd).call(this,t,s)}async getFromId(t){l(this,os)||g(this,os,new Map);const e=l(this,os).get(t);if(!e)return null;if(e.bitmap)return e.refCounter+=1,e;if(e.file)return this.getFromFile(e.file);if(e.blobPromise){const{blobPromise:s}=e;return delete e.blobPromise,this.getFromBlob(e.id,s)}return this.getFromUrl(e.url)}getFromCanvas(t,e){l(this,os)||g(this,os,new Map);let s=l(this,os).get(t);if(s!=null&&s.bitmap)return s.refCounter+=1,s;const n=new OffscreenCanvas(e.width,e.height);return n.getContext("2d").drawImage(e,0,0),s={bitmap:n.transferToImageBitmap(),id:`image_${l(this,il)}_${ms(this,pu)._++}`,refCounter:1,isSvg:!1},l(this,os).set(t,s),l(this,os).set(s.id,s),s}getSvgUrl(t){const e=l(this,os).get(t);return e!=null&&e.isSvg?e.svgUrl:null}deleteId(t){var n;l(this,os)||g(this,os,new Map);const e=l(this,os).get(t);if(!e||(e.refCounter-=1,e.refCounter!==0))return;const{bitmap:s}=e;if(!e.url&&!e.file){const r=new OffscreenCanvas(s.width,s.height);r.getContext("bitmaprenderer").transferFromImageBitmap(s),e.blobPromise=r.convertToBlob()}(n=s.close)==null||n.call(s),e.bitmap=null}isValidId(t){return t.startsWith(`image_${l(this,il)}_`)}};il=new WeakMap,pu=new WeakMap,os=new WeakMap,nl=new WeakSet,hd=async function(t,e){l(this,os)||g(this,os,new Map);let s=l(this,os).get(t);if(s===null)return null;if(s!=null&&s.bitmap)return s.refCounter+=1,s;try{s||(s={bitmap:null,id:`image_${l(this,il)}_${ms(this,pu)._++}`,refCounter:0,isSvg:!1});let n;if(typeof e=="string"?(s.url=e,n=await Gf(e,"blob")):e instanceof File?n=s.file=e:e instanceof Blob&&(n=e),n.type==="image/svg+xml"){const r=Dm._isSVGFittingCanvas,o=new FileReader,a=new Image,c=new Promise((u,h)=>{a.onload=()=>{s.bitmap=a,s.isSvg=!0,u()},o.onload=async()=>{const d=s.svgUrl=o.result;a.src=await r?`${d}#svgView(preserveAspectRatio(none))`:d},a.onerror=o.onerror=h});o.readAsDataURL(n),await c}else s.bitmap=await createImageBitmap(n);s.refCounter=1}catch(n){Dt(n),s=null}return l(this,os).set(t,s),s&&l(this,os).set(s.id,s),s};let Wp=Dm;var ke,Sr,gu,ve;class KC{constructor(t=128){y(this,ke,[]);y(this,Sr,!1);y(this,gu);y(this,ve,-1);g(this,gu,t)}add({cmd:t,undo:e,post:s,mustExec:n,type:r=NaN,overwriteIfSameType:o=!1,keepUndo:a=!1}){if(n&&t(),l(this,Sr))return;const c={cmd:t,undo:e,post:s,type:r};if(l(this,ve)===-1){l(this,ke).length>0&&(l(this,ke).length=0),g(this,ve,0),l(this,ke).push(c);return}if(o&&l(this,ke)[l(this,ve)].type===r){a&&(c.undo=l(this,ke)[l(this,ve)].undo),l(this,ke)[l(this,ve)]=c;return}const u=l(this,ve)+1;u===l(this,gu)?l(this,ke).splice(0,1):(g(this,ve,u),u<l(this,ke).length&&l(this,ke).splice(u)),l(this,ke).push(c)}undo(){if(l(this,ve)===-1)return;g(this,Sr,!0);const{undo:t,post:e}=l(this,ke)[l(this,ve)];t(),e==null||e(),g(this,Sr,!1),g(this,ve,l(this,ve)-1)}redo(){if(l(this,ve)<l(this,ke).length-1){g(this,ve,l(this,ve)+1),g(this,Sr,!0);const{cmd:t,post:e}=l(this,ke)[l(this,ve)];t(),e==null||e(),g(this,Sr,!1)}}hasSomethingToUndo(){return l(this,ve)!==-1}hasSomethingToRedo(){return l(this,ve)<l(this,ke).length-1}cleanType(t){if(l(this,ve)!==-1){for(let e=l(this,ve);e>=0;e--)if(l(this,ke)[e].type!==t){l(this,ke).splice(e+1,l(this,ve)-e),g(this,ve,e);return}l(this,ke).length=0,g(this,ve,-1)}}destroy(){g(this,ke,null)}}ke=new WeakMap,Sr=new WeakMap,gu=new WeakMap,ve=new WeakMap;var nf,vy;class Vh{constructor(t){y(this,nf);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:e}=Es.platform;for(const[s,n,r={}]of t)for(const o of s){const a=o.startsWith("mac+");e&&a?(this.callbacks.set(o.slice(4),{callback:n,options:r}),this.allKeys.add(o.split("+").at(-1))):!e&&!a&&(this.callbacks.set(o,{callback:n,options:r}),this.allKeys.add(o.split("+").at(-1)))}}exec(t,e){if(!this.allKeys.has(e.key))return;const s=this.callbacks.get(w(this,nf,vy).call(this,e));if(!s)return;const{callback:n,options:{bubbles:r=!1,args:o=[],checker:a=null}}=s;a&&!a(t,e)||(n.bind(t,...o,e)(),r||Qs(e))}}nf=new WeakSet,vy=function(t){t.altKey&&this.buffer.push("alt"),t.ctrlKey&&this.buffer.push("ctrl"),t.metaKey&&this.buffer.push("meta"),t.shiftKey&&this.buffer.push("shift"),this.buffer.push(t.key);const e=this.buffer.join("+");return this.buffer.length=0,e};const rf=class rf{get _colors(){const t=new Map([["CanvasText",null],["Canvas",null]]);return WC(t),Bt(this,"_colors",t)}convert(t){const e=Tm(t);if(!window.matchMedia("(forced-colors: active)").matches)return e;for(const[s,n]of this._colors)if(n.every((r,o)=>r===e[o]))return rf._colorsMapping.get(s);return e}getHexCode(t){const e=this._colors.get(t);return e?bt.makeHexColor(...e):t}};pt(rf,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let qp=rf;var rl,Fs,$e,Ke,ol,Tn,al,ni,xr,Co,ll,Eo,Ji,Ai,ko,mu,vu,cl,bu,Qi,Cr,ul,Er,Zi,of,kr,yu,Tr,To,wu,_u,Ve,te,Pn,Po,Au,Su,Pr,tn,Rn,xu,ri,at,dd,Xp,by,yy,fd,wy,_y,Ay,Kp,Sy,Yp,Jp,xy,bs,An,Cy,Ey,Qp,ky,Ec,Zp;const Ka=class Ka{constructor(t,e,s,n,r,o,a,c,u,h,d,f,p){y(this,at);y(this,rl,new AbortController);y(this,Fs,null);y(this,$e,new Map);y(this,Ke,new Map);y(this,ol,null);y(this,Tn,null);y(this,al,null);y(this,ni,new KC);y(this,xr,null);y(this,Co,null);y(this,ll,0);y(this,Eo,new Set);y(this,Ji,null);y(this,Ai,null);y(this,ko,new Set);pt(this,"_editorUndoBar",null);y(this,mu,!1);y(this,vu,!1);y(this,cl,!1);y(this,bu,null);y(this,Qi,null);y(this,Cr,null);y(this,ul,null);y(this,Er,!1);y(this,Zi,null);y(this,of,new XC);y(this,kr,!1);y(this,yu,!1);y(this,Tr,null);y(this,To,null);y(this,wu,null);y(this,_u,null);y(this,Ve,Lt.NONE);y(this,te,new Set);y(this,Pn,null);y(this,Po,null);y(this,Au,null);y(this,Su,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1});y(this,Pr,[0,0]);y(this,tn,null);y(this,Rn,null);y(this,xu,null);y(this,ri,null);const m=this._signal=l(this,rl).signal;g(this,Rn,t),g(this,xu,e),g(this,ol,s),this._eventBus=n,n._on("editingaction",this.onEditingAction.bind(this),{signal:m}),n._on("pagechanging",this.onPageChanging.bind(this),{signal:m}),n._on("scalechanging",this.onScaleChanging.bind(this),{signal:m}),n._on("rotationchanging",this.onRotationChanging.bind(this),{signal:m}),n._on("setpreference",this.onSetPreference.bind(this),{signal:m}),n._on("switchannotationeditorparams",v=>this.updateParams(v.type,v.value),{signal:m}),w(this,at,wy).call(this),w(this,at,xy).call(this),w(this,at,Kp).call(this),g(this,Tn,r.annotationStorage),g(this,bu,r.filterFactory),g(this,Po,o),g(this,ul,a||null),g(this,mu,c),g(this,vu,u),g(this,cl,h),g(this,_u,d||null),this.viewParameters={realScale:no.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=f||null,this._supportsPinchToZoom=p!==!1}static get _keyboardManager(){const t=Ka.prototype,e=o=>l(o,Rn).contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&o.hasSomethingToControl(),s=(o,{target:a})=>{if(a instanceof HTMLInputElement){const{type:c}=a;return c!=="text"&&c!=="number"}return!0},n=this.TRANSLATE_SMALL,r=this.TRANSLATE_BIG;return Bt(this,"_keyboardManager",new Vh([[["ctrl+a","mac+meta+a"],t.selectAll,{checker:s}],[["ctrl+z","mac+meta+z"],t.undo,{checker:s}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],t.redo,{checker:s}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],t.delete,{checker:s}],[["Enter","mac+Enter"],t.addNewEditorFromKeyboard,{checker:(o,{target:a})=>!(a instanceof HTMLButtonElement)&&l(o,Rn).contains(a)&&!o.isEnterHandled}],[[" ","mac+ "],t.addNewEditorFromKeyboard,{checker:(o,{target:a})=>!(a instanceof HTMLButtonElement)&&l(o,Rn).contains(document.activeElement)}],[["Escape","mac+Escape"],t.unselectAll],[["ArrowLeft","mac+ArrowLeft"],t.translateSelectedEditors,{args:[-n,0],checker:e}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t.translateSelectedEditors,{args:[-r,0],checker:e}],[["ArrowRight","mac+ArrowRight"],t.translateSelectedEditors,{args:[n,0],checker:e}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t.translateSelectedEditors,{args:[r,0],checker:e}],[["ArrowUp","mac+ArrowUp"],t.translateSelectedEditors,{args:[0,-n],checker:e}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t.translateSelectedEditors,{args:[0,-r],checker:e}],[["ArrowDown","mac+ArrowDown"],t.translateSelectedEditors,{args:[0,n],checker:e}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t.translateSelectedEditors,{args:[0,r],checker:e}]]))}destroy(){var t,e,s,n,r;(t=l(this,ri))==null||t.resolve(),g(this,ri,null),(e=l(this,rl))==null||e.abort(),g(this,rl,null),this._signal=null;for(const o of l(this,Ke).values())o.destroy();l(this,Ke).clear(),l(this,$e).clear(),l(this,ko).clear(),g(this,Fs,null),l(this,te).clear(),l(this,ni).destroy(),(s=l(this,ol))==null||s.destroy(),(n=l(this,Zi))==null||n.hide(),g(this,Zi,null),l(this,Qi)&&(clearTimeout(l(this,Qi)),g(this,Qi,null)),l(this,tn)&&(clearTimeout(l(this,tn)),g(this,tn,null)),(r=this._editorUndoBar)==null||r.destroy()}combinedSignal(t){return AbortSignal.any([this._signal,t.signal])}get mlManager(){return l(this,_u)}get useNewAltTextFlow(){return l(this,vu)}get useNewAltTextWhenAddingImage(){return l(this,cl)}get hcmFilter(){return Bt(this,"hcmFilter",l(this,Po)?l(this,bu).addHCMFilter(l(this,Po).foreground,l(this,Po).background):"none")}get direction(){return Bt(this,"direction",getComputedStyle(l(this,Rn)).direction)}get highlightColors(){return Bt(this,"highlightColors",l(this,ul)?new Map(l(this,ul).split(",").map(t=>t.split("=").map(e=>e.trim()))):null)}get highlightColorNames(){return Bt(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,t=>t.reverse())):null)}setCurrentDrawingSession(t){t?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),g(this,Co,t)}setMainHighlightColorPicker(t){g(this,wu,t)}editAltText(t,e=!1){var s;(s=l(this,ol))==null||s.editAltText(this,t,e)}switchToMode(t,e){this._eventBus.on("annotationeditormodechanged",e,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:t})}setPreference(t,e){this._eventBus.dispatch("setpreference",{source:this,name:t,value:e})}onSetPreference({name:t,value:e}){switch(t){case"enableNewAltTextWhenAddingImage":g(this,cl,e);break}}onPageChanging({pageNumber:t}){g(this,ll,t-1)}focusMainContainer(){l(this,Rn).focus()}findParent(t,e){for(const s of l(this,Ke).values()){const{x:n,y:r,width:o,height:a}=s.div.getBoundingClientRect();if(t>=n&&t<=n+o&&e>=r&&e<=r+a)return s}return null}disableUserSelect(t=!1){l(this,xu).classList.toggle("noUserSelect",t)}addShouldRescale(t){l(this,ko).add(t)}removeShouldRescale(t){l(this,ko).delete(t)}onScaleChanging({scale:t}){var e;this.commitOrRemove(),this.viewParameters.realScale=t*no.PDF_TO_CSS_UNITS;for(const s of l(this,ko))s.onScaleChanging();(e=l(this,Co))==null||e.onScaleChanging()}onRotationChanging({pagesRotation:t}){this.commitOrRemove(),this.viewParameters.rotation=t}highlightSelection(t=""){const e=document.getSelection();if(!e||e.isCollapsed)return;const{anchorNode:s,anchorOffset:n,focusNode:r,focusOffset:o}=e,a=e.toString(),u=w(this,at,dd).call(this,e).closest(".textLayer"),h=this.getSelectionBoxes(u);if(!h)return;e.empty();const d=w(this,at,Xp).call(this,u),f=l(this,Ve)===Lt.NONE,p=()=>{d==null||d.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:t,boxes:h,anchorNode:s,anchorOffset:n,focusNode:r,focusOffset:o,text:a}),f&&this.showAllEditors("highlight",!0,!0)};if(f){this.switchToMode(Lt.HIGHLIGHT,p);return}p()}addToAnnotationStorage(t){!t.isEmpty()&&l(this,Tn)&&!l(this,Tn).has(t.id)&&l(this,Tn).setValue(t.id,t)}blur(){if(this.isShiftKeyDown=!1,l(this,Er)&&(g(this,Er,!1),w(this,at,fd).call(this,"main_toolbar")),!this.hasSelection)return;const{activeElement:t}=document;for(const e of l(this,te))if(e.div.contains(t)){g(this,To,[e,t]),e._focusEventsAllowed=!1;break}}focus(){if(!l(this,To))return;const[t,e]=l(this,To);g(this,To,null),e.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:this._signal}),e.focus()}addEditListeners(){w(this,at,Kp).call(this),w(this,at,Yp).call(this)}removeEditListeners(){w(this,at,Sy).call(this),w(this,at,Jp).call(this)}dragOver(t){for(const{type:e}of t.dataTransfer.items)for(const s of l(this,Ai))if(s.isHandlingMimeForPasting(e)){t.dataTransfer.dropEffect="copy",t.preventDefault();return}}drop(t){for(const e of t.dataTransfer.items)for(const s of l(this,Ai))if(s.isHandlingMimeForPasting(e.type)){s.paste(e,this.currentLayer),t.preventDefault();return}}copy(t){var s;if(t.preventDefault(),(s=l(this,Fs))==null||s.commitOrRemove(),!this.hasSelection)return;const e=[];for(const n of l(this,te)){const r=n.serialize(!0);r&&e.push(r)}e.length!==0&&t.clipboardData.setData("application/pdfjs",JSON.stringify(e))}cut(t){this.copy(t),this.delete()}async paste(t){t.preventDefault();const{clipboardData:e}=t;for(const r of e.items)for(const o of l(this,Ai))if(o.isHandlingMimeForPasting(r.type)){o.paste(r,this.currentLayer);return}let s=e.getData("application/pdfjs");if(!s)return;try{s=JSON.parse(s)}catch(r){Dt(`paste: "${r.message}".`);return}if(!Array.isArray(s))return;this.unselectAll();const n=this.currentLayer;try{const r=[];for(const c of s){const u=await n.deserialize(c);if(!u)return;r.push(u)}const o=()=>{for(const c of r)w(this,at,Qp).call(this,c);w(this,at,Zp).call(this,r)},a=()=>{for(const c of r)c.remove()};this.addCommands({cmd:o,undo:a,mustExec:!0})}catch(r){Dt(`paste: "${r.message}".`)}}keydown(t){!this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!0),l(this,Ve)!==Lt.NONE&&!this.isEditorHandlingKeyboard&&Ka._keyboardManager.exec(this,t)}keyup(t){this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!1,l(this,Er)&&(g(this,Er,!1),w(this,at,fd).call(this,"main_toolbar")))}onEditingAction({name:t}){switch(t){case"undo":case"redo":case"delete":case"selectAll":this[t]();break;case"highlightSelection":this.highlightSelection("context_menu");break}}setEditingState(t){t?(w(this,at,_y).call(this),w(this,at,Yp).call(this),w(this,at,bs).call(this,{isEditing:l(this,Ve)!==Lt.NONE,isEmpty:w(this,at,Ec).call(this),hasSomethingToUndo:l(this,ni).hasSomethingToUndo(),hasSomethingToRedo:l(this,ni).hasSomethingToRedo(),hasSelectedEditor:!1})):(w(this,at,Ay).call(this),w(this,at,Jp).call(this),w(this,at,bs).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(t){if(!l(this,Ai)){g(this,Ai,t);for(const e of l(this,Ai))w(this,at,An).call(this,e.defaultPropertiesToUpdate)}}getId(){return l(this,of).id}get currentLayer(){return l(this,Ke).get(l(this,ll))}getLayer(t){return l(this,Ke).get(t)}get currentPageIndex(){return l(this,ll)}addLayer(t){l(this,Ke).set(t.pageIndex,t),l(this,kr)?t.enable():t.disable()}removeLayer(t){l(this,Ke).delete(t.pageIndex)}async updateMode(t,e=null,s=!1){var n;if(l(this,Ve)!==t&&!(l(this,ri)&&(await l(this,ri).promise,!l(this,ri)))){if(g(this,ri,Promise.withResolvers()),g(this,Ve,t),t===Lt.NONE){this.setEditingState(!1),w(this,at,Ey).call(this),(n=this._editorUndoBar)==null||n.hide(),l(this,ri).resolve();return}this.setEditingState(!0),await w(this,at,Cy).call(this),this.unselectAll();for(const r of l(this,Ke).values())r.updateMode(t);if(!e){s&&this.addNewEditorFromKeyboard(),l(this,ri).resolve();return}for(const r of l(this,$e).values())r.annotationElementId===e?(this.setSelected(r),r.enterInEditMode()):r.unselect();l(this,ri).resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(t){t!==l(this,Ve)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:t})}updateParams(t,e){var s;if(l(this,Ai)){switch(t){case Ut.CREATE:this.currentLayer.addNewEditor();return;case Ut.HIGHLIGHT_DEFAULT_COLOR:(s=l(this,wu))==null||s.updateColor(e);break;case Ut.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(l(this,Au)||g(this,Au,new Map)).set(t,e),this.showAllEditors("highlight",e);break}for(const n of l(this,te))n.updateParams(t,e);for(const n of l(this,Ai))n.updateDefaultParams(t,e)}}showAllEditors(t,e,s=!1){var r;for(const o of l(this,$e).values())o.editorType===t&&o.show(e);(((r=l(this,Au))==null?void 0:r.get(Ut.HIGHLIGHT_SHOW_ALL))??!0)!==e&&w(this,at,An).call(this,[[Ut.HIGHLIGHT_SHOW_ALL,e]])}enableWaiting(t=!1){if(l(this,yu)!==t){g(this,yu,t);for(const e of l(this,Ke).values())t?e.disableClick():e.enableClick(),e.div.classList.toggle("waiting",t)}}getEditors(t){const e=[];for(const s of l(this,$e).values())s.pageIndex===t&&e.push(s);return e}getEditor(t){return l(this,$e).get(t)}addEditor(t){l(this,$e).set(t.id,t)}removeEditor(t){var e;t.div.contains(document.activeElement)&&(l(this,Qi)&&clearTimeout(l(this,Qi)),g(this,Qi,setTimeout(()=>{this.focusMainContainer(),g(this,Qi,null)},0))),l(this,$e).delete(t.id),this.unselect(t),(!t.annotationElementId||!l(this,Eo).has(t.annotationElementId))&&((e=l(this,Tn))==null||e.remove(t.id))}addDeletedAnnotationElement(t){l(this,Eo).add(t.annotationElementId),this.addChangedExistingAnnotation(t),t.deleted=!0}isDeletedAnnotationElement(t){return l(this,Eo).has(t)}removeDeletedAnnotationElement(t){l(this,Eo).delete(t.annotationElementId),this.removeChangedExistingAnnotation(t),t.deleted=!1}setActiveEditor(t){l(this,Fs)!==t&&(g(this,Fs,t),t&&w(this,at,An).call(this,t.propertiesToUpdate))}updateUI(t){l(this,at,ky)===t&&w(this,at,An).call(this,t.propertiesToUpdate)}updateUIForDefaultProperties(t){w(this,at,An).call(this,t.defaultPropertiesToUpdate)}toggleSelected(t){if(l(this,te).has(t)){l(this,te).delete(t),t.unselect(),w(this,at,bs).call(this,{hasSelectedEditor:this.hasSelection});return}l(this,te).add(t),t.select(),w(this,at,An).call(this,t.propertiesToUpdate),w(this,at,bs).call(this,{hasSelectedEditor:!0})}setSelected(t){var e;(e=l(this,Co))==null||e.commitOrRemove();for(const s of l(this,te))s!==t&&s.unselect();l(this,te).clear(),l(this,te).add(t),t.select(),w(this,at,An).call(this,t.propertiesToUpdate),w(this,at,bs).call(this,{hasSelectedEditor:!0})}isSelected(t){return l(this,te).has(t)}get firstSelectedEditor(){return l(this,te).values().next().value}unselect(t){t.unselect(),l(this,te).delete(t),w(this,at,bs).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return l(this,te).size!==0}get isEnterHandled(){return l(this,te).size===1&&this.firstSelectedEditor.isEnterHandled}undo(){var t;l(this,ni).undo(),w(this,at,bs).call(this,{hasSomethingToUndo:l(this,ni).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:w(this,at,Ec).call(this)}),(t=this._editorUndoBar)==null||t.hide()}redo(){l(this,ni).redo(),w(this,at,bs).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:l(this,ni).hasSomethingToRedo(),isEmpty:w(this,at,Ec).call(this)})}addCommands(t){l(this,ni).add(t),w(this,at,bs).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:w(this,at,Ec).call(this)})}cleanUndoStack(t){l(this,ni).cleanType(t)}delete(){var r;this.commitOrRemove();const t=(r=this.currentLayer)==null?void 0:r.endDrawingSession(!0);if(!this.hasSelection&&!t)return;const e=t?[t]:[...l(this,te)],s=()=>{var o;(o=this._editorUndoBar)==null||o.show(n,e.length===1?e[0].editorType:e.length);for(const a of e)a.remove()},n=()=>{for(const o of e)w(this,at,Qp).call(this,o)};this.addCommands({cmd:s,undo:n,mustExec:!0})}commitOrRemove(){var t;(t=l(this,Fs))==null||t.commitOrRemove()}hasSomethingToControl(){return l(this,Fs)||this.hasSelection}selectAll(){for(const t of l(this,te))t.commit();w(this,at,Zp).call(this,l(this,$e).values())}unselectAll(){var t;if(!(l(this,Fs)&&(l(this,Fs).commitOrRemove(),l(this,Ve)!==Lt.NONE))&&!((t=l(this,Co))!=null&&t.commitOrRemove())&&this.hasSelection){for(const e of l(this,te))e.unselect();l(this,te).clear(),w(this,at,bs).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(t,e,s=!1){if(s||this.commitOrRemove(),!this.hasSelection)return;l(this,Pr)[0]+=t,l(this,Pr)[1]+=e;const[n,r]=l(this,Pr),o=[...l(this,te)],a=1e3;l(this,tn)&&clearTimeout(l(this,tn)),g(this,tn,setTimeout(()=>{g(this,tn,null),l(this,Pr)[0]=l(this,Pr)[1]=0,this.addCommands({cmd:()=>{for(const c of o)l(this,$e).has(c.id)&&c.translateInPage(n,r)},undo:()=>{for(const c of o)l(this,$e).has(c.id)&&c.translateInPage(-n,-r)},mustExec:!1})},a));for(const c of o)c.translateInPage(t,e)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),g(this,Ji,new Map);for(const t of l(this,te))l(this,Ji).set(t,{savedX:t.x,savedY:t.y,savedPageIndex:t.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!l(this,Ji))return!1;this.disableUserSelect(!1);const t=l(this,Ji);g(this,Ji,null);let e=!1;for(const[{x:n,y:r,pageIndex:o},a]of t)a.newX=n,a.newY=r,a.newPageIndex=o,e||(e=n!==a.savedX||r!==a.savedY||o!==a.savedPageIndex);if(!e)return!1;const s=(n,r,o,a)=>{if(l(this,$e).has(n.id)){const c=l(this,Ke).get(a);c?n._setParentAndPosition(c,r,o):(n.pageIndex=a,n.x=r,n.y=o)}};return this.addCommands({cmd:()=>{for(const[n,{newX:r,newY:o,newPageIndex:a}]of t)s(n,r,o,a)},undo:()=>{for(const[n,{savedX:r,savedY:o,savedPageIndex:a}]of t)s(n,r,o,a)},mustExec:!0}),!0}dragSelectedEditors(t,e){if(l(this,Ji))for(const s of l(this,Ji).keys())s.drag(t,e)}rebuild(t){if(t.parent===null){const e=this.getLayer(t.pageIndex);e?(e.changeParent(t),e.addOrRebuild(t)):(this.addEditor(t),this.addToAnnotationStorage(t),t.rebuild())}else t.parent.addOrRebuild(t)}get isEditorHandlingKeyboard(){var t;return((t=this.getActive())==null?void 0:t.shouldGetKeyboardEvents())||l(this,te).size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(t){return l(this,Fs)===t}getActive(){return l(this,Fs)}getMode(){return l(this,Ve)}get imageManager(){return Bt(this,"imageManager",new Wp)}getSelectionBoxes(t){if(!t)return null;const e=document.getSelection();for(let u=0,h=e.rangeCount;u<h;u++)if(!t.contains(e.getRangeAt(u).commonAncestorContainer))return null;const{x:s,y:n,width:r,height:o}=t.getBoundingClientRect();let a;switch(t.getAttribute("data-main-rotation")){case"90":a=(u,h,d,f)=>({x:(h-n)/o,y:1-(u+d-s)/r,width:f/o,height:d/r});break;case"180":a=(u,h,d,f)=>({x:1-(u+d-s)/r,y:1-(h+f-n)/o,width:d/r,height:f/o});break;case"270":a=(u,h,d,f)=>({x:1-(h+f-n)/o,y:(u-s)/r,width:f/o,height:d/r});break;default:a=(u,h,d,f)=>({x:(u-s)/r,y:(h-n)/o,width:d/r,height:f/o});break}const c=[];for(let u=0,h=e.rangeCount;u<h;u++){const d=e.getRangeAt(u);if(!d.collapsed)for(const{x:f,y:p,width:m,height:v}of d.getClientRects())m===0||v===0||c.push(a(f,p,m,v))}return c.length===0?null:c}addChangedExistingAnnotation({annotationElementId:t,id:e}){(l(this,al)||g(this,al,new Map)).set(t,e)}removeChangedExistingAnnotation({annotationElementId:t}){var e;(e=l(this,al))==null||e.delete(t)}renderAnnotationElement(t){var n;const e=(n=l(this,al))==null?void 0:n.get(t.data.id);if(!e)return;const s=l(this,Tn).getRawValue(e);s&&(l(this,Ve)===Lt.NONE&&!s.hasBeenModified||s.renderAnnotationElement(t))}};rl=new WeakMap,Fs=new WeakMap,$e=new WeakMap,Ke=new WeakMap,ol=new WeakMap,Tn=new WeakMap,al=new WeakMap,ni=new WeakMap,xr=new WeakMap,Co=new WeakMap,ll=new WeakMap,Eo=new WeakMap,Ji=new WeakMap,Ai=new WeakMap,ko=new WeakMap,mu=new WeakMap,vu=new WeakMap,cl=new WeakMap,bu=new WeakMap,Qi=new WeakMap,Cr=new WeakMap,ul=new WeakMap,Er=new WeakMap,Zi=new WeakMap,of=new WeakMap,kr=new WeakMap,yu=new WeakMap,Tr=new WeakMap,To=new WeakMap,wu=new WeakMap,_u=new WeakMap,Ve=new WeakMap,te=new WeakMap,Pn=new WeakMap,Po=new WeakMap,Au=new WeakMap,Su=new WeakMap,Pr=new WeakMap,tn=new WeakMap,Rn=new WeakMap,xu=new WeakMap,ri=new WeakMap,at=new WeakSet,dd=function({anchorNode:t}){return t.nodeType===Node.TEXT_NODE?t.parentElement:t},Xp=function(t){const{currentLayer:e}=this;if(e.hasTextLayer(t))return e;for(const s of l(this,Ke).values())if(s.hasTextLayer(t))return s;return null},by=function(){const t=document.getSelection();if(!t||t.isCollapsed)return;const s=w(this,at,dd).call(this,t).closest(".textLayer"),n=this.getSelectionBoxes(s);n&&(l(this,Zi)||g(this,Zi,new qC(this)),l(this,Zi).show(s,n,this.direction==="ltr"))},yy=function(){var r,o,a;const t=document.getSelection();if(!t||t.isCollapsed){l(this,Pn)&&((r=l(this,Zi))==null||r.hide(),g(this,Pn,null),w(this,at,bs).call(this,{hasSelectedText:!1}));return}const{anchorNode:e}=t;if(e===l(this,Pn))return;const n=w(this,at,dd).call(this,t).closest(".textLayer");if(!n){l(this,Pn)&&((o=l(this,Zi))==null||o.hide(),g(this,Pn,null),w(this,at,bs).call(this,{hasSelectedText:!1}));return}if((a=l(this,Zi))==null||a.hide(),g(this,Pn,e),w(this,at,bs).call(this,{hasSelectedText:!0}),!(l(this,Ve)!==Lt.HIGHLIGHT&&l(this,Ve)!==Lt.NONE)&&(l(this,Ve)===Lt.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),g(this,Er,this.isShiftKeyDown),!this.isShiftKeyDown)){const c=l(this,Ve)===Lt.HIGHLIGHT?w(this,at,Xp).call(this,n):null;c==null||c.toggleDrawing();const u=new AbortController,h=this.combinedSignal(u),d=f=>{f.type==="pointerup"&&f.button!==0||(u.abort(),c==null||c.toggleDrawing(!0),f.type==="pointerup"&&w(this,at,fd).call(this,"main_toolbar"))};window.addEventListener("pointerup",d,{signal:h}),window.addEventListener("blur",d,{signal:h})}},fd=function(t=""){l(this,Ve)===Lt.HIGHLIGHT?this.highlightSelection(t):l(this,mu)&&w(this,at,by).call(this)},wy=function(){document.addEventListener("selectionchange",w(this,at,yy).bind(this),{signal:this._signal})},_y=function(){if(l(this,Cr))return;g(this,Cr,new AbortController);const t=this.combinedSignal(l(this,Cr));window.addEventListener("focus",this.focus.bind(this),{signal:t}),window.addEventListener("blur",this.blur.bind(this),{signal:t})},Ay=function(){var t;(t=l(this,Cr))==null||t.abort(),g(this,Cr,null)},Kp=function(){if(l(this,Tr))return;g(this,Tr,new AbortController);const t=this.combinedSignal(l(this,Tr));window.addEventListener("keydown",this.keydown.bind(this),{signal:t}),window.addEventListener("keyup",this.keyup.bind(this),{signal:t})},Sy=function(){var t;(t=l(this,Tr))==null||t.abort(),g(this,Tr,null)},Yp=function(){if(l(this,xr))return;g(this,xr,new AbortController);const t=this.combinedSignal(l(this,xr));document.addEventListener("copy",this.copy.bind(this),{signal:t}),document.addEventListener("cut",this.cut.bind(this),{signal:t}),document.addEventListener("paste",this.paste.bind(this),{signal:t})},Jp=function(){var t;(t=l(this,xr))==null||t.abort(),g(this,xr,null)},xy=function(){const t=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:t}),document.addEventListener("drop",this.drop.bind(this),{signal:t})},bs=function(t){Object.entries(t).some(([s,n])=>l(this,Su)[s]!==n)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(l(this,Su),t)}),l(this,Ve)===Lt.HIGHLIGHT&&t.hasSelectedEditor===!1&&w(this,at,An).call(this,[[Ut.HIGHLIGHT_FREE,!0]]))},An=function(t){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:t})},Cy=async function(){if(!l(this,kr)){g(this,kr,!0);const t=[];for(const e of l(this,Ke).values())t.push(e.enable());await Promise.all(t);for(const e of l(this,$e).values())e.enable()}},Ey=function(){if(this.unselectAll(),l(this,kr)){g(this,kr,!1);for(const t of l(this,Ke).values())t.disable();for(const t of l(this,$e).values())t.disable()}},Qp=function(t){const e=l(this,Ke).get(t.pageIndex);e?e.addOrRebuild(t):(this.addEditor(t),this.addToAnnotationStorage(t))},ky=function(){let t=null;for(t of l(this,te));return t},Ec=function(){if(l(this,$e).size===0)return!0;if(l(this,$e).size===1)for(const t of l(this,$e).values())return t.isEmpty();return!1},Zp=function(t){for(const e of l(this,te))e.unselect();l(this,te).clear();for(const e of t)e.isEmpty()||(l(this,te).add(e),e.select());w(this,at,bs).call(this,{hasSelectedEditor:this.hasSelection})},pt(Ka,"TRANSLATE_SMALL",1),pt(Ka,"TRANSLATE_BIG",10);let Ma=Ka;var Ue,en,Si,hl,sn,$s,dl,nn,Ls,Mn,Ro,rn,Rr,Di,kc,pd;const ys=class ys{constructor(t){y(this,Di);y(this,Ue,null);y(this,en,!1);y(this,Si,null);y(this,hl,null);y(this,sn,null);y(this,$s,null);y(this,dl,!1);y(this,nn,null);y(this,Ls,null);y(this,Mn,null);y(this,Ro,null);y(this,rn,!1);g(this,Ls,t),g(this,rn,t._uiManager.useNewAltTextFlow),l(ys,Rr)||g(ys,Rr,Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"}))}static initialize(t){ys._l10n??(ys._l10n=t)}async render(){const t=g(this,Si,document.createElement("button"));t.className="altText",t.tabIndex="0";const e=g(this,hl,document.createElement("span"));t.append(e),l(this,rn)?(t.classList.add("new"),t.setAttribute("data-l10n-id",l(ys,Rr).missing),e.setAttribute("data-l10n-id",l(ys,Rr)["missing-label"])):(t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const s=l(this,Ls)._uiManager._signal;t.addEventListener("contextmenu",Vi,{signal:s}),t.addEventListener("pointerdown",r=>r.stopPropagation(),{signal:s});const n=r=>{r.preventDefault(),l(this,Ls)._uiManager.editAltText(l(this,Ls)),l(this,rn)&&l(this,Ls)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:l(this,Di,kc)}})};return t.addEventListener("click",n,{capture:!0,signal:s}),t.addEventListener("keydown",r=>{r.target===t&&r.key==="Enter"&&(g(this,dl,!0),n(r))},{signal:s}),await w(this,Di,pd).call(this),t}finish(){l(this,Si)&&(l(this,Si).focus({focusVisible:l(this,dl)}),g(this,dl,!1))}isEmpty(){return l(this,rn)?l(this,Ue)===null:!l(this,Ue)&&!l(this,en)}hasData(){return l(this,rn)?l(this,Ue)!==null||!!l(this,Mn):this.isEmpty()}get guessedText(){return l(this,Mn)}async setGuessedText(t){l(this,Ue)===null&&(g(this,Mn,t),g(this,Ro,await ys._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:t})),w(this,Di,pd).call(this))}toggleAltTextBadge(t=!1){var e;if(!l(this,rn)||l(this,Ue)){(e=l(this,nn))==null||e.remove(),g(this,nn,null);return}if(!l(this,nn)){const s=g(this,nn,document.createElement("div"));s.className="noAltTextBadge",l(this,Ls).div.append(s)}l(this,nn).classList.toggle("hidden",!t)}serialize(t){let e=l(this,Ue);return!t&&l(this,Mn)===e&&(e=l(this,Ro)),{altText:e,decorative:l(this,en),guessedText:l(this,Mn),textWithDisclaimer:l(this,Ro)}}get data(){return{altText:l(this,Ue),decorative:l(this,en)}}set data({altText:t,decorative:e,guessedText:s,textWithDisclaimer:n,cancel:r=!1}){s&&(g(this,Mn,s),g(this,Ro,n)),!(l(this,Ue)===t&&l(this,en)===e)&&(r||(g(this,Ue,t),g(this,en,e)),w(this,Di,pd).call(this))}toggle(t=!1){l(this,Si)&&(!t&&l(this,$s)&&(clearTimeout(l(this,$s)),g(this,$s,null)),l(this,Si).disabled=!t)}shown(){l(this,Ls)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:l(this,Di,kc)}})}destroy(){var t,e;(t=l(this,Si))==null||t.remove(),g(this,Si,null),g(this,hl,null),g(this,sn,null),(e=l(this,nn))==null||e.remove(),g(this,nn,null)}};Ue=new WeakMap,en=new WeakMap,Si=new WeakMap,hl=new WeakMap,sn=new WeakMap,$s=new WeakMap,dl=new WeakMap,nn=new WeakMap,Ls=new WeakMap,Mn=new WeakMap,Ro=new WeakMap,rn=new WeakMap,Rr=new WeakMap,Di=new WeakSet,kc=function(){return l(this,Ue)&&"added"||l(this,Ue)===null&&this.guessedText&&"review"||"missing"},pd=async function(){var n,r,o;const t=l(this,Si);if(!t)return;if(l(this,rn)){if(t.classList.toggle("done",!!l(this,Ue)),t.setAttribute("data-l10n-id",l(ys,Rr)[l(this,Di,kc)]),(n=l(this,hl))==null||n.setAttribute("data-l10n-id",l(ys,Rr)[`${l(this,Di,kc)}-label`]),!l(this,Ue)){(r=l(this,sn))==null||r.remove();return}}else{if(!l(this,Ue)&&!l(this,en)){t.classList.remove("done"),(o=l(this,sn))==null||o.remove();return}t.classList.add("done"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let e=l(this,sn);if(!e){g(this,sn,e=document.createElement("span")),e.className="tooltip",e.setAttribute("role","tooltip"),e.id=`alt-text-tooltip-${l(this,Ls).id}`;const a=100,c=l(this,Ls)._uiManager._signal;c.addEventListener("abort",()=>{clearTimeout(l(this,$s)),g(this,$s,null)},{once:!0}),t.addEventListener("mouseenter",()=>{g(this,$s,setTimeout(()=>{g(this,$s,null),l(this,sn).classList.add("show"),l(this,Ls)._reportTelemetry({action:"alt_text_tooltip"})},a))},{signal:c}),t.addEventListener("mouseleave",()=>{var u;l(this,$s)&&(clearTimeout(l(this,$s)),g(this,$s,null)),(u=l(this,sn))==null||u.classList.remove("show")},{signal:c})}l(this,en)?e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(e.removeAttribute("data-l10n-id"),e.textContent=l(this,Ue)),e.parentNode||t.append(e);const s=l(this,Ls).getImageForAltText();s==null||s.setAttribute("aria-describedby",e.id)},y(ys,Rr,null),pt(ys,"_l10n",null);let Kd=ys;var Cu,Mo,Eu,ku,Tu,Pu,Ru,fl,In,Io,Mr,cr,Ty,Py,tg;const Om=class Om{constructor({container:t,isPinchingDisabled:e=null,isPinchingStopped:s=null,onPinchStart:n=null,onPinching:r=null,onPinchEnd:o=null,signal:a}){y(this,cr);y(this,Cu);y(this,Mo,!1);y(this,Eu,null);y(this,ku);y(this,Tu);y(this,Pu);y(this,Ru);y(this,fl);y(this,In,null);y(this,Io);y(this,Mr,null);g(this,Cu,t),g(this,Eu,s),g(this,ku,e),g(this,Tu,n),g(this,Pu,r),g(this,Ru,o),g(this,Io,new AbortController),g(this,fl,AbortSignal.any([a,l(this,Io).signal])),t.addEventListener("touchstart",w(this,cr,Ty).bind(this),{passive:!1,signal:l(this,fl)})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return Bt(this,"MIN_TOUCH_DISTANCE_TO_PINCH",35/(window.devicePixelRatio||1))}destroy(){var t;(t=l(this,Io))==null||t.abort(),g(this,Io,null)}};Cu=new WeakMap,Mo=new WeakMap,Eu=new WeakMap,ku=new WeakMap,Tu=new WeakMap,Pu=new WeakMap,Ru=new WeakMap,fl=new WeakMap,In=new WeakMap,Io=new WeakMap,Mr=new WeakMap,cr=new WeakSet,Ty=function(t){var n,r,o;if((n=l(this,ku))!=null&&n.call(this)||t.touches.length<2)return;if(!l(this,Mr)){g(this,Mr,new AbortController);const a=AbortSignal.any([l(this,fl),l(this,Mr).signal]),c=l(this,Cu),u={signal:a,passive:!1};c.addEventListener("touchmove",w(this,cr,Py).bind(this),u),c.addEventListener("touchend",w(this,cr,tg).bind(this),u),c.addEventListener("touchcancel",w(this,cr,tg).bind(this),u),(r=l(this,Tu))==null||r.call(this)}if(Qs(t),t.touches.length!==2||(o=l(this,Eu))!=null&&o.call(this)){g(this,In,null);return}let[e,s]=t.touches;e.identifier>s.identifier&&([e,s]=[s,e]),g(this,In,{touch0X:e.screenX,touch0Y:e.screenY,touch1X:s.screenX,touch1Y:s.screenY})},Py=function(t){var C;if(!l(this,In)||t.touches.length!==2)return;let[e,s]=t.touches;e.identifier>s.identifier&&([e,s]=[s,e]);const{screenX:n,screenY:r}=e,{screenX:o,screenY:a}=s,c=l(this,In),{touch0X:u,touch0Y:h,touch1X:d,touch1Y:f}=c,p=d-u,m=f-h,v=o-n,_=a-r,b=Math.hypot(v,_)||1,A=Math.hypot(p,m)||1;if(!l(this,Mo)&&Math.abs(A-b)<=Om.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(c.touch0X=n,c.touch0Y=r,c.touch1X=o,c.touch1Y=a,t.preventDefault(),!l(this,Mo)){g(this,Mo,!0);return}const x=[(n+o)/2,(r+a)/2];(C=l(this,Pu))==null||C.call(this,x,A,b)},tg=function(t){var e;l(this,Mr).abort(),g(this,Mr,null),(e=l(this,Ru))==null||e.call(this),l(this,In)&&(t.preventDefault(),g(this,In,null),g(this,Mo,!1))};let Yd=Om;var Lo,xi,ue,pl,Ir,Mu,Do,Ye,Oo,Ln,Lr,Iu,No,Bs,Lu,Fo,Dn,on,gl,ml,oi,$o,Du,af,xt,eg,Ou,sg,gd,Ry,My,ig,md,ng,Iy,Ly,Dy,rg,Oy,og,Ny,Fy,$y,ag,Tc;const Ot=class Ot{constructor(t){y(this,xt);y(this,Lo,null);y(this,xi,null);y(this,ue,null);y(this,pl,!1);y(this,Ir,null);y(this,Mu,"");y(this,Do,!1);y(this,Ye,null);y(this,Oo,null);y(this,Ln,null);y(this,Lr,null);y(this,Iu,"");y(this,No,!1);y(this,Bs,null);y(this,Lu,!1);y(this,Fo,!1);y(this,Dn,!1);y(this,on,null);y(this,gl,0);y(this,ml,0);y(this,oi,null);y(this,$o,null);pt(this,"_editToolbar",null);pt(this,"_initialOptions",Object.create(null));pt(this,"_initialData",null);pt(this,"_isVisible",!0);pt(this,"_uiManager",null);pt(this,"_focusEventsAllowed",!0);y(this,Du,!1);y(this,af,Ot._zIndex++);this.parent=t.parent,this.id=t.id,this.width=this.height=null,this.pageIndex=t.parent.pageIndex,this.name=t.name,this.div=null,this._uiManager=t.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=t.isCentered,this._structTreeParentId=null;const{rotation:e,rawDims:{pageWidth:s,pageHeight:n,pageX:r,pageY:o}}=this.parent.viewport;this.rotation=e,this.pageRotation=(360+e-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[s,n],this.pageTranslation=[r,o];const[a,c]=this.parentDimensions;this.x=t.x/a,this.y=t.y/c,this.isAttachedToDOM=!1,this.deleted=!1}static get _resizerKeyboardManager(){const t=Ot.prototype._resizeWithKeyboard,e=Ma.TRANSLATE_SMALL,s=Ma.TRANSLATE_BIG;return Bt(this,"_resizerKeyboardManager",new Vh([[["ArrowLeft","mac+ArrowLeft"],t,{args:[-e,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t,{args:[-s,0]}],[["ArrowRight","mac+ArrowRight"],t,{args:[e,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t,{args:[s,0]}],[["ArrowUp","mac+ArrowUp"],t,{args:[0,-e]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t,{args:[0,-s]}],[["ArrowDown","mac+ArrowDown"],t,{args:[0,e]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t,{args:[0,s]}],[["Escape","mac+Escape"],Ot.prototype._stopResizingWithKeyboard]]))}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get isDrawer(){return!1}static get _defaultLineColor(){return Bt(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(t){const e=new YC({id:t.parent.getNextId(),parent:t.parent,uiManager:t._uiManager});e.annotationElementId=t.annotationElementId,e.deleted=!0,e._uiManager.addToAnnotationStorage(e)}static initialize(t,e){if(Ot._l10n??(Ot._l10n=t),Ot._l10nResizer||(Ot._l10nResizer=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"})),Ot._borderLineWidth!==-1)return;const s=getComputedStyle(document.documentElement);Ot._borderLineWidth=parseFloat(s.getPropertyValue("--outline-width"))||0}static updateDefaultParams(t,e){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(t){return!1}static paste(t,e){ae("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return l(this,Du)}set _isDraggable(t){var e;g(this,Du,t),(e=this.div)==null||e.classList.toggle("draggable",t)}get isEnterHandled(){return!0}center(){const[t,e]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*e/(t*2),this.y+=this.width*t/(e*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*e/(t*2),this.y-=this.width*t/(e*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(t){this._uiManager.addCommands(t)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=l(this,af)}setParent(t){t!==null?(this.pageIndex=t.pageIndex,this.pageDimensions=t.pageDimensions):w(this,xt,Tc).call(this),this.parent=t}focusin(t){this._focusEventsAllowed&&(l(this,No)?g(this,No,!1):this.parent.setSelected(this))}focusout(t){var s;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const e=t.relatedTarget;e!=null&&e.closest(`#${this.id}`)||(t.preventDefault(),(s=this.parent)!=null&&s.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(t,e,s,n){const[r,o]=this.parentDimensions;[s,n]=this.screenToPageTranslation(s,n),this.x=(t+s)/r,this.y=(e+n)/o,this.fixAndSetPosition()}translate(t,e){w(this,xt,eg).call(this,this.parentDimensions,t,e)}translateInPage(t,e){l(this,Bs)||g(this,Bs,[this.x,this.y,this.width,this.height]),w(this,xt,eg).call(this,this.pageDimensions,t,e),this.div.scrollIntoView({block:"nearest"})}drag(t,e){l(this,Bs)||g(this,Bs,[this.x,this.y,this.width,this.height]);const{div:s,parentDimensions:[n,r]}=this;if(this.x+=t/n,this.y+=e/r,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:d,y:f}=this.div.getBoundingClientRect();this.parent.findNewParent(this,d,f)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:o,y:a}=this;const[c,u]=this.getBaseTranslation();o+=c,a+=u;const{style:h}=s;h.left=`${(100*o).toFixed(2)}%`,h.top=`${(100*a).toFixed(2)}%`,this._onTranslating(o,a),s.scrollIntoView({block:"nearest"})}_onTranslating(t,e){}_onTranslated(t,e){}get _hasBeenMoved(){return!!l(this,Bs)&&(l(this,Bs)[0]!==this.x||l(this,Bs)[1]!==this.y)}get _hasBeenResized(){return!!l(this,Bs)&&(l(this,Bs)[2]!==this.width||l(this,Bs)[3]!==this.height)}getBaseTranslation(){const[t,e]=this.parentDimensions,{_borderLineWidth:s}=Ot,n=s/t,r=s/e;switch(this.rotation){case 90:return[-n,r];case 180:return[n,r];case 270:return[n,-r];default:return[-n,-r]}}get _mustFixPosition(){return!0}fixAndSetPosition(t=this.rotation){const{div:{style:e},pageDimensions:[s,n]}=this;let{x:r,y:o,width:a,height:c}=this;if(a*=s,c*=n,r*=s,o*=n,this._mustFixPosition)switch(t){case 0:r=Math.max(0,Math.min(s-a,r)),o=Math.max(0,Math.min(n-c,o));break;case 90:r=Math.max(0,Math.min(s-c,r)),o=Math.min(n,Math.max(a,o));break;case 180:r=Math.min(s,Math.max(a,r)),o=Math.min(n,Math.max(c,o));break;case 270:r=Math.min(s,Math.max(c,r)),o=Math.max(0,Math.min(n-a,o));break}this.x=r/=s,this.y=o/=n;const[u,h]=this.getBaseTranslation();r+=u,o+=h,e.left=`${(100*r).toFixed(2)}%`,e.top=`${(100*o).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(t,e){var s;return w(s=Ot,Ou,sg).call(s,t,e,this.parentRotation)}pageTranslationToScreen(t,e){var s;return w(s=Ot,Ou,sg).call(s,t,e,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:t,pageDimensions:[e,s]}=this;return[e*t,s*t]}setDims(t,e){const[s,n]=this.parentDimensions,{style:r}=this.div;r.width=`${(100*t/s).toFixed(2)}%`,l(this,Do)||(r.height=`${(100*e/n).toFixed(2)}%`)}fixDims(){const{style:t}=this.div,{height:e,width:s}=t,n=s.endsWith("%"),r=!l(this,Do)&&e.endsWith("%");if(n&&r)return;const[o,a]=this.parentDimensions;n||(t.width=`${(100*parseFloat(s)/o).toFixed(2)}%`),!l(this,Do)&&!r&&(t.height=`${(100*parseFloat(e)/a).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}_onResized(){}static _round(t){return Math.round(t*1e4)/1e4}_onResizing(){}altTextFinish(){var t;(t=l(this,ue))==null||t.finish()}async addEditToolbar(){return this._editToolbar||l(this,Fo)?this._editToolbar:(this._editToolbar=new Gp(this),this.div.append(this._editToolbar.render()),l(this,ue)&&await this._editToolbar.addAltText(l(this,ue)),this._editToolbar)}removeEditToolbar(){var t;this._editToolbar&&(this._editToolbar.remove(),this._editToolbar=null,(t=l(this,ue))==null||t.destroy())}addContainer(t){var s;const e=(s=this._editToolbar)==null?void 0:s.div;e?e.before(t):this.div.append(t)}getClientDimensions(){return this.div.getBoundingClientRect()}async addAltTextButton(){l(this,ue)||(Kd.initialize(Ot._l10n),g(this,ue,new Kd(this)),l(this,Lo)&&(l(this,ue).data=l(this,Lo),g(this,Lo,null)),await this.addEditToolbar())}get altTextData(){var t;return(t=l(this,ue))==null?void 0:t.data}set altTextData(t){l(this,ue)&&(l(this,ue).data=t)}get guessedAltText(){var t;return(t=l(this,ue))==null?void 0:t.guessedText}async setGuessedAltText(t){var e;await((e=l(this,ue))==null?void 0:e.setGuessedText(t))}serializeAltText(t){var e;return(e=l(this,ue))==null?void 0:e.serialize(t)}hasAltText(){return!!l(this,ue)&&!l(this,ue).isEmpty()}hasAltTextData(){var t;return((t=l(this,ue))==null?void 0:t.hasData())??!1}render(){var r;this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.tabIndex=l(this,pl)?-1:0,this._isVisible||this.div.classList.add("hidden"),this.setInForeground(),w(this,xt,og).call(this);const[t,e]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*e/t).toFixed(2)}%`,this.div.style.maxHeight=`${(100*t/e).toFixed(2)}%`);const[s,n]=this.getInitialTranslation();return this.translate(s,n),Xd(this,this.div,["pointerdown"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(l(this,$o)||g(this,$o,new Yd({container:this.div,isPinchingDisabled:()=>!this.isSelected,onPinchStart:w(this,xt,Iy).bind(this),onPinching:w(this,xt,Ly).bind(this),onPinchEnd:w(this,xt,Dy).bind(this),signal:this._uiManager._signal}))),(r=this._uiManager._editorUndoBar)==null||r.hide(),this.div}pointerdown(t){const{isMac:e}=Es.platform;if(t.button!==0||t.ctrlKey&&e){t.preventDefault();return}if(g(this,No,!0),this._isDraggable){w(this,xt,Oy).call(this,t);return}w(this,xt,rg).call(this,t)}get isSelected(){return this._uiManager.isSelected(this)}_onStartDragging(){}_onStopDragging(){}moveInDOM(){l(this,on)&&clearTimeout(l(this,on)),g(this,on,setTimeout(()=>{var t;g(this,on,null),(t=this.parent)==null||t.moveEditorInDOM(this)},0))}_setParentAndPosition(t,e,s){t.changeParent(this),this.x=e,this.y=s,this.fixAndSetPosition(),this._onTranslated()}getRect(t,e,s=this.rotation){const n=this.parentScale,[r,o]=this.pageDimensions,[a,c]=this.pageTranslation,u=t/n,h=e/n,d=this.x*r,f=this.y*o,p=this.width*r,m=this.height*o;switch(s){case 0:return[d+u+a,o-f-h-m+c,d+u+p+a,o-f-h+c];case 90:return[d+h+a,o-f+u+c,d+h+m+a,o-f+u+p+c];case 180:return[d-u-p+a,o-f+h+c,d-u+a,o-f+h+m+c];case 270:return[d-h-m+a,o-f-u-p+c,d-h+a,o-f-u+c];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(t,e){const[s,n,r,o]=t,a=r-s,c=o-n;switch(this.rotation){case 0:return[s,e-o,a,c];case 90:return[s,e-n,c,a];case 180:return[r,e-n,a,c];case 270:return[r,e-o,c,a];default:throw new Error("Invalid rotation")}}onceAdded(t){}isEmpty(){return!1}enableEditMode(){g(this,Fo,!0)}disableEditMode(){g(this,Fo,!1)}isInEditMode(){return l(this,Fo)}shouldGetKeyboardEvents(){return l(this,Dn)}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:t,left:e,bottom:s,right:n}=this.getClientDimensions(),{innerHeight:r,innerWidth:o}=window;return e<o&&n>0&&t<r&&s>0}rebuild(){w(this,xt,og).call(this)}rotate(t){}resize(){}serializeDeleted(){var t;return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:((t=this._initialData)==null?void 0:t.popupRef)||""}}serialize(t=!1,e=null){ae("An editor must be serializable")}static async deserialize(t,e,s){const n=new this.prototype.constructor({parent:e,id:e.getNextId(),uiManager:s});n.rotation=t.rotation,g(n,Lo,t.accessibilityData);const[r,o]=n.pageDimensions,[a,c,u,h]=n.getRectInCurrentCoords(t.rect,o);return n.x=a/r,n.y=c/o,n.width=u/r,n.height=h/o,n}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){var t,e;if((t=l(this,Lr))==null||t.abort(),g(this,Lr,null),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),l(this,on)&&(clearTimeout(l(this,on)),g(this,on,null)),w(this,xt,Tc).call(this),this.removeEditToolbar(),l(this,oi)){for(const s of l(this,oi).values())clearTimeout(s);g(this,oi,null)}this.parent=null,(e=l(this,$o))==null||e.destroy(),g(this,$o,null)}get isResizable(){return!1}makeResizable(){this.isResizable&&(w(this,xt,Ry).call(this),l(this,Ye).classList.remove("hidden"),Xd(this,this.div,["keydown"]))}get toolbarPosition(){return null}keydown(t){if(!this.isResizable||t.target!==this.div||t.key!=="Enter")return;this._uiManager.setSelected(this),g(this,Ln,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const e=l(this,Ye).children;if(!l(this,xi)){g(this,xi,Array.from(e));const o=w(this,xt,Ny).bind(this),a=w(this,xt,Fy).bind(this),c=this._uiManager._signal;for(const u of l(this,xi)){const h=u.getAttribute("data-resizer-name");u.setAttribute("role","spinbutton"),u.addEventListener("keydown",o,{signal:c}),u.addEventListener("blur",a,{signal:c}),u.addEventListener("focus",w(this,xt,$y).bind(this,h),{signal:c}),u.setAttribute("data-l10n-id",Ot._l10nResizer[h])}}const s=l(this,xi)[0];let n=0;for(const o of e){if(o===s)break;n++}const r=(360-this.rotation+this.parentRotation)%360/90*(l(this,xi).length/4);if(r!==n){if(r<n)for(let a=0;a<n-r;a++)l(this,Ye).append(l(this,Ye).firstChild);else if(r>n)for(let a=0;a<r-n;a++)l(this,Ye).firstChild.before(l(this,Ye).lastChild);let o=0;for(const a of e){const u=l(this,xi)[o++].getAttribute("data-resizer-name");a.setAttribute("data-l10n-id",Ot._l10nResizer[u])}}w(this,xt,ag).call(this,0),g(this,Dn,!0),l(this,Ye).firstChild.focus({focusVisible:!0}),t.preventDefault(),t.stopImmediatePropagation()}_resizeWithKeyboard(t,e){l(this,Dn)&&w(this,xt,ng).call(this,l(this,Iu),{deltaX:t,deltaY:e,fromKeyboard:!0})}_stopResizingWithKeyboard(){w(this,xt,Tc).call(this),this.div.focus()}select(){var t,e,s;if(this.makeResizable(),(t=this.div)==null||t.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{var n,r;(n=this.div)!=null&&n.classList.contains("selectedEditor")&&((r=this._editToolbar)==null||r.show())});return}(e=this._editToolbar)==null||e.show(),(s=l(this,ue))==null||s.toggleAltTextBadge(!1)}unselect(){var t,e,s,n,r;(t=l(this,Ye))==null||t.classList.add("hidden"),(e=this.div)==null||e.classList.remove("selectedEditor"),(s=this.div)!=null&&s.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),(n=this._editToolbar)==null||n.hide(),(r=l(this,ue))==null||r.toggleAltTextBadge(!0)}updateParams(t,e){}disableEditing(){}enableEditing(){}enterInEditMode(){}getImageForAltText(){return null}get contentDiv(){return this.div}get isEditing(){return l(this,Lu)}set isEditing(t){g(this,Lu,t),this.parent&&(t?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(t,e){g(this,Do,!0);const s=t/e,{style:n}=this.div;n.aspectRatio=s,n.height="auto"}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(t,e=!1){if(e){l(this,oi)||g(this,oi,new Map);const{action:s}=t;let n=l(this,oi).get(s);n&&clearTimeout(n),n=setTimeout(()=>{this._reportTelemetry(t),l(this,oi).delete(s),l(this,oi).size===0&&g(this,oi,null)},Ot._telemetryTimeout),l(this,oi).set(s,n);return}t.type||(t.type=this.editorType),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:t}})}show(t=this._isVisible){this.div.classList.toggle("hidden",!t),this._isVisible=t}enable(){this.div&&(this.div.tabIndex=0),g(this,pl,!1)}disable(){this.div&&(this.div.tabIndex=-1),g(this,pl,!0)}renderAnnotationElement(t){let e=t.container.querySelector(".annotationContent");if(!e)e=document.createElement("div"),e.classList.add("annotationContent",this.editorType),t.container.prepend(e);else if(e.nodeName==="CANVAS"){const s=e;e=document.createElement("div"),e.classList.add("annotationContent",this.editorType),s.before(e)}return e}resetAnnotationElement(t){const{firstChild:e}=t.container;(e==null?void 0:e.nodeName)==="DIV"&&e.classList.contains("annotationContent")&&e.remove()}};Lo=new WeakMap,xi=new WeakMap,ue=new WeakMap,pl=new WeakMap,Ir=new WeakMap,Mu=new WeakMap,Do=new WeakMap,Ye=new WeakMap,Oo=new WeakMap,Ln=new WeakMap,Lr=new WeakMap,Iu=new WeakMap,No=new WeakMap,Bs=new WeakMap,Lu=new WeakMap,Fo=new WeakMap,Dn=new WeakMap,on=new WeakMap,gl=new WeakMap,ml=new WeakMap,oi=new WeakMap,$o=new WeakMap,Du=new WeakMap,af=new WeakMap,xt=new WeakSet,eg=function([t,e],s,n){[s,n]=this.screenToPageTranslation(s,n),this.x+=s/t,this.y+=n/e,this._onTranslating(this.x,this.y),this.fixAndSetPosition()},Ou=new WeakSet,sg=function(t,e,s){switch(s){case 90:return[e,-t];case 180:return[-t,-e];case 270:return[-e,t];default:return[t,e]}},gd=function(t){switch(t){case 90:{const[e,s]=this.pageDimensions;return[0,-e/s,s/e,0]}case 180:return[-1,0,0,-1];case 270:{const[e,s]=this.pageDimensions;return[0,e/s,-s/e,0]}default:return[1,0,0,1]}},Ry=function(){if(l(this,Ye))return;g(this,Ye,document.createElement("div")),l(this,Ye).classList.add("resizers");const t=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],e=this._uiManager._signal;for(const s of t){const n=document.createElement("div");l(this,Ye).append(n),n.classList.add("resizer",s),n.setAttribute("data-resizer-name",s),n.addEventListener("pointerdown",w(this,xt,My).bind(this,s),{signal:e}),n.addEventListener("contextmenu",Vi,{signal:e}),n.tabIndex=-1}this.div.prepend(l(this,Ye))},My=function(t,e){var h;e.preventDefault();const{isMac:s}=Es.platform;if(e.button!==0||e.ctrlKey&&s)return;(h=l(this,ue))==null||h.toggle(!1);const n=this._isDraggable;this._isDraggable=!1,g(this,Oo,[e.screenX,e.screenY]);const r=new AbortController,o=this._uiManager.combinedSignal(r);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",w(this,xt,ng).bind(this,t),{passive:!0,capture:!0,signal:o}),window.addEventListener("touchmove",Qs,{passive:!1,signal:o}),window.addEventListener("contextmenu",Vi,{signal:o}),g(this,Ln,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const a=this.parent.div.style.cursor,c=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(e.target).cursor;const u=()=>{var d;r.abort(),this.parent.togglePointerEvents(!0),(d=l(this,ue))==null||d.toggle(!0),this._isDraggable=n,this.parent.div.style.cursor=a,this.div.style.cursor=c,w(this,xt,md).call(this)};window.addEventListener("pointerup",u,{signal:o}),window.addEventListener("blur",u,{signal:o})},ig=function(t,e,s,n){this.width=s,this.height=n,this.x=t,this.y=e;const[r,o]=this.parentDimensions;this.setDims(r*s,o*n),this.fixAndSetPosition(),this._onResized()},md=function(){if(!l(this,Ln))return;const{savedX:t,savedY:e,savedWidth:s,savedHeight:n}=l(this,Ln);g(this,Ln,null);const r=this.x,o=this.y,a=this.width,c=this.height;r===t&&o===e&&a===s&&c===n||this.addCommands({cmd:w(this,xt,ig).bind(this,r,o,a,c),undo:w(this,xt,ig).bind(this,t,e,s,n),mustExec:!0})},ng=function(t,e){const[s,n]=this.parentDimensions,r=this.x,o=this.y,a=this.width,c=this.height,u=Ot.MIN_SIZE/s,h=Ot.MIN_SIZE/n,d=w(this,xt,gd).call(this,this.rotation),f=(H,V)=>[d[0]*H+d[2]*V,d[1]*H+d[3]*V],p=w(this,xt,gd).call(this,360-this.rotation),m=(H,V)=>[p[0]*H+p[2]*V,p[1]*H+p[3]*V];let v,_,b=!1,A=!1;switch(t){case"topLeft":b=!0,v=(H,V)=>[0,0],_=(H,V)=>[H,V];break;case"topMiddle":v=(H,V)=>[H/2,0],_=(H,V)=>[H/2,V];break;case"topRight":b=!0,v=(H,V)=>[H,0],_=(H,V)=>[0,V];break;case"middleRight":A=!0,v=(H,V)=>[H,V/2],_=(H,V)=>[0,V/2];break;case"bottomRight":b=!0,v=(H,V)=>[H,V],_=(H,V)=>[0,0];break;case"bottomMiddle":v=(H,V)=>[H/2,V],_=(H,V)=>[H/2,0];break;case"bottomLeft":b=!0,v=(H,V)=>[0,V],_=(H,V)=>[H,0];break;case"middleLeft":A=!0,v=(H,V)=>[0,V/2],_=(H,V)=>[H,V/2];break}const x=v(a,c),C=_(a,c);let T=f(...C);const D=Ot._round(r+T[0]),P=Ot._round(o+T[1]);let j=1,L=1,$,N;if(e.fromKeyboard)({deltaX:$,deltaY:N}=e);else{const{screenX:H,screenY:V}=e,[Z,St]=l(this,Oo);[$,N]=this.screenToPageTranslation(H-Z,V-St),l(this,Oo)[0]=H,l(this,Oo)[1]=V}if([$,N]=m($/s,N/n),b){const H=Math.hypot(a,c);j=L=Math.max(Math.min(Math.hypot(C[0]-x[0]-$,C[1]-x[1]-N)/H,1/a,1/c),u/a,h/c)}else A?j=Math.max(u,Math.min(1,Math.abs(C[0]-x[0]-$)))/a:L=Math.max(h,Math.min(1,Math.abs(C[1]-x[1]-N)))/c;const I=Ot._round(a*j),F=Ot._round(c*L);T=f(..._(I,F));const Q=D-T[0],J=P-T[1];l(this,Bs)||g(this,Bs,[this.x,this.y,this.width,this.height]),this.width=I,this.height=F,this.x=Q,this.y=J,this.setDims(s*I,n*F),this.fixAndSetPosition(),this._onResizing()},Iy=function(){var t;g(this,Ln,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height}),(t=l(this,ue))==null||t.toggle(!1),this.parent.togglePointerEvents(!1)},Ly=function(t,e,s){let r=.7*(s/e)+1-.7;if(r===1)return;const o=w(this,xt,gd).call(this,this.rotation),a=(D,P)=>[o[0]*D+o[2]*P,o[1]*D+o[3]*P],[c,u]=this.parentDimensions,h=this.x,d=this.y,f=this.width,p=this.height,m=Ot.MIN_SIZE/c,v=Ot.MIN_SIZE/u;r=Math.max(Math.min(r,1/f,1/p),m/f,v/p);const _=Ot._round(f*r),b=Ot._round(p*r);if(_===f&&b===p)return;l(this,Bs)||g(this,Bs,[h,d,f,p]);const A=a(f/2,p/2),x=Ot._round(h+A[0]),C=Ot._round(d+A[1]),T=a(_/2,b/2);this.x=x-T[0],this.y=C-T[1],this.width=_,this.height=b,this.setDims(c*_,u*b),this.fixAndSetPosition(),this._onResizing()},Dy=function(){var t;(t=l(this,ue))==null||t.toggle(!0),this.parent.togglePointerEvents(!0),w(this,xt,md).call(this)},rg=function(t){const{isMac:e}=Es.platform;t.ctrlKey&&!e||t.shiftKey||t.metaKey&&e?this.parent.toggleSelected(this):this.parent.setSelected(this)},Oy=function(t){const{isSelected:e}=this;this._uiManager.setUpDragSession();let s=!1;const n=new AbortController,r=this._uiManager.combinedSignal(n),o={capture:!0,passive:!1,signal:r},a=u=>{n.abort(),g(this,Ir,null),g(this,No,!1),this._uiManager.endDragSession()||w(this,xt,rg).call(this,u),s&&this._onStopDragging()};e&&(g(this,gl,t.clientX),g(this,ml,t.clientY),g(this,Ir,t.pointerId),g(this,Mu,t.pointerType),window.addEventListener("pointermove",u=>{s||(s=!0,this._onStartDragging());const{clientX:h,clientY:d,pointerId:f}=u;if(f!==l(this,Ir)){Qs(u);return}const[p,m]=this.screenToPageTranslation(h-l(this,gl),d-l(this,ml));g(this,gl,h),g(this,ml,d),this._uiManager.dragSelectedEditors(p,m)},o),window.addEventListener("touchmove",Qs,o),window.addEventListener("pointerdown",u=>{u.pointerType===l(this,Mu)&&(l(this,$o)||u.isPrimary)&&a(u),Qs(u)},o));const c=u=>{if(!l(this,Ir)||l(this,Ir)===u.pointerId){a(u);return}Qs(u)};window.addEventListener("pointerup",c,{signal:r}),window.addEventListener("blur",c,{signal:r})},og=function(){if(l(this,Lr)||!this.div)return;g(this,Lr,new AbortController);const t=this._uiManager.combinedSignal(l(this,Lr));this.div.addEventListener("focusin",this.focusin.bind(this),{signal:t}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:t})},Ny=function(t){Ot._resizerKeyboardManager.exec(this,t)},Fy=function(t){var e;l(this,Dn)&&((e=t.relatedTarget)==null?void 0:e.parentNode)!==l(this,Ye)&&w(this,xt,Tc).call(this)},$y=function(t){g(this,Iu,l(this,Dn)?t:"")},ag=function(t){if(l(this,xi))for(const e of l(this,xi))e.tabIndex=t},Tc=function(){g(this,Dn,!1),w(this,xt,ag).call(this,-1),w(this,xt,md).call(this)},y(Ot,Ou),pt(Ot,"_l10n",null),pt(Ot,"_l10nResizer",null),pt(Ot,"_borderLineWidth",-1),pt(Ot,"_colorManager",new qp),pt(Ot,"_zIndex",1),pt(Ot,"_telemetryTimeout",1e3);let ye=Ot;class YC extends ye{constructor(t){super(t),this.annotationElementId=t.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const ob=3285377520,ii=4294901760,qi=65535;class By{constructor(t){this.h1=t?t&4294967295:ob,this.h2=t?t&4294967295:ob}update(t){let e,s;if(typeof t=="string"){e=new Uint8Array(t.length*2),s=0;for(let v=0,_=t.length;v<_;v++){const b=t.charCodeAt(v);b<=255?e[s++]=b:(e[s++]=b>>>8,e[s++]=b&255)}}else if(ArrayBuffer.isView(t))e=t.slice(),s=e.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const n=s>>2,r=s-n*4,o=new Uint32Array(e.buffer,0,n);let a=0,c=0,u=this.h1,h=this.h2;const d=3432918353,f=461845907,p=d&qi,m=f&qi;for(let v=0;v<n;v++)v&1?(a=o[v],a=a*d&ii|a*p&qi,a=a<<15|a>>>17,a=a*f&ii|a*m&qi,u^=a,u=u<<13|u>>>19,u=u*5+3864292196):(c=o[v],c=c*d&ii|c*p&qi,c=c<<15|c>>>17,c=c*f&ii|c*m&qi,h^=c,h=h<<13|h>>>19,h=h*5+3864292196);switch(a=0,r){case 3:a^=e[n*4+2]<<16;case 2:a^=e[n*4+1]<<8;case 1:a^=e[n*4],a=a*d&ii|a*p&qi,a=a<<15|a>>>17,a=a*f&ii|a*m&qi,n&1?u^=a:h^=a}this.h1=u,this.h2=h}hexdigest(){let t=this.h1,e=this.h2;return t^=e>>>1,t=t*3981806797&ii|t*36045&qi,e=e*4283543511&ii|((e<<16|t>>>16)*2950163797&ii)>>>16,t^=e>>>1,t=t*444984403&ii|t*60499&qi,e=e*3301882366&ii|((e<<16|t>>>16)*3120437893&ii)>>>16,t^=e>>>1,(t>>>0).toString(16).padStart(8,"0")+(e>>>0).toString(16).padStart(8,"0")}}const lg=Object.freeze({map:null,hash:"",transfer:void 0});var Bo,Ho,Ge,lf,Hy;class Pm{constructor(){y(this,lf);y(this,Bo,!1);y(this,Ho,null);y(this,Ge,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(t,e){const s=l(this,Ge).get(t);return s===void 0?e:Object.assign(e,s)}getRawValue(t){return l(this,Ge).get(t)}remove(t){if(l(this,Ge).delete(t),l(this,Ge).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const e of l(this,Ge).values())if(e instanceof ye)return;this.onAnnotationEditor(null)}}setValue(t,e){const s=l(this,Ge).get(t);let n=!1;if(s!==void 0)for(const[r,o]of Object.entries(e))s[r]!==o&&(n=!0,s[r]=o);else n=!0,l(this,Ge).set(t,e);n&&w(this,lf,Hy).call(this),e instanceof ye&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(e.constructor._type)}has(t){return l(this,Ge).has(t)}getAll(){return l(this,Ge).size>0?Sm(l(this,Ge)):null}setAll(t){for(const[e,s]of Object.entries(t))this.setValue(e,s)}get size(){return l(this,Ge).size}resetModified(){l(this,Bo)&&(g(this,Bo,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new jy(this)}get serializable(){if(l(this,Ge).size===0)return lg;const t=new Map,e=new By,s=[],n=Object.create(null);let r=!1;for(const[o,a]of l(this,Ge)){const c=a instanceof ye?a.serialize(!1,n):a;c&&(t.set(o,c),e.update(`${o}:${JSON.stringify(c)}`),r||(r=!!c.bitmap))}if(r)for(const o of t.values())o.bitmap&&s.push(o.bitmap);return t.size>0?{map:t,hash:e.hexdigest(),transfer:s}:lg}get editorStats(){let t=null;const e=new Map;for(const s of l(this,Ge).values()){if(!(s instanceof ye))continue;const n=s.telemetryFinalData;if(!n)continue;const{type:r}=n;e.has(r)||e.set(r,Object.getPrototypeOf(s).constructor),t||(t=Object.create(null));const o=t[r]||(t[r]=new Map);for(const[a,c]of Object.entries(n)){if(a==="type")continue;let u=o.get(a);u||(u=new Map,o.set(a,u));const h=u.get(c)??0;u.set(c,h+1)}}for(const[s,n]of e)t[s]=n.computeTelemetryFinalData(t[s]);return t}resetModifiedIds(){g(this,Ho,null)}get modifiedIds(){if(l(this,Ho))return l(this,Ho);const t=[];for(const e of l(this,Ge).values())!(e instanceof ye)||!e.annotationElementId||!e.serialize()||t.push(e.annotationElementId);return g(this,Ho,{ids:new Set(t),hash:t.join(",")})}}Bo=new WeakMap,Ho=new WeakMap,Ge=new WeakMap,lf=new WeakSet,Hy=function(){l(this,Bo)||(g(this,Bo,!0),typeof this.onSetModified=="function"&&this.onSetModified())};var Nu;class jy extends Pm{constructor(e){super();y(this,Nu);const{map:s,hash:n,transfer:r}=e.serializable,o=structuredClone(s,r?{transfer:r}:null);g(this,Nu,{map:o,hash:n,transfer:r})}get print(){ae("Should not call PrintAnnotationStorage.print")}get serializable(){return l(this,Nu)}get modifiedIds(){return Bt(this,"modifiedIds",{ids:new Set,hash:""})}}Nu=new WeakMap;var vl;class JC{constructor({ownerDocument:t=globalThis.document,styleElement:e=null}){y(this,vl,new Set);this._document=t,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(t){this.nativeFontFaces.add(t),this._document.fonts.add(t)}removeNativeFontFace(t){this.nativeFontFaces.delete(t),this._document.fonts.delete(t)}insertRule(t){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const e=this.styleElement.sheet;e.insertRule(t,e.cssRules.length)}clear(){for(const t of this.nativeFontFaces)this._document.fonts.delete(t);this.nativeFontFaces.clear(),l(this,vl).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:t,_inspectFont:e}){if(!(!t||l(this,vl).has(t.loadedName))){if(Ie(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:s,src:n,style:r}=t,o=new FontFace(s,n,r);this.addNativeFontFace(o);try{await o.load(),l(this,vl).add(s),e==null||e(t)}catch{Dt(`Cannot load system font: ${t.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(o)}return}ae("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(t){if(t.attached||t.missingFile&&!t.systemFontInfo)return;if(t.attached=!0,t.systemFontInfo){await this.loadSystemFont(t);return}if(this.isFontLoadingAPISupported){const s=t.createNativeFontFace();if(s){this.addNativeFontFace(s);try{await s.loaded}catch(n){throw Dt(`Failed to load font '${s.family}': '${n}'.`),t.disableFontFace=!0,n}}return}const e=t.createFontFaceRule();if(e){if(this.insertRule(e),this.isSyncFontLoadingSupported)return;await new Promise(s=>{const n=this._queueLoadingCallback(s);this._prepareFontLoadEvent(t,n)})}}get isFontLoadingAPISupported(){var e;const t=!!((e=this._document)!=null&&e.fonts);return Bt(this,"isFontLoadingAPISupported",t)}get isSyncFontLoadingSupported(){let t=!1;return(gs||typeof navigator<"u"&&typeof(navigator==null?void 0:navigator.userAgent)=="string"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(t=!0),Bt(this,"isSyncFontLoadingSupported",t)}_queueLoadingCallback(t){function e(){for(Ie(!n.done,"completeRequest() cannot be called twice."),n.done=!0;s.length>0&&s[0].done;){const r=s.shift();setTimeout(r.callback,0)}}const{loadingRequests:s}=this,n={done:!1,complete:e,callback:t};return s.push(n),n}get _loadTestFont(){const t=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return Bt(this,"_loadTestFont",t)}_prepareFontLoadEvent(t,e){function s(C,T){return C.charCodeAt(T)<<24|C.charCodeAt(T+1)<<16|C.charCodeAt(T+2)<<8|C.charCodeAt(T+3)&255}function n(C,T,D,P){const j=C.substring(0,T),L=C.substring(T+D);return j+P+L}let r,o;const a=this._document.createElement("canvas");a.width=1,a.height=1;const c=a.getContext("2d");let u=0;function h(C,T){if(++u>30){Dt("Load test font never loaded."),T();return}if(c.font="30px "+C,c.fillText(".",0,20),c.getImageData(0,0,1,1).data[3]>0){T();return}setTimeout(h.bind(null,C,T))}const d=`lt${Date.now()}${this.loadTestFontId++}`;let f=this._loadTestFont;f=n(f,976,d.length,d);const m=16,v=1482184792;let _=s(f,m);for(r=0,o=d.length-3;r<o;r+=4)_=_-v+s(d,r)|0;r<d.length&&(_=_-v+s(d+"XXX",r)|0),f=n(f,m,4,NC(_));const b=`url(data:font/opentype;base64,${btoa(f)});`,A=`@font-face {font-family:"${d}";src:${b}}`;this.insertRule(A);const x=this._document.createElement("div");x.style.visibility="hidden",x.style.width=x.style.height="10px",x.style.position="absolute",x.style.top=x.style.left="0px";for(const C of[t.loadedName,d]){const T=this._document.createElement("span");T.textContent="Hi",T.style.fontFamily=C,x.append(T)}this._document.body.append(x),h(d,()=>{x.remove(),e.complete()})}}vl=new WeakMap;class QC{constructor(t,{disableFontFace:e=!1,fontExtraProperties:s=!1,inspectFont:n=null}){this.compiledGlyphs=Object.create(null);for(const r in t)this[r]=t[r];this.disableFontFace=e===!0,this.fontExtraProperties=s===!0,this._inspectFont=n}createNativeFontFace(){var e;if(!this.data||this.disableFontFace)return null;let t;if(!this.cssFontInfo)t=new FontFace(this.loadedName,this.data,{});else{const s={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(s.style=`oblique ${this.cssFontInfo.italicAngle}deg`),t=new FontFace(this.cssFontInfo.fontFamily,this.data,s)}return(e=this._inspectFont)==null||e.call(this,this),t}createFontFaceRule(){var s;if(!this.data||this.disableFontFace)return null;const t=`url(data:${this.mimetype};base64,${VC(this.data)});`;let e;if(!this.cssFontInfo)e=`@font-face {font-family:"${this.loadedName}";src:${t}}`;else{let n=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(n+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),e=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${n}src:${t}}`}return(s=this._inspectFont)==null||s.call(this,this,t),e}getPathGenerator(t,e){if(this.compiledGlyphs[e]!==void 0)return this.compiledGlyphs[e];const s=this.loadedName+"_path_"+e;let n;try{n=t.get(s)}catch(o){Dt(`getPathGenerator - ignoring character: "${o}".`)}const r=new Path2D(n||"");return this.fontExtraProperties||t.delete(s),this.compiledGlyphs[e]=r}}const Qh={DATA:1,ERROR:2},Me={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function ab(){}function Ms(i){if(i instanceof io||i instanceof jp||i instanceof au||i instanceof ib||i instanceof qd||i instanceof mp)return i;switch(i instanceof Error||typeof i=="object"&&i!==null||ae('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),i.name){case"AbortException":return new io(i.message);case"InvalidPDFException":return new jp(i.message);case"MissingPDFException":return new au(i.message);case"PasswordException":return new ib(i.message,i.code);case"UnexpectedResponseException":return new qd(i.message,i.status);case"UnknownErrorException":return new mp(i.message,i.details)}return new mp(i.message,i.toString())}var bl,gi,Vy,Uy,Gy,vd;class Pc{constructor(t,e,s){y(this,gi);y(this,bl,new AbortController);this.sourceName=t,this.targetName=e,this.comObj=s,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),s.addEventListener("message",w(this,gi,Vy).bind(this),{signal:l(this,bl).signal})}on(t,e){const s=this.actionHandler;if(s[t])throw new Error(`There is already an actionName called "${t}"`);s[t]=e}send(t,e,s){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,data:e},s)}sendWithPromise(t,e,s){const n=this.callbackId++,r=Promise.withResolvers();this.callbackCapabilities[n]=r;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,callbackId:n,data:e},s)}catch(o){r.reject(o)}return r.promise}sendWithStream(t,e,s,n){const r=this.streamId++,o=this.sourceName,a=this.targetName,c=this.comObj;return new ReadableStream({start:u=>{const h=Promise.withResolvers();return this.streamControllers[r]={controller:u,startCall:h,pullCall:null,cancelCall:null,isClosed:!1},c.postMessage({sourceName:o,targetName:a,action:t,streamId:r,data:e,desiredSize:u.desiredSize},n),h.promise},pull:u=>{const h=Promise.withResolvers();return this.streamControllers[r].pullCall=h,c.postMessage({sourceName:o,targetName:a,stream:Me.PULL,streamId:r,desiredSize:u.desiredSize}),h.promise},cancel:u=>{Ie(u instanceof Error,"cancel must have a valid reason");const h=Promise.withResolvers();return this.streamControllers[r].cancelCall=h,this.streamControllers[r].isClosed=!0,c.postMessage({sourceName:o,targetName:a,stream:Me.CANCEL,streamId:r,reason:Ms(u)}),h.promise}},s)}destroy(){var t;(t=l(this,bl))==null||t.abort(),g(this,bl,null)}}bl=new WeakMap,gi=new WeakSet,Vy=function({data:t}){if(t.targetName!==this.sourceName)return;if(t.stream){w(this,gi,Gy).call(this,t);return}if(t.callback){const s=t.callbackId,n=this.callbackCapabilities[s];if(!n)throw new Error(`Cannot resolve callback ${s}`);if(delete this.callbackCapabilities[s],t.callback===Qh.DATA)n.resolve(t.data);else if(t.callback===Qh.ERROR)n.reject(Ms(t.reason));else throw new Error("Unexpected callback case");return}const e=this.actionHandler[t.action];if(!e)throw new Error(`Unknown action from worker: ${t.action}`);if(t.callbackId){const s=this.sourceName,n=t.sourceName,r=this.comObj;Promise.try(e,t.data).then(function(o){r.postMessage({sourceName:s,targetName:n,callback:Qh.DATA,callbackId:t.callbackId,data:o})},function(o){r.postMessage({sourceName:s,targetName:n,callback:Qh.ERROR,callbackId:t.callbackId,reason:Ms(o)})});return}if(t.streamId){w(this,gi,Uy).call(this,t);return}e(t.data)},Uy=function(t){const e=t.streamId,s=this.sourceName,n=t.sourceName,r=this.comObj,o=this,a=this.actionHandler[t.action],c={enqueue(u,h=1,d){if(this.isCancelled)return;const f=this.desiredSize;this.desiredSize-=h,f>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),r.postMessage({sourceName:s,targetName:n,stream:Me.ENQUEUE,streamId:e,chunk:u},d)},close(){this.isCancelled||(this.isCancelled=!0,r.postMessage({sourceName:s,targetName:n,stream:Me.CLOSE,streamId:e}),delete o.streamSinks[e])},error(u){Ie(u instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,r.postMessage({sourceName:s,targetName:n,stream:Me.ERROR,streamId:e,reason:Ms(u)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:t.desiredSize,ready:null};c.sinkCapability.resolve(),c.ready=c.sinkCapability.promise,this.streamSinks[e]=c,Promise.try(a,t.data,c).then(function(){r.postMessage({sourceName:s,targetName:n,stream:Me.START_COMPLETE,streamId:e,success:!0})},function(u){r.postMessage({sourceName:s,targetName:n,stream:Me.START_COMPLETE,streamId:e,reason:Ms(u)})})},Gy=function(t){const e=t.streamId,s=this.sourceName,n=t.sourceName,r=this.comObj,o=this.streamControllers[e],a=this.streamSinks[e];switch(t.stream){case Me.START_COMPLETE:t.success?o.startCall.resolve():o.startCall.reject(Ms(t.reason));break;case Me.PULL_COMPLETE:t.success?o.pullCall.resolve():o.pullCall.reject(Ms(t.reason));break;case Me.PULL:if(!a){r.postMessage({sourceName:s,targetName:n,stream:Me.PULL_COMPLETE,streamId:e,success:!0});break}a.desiredSize<=0&&t.desiredSize>0&&a.sinkCapability.resolve(),a.desiredSize=t.desiredSize,Promise.try(a.onPull||ab).then(function(){r.postMessage({sourceName:s,targetName:n,stream:Me.PULL_COMPLETE,streamId:e,success:!0})},function(u){r.postMessage({sourceName:s,targetName:n,stream:Me.PULL_COMPLETE,streamId:e,reason:Ms(u)})});break;case Me.ENQUEUE:if(Ie(o,"enqueue should have stream controller"),o.isClosed)break;o.controller.enqueue(t.chunk);break;case Me.CLOSE:if(Ie(o,"close should have stream controller"),o.isClosed)break;o.isClosed=!0,o.controller.close(),w(this,gi,vd).call(this,o,e);break;case Me.ERROR:Ie(o,"error should have stream controller"),o.controller.error(Ms(t.reason)),w(this,gi,vd).call(this,o,e);break;case Me.CANCEL_COMPLETE:t.success?o.cancelCall.resolve():o.cancelCall.reject(Ms(t.reason)),w(this,gi,vd).call(this,o,e);break;case Me.CANCEL:if(!a)break;const c=Ms(t.reason);Promise.try(a.onCancel||ab,c).then(function(){r.postMessage({sourceName:s,targetName:n,stream:Me.CANCEL_COMPLETE,streamId:e,success:!0})},function(u){r.postMessage({sourceName:s,targetName:n,stream:Me.CANCEL_COMPLETE,streamId:e,reason:Ms(u)})}),a.sinkCapability.reject(c),a.isCancelled=!0,delete this.streamSinks[e];break;default:throw new Error("Unexpected stream case")}},vd=async function(t,e){var s,n,r;await Promise.allSettled([(s=t.startCall)==null?void 0:s.promise,(n=t.pullCall)==null?void 0:n.promise,(r=t.cancelCall)==null?void 0:r.promise]),delete this.streamControllers[e]};var Fu;class zy{constructor({enableHWA:t=!1}){y(this,Fu,!1);g(this,Fu,t)}create(t,e){if(t<=0||e<=0)throw new Error("Invalid canvas size");const s=this._createCanvas(t,e);return{canvas:s,context:s.getContext("2d",{willReadFrequently:!l(this,Fu)})}}reset(t,e,s){if(!t.canvas)throw new Error("Canvas is not specified");if(e<=0||s<=0)throw new Error("Invalid canvas size");t.canvas.width=e,t.canvas.height=s}destroy(t){if(!t.canvas)throw new Error("Canvas is not specified");t.canvas.width=0,t.canvas.height=0,t.canvas=null,t.context=null}_createCanvas(t,e){ae("Abstract method `_createCanvas` called.")}}Fu=new WeakMap;class ZC extends zy{constructor({ownerDocument:t=globalThis.document,enableHWA:e=!1}){super({enableHWA:e}),this._document=t}_createCanvas(t,e){const s=this._document.createElement("canvas");return s.width=t,s.height=e,s}}class Wy{constructor({baseUrl:t=null,isCompressed:e=!0}){this.baseUrl=t,this.isCompressed=e}async fetch({name:t}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!t)throw new Error("CMap name must be specified.");const e=this.baseUrl+t+(this.isCompressed?".bcmap":"");return this._fetch(e).then(s=>({cMapData:s,isCompressed:this.isCompressed})).catch(s=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${e}`)})}async _fetch(t){ae("Abstract method `_fetch` called.")}}class qy extends Wy{async _fetch(t){const e=await Gf(t,this.isCompressed?"arraybuffer":"text");return e instanceof ArrayBuffer?new Uint8Array(e):Uf(e)}}class Xy{addFilter(t){return"none"}addHCMFilter(t,e){return"none"}addAlphaFilter(t){return"none"}addLuminosityFilter(t){return"none"}addHighlightHCMFilter(t,e,s,n,r){return"none"}destroy(t=!1){}}var jo,yl,On,Nn,as,Vo,Uo,ut,ns,Rc,Va,bd,Ua,Ky,cg,Ga,Mc,Ic,ug,Lc;class tE extends Xy{constructor({docId:e,ownerDocument:s=globalThis.document}){super();y(this,ut);y(this,jo);y(this,yl);y(this,On);y(this,Nn);y(this,as);y(this,Vo);y(this,Uo,0);g(this,Nn,e),g(this,as,s)}addFilter(e){if(!e)return"none";let s=l(this,ut,ns).get(e);if(s)return s;const[n,r,o]=w(this,ut,bd).call(this,e),a=e.length===1?n:`${n}${r}${o}`;if(s=l(this,ut,ns).get(a),s)return l(this,ut,ns).set(e,s),s;const c=`g_${l(this,Nn)}_transfer_map_${ms(this,Uo)._++}`,u=w(this,ut,Ua).call(this,c);l(this,ut,ns).set(e,u),l(this,ut,ns).set(a,u);const h=w(this,ut,Ga).call(this,c);return w(this,ut,Ic).call(this,n,r,o,h),u}addHCMFilter(e,s){var m;const n=`${e}-${s}`,r="base";let o=l(this,ut,Rc).get(r);if((o==null?void 0:o.key)===n||(o?((m=o.filter)==null||m.remove(),o.key=n,o.url="none",o.filter=null):(o={key:n,url:"none",filter:null},l(this,ut,Rc).set(r,o)),!e||!s))return o.url;const a=w(this,ut,Lc).call(this,e);e=bt.makeHexColor(...a);const c=w(this,ut,Lc).call(this,s);if(s=bt.makeHexColor(...c),l(this,ut,Va).style.color="",e==="#000000"&&s==="#ffffff"||e===s)return o.url;const u=new Array(256);for(let v=0;v<=255;v++){const _=v/255;u[v]=_<=.03928?_/12.92:((_+.055)/1.055)**2.4}const h=u.join(","),d=`g_${l(this,Nn)}_hcm_filter`,f=o.filter=w(this,ut,Ga).call(this,d);w(this,ut,Ic).call(this,h,h,h,f),w(this,ut,cg).call(this,f);const p=(v,_)=>{const b=a[v]/255,A=c[v]/255,x=new Array(_+1);for(let C=0;C<=_;C++)x[C]=b+C/_*(A-b);return x.join(",")};return w(this,ut,Ic).call(this,p(0,5),p(1,5),p(2,5),f),o.url=w(this,ut,Ua).call(this,d),o.url}addAlphaFilter(e){let s=l(this,ut,ns).get(e);if(s)return s;const[n]=w(this,ut,bd).call(this,[e]),r=`alpha_${n}`;if(s=l(this,ut,ns).get(r),s)return l(this,ut,ns).set(e,s),s;const o=`g_${l(this,Nn)}_alpha_map_${ms(this,Uo)._++}`,a=w(this,ut,Ua).call(this,o);l(this,ut,ns).set(e,a),l(this,ut,ns).set(r,a);const c=w(this,ut,Ga).call(this,o);return w(this,ut,ug).call(this,n,c),a}addLuminosityFilter(e){let s=l(this,ut,ns).get(e||"luminosity");if(s)return s;let n,r;if(e?([n]=w(this,ut,bd).call(this,[e]),r=`luminosity_${n}`):r="luminosity",s=l(this,ut,ns).get(r),s)return l(this,ut,ns).set(e,s),s;const o=`g_${l(this,Nn)}_luminosity_map_${ms(this,Uo)._++}`,a=w(this,ut,Ua).call(this,o);l(this,ut,ns).set(e,a),l(this,ut,ns).set(r,a);const c=w(this,ut,Ga).call(this,o);return w(this,ut,Ky).call(this,c),e&&w(this,ut,ug).call(this,n,c),a}addHighlightHCMFilter(e,s,n,r,o){var A;const a=`${s}-${n}-${r}-${o}`;let c=l(this,ut,Rc).get(e);if((c==null?void 0:c.key)===a||(c?((A=c.filter)==null||A.remove(),c.key=a,c.url="none",c.filter=null):(c={key:a,url:"none",filter:null},l(this,ut,Rc).set(e,c)),!s||!n))return c.url;const[u,h]=[s,n].map(w(this,ut,Lc).bind(this));let d=Math.round(.2126*u[0]+.7152*u[1]+.0722*u[2]),f=Math.round(.2126*h[0]+.7152*h[1]+.0722*h[2]),[p,m]=[r,o].map(w(this,ut,Lc).bind(this));f<d&&([d,f,p,m]=[f,d,m,p]),l(this,ut,Va).style.color="";const v=(x,C,T)=>{const D=new Array(256),P=(f-d)/T,j=x/255,L=(C-x)/(255*T);let $=0;for(let N=0;N<=T;N++){const I=Math.round(d+N*P),F=j+N*L;for(let Q=$;Q<=I;Q++)D[Q]=F;$=I+1}for(let N=$;N<256;N++)D[N]=D[$-1];return D.join(",")},_=`g_${l(this,Nn)}_hcm_${e}_filter`,b=c.filter=w(this,ut,Ga).call(this,_);return w(this,ut,cg).call(this,b),w(this,ut,Ic).call(this,v(p[0],m[0],5),v(p[1],m[1],5),v(p[2],m[2],5),b),c.url=w(this,ut,Ua).call(this,_),c.url}destroy(e=!1){var s,n,r,o;e&&((s=l(this,Vo))!=null&&s.size)||((n=l(this,On))==null||n.parentNode.parentNode.remove(),g(this,On,null),(r=l(this,yl))==null||r.clear(),g(this,yl,null),(o=l(this,Vo))==null||o.clear(),g(this,Vo,null),g(this,Uo,0))}}jo=new WeakMap,yl=new WeakMap,On=new WeakMap,Nn=new WeakMap,as=new WeakMap,Vo=new WeakMap,Uo=new WeakMap,ut=new WeakSet,ns=function(){return l(this,yl)||g(this,yl,new Map)},Rc=function(){return l(this,Vo)||g(this,Vo,new Map)},Va=function(){if(!l(this,On)){const e=l(this,as).createElement("div"),{style:s}=e;s.visibility="hidden",s.contain="strict",s.width=s.height=0,s.position="absolute",s.top=s.left=0,s.zIndex=-1;const n=l(this,as).createElementNS(_n,"svg");n.setAttribute("width",0),n.setAttribute("height",0),g(this,On,l(this,as).createElementNS(_n,"defs")),e.append(n),n.append(l(this,On)),l(this,as).body.append(e)}return l(this,On)},bd=function(e){if(e.length===1){const u=e[0],h=new Array(256);for(let f=0;f<256;f++)h[f]=u[f]/255;const d=h.join(",");return[d,d,d]}const[s,n,r]=e,o=new Array(256),a=new Array(256),c=new Array(256);for(let u=0;u<256;u++)o[u]=s[u]/255,a[u]=n[u]/255,c[u]=r[u]/255;return[o.join(","),a.join(","),c.join(",")]},Ua=function(e){if(l(this,jo)===void 0){g(this,jo,"");const s=l(this,as).URL;s!==l(this,as).baseURI&&(zf(s)?Dt('#createUrl: ignore "data:"-URL for performance reasons.'):g(this,jo,s.split("#",1)[0]))}return`url(${l(this,jo)}#${e})`},Ky=function(e){const s=l(this,as).createElementNS(_n,"feColorMatrix");s.setAttribute("type","matrix"),s.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),e.append(s)},cg=function(e){const s=l(this,as).createElementNS(_n,"feColorMatrix");s.setAttribute("type","matrix"),s.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),e.append(s)},Ga=function(e){const s=l(this,as).createElementNS(_n,"filter");return s.setAttribute("color-interpolation-filters","sRGB"),s.setAttribute("id",e),l(this,ut,Va).append(s),s},Mc=function(e,s,n){const r=l(this,as).createElementNS(_n,s);r.setAttribute("type","discrete"),r.setAttribute("tableValues",n),e.append(r)},Ic=function(e,s,n,r){const o=l(this,as).createElementNS(_n,"feComponentTransfer");r.append(o),w(this,ut,Mc).call(this,o,"feFuncR",e),w(this,ut,Mc).call(this,o,"feFuncG",s),w(this,ut,Mc).call(this,o,"feFuncB",n)},ug=function(e,s){const n=l(this,as).createElementNS(_n,"feComponentTransfer");s.append(n),w(this,ut,Mc).call(this,n,"feFuncA",e)},Lc=function(e){return l(this,ut,Va).style.color=e,Tm(getComputedStyle(l(this,ut,Va)).getPropertyValue("color"))};class Yy{constructor({baseUrl:t=null}){this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!t)throw new Error("Font filename must be specified.");const e=`${this.baseUrl}${t}`;return this._fetch(e).catch(s=>{throw new Error(`Unable to load font data at: ${e}`)})}async _fetch(t){ae("Abstract method `_fetch` called.")}}class Jy extends Yy{async _fetch(t){const e=await Gf(t,"arraybuffer");return new Uint8Array(e)}}gs&&Dt("Please use the `legacy` build in Node.js environments.");async function Qy(i){const e=await process.getBuiltinModule("fs").promises.readFile(i);return new Uint8Array(e)}class eE extends Xy{}class sE extends zy{_createCanvas(t,e){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(t,e)}}class iE extends Wy{async _fetch(t){return Qy(t)}}class nE extends Yy{async _fetch(t){return Qy(t)}}const hs={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function hg(i,t){if(!t)return;const e=t[2]-t[0],s=t[3]-t[1],n=new Path2D;n.rect(t[0],t[1],e,s),i.clip(n)}class Rm{getPattern(){ae("Abstract method `getPattern` called.")}}class rE extends Rm{constructor(t){super(),this._type=t[1],this._bbox=t[2],this._colorStops=t[3],this._p0=t[4],this._p1=t[5],this._r0=t[6],this._r1=t[7],this.matrix=null}_createGradient(t){let e;this._type==="axial"?e=t.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(e=t.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const s of this._colorStops)e.addColorStop(s[0],s[1]);return e}getPattern(t,e,s,n){let r;if(n===hs.STROKE||n===hs.FILL){const o=e.current.getClippedPathBoundingBox(n,de(t))||[0,0,0,0],a=Math.ceil(o[2]-o[0])||1,c=Math.ceil(o[3]-o[1])||1,u=e.cachedCanvases.getCanvas("pattern",a,c),h=u.context;h.clearRect(0,0,h.canvas.width,h.canvas.height),h.beginPath(),h.rect(0,0,h.canvas.width,h.canvas.height),h.translate(-o[0],-o[1]),s=bt.transform(s,[1,0,0,1,o[0],o[1]]),h.transform(...e.baseTransform),this.matrix&&h.transform(...this.matrix),hg(h,this._bbox),h.fillStyle=this._createGradient(h),h.fill(),r=t.createPattern(u.canvas,"no-repeat");const d=new DOMMatrix(s);r.setTransform(d)}else hg(t,this._bbox),r=this._createGradient(t);return r}}function yp(i,t,e,s,n,r,o,a){const c=t.coords,u=t.colors,h=i.data,d=i.width*4;let f;c[e+1]>c[s+1]&&(f=e,e=s,s=f,f=r,r=o,o=f),c[s+1]>c[n+1]&&(f=s,s=n,n=f,f=o,o=a,a=f),c[e+1]>c[s+1]&&(f=e,e=s,s=f,f=r,r=o,o=f);const p=(c[e]+t.offsetX)*t.scaleX,m=(c[e+1]+t.offsetY)*t.scaleY,v=(c[s]+t.offsetX)*t.scaleX,_=(c[s+1]+t.offsetY)*t.scaleY,b=(c[n]+t.offsetX)*t.scaleX,A=(c[n+1]+t.offsetY)*t.scaleY;if(m>=A)return;const x=u[r],C=u[r+1],T=u[r+2],D=u[o],P=u[o+1],j=u[o+2],L=u[a],$=u[a+1],N=u[a+2],I=Math.round(m),F=Math.round(A);let Q,J,H,V,Z,St,wt,_t;for(let Pt=I;Pt<=F;Pt++){if(Pt<_){const U=Pt<m?0:(m-Pt)/(m-_);Q=p-(p-v)*U,J=x-(x-D)*U,H=C-(C-P)*U,V=T-(T-j)*U}else{let U;Pt>A?U=1:_===A?U=0:U=(_-Pt)/(_-A),Q=v-(v-b)*U,J=D-(D-L)*U,H=P-(P-$)*U,V=j-(j-N)*U}let Mt;Pt<m?Mt=0:Pt>A?Mt=1:Mt=(m-Pt)/(m-A),Z=p-(p-b)*Mt,St=x-(x-L)*Mt,wt=C-(C-$)*Mt,_t=T-(T-N)*Mt;const Ht=Math.round(Math.min(Q,Z)),xe=Math.round(Math.max(Q,Z));let qt=d*Pt+Ht*4;for(let U=Ht;U<=xe;U++)Mt=(Q-U)/(Q-Z),Mt<0?Mt=0:Mt>1&&(Mt=1),h[qt++]=J-(J-St)*Mt|0,h[qt++]=H-(H-wt)*Mt|0,h[qt++]=V-(V-_t)*Mt|0,h[qt++]=255}}function oE(i,t,e){const s=t.coords,n=t.colors;let r,o;switch(t.type){case"lattice":const a=t.verticesPerRow,c=Math.floor(s.length/a)-1,u=a-1;for(r=0;r<c;r++){let h=r*a;for(let d=0;d<u;d++,h++)yp(i,e,s[h],s[h+1],s[h+a],n[h],n[h+1],n[h+a]),yp(i,e,s[h+a+1],s[h+1],s[h+a],n[h+a+1],n[h+1],n[h+a])}break;case"triangles":for(r=0,o=s.length;r<o;r+=3)yp(i,e,s[r],s[r+1],s[r+2],n[r],n[r+1],n[r+2]);break;default:throw new Error("illegal figure")}}class aE extends Rm{constructor(t){super(),this._coords=t[2],this._colors=t[3],this._figures=t[4],this._bounds=t[5],this._bbox=t[7],this._background=t[8],this.matrix=null}_createMeshCanvas(t,e,s){const a=Math.floor(this._bounds[0]),c=Math.floor(this._bounds[1]),u=Math.ceil(this._bounds[2])-a,h=Math.ceil(this._bounds[3])-c,d=Math.min(Math.ceil(Math.abs(u*t[0]*1.1)),3e3),f=Math.min(Math.ceil(Math.abs(h*t[1]*1.1)),3e3),p=u/d,m=h/f,v={coords:this._coords,colors:this._colors,offsetX:-a,offsetY:-c,scaleX:1/p,scaleY:1/m},_=d+2*2,b=f+2*2,A=s.getCanvas("mesh",_,b),x=A.context,C=x.createImageData(d,f);if(e){const D=C.data;for(let P=0,j=D.length;P<j;P+=4)D[P]=e[0],D[P+1]=e[1],D[P+2]=e[2],D[P+3]=255}for(const D of this._figures)oE(C,D,v);return x.putImageData(C,2,2),{canvas:A.canvas,offsetX:a-2*p,offsetY:c-2*m,scaleX:p,scaleY:m}}getPattern(t,e,s,n){hg(t,this._bbox);let r;if(n===hs.SHADING)r=bt.singularValueDecompose2dScale(de(t));else if(r=bt.singularValueDecompose2dScale(e.baseTransform),this.matrix){const a=bt.singularValueDecompose2dScale(this.matrix);r=[r[0]*a[0],r[1]*a[1]]}const o=this._createMeshCanvas(r,n===hs.SHADING?null:this._background,e.cachedCanvases);return n!==hs.SHADING&&(t.setTransform(...e.baseTransform),this.matrix&&t.transform(...this.matrix)),t.translate(o.offsetX,o.offsetY),t.scale(o.scaleX,o.scaleY),t.createPattern(o.canvas,"no-repeat")}}class lE extends Rm{getPattern(){return"hotpink"}}function cE(i){switch(i[0]){case"RadialAxial":return new rE(i);case"Mesh":return new aE(i);case"Dummy":return new lE}throw new Error(`Unknown IR type: ${i[0]}`)}const lb={COLORED:1,UNCOLORED:2},cf=class cf{constructor(t,e,s,n,r){this.operatorList=t[2],this.matrix=t[3],this.bbox=t[4],this.xstep=t[5],this.ystep=t[6],this.paintType=t[7],this.tilingType=t[8],this.color=e,this.ctx=s,this.canvasGraphicsFactory=n,this.baseTransform=r}createPatternCanvas(t){const{bbox:e,operatorList:s,paintType:n,tilingType:r,color:o,canvasGraphicsFactory:a}=this;let{xstep:c,ystep:u}=this;c=Math.abs(c),u=Math.abs(u),Vf("TilingType: "+r);const h=e[0],d=e[1],f=e[2],p=e[3],m=f-h,v=p-d,_=bt.singularValueDecompose2dScale(this.matrix),b=bt.singularValueDecompose2dScale(this.baseTransform),A=_[0]*b[0],x=_[1]*b[1];let C=m,T=v,D=!1,P=!1;const j=Math.ceil(c*A),L=Math.ceil(u*x),$=Math.ceil(m*A),N=Math.ceil(v*x);j>=$?C=c:D=!0,L>=N?T=u:P=!0;const I=this.getSizeAndScale(C,this.ctx.canvas.width,A),F=this.getSizeAndScale(T,this.ctx.canvas.height,x),Q=t.cachedCanvases.getCanvas("pattern",I.size,F.size),J=Q.context,H=a.createCanvasGraphics(J);if(H.groupLevel=t.groupLevel,this.setFillAndStrokeStyleToContext(H,n,o),J.translate(-I.scale*h,-F.scale*d),H.transform(I.scale,0,0,F.scale,0,0),J.save(),this.clipBbox(H,h,d,f,p),H.baseTransform=de(H.ctx),H.executeOperatorList(s),H.endDrawing(),J.restore(),D||P){const V=Q.canvas;D&&(C=c),P&&(T=u);const Z=this.getSizeAndScale(C,this.ctx.canvas.width,A),St=this.getSizeAndScale(T,this.ctx.canvas.height,x),wt=Z.size,_t=St.size,Pt=t.cachedCanvases.getCanvas("pattern-workaround",wt,_t),Mt=Pt.context,Ht=D?Math.floor(m/c):0,xe=P?Math.floor(v/u):0;for(let qt=0;qt<=Ht;qt++)for(let U=0;U<=xe;U++)Mt.drawImage(V,wt*qt,_t*U,wt,_t,0,0,wt,_t);return{canvas:Pt.canvas,scaleX:Z.scale,scaleY:St.scale,offsetX:h,offsetY:d}}return{canvas:Q.canvas,scaleX:I.scale,scaleY:F.scale,offsetX:h,offsetY:d}}getSizeAndScale(t,e,s){const n=Math.max(cf.MAX_PATTERN_SIZE,e);let r=Math.ceil(t*s);return r>=n?r=n:s=r/t,{scale:s,size:r}}clipBbox(t,e,s,n,r){const o=n-e,a=r-s;t.ctx.rect(e,s,o,a),t.current.updateRectMinMax(de(t.ctx),[e,s,n,r]),t.clip(),t.endPath()}setFillAndStrokeStyleToContext(t,e,s){const n=t.ctx,r=t.current;switch(e){case lb.COLORED:const o=this.ctx;n.fillStyle=o.fillStyle,n.strokeStyle=o.strokeStyle,r.fillColor=o.fillStyle,r.strokeColor=o.strokeStyle;break;case lb.UNCOLORED:const a=bt.makeHexColor(s[0],s[1],s[2]);n.fillStyle=a,n.strokeStyle=a,r.fillColor=a,r.strokeColor=a;break;default:throw new OC(`Unsupported paint type: ${e}`)}}getPattern(t,e,s,n){let r=s;n!==hs.SHADING&&(r=bt.transform(r,e.baseTransform),this.matrix&&(r=bt.transform(r,this.matrix)));const o=this.createPatternCanvas(e);let a=new DOMMatrix(r);a=a.translate(o.offsetX,o.offsetY),a=a.scale(1/o.scaleX,1/o.scaleY);const c=t.createPattern(o.canvas,"repeat");return c.setTransform(a),c}};pt(cf,"MAX_PATTERN_SIZE",3e3);let dg=cf;function uE({src:i,srcPos:t=0,dest:e,width:s,height:n,nonBlackColor:r=4294967295,inverseDecode:o=!1}){const a=Es.isLittleEndian?4278190080:255,[c,u]=o?[r,a]:[a,r],h=s>>3,d=s&7,f=i.length;e=new Uint32Array(e.buffer);let p=0;for(let m=0;m<n;m++){for(const _=t+h;t<_;t++){const b=t<f?i[t]:255;e[p++]=b&128?u:c,e[p++]=b&64?u:c,e[p++]=b&32?u:c,e[p++]=b&16?u:c,e[p++]=b&8?u:c,e[p++]=b&4?u:c,e[p++]=b&2?u:c,e[p++]=b&1?u:c}if(d===0)continue;const v=t<f?i[t++]:255;for(let _=0;_<d;_++)e[p++]=v&1<<7-_?u:c}return{srcPos:t,destPos:p}}const cb=16,ub=100,hE=15,hb=10,db=1e3,Ns=16;function dE(i,t){if(i._removeMirroring)throw new Error("Context is already forwarding operations.");i.__originalSave=i.save,i.__originalRestore=i.restore,i.__originalRotate=i.rotate,i.__originalScale=i.scale,i.__originalTranslate=i.translate,i.__originalTransform=i.transform,i.__originalSetTransform=i.setTransform,i.__originalResetTransform=i.resetTransform,i.__originalClip=i.clip,i.__originalMoveTo=i.moveTo,i.__originalLineTo=i.lineTo,i.__originalBezierCurveTo=i.bezierCurveTo,i.__originalRect=i.rect,i.__originalClosePath=i.closePath,i.__originalBeginPath=i.beginPath,i._removeMirroring=()=>{i.save=i.__originalSave,i.restore=i.__originalRestore,i.rotate=i.__originalRotate,i.scale=i.__originalScale,i.translate=i.__originalTranslate,i.transform=i.__originalTransform,i.setTransform=i.__originalSetTransform,i.resetTransform=i.__originalResetTransform,i.clip=i.__originalClip,i.moveTo=i.__originalMoveTo,i.lineTo=i.__originalLineTo,i.bezierCurveTo=i.__originalBezierCurveTo,i.rect=i.__originalRect,i.closePath=i.__originalClosePath,i.beginPath=i.__originalBeginPath,delete i._removeMirroring},i.save=function(){t.save(),this.__originalSave()},i.restore=function(){t.restore(),this.__originalRestore()},i.translate=function(s,n){t.translate(s,n),this.__originalTranslate(s,n)},i.scale=function(s,n){t.scale(s,n),this.__originalScale(s,n)},i.transform=function(s,n,r,o,a,c){t.transform(s,n,r,o,a,c),this.__originalTransform(s,n,r,o,a,c)},i.setTransform=function(s,n,r,o,a,c){t.setTransform(s,n,r,o,a,c),this.__originalSetTransform(s,n,r,o,a,c)},i.resetTransform=function(){t.resetTransform(),this.__originalResetTransform()},i.rotate=function(s){t.rotate(s),this.__originalRotate(s)},i.clip=function(s){t.clip(s),this.__originalClip(s)},i.moveTo=function(e,s){t.moveTo(e,s),this.__originalMoveTo(e,s)},i.lineTo=function(e,s){t.lineTo(e,s),this.__originalLineTo(e,s)},i.bezierCurveTo=function(e,s,n,r,o,a){t.bezierCurveTo(e,s,n,r,o,a),this.__originalBezierCurveTo(e,s,n,r,o,a)},i.rect=function(e,s,n,r){t.rect(e,s,n,r),this.__originalRect(e,s,n,r)},i.closePath=function(){t.closePath(),this.__originalClosePath()},i.beginPath=function(){t.beginPath(),this.__originalBeginPath()}}class fE{constructor(t){this.canvasFactory=t,this.cache=Object.create(null)}getCanvas(t,e,s){let n;return this.cache[t]!==void 0?(n=this.cache[t],this.canvasFactory.reset(n,e,s)):(n=this.canvasFactory.create(e,s),this.cache[t]=n),n}delete(t){delete this.cache[t]}clear(){for(const t in this.cache){const e=this.cache[t];this.canvasFactory.destroy(e),delete this.cache[t]}}}function Zh(i,t,e,s,n,r,o,a,c,u){const[h,d,f,p,m,v]=de(i);if(d===0&&f===0){const A=o*h+m,x=Math.round(A),C=a*p+v,T=Math.round(C),D=(o+c)*h+m,P=Math.abs(Math.round(D)-x)||1,j=(a+u)*p+v,L=Math.abs(Math.round(j)-T)||1;return i.setTransform(Math.sign(h),0,0,Math.sign(p),x,T),i.drawImage(t,e,s,n,r,0,0,P,L),i.setTransform(h,d,f,p,m,v),[P,L]}if(h===0&&p===0){const A=a*f+m,x=Math.round(A),C=o*d+v,T=Math.round(C),D=(a+u)*f+m,P=Math.abs(Math.round(D)-x)||1,j=(o+c)*d+v,L=Math.abs(Math.round(j)-T)||1;return i.setTransform(0,Math.sign(d),Math.sign(f),0,x,T),i.drawImage(t,e,s,n,r,0,0,L,P),i.setTransform(h,d,f,p,m,v),[L,P]}i.drawImage(t,e,s,n,r,o,a,c,u);const _=Math.hypot(h,d),b=Math.hypot(f,p);return[_*c,b*u]}function pE(i){const{width:t,height:e}=i;if(t>db||e>db)return null;const s=1e3,n=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),r=t+1;let o=new Uint8Array(r*(e+1)),a,c,u;const h=t+7&-8;let d=new Uint8Array(h*e),f=0;for(const b of i.data){let A=128;for(;A>0;)d[f++]=b&A?0:255,A>>=1}let p=0;for(f=0,d[f]!==0&&(o[0]=1,++p),c=1;c<t;c++)d[f]!==d[f+1]&&(o[c]=d[f]?2:1,++p),f++;for(d[f]!==0&&(o[c]=2,++p),a=1;a<e;a++){f=a*h,u=a*r,d[f-h]!==d[f]&&(o[u]=d[f]?1:8,++p);let b=(d[f]?4:0)+(d[f-h]?8:0);for(c=1;c<t;c++)b=(b>>2)+(d[f+1]?4:0)+(d[f-h+1]?8:0),n[b]&&(o[u+c]=n[b],++p),f++;if(d[f-h]!==d[f]&&(o[u+c]=d[f]?2:4,++p),p>s)return null}for(f=h*(e-1),u=a*r,d[f]!==0&&(o[u]=8,++p),c=1;c<t;c++)d[f]!==d[f+1]&&(o[u+c]=d[f]?4:8,++p),f++;if(d[f]!==0&&(o[u+c]=4,++p),p>s)return null;const m=new Int32Array([0,r,-1,0,-r,0,0,0,1]),v=new Path2D;for(a=0;p&&a<=e;a++){let b=a*r;const A=b+t;for(;b<A&&!o[b];)b++;if(b===A)continue;v.moveTo(b%r,a);const x=b;let C=o[b];do{const T=m[C];do b+=T;while(!o[b]);const D=o[b];D!==5&&D!==10?(C=D,o[b]=0):(C=D&51*C>>4,o[b]&=C>>2|C<<2),v.lineTo(b%r,b/r|0),o[b]||--p}while(x!==b);--a}return d=null,o=null,function(b){b.save(),b.scale(1/t,-1/e),b.translate(0,-e),b.fill(v),b.beginPath(),b.restore()}}class fb{constructor(t,e){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=ly,this.textMatrixScale=1,this.fontMatrix=Hp,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=is.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.patternStroke=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,t,e])}clone(){const t=Object.create(this);return t.clipBox=this.clipBox.slice(),t}setCurrentPoint(t,e){this.x=t,this.y=e}updatePathMinMax(t,e,s){[e,s]=bt.applyTransform([e,s],t),this.minX=Math.min(this.minX,e),this.minY=Math.min(this.minY,s),this.maxX=Math.max(this.maxX,e),this.maxY=Math.max(this.maxY,s)}updateRectMinMax(t,e){const s=bt.applyTransform(e,t),n=bt.applyTransform(e.slice(2),t),r=bt.applyTransform([e[0],e[3]],t),o=bt.applyTransform([e[2],e[1]],t);this.minX=Math.min(this.minX,s[0],n[0],r[0],o[0]),this.minY=Math.min(this.minY,s[1],n[1],r[1],o[1]),this.maxX=Math.max(this.maxX,s[0],n[0],r[0],o[0]),this.maxY=Math.max(this.maxY,s[1],n[1],r[1],o[1])}updateScalingPathMinMax(t,e){bt.scaleMinMax(t,e),this.minX=Math.min(this.minX,e[0]),this.minY=Math.min(this.minY,e[1]),this.maxX=Math.max(this.maxX,e[2]),this.maxY=Math.max(this.maxY,e[3])}updateCurvePathMinMax(t,e,s,n,r,o,a,c,u,h){const d=bt.bezierBoundingBox(e,s,n,r,o,a,c,u,h);h||this.updateRectMinMax(t,d)}getPathBoundingBox(t=hs.FILL,e=null){const s=[this.minX,this.minY,this.maxX,this.maxY];if(t===hs.STROKE){e||ae("Stroke bounding box must include transform.");const n=bt.singularValueDecompose2dScale(e),r=n[0]*this.lineWidth/2,o=n[1]*this.lineWidth/2;s[0]-=r,s[1]-=o,s[2]+=r,s[3]+=o}return s}updateClipFromPath(){const t=bt.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(t||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(t){this.clipBox=t,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(t=hs.FILL,e=null){return bt.intersect(this.clipBox,this.getPathBoundingBox(t,e))}}function pb(i,t){if(t instanceof ImageData){i.putImageData(t,0,0);return}const e=t.height,s=t.width,n=e%Ns,r=(e-n)/Ns,o=n===0?r:r+1,a=i.createImageData(s,Ns);let c=0,u;const h=t.data,d=a.data;let f,p,m,v;if(t.kind===ld.GRAYSCALE_1BPP){const _=h.byteLength,b=new Uint32Array(d.buffer,0,d.byteLength>>2),A=b.length,x=s+7>>3,C=4294967295,T=Es.isLittleEndian?4278190080:255;for(f=0;f<o;f++){for(m=f<r?Ns:n,u=0,p=0;p<m;p++){const D=_-c;let P=0;const j=D>x?s:D*8-7,L=j&-8;let $=0,N=0;for(;P<L;P+=8)N=h[c++],b[u++]=N&128?C:T,b[u++]=N&64?C:T,b[u++]=N&32?C:T,b[u++]=N&16?C:T,b[u++]=N&8?C:T,b[u++]=N&4?C:T,b[u++]=N&2?C:T,b[u++]=N&1?C:T;for(;P<j;P++)$===0&&(N=h[c++],$=128),b[u++]=N&$?C:T,$>>=1}for(;u<A;)b[u++]=0;i.putImageData(a,0,f*Ns)}}else if(t.kind===ld.RGBA_32BPP){for(p=0,v=s*Ns*4,f=0;f<r;f++)d.set(h.subarray(c,c+v)),c+=v,i.putImageData(a,0,p),p+=Ns;f<o&&(v=s*n*4,d.set(h.subarray(c,c+v)),i.putImageData(a,0,p))}else if(t.kind===ld.RGB_24BPP)for(m=Ns,v=s*m,f=0;f<o;f++){for(f>=r&&(m=n,v=s*m),u=0,p=v;p--;)d[u++]=h[c++],d[u++]=h[c++],d[u++]=h[c++],d[u++]=255;i.putImageData(a,0,f*Ns)}else throw new Error(`bad image kind: ${t.kind}`)}function gb(i,t){if(t.bitmap){i.drawImage(t.bitmap,0,0);return}const e=t.height,s=t.width,n=e%Ns,r=(e-n)/Ns,o=n===0?r:r+1,a=i.createImageData(s,Ns);let c=0;const u=t.data,h=a.data;for(let d=0;d<o;d++){const f=d<r?Ns:n;({srcPos:c}=uE({src:u,srcPos:c,dest:h,width:s,height:f,nonBlackColor:0})),i.putImageData(a,0,d*Ns)}}function wc(i,t){const e=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const s of e)i[s]!==void 0&&(t[s]=i[s]);i.setLineDash!==void 0&&(t.setLineDash(i.getLineDash()),t.lineDashOffset=i.lineDashOffset)}function td(i){if(i.strokeStyle=i.fillStyle="#000000",i.fillRule="nonzero",i.globalAlpha=1,i.lineWidth=1,i.lineCap="butt",i.lineJoin="miter",i.miterLimit=10,i.globalCompositeOperation="source-over",i.font="10px sans-serif",i.setLineDash!==void 0&&(i.setLineDash([]),i.lineDashOffset=0),!gs){const{filter:t}=i;t!=="none"&&t!==""&&(i.filter="none")}}function mb(i,t){if(t)return!0;const e=bt.singularValueDecompose2dScale(i);e[0]=Math.fround(e[0]),e[1]=Math.fround(e[1]);const s=Math.fround((globalThis.devicePixelRatio||1)*no.PDF_TO_CSS_UNITS);return e[0]<=s&&e[1]<=s}const gE=["butt","round","square"],mE=["miter","round","bevel"],vE={},vb={};var Ui,fg,pg,gg;const Nm=class Nm{constructor(t,e,s,n,r,{optionalContentConfig:o,markedContentStack:a=null},c,u){y(this,Ui);this.ctx=t,this.current=new fb(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=e,this.objs=s,this.canvasFactory=n,this.filterFactory=r,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=a||[],this.optionalContentConfig=o,this.cachedCanvases=new fE(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=c,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=u,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(t,e=null){return typeof t=="string"?t.startsWith("g_")?this.commonObjs.get(t):this.objs.get(t):e}beginDrawing({transform:t,viewport:e,transparency:s=!1,background:n=null}){const r=this.ctx.canvas.width,o=this.ctx.canvas.height,a=this.ctx.fillStyle;if(this.ctx.fillStyle=n||"#ffffff",this.ctx.fillRect(0,0,r,o),this.ctx.fillStyle=a,s){const c=this.cachedCanvases.getCanvas("transparent",r,o);this.compositeCtx=this.ctx,this.transparentCanvas=c.canvas,this.ctx=c.context,this.ctx.save(),this.ctx.transform(...de(this.compositeCtx))}this.ctx.save(),td(this.ctx),t&&(this.ctx.transform(...t),this.outputScaleX=t[0],this.outputScaleY=t[0]),this.ctx.transform(...e.transform),this.viewportScale=e.scale,this.baseTransform=de(this.ctx)}executeOperatorList(t,e,s,n){const r=t.argsArray,o=t.fnArray;let a=e||0;const c=r.length;if(c===a)return a;const u=c-a>hb&&typeof s=="function",h=u?Date.now()+hE:0;let d=0;const f=this.commonObjs,p=this.objs;let m;for(;;){if(n!==void 0&&a===n.nextBreakPoint)return n.breakIt(a,s),a;if(m=o[a],m!==wi.dependency)this[m].apply(this,r[a]);else for(const v of r[a]){const _=v.startsWith("g_")?f:p;if(!_.has(v))return _.get(v,s),a}if(a++,a===c)return a;if(u&&++d>hb){if(Date.now()>h)return s(),a;d=0}}}endDrawing(){w(this,Ui,fg).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const t of this._cachedBitmapsMap.values()){for(const e of t.values())typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement&&(e.width=e.height=0);t.clear()}this._cachedBitmapsMap.clear(),w(this,Ui,pg).call(this)}_scaleImage(t,e){const s=t.width??t.displayWidth,n=t.height??t.displayHeight;let r=Math.max(Math.hypot(e[0],e[1]),1),o=Math.max(Math.hypot(e[2],e[3]),1),a=s,c=n,u="prescale1",h,d;for(;r>2&&a>1||o>2&&c>1;){let f=a,p=c;r>2&&a>1&&(f=a>=16384?Math.floor(a/2)-1||1:Math.ceil(a/2),r/=a/f),o>2&&c>1&&(p=c>=16384?Math.floor(c/2)-1||1:Math.ceil(c)/2,o/=c/p),h=this.cachedCanvases.getCanvas(u,f,p),d=h.context,d.clearRect(0,0,f,p),d.drawImage(t,0,0,a,c,0,0,f,p),t=h.canvas,a=f,c=p,u=u==="prescale1"?"prescale2":"prescale1"}return{img:t,paintWidth:a,paintHeight:c}}_createMaskCanvas(t){const e=this.ctx,{width:s,height:n}=t,r=this.current.fillColor,o=this.current.patternFill,a=de(e);let c,u,h,d;if((t.bitmap||t.data)&&t.count>1){const j=t.bitmap||t.data.buffer;u=JSON.stringify(o?a:[a.slice(0,4),r]),c=this._cachedBitmapsMap.get(j),c||(c=new Map,this._cachedBitmapsMap.set(j,c));const L=c.get(u);if(L&&!o){const $=Math.round(Math.min(a[0],a[2])+a[4]),N=Math.round(Math.min(a[1],a[3])+a[5]);return{canvas:L,offsetX:$,offsetY:N}}h=L}h||(d=this.cachedCanvases.getCanvas("maskCanvas",s,n),gb(d.context,t));let f=bt.transform(a,[1/s,0,0,-1/n,0,0]);f=bt.transform(f,[1,0,0,1,0,-n]);const[p,m,v,_]=bt.getAxialAlignedBoundingBox([0,0,s,n],f),b=Math.round(v-p)||1,A=Math.round(_-m)||1,x=this.cachedCanvases.getCanvas("fillCanvas",b,A),C=x.context,T=p,D=m;C.translate(-T,-D),C.transform(...f),h||(h=this._scaleImage(d.canvas,Wi(C)),h=h.img,c&&o&&c.set(u,h)),C.imageSmoothingEnabled=mb(de(C),t.interpolate),Zh(C,h,0,0,h.width,h.height,0,0,s,n),C.globalCompositeOperation="source-in";const P=bt.transform(Wi(C),[1,0,0,1,-T,-D]);return C.fillStyle=o?r.getPattern(e,this,P,hs.FILL):r,C.fillRect(0,0,s,n),c&&!o&&(this.cachedCanvases.delete("fillCanvas"),c.set(u,x.canvas)),{canvas:x.canvas,offsetX:Math.round(T),offsetY:Math.round(D)}}setLineWidth(t){t!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=t,this.ctx.lineWidth=t}setLineCap(t){this.ctx.lineCap=gE[t]}setLineJoin(t){this.ctx.lineJoin=mE[t]}setMiterLimit(t){this.ctx.miterLimit=t}setDash(t,e){const s=this.ctx;s.setLineDash!==void 0&&(s.setLineDash(t),s.lineDashOffset=e)}setRenderingIntent(t){}setFlatness(t){}setGState(t){for(const[e,s]of t)switch(e){case"LW":this.setLineWidth(s);break;case"LC":this.setLineCap(s);break;case"LJ":this.setLineJoin(s);break;case"ML":this.setMiterLimit(s);break;case"D":this.setDash(s[0],s[1]);break;case"RI":this.setRenderingIntent(s);break;case"FL":this.setFlatness(s);break;case"Font":this.setFont(s[0],s[1]);break;case"CA":this.current.strokeAlpha=s;break;case"ca":this.current.fillAlpha=s,this.ctx.globalAlpha=s;break;case"BM":this.ctx.globalCompositeOperation=s;break;case"SMask":this.current.activeSMask=s?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(s);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const t=this.inSMaskMode;this.current.activeSMask&&!t?this.beginSMaskMode():!this.current.activeSMask&&t&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const t=this.ctx.canvas.width,e=this.ctx.canvas.height,s="smaskGroupAt"+this.groupLevel,n=this.cachedCanvases.getCanvas(s,t,e);this.suspendedCtx=this.ctx,this.ctx=n.context;const r=this.ctx;r.setTransform(...de(this.suspendedCtx)),wc(this.suspendedCtx,r),dE(r,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),wc(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(t){if(!this.current.activeSMask)return;t?(t[0]=Math.floor(t[0]),t[1]=Math.floor(t[1]),t[2]=Math.ceil(t[2]),t[3]=Math.ceil(t[3])):t=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const e=this.current.activeSMask,s=this.suspendedCtx;this.composeSMask(s,e,this.ctx,t),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(t,e,s,n){const r=n[0],o=n[1],a=n[2]-r,c=n[3]-o;a===0||c===0||(this.genericComposeSMask(e.context,s,a,c,e.subtype,e.backdrop,e.transferMap,r,o,e.offsetX,e.offsetY),t.save(),t.globalAlpha=1,t.globalCompositeOperation="source-over",t.setTransform(1,0,0,1,0,0),t.drawImage(s.canvas,0,0),t.restore())}genericComposeSMask(t,e,s,n,r,o,a,c,u,h,d){let f=t.canvas,p=c-h,m=u-d;if(o){const _=bt.makeHexColor(...o);if(p<0||m<0||p+s>f.width||m+n>f.height){const b=this.cachedCanvases.getCanvas("maskExtension",s,n),A=b.context;A.drawImage(f,-p,-m),A.globalCompositeOperation="destination-atop",A.fillStyle=_,A.fillRect(0,0,s,n),A.globalCompositeOperation="source-over",f=b.canvas,p=m=0}else{t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0);const b=new Path2D;b.rect(p,m,s,n),t.clip(b),t.globalCompositeOperation="destination-atop",t.fillStyle=_,t.fillRect(p,m,s,n),t.restore()}}e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0),r==="Alpha"&&a?e.filter=this.filterFactory.addAlphaFilter(a):r==="Luminosity"&&(e.filter=this.filterFactory.addLuminosityFilter(a));const v=new Path2D;v.rect(c,u,s,n),e.clip(v),e.globalCompositeOperation="destination-in",e.drawImage(f,p,m,s,n,c,u,s,n),e.restore()}save(){this.inSMaskMode?(wc(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const t=this.current;this.stateStack.push(t),this.current=t.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),wc(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(t,e,s,n,r,o){this.ctx.transform(t,e,s,n,r,o),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(t,e,s){const n=this.ctx,r=this.current;let o=r.x,a=r.y,c,u;const h=de(n),d=h[0]===0&&h[3]===0||h[1]===0&&h[2]===0,f=d?s.slice(0):null;for(let p=0,m=0,v=t.length;p<v;p++)switch(t[p]|0){case wi.rectangle:o=e[m++],a=e[m++];const _=e[m++],b=e[m++],A=o+_,x=a+b;n.moveTo(o,a),_===0||b===0?n.lineTo(A,x):(n.lineTo(A,a),n.lineTo(A,x),n.lineTo(o,x)),d||r.updateRectMinMax(h,[o,a,A,x]),n.closePath();break;case wi.moveTo:o=e[m++],a=e[m++],n.moveTo(o,a),d||r.updatePathMinMax(h,o,a);break;case wi.lineTo:o=e[m++],a=e[m++],n.lineTo(o,a),d||r.updatePathMinMax(h,o,a);break;case wi.curveTo:c=o,u=a,o=e[m+4],a=e[m+5],n.bezierCurveTo(e[m],e[m+1],e[m+2],e[m+3],o,a),r.updateCurvePathMinMax(h,c,u,e[m],e[m+1],e[m+2],e[m+3],o,a,f),m+=6;break;case wi.curveTo2:c=o,u=a,n.bezierCurveTo(o,a,e[m],e[m+1],e[m+2],e[m+3]),r.updateCurvePathMinMax(h,c,u,o,a,e[m],e[m+1],e[m+2],e[m+3],f),o=e[m+2],a=e[m+3],m+=4;break;case wi.curveTo3:c=o,u=a,o=e[m+2],a=e[m+3],n.bezierCurveTo(e[m],e[m+1],o,a,o,a),r.updateCurvePathMinMax(h,c,u,e[m],e[m+1],o,a,o,a,f),m+=4;break;case wi.closePath:n.closePath();break}d&&r.updateScalingPathMinMax(h,f),r.setCurrentPoint(o,a)}closePath(){this.ctx.closePath()}stroke(t=!0){const e=this.ctx,s=this.current.strokeColor;e.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof s=="object"&&(s!=null&&s.getPattern)?(e.save(),e.strokeStyle=s.getPattern(e,this,Wi(e),hs.STROKE),this.rescaleAndStroke(!1),e.restore()):this.rescaleAndStroke(!0)),t&&this.consumePath(this.current.getClippedPathBoundingBox()),e.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(t=!0){const e=this.ctx,s=this.current.fillColor,n=this.current.patternFill;let r=!1;n&&(e.save(),e.fillStyle=s.getPattern(e,this,Wi(e),hs.FILL),r=!0);const o=this.current.getClippedPathBoundingBox();this.contentVisible&&o!==null&&(this.pendingEOFill?(e.fill("evenodd"),this.pendingEOFill=!1):e.fill()),r&&e.restore(),t&&this.consumePath(o)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=vE}eoClip(){this.pendingClip=vb}beginText(){this.current.textMatrix=ly,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const t=this.pendingTextPaths,e=this.ctx;if(t===void 0){e.beginPath();return}const s=new Path2D,n=e.getTransform().invertSelf();for(const{transform:r,x:o,y:a,fontSize:c,path:u}of t)s.addPath(u,new DOMMatrix(r).preMultiplySelf(n).translate(o,a).scale(c,-c));e.clip(s),e.beginPath(),delete this.pendingTextPaths}setCharSpacing(t){this.current.charSpacing=t}setWordSpacing(t){this.current.wordSpacing=t}setHScale(t){this.current.textHScale=t/100}setLeading(t){this.current.leading=-t}setFont(t,e){var h;const s=this.commonObjs.get(t),n=this.current;if(!s)throw new Error(`Can't find font for ${t}`);if(n.fontMatrix=s.fontMatrix||Hp,(n.fontMatrix[0]===0||n.fontMatrix[3]===0)&&Dt("Invalid font matrix for font "+t),e<0?(e=-e,n.fontDirection=-1):n.fontDirection=1,this.current.font=s,this.current.fontSize=e,s.isType3Font)return;const r=s.loadedName||"sans-serif",o=((h=s.systemFontInfo)==null?void 0:h.css)||`"${r}", ${s.fallbackName}`;let a="normal";s.black?a="900":s.bold&&(a="bold");const c=s.italic?"italic":"normal";let u=e;e<cb?u=cb:e>ub&&(u=ub),this.current.fontSizeScale=e/u,this.ctx.font=`${c} ${a} ${u}px ${o}`}setTextRenderingMode(t){this.current.textRenderingMode=t}setTextRise(t){this.current.textRise=t}moveText(t,e){this.current.x=this.current.lineX+=t,this.current.y=this.current.lineY+=e}setLeadingMoveText(t,e){this.setLeading(-e),this.moveText(t,e)}setTextMatrix(t,e,s,n,r,o){this.current.textMatrix=[t,e,s,n,r,o],this.current.textMatrixScale=Math.hypot(t,e),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(t,e,s,n,r){const o=this.ctx,a=this.current,c=a.font,u=a.textRenderingMode,h=a.fontSize/a.fontSizeScale,d=u&is.FILL_STROKE_MASK,f=!!(u&is.ADD_TO_PATH_FLAG),p=a.patternFill&&!c.missingFile,m=a.patternStroke&&!c.missingFile;let v;if((c.disableFontFace||f||p||m)&&(v=c.getPathGenerator(this.commonObjs,t)),c.disableFontFace||p||m){if(o.save(),o.translate(e,s),o.scale(h,-h),d===is.FILL||d===is.FILL_STROKE)if(n){const _=o.getTransform();o.setTransform(...n),o.fill(w(this,Ui,gg).call(this,v,_,n))}else o.fill(v);if(d===is.STROKE||d===is.FILL_STROKE)if(r){const _=o.getTransform();o.setTransform(...r),o.stroke(w(this,Ui,gg).call(this,v,_,r))}else o.lineWidth/=h,o.stroke(v);o.restore()}else(d===is.FILL||d===is.FILL_STROKE)&&o.fillText(t,e,s),(d===is.STROKE||d===is.FILL_STROKE)&&o.strokeText(t,e,s);f&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:de(o),x:e,y:s,fontSize:h,path:v})}get isFontSubpixelAAEnabled(){const{context:t}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);t.scale(1.5,1),t.fillText("I",0,10);const e=t.getImageData(0,0,10,10).data;let s=!1;for(let n=3;n<e.length;n+=4)if(e[n]>0&&e[n]<255){s=!0;break}return Bt(this,"isFontSubpixelAAEnabled",s)}showText(t){const e=this.current,s=e.font;if(s.isType3Font)return this.showType3Text(t);const n=e.fontSize;if(n===0)return;const r=this.ctx,o=e.fontSizeScale,a=e.charSpacing,c=e.wordSpacing,u=e.fontDirection,h=e.textHScale*u,d=t.length,f=s.vertical,p=f?1:-1,m=s.defaultVMetrics,v=n*e.fontMatrix[0],_=e.textRenderingMode===is.FILL&&!s.disableFontFace&&!e.patternFill;r.save(),r.transform(...e.textMatrix),r.translate(e.x,e.y+e.textRise),u>0?r.scale(h,-1):r.scale(h,1);let b,A;if(e.patternFill){r.save();const P=e.fillColor.getPattern(r,this,Wi(r),hs.FILL);b=de(r),r.restore(),r.fillStyle=P}if(e.patternStroke){r.save();const P=e.strokeColor.getPattern(r,this,Wi(r),hs.STROKE);A=de(r),r.restore(),r.strokeStyle=P}let x=e.lineWidth;const C=e.textMatrixScale;if(C===0||x===0){const P=e.textRenderingMode&is.FILL_STROKE_MASK;(P===is.STROKE||P===is.FILL_STROKE)&&(x=this.getSinglePixelWidth())}else x/=C;if(o!==1&&(r.scale(o,o),x/=o),r.lineWidth=x,s.isInvalidPDFjsFont){const P=[];let j=0;for(const L of t)P.push(L.unicode),j+=L.width;r.fillText(P.join(""),0,0),e.x+=j*v*h,r.restore(),this.compose();return}let T=0,D;for(D=0;D<d;++D){const P=t[D];if(typeof P=="number"){T+=p*P*n/1e3;continue}let j=!1;const L=(P.isSpace?c:0)+a,$=P.fontChar,N=P.accent;let I,F,Q=P.width;if(f){const H=P.vmetric||m,V=-(P.vmetric?H[1]:Q*.5)*v,Z=H[2]*v;Q=H?-H[0]:Q,I=V/o,F=(T+Z)/o}else I=T/o,F=0;if(s.remeasure&&Q>0){const H=r.measureText($).width*1e3/n*o;if(Q<H&&this.isFontSubpixelAAEnabled){const V=Q/H;j=!0,r.save(),r.scale(V,1),I/=V}else Q!==H&&(I+=(Q-H)/2e3*n/o)}if(this.contentVisible&&(P.isInFont||s.missingFile)){if(_&&!N)r.fillText($,I,F);else if(this.paintChar($,I,F,b,A),N){const H=I+n*N.offset.x/o,V=F-n*N.offset.y/o;this.paintChar(N.fontChar,H,V,b,A)}}const J=f?Q*v-L*u:Q*v+L*u;T+=J,j&&r.restore()}f?e.y-=T:e.x+=T*h,r.restore(),this.compose()}showType3Text(t){const e=this.ctx,s=this.current,n=s.font,r=s.fontSize,o=s.fontDirection,a=n.vertical?1:-1,c=s.charSpacing,u=s.wordSpacing,h=s.textHScale*o,d=s.fontMatrix||Hp,f=t.length,p=s.textRenderingMode===is.INVISIBLE;let m,v,_,b;if(!(p||r===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,e.save(),e.transform(...s.textMatrix),e.translate(s.x,s.y),e.scale(h,o),m=0;m<f;++m){if(v=t[m],typeof v=="number"){b=a*v*r/1e3,this.ctx.translate(b,0),s.x+=b*h;continue}const A=(v.isSpace?u:0)+c,x=n.charProcOperatorList[v.operatorListId];if(!x){Dt(`Type3 character "${v.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=v,this.save(),e.scale(r,r),e.transform(...d),this.executeOperatorList(x),this.restore()),_=bt.applyTransform([v.width,0],d)[0]*r+A,e.translate(_,0),s.x+=_*h}e.restore(),this.processingType3=null}}setCharWidth(t,e){}setCharWidthAndBounds(t,e,s,n,r,o){this.ctx.rect(s,n,r-s,o-n),this.ctx.clip(),this.endPath()}getColorN_Pattern(t){let e;if(t[0]==="TilingPattern"){const s=t[1],n=this.baseTransform||de(this.ctx),r={createCanvasGraphics:o=>new Nm(o,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};e=new dg(t,s,this.ctx,r,n)}else e=this._getPattern(t[1],t[2]);return e}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments),this.current.patternStroke=!0}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(t,e,s){this.ctx.strokeStyle=this.current.strokeColor=bt.makeHexColor(t,e,s),this.current.patternStroke=!1}setStrokeTransparent(){this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(t,e,s){this.ctx.fillStyle=this.current.fillColor=bt.makeHexColor(t,e,s),this.current.patternFill=!1}setFillTransparent(){this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(t,e=null){let s;return this.cachedPatterns.has(t)?s=this.cachedPatterns.get(t):(s=cE(this.getObject(t)),this.cachedPatterns.set(t,s)),e&&(s.matrix=e),s}shadingFill(t){if(!this.contentVisible)return;const e=this.ctx;this.save();const s=this._getPattern(t);e.fillStyle=s.getPattern(e,this,Wi(e),hs.SHADING);const n=Wi(e);if(n){const{width:r,height:o}=e.canvas,[a,c,u,h]=bt.getAxialAlignedBoundingBox([0,0,r,o],n);this.ctx.fillRect(a,c,u-a,h-c)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){ae("Should not call beginInlineImage")}beginImageData(){ae("Should not call beginImageData")}paintFormXObjectBegin(t,e){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),t&&this.transform(...t),this.baseTransform=de(this.ctx),e)){const s=e[2]-e[0],n=e[3]-e[1];this.ctx.rect(e[0],e[1],s,n),this.current.updateRectMinMax(de(this.ctx),e),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(t){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const e=this.ctx;t.isolated||Vf("TODO: Support non-isolated groups."),t.knockout&&Dt("Knockout groups not supported.");const s=de(e);if(t.matrix&&e.transform(...t.matrix),!t.bbox)throw new Error("Bounding box is required.");let n=bt.getAxialAlignedBoundingBox(t.bbox,de(e));const r=[0,0,e.canvas.width,e.canvas.height];n=bt.intersect(n,r)||[0,0,0,0];const o=Math.floor(n[0]),a=Math.floor(n[1]),c=Math.max(Math.ceil(n[2])-o,1),u=Math.max(Math.ceil(n[3])-a,1);this.current.startNewPathAndClipBox([0,0,c,u]);let h="groupAt"+this.groupLevel;t.smask&&(h+="_smask_"+this.smaskCounter++%2);const d=this.cachedCanvases.getCanvas(h,c,u),f=d.context;f.translate(-o,-a),f.transform(...s),t.smask?this.smaskStack.push({canvas:d.canvas,context:f,offsetX:o,offsetY:a,subtype:t.smask.subtype,backdrop:t.smask.backdrop,transferMap:t.smask.transferMap||null,startTransformInverse:null}):(e.setTransform(1,0,0,1,0,0),e.translate(o,a),e.save()),wc(e,f),this.ctx=f,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(e),this.groupLevel++}endGroup(t){if(!this.contentVisible)return;this.groupLevel--;const e=this.ctx,s=this.groupStack.pop();if(this.ctx=s,this.ctx.imageSmoothingEnabled=!1,t.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const n=de(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...n);const r=bt.getAxialAlignedBoundingBox([0,0,e.canvas.width,e.canvas.height],n);this.ctx.drawImage(e.canvas,0,0),this.ctx.restore(),this.compose(r)}}beginAnnotation(t,e,s,n,r){if(w(this,Ui,fg).call(this),td(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),e){const o=e[2]-e[0],a=e[3]-e[1];if(r&&this.annotationCanvasMap){s=s.slice(),s[4]-=e[0],s[5]-=e[1],e=e.slice(),e[0]=e[1]=0,e[2]=o,e[3]=a;const[c,u]=bt.singularValueDecompose2dScale(de(this.ctx)),{viewportScale:h}=this,d=Math.ceil(o*this.outputScaleX*h),f=Math.ceil(a*this.outputScaleY*h);this.annotationCanvas=this.canvasFactory.create(d,f);const{canvas:p,context:m}=this.annotationCanvas;this.annotationCanvasMap.set(t,p),this.annotationCanvas.savedCtx=this.ctx,this.ctx=m,this.ctx.save(),this.ctx.setTransform(c,0,0,-u,0,a*u),td(this.ctx)}else td(this.ctx),this.endPath(),this.ctx.rect(e[0],e[1],o,a),this.ctx.clip(),this.ctx.beginPath()}this.current=new fb(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...s),this.transform(...n)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),w(this,Ui,pg).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(t){if(!this.contentVisible)return;const e=t.count;t=this.getObject(t.data,t),t.count=e;const s=this.ctx,n=this.processingType3;if(n&&(n.compiled===void 0&&(n.compiled=pE(t)),n.compiled)){n.compiled(s);return}const r=this._createMaskCanvas(t),o=r.canvas;s.save(),s.setTransform(1,0,0,1,0,0),s.drawImage(o,r.offsetX,r.offsetY),s.restore(),this.compose()}paintImageMaskXObjectRepeat(t,e,s=0,n=0,r,o){if(!this.contentVisible)return;t=this.getObject(t.data,t);const a=this.ctx;a.save();const c=de(a);a.transform(e,s,n,r,0,0);const u=this._createMaskCanvas(t);a.setTransform(1,0,0,1,u.offsetX-c[4],u.offsetY-c[5]);for(let h=0,d=o.length;h<d;h+=2){const f=bt.transform(c,[e,s,n,r,o[h],o[h+1]]),[p,m]=bt.applyTransform([0,0],f);a.drawImage(u.canvas,p,m)}a.restore(),this.compose()}paintImageMaskXObjectGroup(t){if(!this.contentVisible)return;const e=this.ctx,s=this.current.fillColor,n=this.current.patternFill;for(const r of t){const{data:o,width:a,height:c,transform:u}=r,h=this.cachedCanvases.getCanvas("maskCanvas",a,c),d=h.context;d.save();const f=this.getObject(o,r);gb(d,f),d.globalCompositeOperation="source-in",d.fillStyle=n?s.getPattern(d,this,Wi(e),hs.FILL):s,d.fillRect(0,0,a,c),d.restore(),e.save(),e.transform(...u),e.scale(1,-1),Zh(e,h.canvas,0,0,a,c,0,-1,1,1),e.restore()}this.compose()}paintImageXObject(t){if(!this.contentVisible)return;const e=this.getObject(t);if(!e){Dt("Dependent image isn't ready yet");return}this.paintInlineImageXObject(e)}paintImageXObjectRepeat(t,e,s,n){if(!this.contentVisible)return;const r=this.getObject(t);if(!r){Dt("Dependent image isn't ready yet");return}const o=r.width,a=r.height,c=[];for(let u=0,h=n.length;u<h;u+=2)c.push({transform:[e,0,0,s,n[u],n[u+1]],x:0,y:0,w:o,h:a});this.paintInlineImageXObjectGroup(r,c)}applyTransferMapsToCanvas(t){return this.current.transferMaps!=="none"&&(t.filter=this.current.transferMaps,t.drawImage(t.canvas,0,0),t.filter="none"),t.canvas}applyTransferMapsToBitmap(t){if(this.current.transferMaps==="none")return t.bitmap;const{bitmap:e,width:s,height:n}=t,r=this.cachedCanvases.getCanvas("inlineImage",s,n),o=r.context;return o.filter=this.current.transferMaps,o.drawImage(e,0,0),o.filter="none",r.canvas}paintInlineImageXObject(t){if(!this.contentVisible)return;const e=t.width,s=t.height,n=this.ctx;if(this.save(),!gs){const{filter:a}=n;a!=="none"&&a!==""&&(n.filter="none")}n.scale(1/e,-1/s);let r;if(t.bitmap)r=this.applyTransferMapsToBitmap(t);else if(typeof HTMLElement=="function"&&t instanceof HTMLElement||!t.data)r=t;else{const c=this.cachedCanvases.getCanvas("inlineImage",e,s).context;pb(c,t),r=this.applyTransferMapsToCanvas(c)}const o=this._scaleImage(r,Wi(n));n.imageSmoothingEnabled=mb(de(n),t.interpolate),Zh(n,o.img,0,0,o.paintWidth,o.paintHeight,0,-s,e,s),this.compose(),this.restore()}paintInlineImageXObjectGroup(t,e){if(!this.contentVisible)return;const s=this.ctx;let n;if(t.bitmap)n=t.bitmap;else{const r=t.width,o=t.height,c=this.cachedCanvases.getCanvas("inlineImage",r,o).context;pb(c,t),n=this.applyTransferMapsToCanvas(c)}for(const r of e)s.save(),s.transform(...r.transform),s.scale(1,-1),Zh(s,n,r.x,r.y,r.w,r.h,0,-1,1,1),s.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(t){}markPointProps(t,e){}beginMarkedContent(t){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(t,e){t==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(e)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(t){const e=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(t);const s=this.ctx;this.pendingClip&&(e||(this.pendingClip===vb?s.clip("evenodd"):s.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),s.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const t=de(this.ctx);if(t[1]===0&&t[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(t[0]),Math.abs(t[3]));else{const e=Math.abs(t[0]*t[3]-t[2]*t[1]),s=Math.hypot(t[0],t[2]),n=Math.hypot(t[1],t[3]);this._cachedGetSinglePixelWidth=Math.max(s,n)/e}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:t}=this.current,{a:e,b:s,c:n,d:r}=this.ctx.getTransform();let o,a;if(s===0&&n===0){const c=Math.abs(e),u=Math.abs(r);if(c===u)if(t===0)o=a=1/c;else{const h=c*t;o=a=h<1?1/h:1}else if(t===0)o=1/c,a=1/u;else{const h=c*t,d=u*t;o=h<1?1/h:1,a=d<1?1/d:1}}else{const c=Math.abs(e*r-s*n),u=Math.hypot(e,s),h=Math.hypot(n,r);if(t===0)o=h/c,a=u/c;else{const d=t*c;o=h>d?h/d:1,a=u>d?u/d:1}}this._cachedScaleForStroking[0]=o,this._cachedScaleForStroking[1]=a}return this._cachedScaleForStroking}rescaleAndStroke(t){const{ctx:e}=this,{lineWidth:s}=this.current,[n,r]=this.getScaleForStroking();if(e.lineWidth=s||1,n===1&&r===1){e.stroke();return}const o=e.getLineDash();if(t&&e.save(),e.scale(n,r),o.length>0){const a=Math.max(n,r);e.setLineDash(o.map(c=>c/a)),e.lineDashOffset/=a}e.stroke(),t&&e.restore()}isContentVisible(){for(let t=this.markedContentStack.length-1;t>=0;t--)if(!this.markedContentStack[t].visible)return!1;return!0}};Ui=new WeakSet,fg=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},pg=function(){if(this.pageColors){const t=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(t!=="none"){const e=this.ctx.filter;this.ctx.filter=t,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=e}}},gg=function(t,e,s){const n=new Path2D;return n.addPath(t,new DOMMatrix(s).invertSelf().multiplySelf(e)),n};let el=Nm;for(const i in wi)el.prototype[i]!==void 0&&(el.prototype[wi[i]]=el.prototype[i]);var $u,Bu;class sr{static get workerPort(){return l(this,$u)}static set workerPort(t){if(!(typeof Worker<"u"&&t instanceof Worker)&&t!==null)throw new Error("Invalid `workerPort` type.");g(this,$u,t)}static get workerSrc(){return l(this,Bu)}static set workerSrc(t){if(typeof t!="string")throw new Error("Invalid `workerSrc` type.");g(this,Bu,t)}}$u=new WeakMap,Bu=new WeakMap,y(sr,$u,null),y(sr,Bu,"");var Go,Hu;class bE{constructor({parsedData:t,rawData:e}){y(this,Go);y(this,Hu);g(this,Go,t),g(this,Hu,e)}getRaw(){return l(this,Hu)}get(t){return l(this,Go).get(t)??null}getAll(){return Sm(l(this,Go))}has(t){return l(this,Go).has(t)}}Go=new WeakMap,Hu=new WeakMap;const za=Symbol("INTERNAL");var ju,Vu,Uu,wl;class yE{constructor(t,{name:e,intent:s,usage:n,rbGroups:r}){y(this,ju,!1);y(this,Vu,!1);y(this,Uu,!1);y(this,wl,!0);g(this,ju,!!(t&Ks.DISPLAY)),g(this,Vu,!!(t&Ks.PRINT)),this.name=e,this.intent=s,this.usage=n,this.rbGroups=r}get visible(){if(l(this,Uu))return l(this,wl);if(!l(this,wl))return!1;const{print:t,view:e}=this.usage;return l(this,ju)?(e==null?void 0:e.viewState)!=="OFF":l(this,Vu)?(t==null?void 0:t.printState)!=="OFF":!0}_setVisible(t,e,s=!1){t!==za&&ae("Internal method `_setVisible` called."),g(this,Uu,s),g(this,wl,e)}}ju=new WeakMap,Vu=new WeakMap,Uu=new WeakMap,wl=new WeakMap;var Dr,ee,_l,Al,Gu,mg;class wE{constructor(t,e=Ks.DISPLAY){y(this,Gu);y(this,Dr,null);y(this,ee,new Map);y(this,_l,null);y(this,Al,null);if(this.renderingIntent=e,this.name=null,this.creator=null,t!==null){this.name=t.name,this.creator=t.creator,g(this,Al,t.order);for(const s of t.groups)l(this,ee).set(s.id,new yE(e,s));if(t.baseState==="OFF")for(const s of l(this,ee).values())s._setVisible(za,!1);for(const s of t.on)l(this,ee).get(s)._setVisible(za,!0);for(const s of t.off)l(this,ee).get(s)._setVisible(za,!1);g(this,_l,this.getHash())}}isVisible(t){if(l(this,ee).size===0)return!0;if(!t)return Vf("Optional content group not defined."),!0;if(t.type==="OCG")return l(this,ee).has(t.id)?l(this,ee).get(t.id).visible:(Dt(`Optional content group not found: ${t.id}`),!0);if(t.type==="OCMD"){if(t.expression)return w(this,Gu,mg).call(this,t.expression);if(!t.policy||t.policy==="AnyOn"){for(const e of t.ids){if(!l(this,ee).has(e))return Dt(`Optional content group not found: ${e}`),!0;if(l(this,ee).get(e).visible)return!0}return!1}else if(t.policy==="AllOn"){for(const e of t.ids){if(!l(this,ee).has(e))return Dt(`Optional content group not found: ${e}`),!0;if(!l(this,ee).get(e).visible)return!1}return!0}else if(t.policy==="AnyOff"){for(const e of t.ids){if(!l(this,ee).has(e))return Dt(`Optional content group not found: ${e}`),!0;if(!l(this,ee).get(e).visible)return!0}return!1}else if(t.policy==="AllOff"){for(const e of t.ids){if(!l(this,ee).has(e))return Dt(`Optional content group not found: ${e}`),!0;if(l(this,ee).get(e).visible)return!1}return!0}return Dt(`Unknown optional content policy ${t.policy}.`),!0}return Dt(`Unknown group type ${t.type}.`),!0}setVisibility(t,e=!0,s=!0){var r;const n=l(this,ee).get(t);if(!n){Dt(`Optional content group not found: ${t}`);return}if(s&&e&&n.rbGroups.length)for(const o of n.rbGroups)for(const a of o)a!==t&&((r=l(this,ee).get(a))==null||r._setVisible(za,!1,!0));n._setVisible(za,!!e,!0),g(this,Dr,null)}setOCGState({state:t,preserveRB:e}){let s;for(const n of t){switch(n){case"ON":case"OFF":case"Toggle":s=n;continue}const r=l(this,ee).get(n);if(r)switch(s){case"ON":this.setVisibility(n,!0,e);break;case"OFF":this.setVisibility(n,!1,e);break;case"Toggle":this.setVisibility(n,!r.visible,e);break}}g(this,Dr,null)}get hasInitialVisibility(){return l(this,_l)===null||this.getHash()===l(this,_l)}getOrder(){return l(this,ee).size?l(this,Al)?l(this,Al).slice():[...l(this,ee).keys()]:null}getGroups(){return l(this,ee).size>0?Sm(l(this,ee)):null}getGroup(t){return l(this,ee).get(t)||null}getHash(){if(l(this,Dr)!==null)return l(this,Dr);const t=new By;for(const[e,s]of l(this,ee))t.update(`${e}:${s.visible}`);return g(this,Dr,t.hexdigest())}}Dr=new WeakMap,ee=new WeakMap,_l=new WeakMap,Al=new WeakMap,Gu=new WeakSet,mg=function(t){const e=t.length;if(e<2)return!0;const s=t[0];for(let n=1;n<e;n++){const r=t[n];let o;if(Array.isArray(r))o=w(this,Gu,mg).call(this,r);else if(l(this,ee).has(r))o=l(this,ee).get(r).visible;else return Dt(`Optional content group not found: ${r}`),!0;switch(s){case"And":if(!o)return!1;break;case"Or":if(o)return!0;break;case"Not":return!o;default:return!0}}return s==="And"};class _E{constructor(t,{disableRange:e=!1,disableStream:s=!1}){Ie(t,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:n,initialData:r,progressiveDone:o,contentDispositionFilename:a}=t;if(this._queuedChunks=[],this._progressiveDone=o,this._contentDispositionFilename=a,(r==null?void 0:r.length)>0){const c=r instanceof Uint8Array&&r.byteLength===r.buffer.byteLength?r.buffer:new Uint8Array(r).buffer;this._queuedChunks.push(c)}this._pdfDataRangeTransport=t,this._isStreamingSupported=!s,this._isRangeSupported=!e,this._contentLength=n,this._fullRequestReader=null,this._rangeReaders=[],t.addRangeListener((c,u)=>{this._onReceiveData({begin:c,chunk:u})}),t.addProgressListener((c,u)=>{this._onProgress({loaded:c,total:u})}),t.addProgressiveReadListener(c=>{this._onReceiveData({chunk:c})}),t.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),t.transportReady()}_onReceiveData({begin:t,chunk:e}){const s=e instanceof Uint8Array&&e.byteLength===e.buffer.byteLength?e.buffer:new Uint8Array(e).buffer;if(t===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(s):this._queuedChunks.push(s);else{const n=this._rangeReaders.some(function(r){return r._begin!==t?!1:(r._enqueue(s),!0)});Ie(n,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var t;return((t=this._fullRequestReader)==null?void 0:t._loaded)??0}_onProgress(t){var e,s,n,r;t.total===void 0?(s=(e=this._rangeReaders[0])==null?void 0:e.onProgress)==null||s.call(e,{loaded:t.loaded}):(r=(n=this._fullRequestReader)==null?void 0:n.onProgress)==null||r.call(n,{loaded:t.loaded,total:t.total})}_onProgressiveDone(){var t;(t=this._fullRequestReader)==null||t.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(t){const e=this._rangeReaders.indexOf(t);e>=0&&this._rangeReaders.splice(e,1)}getFullReader(){Ie(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const t=this._queuedChunks;return this._queuedChunks=null,new AE(this,t,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const s=new SE(this,t,e);return this._pdfDataRangeTransport.requestDataRange(t,e),this._rangeReaders.push(s),s}cancelAllRequests(t){var e;(e=this._fullRequestReader)==null||e.cancel(t);for(const s of this._rangeReaders.slice(0))s.cancel(t);this._pdfDataRangeTransport.abort()}}class AE{constructor(t,e,s=!1,n=null){this._stream=t,this._done=s||!1,this._filename=Em(n)?n:null,this._queuedChunks=e||[],this._loaded=0;for(const r of this._queuedChunks)this._loaded+=r.byteLength;this._requests=[],this._headersReady=Promise.resolve(),t._fullRequestReader=this,this.onProgress=null}_enqueue(t){this._done||(this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunks.push(t),this._loaded+=t.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class SE{constructor(t,e,s){this._stream=t,this._begin=e,this._end=s,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(t){if(!this._done){if(this._requests.length===0)this._queuedChunk=t;else{this._requests.shift().resolve({value:t,done:!1});for(const s of this._requests)s.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function xE(i){let t=!0,e=s("filename\\*","i").exec(i);if(e){e=e[1];let h=a(e);return h=unescape(h),h=c(h),h=u(h),r(h)}if(e=o(i),e){const h=u(e);return r(h)}if(e=s("filename","i").exec(i),e){e=e[1];let h=a(e);return h=u(h),r(h)}function s(h,d){return new RegExp("(?:^|;)\\s*"+h+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',d)}function n(h,d){if(h){if(!/^[\x00-\xFF]+$/.test(d))return d;try{const f=new TextDecoder(h,{fatal:!0}),p=Uf(d);d=f.decode(p),t=!1}catch{}}return d}function r(h){return t&&/[\x80-\xff]/.test(h)&&(h=n("utf-8",h),t&&(h=n("iso-8859-1",h))),h}function o(h){const d=[];let f;const p=s("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(f=p.exec(h))!==null;){let[,v,_,b]=f;if(v=parseInt(v,10),v in d){if(v===0)break;continue}d[v]=[_,b]}const m=[];for(let v=0;v<d.length&&v in d;++v){let[_,b]=d[v];b=a(b),_&&(b=unescape(b),v===0&&(b=c(b))),m.push(b)}return m.join("")}function a(h){if(h.startsWith('"')){const d=h.slice(1).split('\\"');for(let f=0;f<d.length;++f){const p=d[f].indexOf('"');p!==-1&&(d[f]=d[f].slice(0,p),d.length=f+1),d[f]=d[f].replaceAll(/\\(.)/g,"$1")}h=d.join('"')}return h}function c(h){const d=h.indexOf("'");if(d===-1)return h;const f=h.slice(0,d),m=h.slice(d+1).replace(/^[^']*'/,"");return n(f,m)}function u(h){return!h.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(h)?h:h.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(d,f,p,m){if(p==="q"||p==="Q")return m=m.replaceAll("_"," "),m=m.replaceAll(/=([0-9a-fA-F]{2})/g,function(v,_){return String.fromCharCode(parseInt(_,16))}),n(f,m);try{m=atob(m)}catch{}return n(f,m)})}return""}function Zy(i,t){const e=new Headers;if(!i||!t||typeof t!="object")return e;for(const s in t){const n=t[s];n!==void 0&&e.append(s,n)}return e}function Wf(i){try{return new URL(i).origin}catch{}return null}function tw({responseHeaders:i,isHttp:t,rangeChunkSize:e,disableRange:s}){const n={allowRangeRequests:!1,suggestedLength:void 0},r=parseInt(i.get("Content-Length"),10);return!Number.isInteger(r)||(n.suggestedLength=r,r<=2*e)||s||!t||i.get("Accept-Ranges")!=="bytes"||(i.get("Content-Encoding")||"identity")!=="identity"||(n.allowRangeRequests=!0),n}function ew(i){const t=i.get("Content-Disposition");if(t){let e=xE(t);if(e.includes("%"))try{e=decodeURIComponent(e)}catch{}if(Em(e))return e}return null}function qf(i,t){return i===404||i===0&&t.startsWith("file:")?new au('Missing PDF "'+t+'".'):new qd(`Unexpected server response (${i}) while retrieving PDF "${t}".`,i)}function sw(i){return i===200||i===206}function iw(i,t,e){return{method:"GET",headers:i,signal:e.signal,mode:"cors",credentials:t?"include":"same-origin",redirect:"follow"}}function nw(i){return i instanceof Uint8Array?i.buffer:i instanceof ArrayBuffer?i:(Dt(`getArrayBuffer - unexpected data format: ${i}`),new Uint8Array(i).buffer)}class bb{constructor(t){pt(this,"_responseOrigin",null);this.source=t,this.isHttp=/^https?:/i.test(t.url),this.headers=Zy(this.isHttp,t.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var t;return((t=this._fullRequestReader)==null?void 0:t._loaded)??0}getFullReader(){return Ie(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new CE(this),this._fullRequestReader}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const s=new EE(this,t,e);return this._rangeRequestReaders.push(s),s}cancelAllRequests(t){var e;(e=this._fullRequestReader)==null||e.cancel(t);for(const s of this._rangeRequestReaders.slice(0))s.cancel(t)}}class CE{constructor(t){this._stream=t,this._reader=null,this._loaded=0,this._filename=null;const e=t.source;this._withCredentials=e.withCredentials||!1,this._contentLength=e.length,this._headersCapability=Promise.withResolvers(),this._disableRange=e.disableRange||!1,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange;const s=new Headers(t.headers),n=e.url;fetch(n,iw(s,this._withCredentials,this._abortController)).then(r=>{if(t._responseOrigin=Wf(r.url),!sw(r.status))throw qf(r.status,n);this._reader=r.body.getReader(),this._headersCapability.resolve();const o=r.headers,{allowRangeRequests:a,suggestedLength:c}=tw({responseHeaders:o,isHttp:t.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=a,this._contentLength=c||this._contentLength,this._filename=ew(o),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new io("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var s;await this._headersCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:(this._loaded+=t.byteLength,(s=this.onProgress)==null||s.call(this,{loaded:this._loaded,total:this._contentLength}),{value:nw(t),done:!1})}cancel(t){var e;(e=this._reader)==null||e.cancel(t),this._abortController.abort()}}class EE{constructor(t,e,s){this._stream=t,this._reader=null,this._loaded=0;const n=t.source;this._withCredentials=n.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!n.disableStream,this._abortController=new AbortController;const r=new Headers(t.headers);r.append("Range",`bytes=${e}-${s-1}`);const o=n.url;fetch(o,iw(r,this._withCredentials,this._abortController)).then(a=>{const c=Wf(a.url);if(c!==t._responseOrigin)throw new Error(`Expected range response-origin "${c}" to match "${t._responseOrigin}".`);if(!sw(a.status))throw qf(a.status,o);this._readCapability.resolve(),this._reader=a.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var s;await this._readCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:(this._loaded+=t.byteLength,(s=this.onProgress)==null||s.call(this,{loaded:this._loaded}),{value:nw(t),done:!1})}cancel(t){var e;(e=this._reader)==null||e.cancel(t),this._abortController.abort()}}const wp=200,_p=206;function kE(i){const t=i.response;return typeof t!="string"?t:Uf(t).buffer}class TE{constructor({url:t,httpHeaders:e,withCredentials:s}){pt(this,"_responseOrigin",null);this.url=t,this.isHttp=/^https?:/i.test(t),this.headers=Zy(this.isHttp,e),this.withCredentials=s||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(t){const e=new XMLHttpRequest,s=this.currXhrId++,n=this.pendingRequests[s]={xhr:e};e.open("GET",this.url),e.withCredentials=this.withCredentials;for(const[r,o]of this.headers)e.setRequestHeader(r,o);return this.isHttp&&"begin"in t&&"end"in t?(e.setRequestHeader("Range",`bytes=${t.begin}-${t.end-1}`),n.expectedStatus=_p):n.expectedStatus=wp,e.responseType="arraybuffer",Ie(t.onError,"Expected `onError` callback to be provided."),e.onerror=()=>{t.onError(e.status)},e.onreadystatechange=this.onStateChange.bind(this,s),e.onprogress=this.onProgress.bind(this,s),n.onHeadersReceived=t.onHeadersReceived,n.onDone=t.onDone,n.onError=t.onError,n.onProgress=t.onProgress,e.send(null),s}onProgress(t,e){var n;const s=this.pendingRequests[t];s&&((n=s.onProgress)==null||n.call(s,e))}onStateChange(t,e){const s=this.pendingRequests[t];if(!s)return;const n=s.xhr;if(n.readyState>=2&&s.onHeadersReceived&&(s.onHeadersReceived(),delete s.onHeadersReceived),n.readyState!==4||!(t in this.pendingRequests))return;if(delete this.pendingRequests[t],n.status===0&&this.isHttp){s.onError(n.status);return}const r=n.status||wp;if(!(r===wp&&s.expectedStatus===_p)&&r!==s.expectedStatus){s.onError(n.status);return}const a=kE(n);if(r===_p){const c=n.getResponseHeader("Content-Range"),u=/bytes (\d+)-(\d+)\/(\d+)/.exec(c);u?s.onDone({begin:parseInt(u[1],10),chunk:a}):(Dt('Missing or invalid "Content-Range" header.'),s.onError(0))}else a?s.onDone({begin:0,chunk:a}):s.onError(n.status)}getRequestXhr(t){return this.pendingRequests[t].xhr}isPendingRequest(t){return t in this.pendingRequests}abortRequest(t){const e=this.pendingRequests[t].xhr;delete this.pendingRequests[t],e.abort()}}class PE{constructor(t){this._source=t,this._manager=new TE(t),this._rangeChunkSize=t.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(t){const e=this._rangeRequestReaders.indexOf(t);e>=0&&this._rangeRequestReaders.splice(e,1)}getFullReader(){return Ie(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new RE(this._manager,this._source),this._fullRequestReader}getRangeReader(t,e){const s=new ME(this._manager,t,e);return s.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(s),s}cancelAllRequests(t){var e;(e=this._fullRequestReader)==null||e.cancel(t);for(const s of this._rangeRequestReaders.slice(0))s.cancel(t)}}class RE{constructor(t,e){this._manager=t,this._url=e.url,this._fullRequestId=t.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=e.disableRange||!1,this._contentLength=e.length,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const t=this._fullRequestId,e=this._manager.getRequestXhr(t);this._manager._responseOrigin=Wf(e.responseURL);const s=e.getAllResponseHeaders(),n=new Headers(s?s.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(a=>{const[c,...u]=a.split(": ");return[c,u.join(": ")]}):[]),{allowRangeRequests:r,suggestedLength:o}=tw({responseHeaders:n,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});r&&(this._isRangeSupported=!0),this._contentLength=o||this._contentLength,this._filename=ew(n),this._isRangeSupported&&this._manager.abortRequest(t),this._headersCapability.resolve()}_onDone(t){if(t&&(this._requests.length>0?this._requests.shift().resolve({value:t.chunk,done:!1}):this._cachedChunks.push(t.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(t){this._storedError=qf(t,this._url),this._headersCapability.reject(this._storedError);for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(t){var e;(e=this.onProgress)==null||e.call(this,{loaded:t.loaded,total:t.lengthComputable?t.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0,this._headersCapability.reject(t);for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class ME{constructor(t,e,s){this._manager=t,this._url=t.url,this._requestId=t.request({begin:e,end:s,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){var e;const t=Wf((e=this._manager.getRequestXhr(this._requestId))==null?void 0:e.responseURL);t!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${t}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){var t;(t=this.onClosed)==null||t.call(this,this)}_onDone(t){const e=t.chunk;this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunk=e,this._done=!0;for(const s of this._requests)s.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(t){this._storedError??(this._storedError=qf(t,this._url));for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(t){var e;this.isStreamingSupported||(e=this.onProgress)==null||e.call(this,{loaded:t.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const IE=/^[a-z][a-z0-9\-+.]+:/i;function LE(i){if(IE.test(i))return new URL(i);const t=process.getBuiltinModule("url");return new URL(t.pathToFileURL(i))}class DE{constructor(t){this.source=t,this.url=LE(t.url),Ie(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var t;return((t=this._fullRequestReader)==null?void 0:t._loaded)??0}getFullReader(){return Ie(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new OE(this),this._fullRequestReader}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const s=new NE(this,t,e);return this._rangeRequestReaders.push(s),s}cancelAllRequests(t){var e;(e=this._fullRequestReader)==null||e.cancel(t);for(const s of this._rangeRequestReaders.slice(0))s.cancel(t)}}class OE{constructor(t){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null;const e=t.source;this._contentLength=e.length,this._loaded=0,this._filename=null,this._disableRange=e.disableRange||!1,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const s=process.getBuiltinModule("fs");s.promises.lstat(this._url).then(n=>{this._contentLength=n.size,this._setReadableStream(s.createReadStream(this._url)),this._headersCapability.resolve()},n=>{n.code==="ENOENT"&&(n=new au(`Missing PDF "${this._url}".`)),this._storedError=n,this._headersCapability.reject(n)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var s;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return t===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,(s=this.onProgress)==null||s.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){if(!this._readableStream){this._error(t);return}this._readableStream.destroy(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",e=>{this._error(e)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new io("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class NE{constructor(t,e,s){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const n=t.source;this._isStreamingSupported=!n.disableStream;const r=process.getBuiltinModule("fs");this._setReadableStream(r.createReadStream(this._url,{start:e,end:s-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){var s;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return t===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,(s=this.onProgress)==null||s.call(this,{loaded:this._loaded}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){if(!this._readableStream){this._error(t);return}this._readableStream.destroy(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",e=>{this._error(e)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const FE=1e5,Rs=30,$E=.8;var Ab,Or,Ds,zu,Wu,zo,Fn,qu,Xu,Wo,Sl,xl,Nr,Cl,Ku,El,qo,Yu,Ju,Xo,Ko,Qu,Fr,kl,ur,rw,ow,vg,ei,yd,bg,aw,lw;const Fe=class Fe{constructor({textContentSource:t,container:e,viewport:s}){y(this,ur);y(this,Or,Promise.withResolvers());y(this,Ds,null);y(this,zu,!1);y(this,Wu,!!((Ab=globalThis.FontInspector)!=null&&Ab.enabled));y(this,zo,null);y(this,Fn,null);y(this,qu,0);y(this,Xu,0);y(this,Wo,null);y(this,Sl,null);y(this,xl,0);y(this,Nr,0);y(this,Cl,Object.create(null));y(this,Ku,[]);y(this,El,null);y(this,qo,[]);y(this,Yu,new WeakMap);y(this,Ju,null);var c;if(t instanceof ReadableStream)g(this,El,t);else if(typeof t=="object")g(this,El,new ReadableStream({start(u){u.enqueue(t),u.close()}}));else throw new Error('No "textContentSource" parameter specified.');g(this,Ds,g(this,Sl,e)),g(this,Nr,s.scale*(globalThis.devicePixelRatio||1)),g(this,xl,s.rotation),g(this,Fn,{div:null,properties:null,ctx:null});const{pageWidth:n,pageHeight:r,pageX:o,pageY:a}=s.rawDims;g(this,Ju,[1,0,0,-1,-o,a+r]),g(this,Xu,n),g(this,qu,r),w(c=Fe,ei,aw).call(c),Ra(e,s),l(this,Or).promise.finally(()=>{l(Fe,kl).delete(this),g(this,Fn,null),g(this,Cl,null)}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:t,isFirefox:e}=Es.platform;return Bt(this,"fontFamilyMap",new Map([["sans-serif",`${t&&e?"Calibri, ":""}sans-serif`],["monospace",`${t&&e?"Lucida Console, ":""}monospace`]]))}render(){const t=()=>{l(this,Wo).read().then(({value:e,done:s})=>{if(s){l(this,Or).resolve();return}l(this,zo)??g(this,zo,e.lang),Object.assign(l(this,Cl),e.styles),w(this,ur,rw).call(this,e.items),t()},l(this,Or).reject)};return g(this,Wo,l(this,El).getReader()),l(Fe,kl).add(this),t(),l(this,Or).promise}update({viewport:t,onBefore:e=null}){var r;const s=t.scale*(globalThis.devicePixelRatio||1),n=t.rotation;if(n!==l(this,xl)&&(e==null||e(),g(this,xl,n),Ra(l(this,Sl),{rotation:n})),s!==l(this,Nr)){e==null||e(),g(this,Nr,s);const o={div:null,properties:null,ctx:w(r=Fe,ei,yd).call(r,l(this,zo))};for(const a of l(this,qo))o.properties=l(this,Yu).get(a),o.div=a,w(this,ur,vg).call(this,o)}}cancel(){var e;const t=new io("TextLayer task cancelled.");(e=l(this,Wo))==null||e.cancel(t).catch(()=>{}),g(this,Wo,null),l(this,Or).reject(t)}get textDivs(){return l(this,qo)}get textContentItemsStr(){return l(this,Ku)}static cleanup(){if(!(l(this,kl).size>0)){l(this,Xo).clear();for(const{canvas:t}of l(this,Ko).values())t.remove();l(this,Ko).clear()}}};Or=new WeakMap,Ds=new WeakMap,zu=new WeakMap,Wu=new WeakMap,zo=new WeakMap,Fn=new WeakMap,qu=new WeakMap,Xu=new WeakMap,Wo=new WeakMap,Sl=new WeakMap,xl=new WeakMap,Nr=new WeakMap,Cl=new WeakMap,Ku=new WeakMap,El=new WeakMap,qo=new WeakMap,Yu=new WeakMap,Ju=new WeakMap,Xo=new WeakMap,Ko=new WeakMap,Qu=new WeakMap,Fr=new WeakMap,kl=new WeakMap,ur=new WeakSet,rw=function(t){var n,r;if(l(this,zu))return;(r=l(this,Fn)).ctx??(r.ctx=w(n=Fe,ei,yd).call(n,l(this,zo)));const e=l(this,qo),s=l(this,Ku);for(const o of t){if(e.length>FE){Dt("Ignoring additional textDivs for performance reasons."),g(this,zu,!0);return}if(o.str===void 0){if(o.type==="beginMarkedContentProps"||o.type==="beginMarkedContent"){const a=l(this,Ds);g(this,Ds,document.createElement("span")),l(this,Ds).classList.add("markedContent"),o.id!==null&&l(this,Ds).setAttribute("id",`${o.id}`),a.append(l(this,Ds))}else o.type==="endMarkedContent"&&g(this,Ds,l(this,Ds).parentNode);continue}s.push(o.str),w(this,ur,ow).call(this,o)}},ow=function(t){var v;const e=document.createElement("span"),s={angle:0,canvasWidth:0,hasText:t.str!=="",hasEOL:t.hasEOL,fontSize:0};l(this,qo).push(e);const n=bt.transform(l(this,Ju),t.transform);let r=Math.atan2(n[1],n[0]);const o=l(this,Cl)[t.fontName];o.vertical&&(r+=Math.PI/2);let a=l(this,Wu)&&o.fontSubstitution||o.fontFamily;a=Fe.fontFamilyMap.get(a)||a;const c=Math.hypot(n[2],n[3]),u=c*w(v=Fe,ei,lw).call(v,a,l(this,zo));let h,d;r===0?(h=n[4],d=n[5]-u):(h=n[4]+u*Math.sin(r),d=n[5]-u*Math.cos(r));const f="calc(var(--scale-factor)*",p=e.style;l(this,Ds)===l(this,Sl)?(p.left=`${(100*h/l(this,Xu)).toFixed(2)}%`,p.top=`${(100*d/l(this,qu)).toFixed(2)}%`):(p.left=`${f}${h.toFixed(2)}px)`,p.top=`${f}${d.toFixed(2)}px)`),p.fontSize=`${f}${(l(Fe,Fr)*c).toFixed(2)}px)`,p.fontFamily=a,s.fontSize=c,e.setAttribute("role","presentation"),e.textContent=t.str,e.dir=t.dir,l(this,Wu)&&(e.dataset.fontName=o.fontSubstitutionLoadedName||t.fontName),r!==0&&(s.angle=r*(180/Math.PI));let m=!1;if(t.str.length>1)m=!0;else if(t.str!==" "&&t.transform[0]!==t.transform[3]){const _=Math.abs(t.transform[0]),b=Math.abs(t.transform[3]);_!==b&&Math.max(_,b)/Math.min(_,b)>1.5&&(m=!0)}if(m&&(s.canvasWidth=o.vertical?t.height:t.width),l(this,Yu).set(e,s),l(this,Fn).div=e,l(this,Fn).properties=s,w(this,ur,vg).call(this,l(this,Fn)),s.hasText&&l(this,Ds).append(e),s.hasEOL){const _=document.createElement("br");_.setAttribute("role","presentation"),l(this,Ds).append(_)}},vg=function(t){var a;const{div:e,properties:s,ctx:n}=t,{style:r}=e;let o="";if(l(Fe,Fr)>1&&(o=`scale(${1/l(Fe,Fr)})`),s.canvasWidth!==0&&s.hasText){const{fontFamily:c}=r,{canvasWidth:u,fontSize:h}=s;w(a=Fe,ei,bg).call(a,n,h*l(this,Nr),c);const{width:d}=n.measureText(e.textContent);d>0&&(o=`scaleX(${u*l(this,Nr)/d}) ${o}`)}s.angle!==0&&(o=`rotate(${s.angle}deg) ${o}`),o.length>0&&(r.transform=o)},ei=new WeakSet,yd=function(t=null){let e=l(this,Ko).get(t||(t=""));if(!e){const s=document.createElement("canvas");s.className="hiddenCanvasElement",s.lang=t,document.body.append(s),e=s.getContext("2d",{alpha:!1,willReadFrequently:!0}),l(this,Ko).set(t,e),l(this,Qu).set(e,{size:0,family:""})}return e},bg=function(t,e,s){const n=l(this,Qu).get(t);e===n.size&&s===n.family||(t.font=`${e}px ${s}`,n.size=e,n.family=s)},aw=function(){if(l(this,Fr)!==null)return;const t=document.createElement("div");t.style.opacity=0,t.style.lineHeight=1,t.style.fontSize="1px",t.style.position="absolute",t.textContent="X",document.body.append(t),g(this,Fr,t.getBoundingClientRect().height),t.remove()},lw=function(t,e){const s=l(this,Xo).get(t);if(s)return s;const n=w(this,ei,yd).call(this,e);n.canvas.width=n.canvas.height=Rs,w(this,ei,bg).call(this,n,Rs,t);const r=n.measureText("");let o=r.fontBoundingBoxAscent,a=Math.abs(r.fontBoundingBoxDescent);if(o){const h=o/(o+a);return l(this,Xo).set(t,h),n.canvas.width=n.canvas.height=0,h}n.strokeStyle="red",n.clearRect(0,0,Rs,Rs),n.strokeText("g",0,0);let c=n.getImageData(0,0,Rs,Rs).data;a=0;for(let h=c.length-1-3;h>=0;h-=4)if(c[h]>0){a=Math.ceil(h/4/Rs);break}n.clearRect(0,0,Rs,Rs),n.strokeText("A",0,Rs),c=n.getImageData(0,0,Rs,Rs).data,o=0;for(let h=0,d=c.length;h<d;h+=4)if(c[h]>0){o=Rs-Math.floor(h/4/Rs);break}n.canvas.width=n.canvas.height=0;const u=o?o/(o+a):$E;return l(this,Xo).set(t,u),u},y(Fe,ei),y(Fe,Xo,new Map),y(Fe,Ko,new Map),y(Fe,Qu,new WeakMap),y(Fe,Fr,null),y(Fe,kl,new Set);let lu=Fe;class cu{static textContent(t){const e=[],s={items:e,styles:Object.create(null)};function n(r){var c;if(!r)return;let o=null;const a=r.name;if(a==="#text")o=r.value;else if(cu.shouldBuildText(a))(c=r==null?void 0:r.attributes)!=null&&c.textContent?o=r.attributes.textContent:r.value&&(o=r.value);else return;if(o!==null&&e.push({str:o}),!!r.children)for(const u of r.children)n(u)}return n(t),s}static shouldBuildText(t){return!(t==="textarea"||t==="input"||t==="option"||t==="select")}}const BE=65536,HE=100,jE=5e3,VE=gs?sE:ZC,UE=gs?iE:qy,GE=gs?eE:tE,zE=gs?nE:Jy;function WE(i={}){typeof i=="string"||i instanceof URL?i={url:i}:(i instanceof ArrayBuffer||ArrayBuffer.isView(i))&&(i={data:i});const t=new yg,{docId:e}=t,s=i.url?qE(i.url):null,n=i.data?XE(i.data):null,r=i.httpHeaders||null,o=i.withCredentials===!0,a=i.password??null,c=i.range instanceof cw?i.range:null,u=Number.isInteger(i.rangeChunkSize)&&i.rangeChunkSize>0?i.rangeChunkSize:BE;let h=i.worker instanceof sl?i.worker:null;const d=i.verbosity,f=typeof i.docBaseUrl=="string"&&!zf(i.docBaseUrl)?i.docBaseUrl:null,p=typeof i.cMapUrl=="string"?i.cMapUrl:null,m=i.cMapPacked!==!1,v=i.CMapReaderFactory||UE,_=typeof i.standardFontDataUrl=="string"?i.standardFontDataUrl:null,b=i.StandardFontDataFactory||zE,A=i.stopAtErrors!==!0,x=Number.isInteger(i.maxImageSize)&&i.maxImageSize>-1?i.maxImageSize:-1,C=i.isEvalSupported!==!1,T=typeof i.isOffscreenCanvasSupported=="boolean"?i.isOffscreenCanvasSupported:!gs,D=typeof i.isImageDecoderSupported=="boolean"?i.isImageDecoderSupported:!gs&&(Es.platform.isFirefox||!globalThis.chrome),P=Number.isInteger(i.canvasMaxAreaInBytes)?i.canvasMaxAreaInBytes:-1,j=typeof i.disableFontFace=="boolean"?i.disableFontFace:gs,L=i.fontExtraProperties===!0,$=i.enableXfa===!0,N=i.ownerDocument||globalThis.document,I=i.disableRange===!0,F=i.disableStream===!0,Q=i.disableAutoFetch===!0,J=i.pdfBug===!0,H=i.CanvasFactory||VE,V=i.FilterFactory||GE,Z=i.enableHWA===!0,St=c?c.length:i.length??NaN,wt=typeof i.useSystemFonts=="boolean"?i.useSystemFonts:!gs&&!j,_t=typeof i.useWorkerFetch=="boolean"?i.useWorkerFetch:v===qy&&b===Jy&&p&&_&&Cc(p,document.baseURI)&&Cc(_,document.baseURI),Pt=null;MC(d);const Mt={canvasFactory:new H({ownerDocument:N,enableHWA:Z}),filterFactory:new V({docId:e,ownerDocument:N}),cMapReaderFactory:_t?null:new v({baseUrl:p,isCompressed:m}),standardFontDataFactory:_t?null:new b({baseUrl:_})};if(!h){const qt={verbosity:d,port:sr.workerPort};h=qt.port?sl.fromPort(qt):new sl(qt),t._worker=h}const Ht={docId:e,apiVersion:"4.10.38",data:n,password:a,disableAutoFetch:Q,rangeChunkSize:u,length:St,docBaseUrl:f,enableXfa:$,evaluatorOptions:{maxImageSize:x,disableFontFace:j,ignoreErrors:A,isEvalSupported:C,isOffscreenCanvasSupported:T,isImageDecoderSupported:D,canvasMaxAreaInBytes:P,fontExtraProperties:L,useSystemFonts:wt,cMapUrl:_t?p:null,standardFontDataUrl:_t?_:null}},xe={disableFontFace:j,fontExtraProperties:L,ownerDocument:N,pdfBug:J,styleElement:Pt,loadingParams:{disableAutoFetch:Q,enableXfa:$}};return h.promise.then(function(){if(t.destroyed)throw new Error("Loading aborted");if(h.destroyed)throw new Error("Worker was destroyed");const qt=h.messageHandler.sendWithPromise("GetDocRequest",Ht,n?[n.buffer]:null);let U;if(c)U=new _E(c,{disableRange:I,disableStream:F});else if(!n){if(!s)throw new Error("getDocument - no `url` parameter provided.");let nt;if(gs)if(Cc(s)){if(typeof fetch>"u"||typeof Response>"u"||!("body"in Response.prototype))throw new Error("getDocument - the Fetch API was disabled in Node.js, see `--no-experimental-fetch`.");nt=bb}else nt=DE;else nt=Cc(s)?bb:PE;U=new nt({url:s,length:St,httpHeaders:r,withCredentials:o,rangeChunkSize:u,disableRange:I,disableStream:F})}return qt.then(nt=>{if(t.destroyed)throw new Error("Loading aborted");if(h.destroyed)throw new Error("Worker was destroyed");const ot=new Pc(e,nt,h.port),ht=new QE(ot,t,U,xe,Mt);t._transport=ht,ot.send("Ready",null)})}).catch(t._capability.reject),t}function qE(i){if(i instanceof URL)return i.href;try{return new URL(i,window.location).href}catch{if(gs&&typeof i=="string")return i}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function XE(i){if(gs&&typeof Buffer<"u"&&i instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(i instanceof Uint8Array&&i.byteLength===i.buffer.byteLength)return i;if(typeof i=="string")return Uf(i);if(i instanceof ArrayBuffer||ArrayBuffer.isView(i)||typeof i=="object"&&!isNaN(i==null?void 0:i.length))return new Uint8Array(i);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function yb(i){return typeof i=="object"&&Number.isInteger(i==null?void 0:i.num)&&i.num>=0&&Number.isInteger(i==null?void 0:i.gen)&&i.gen>=0}var uf;const hf=class hf{constructor(){this._capability=Promise.withResolvers(),this._transport=null,this._worker=null,this.docId=`d${ms(hf,uf)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){var t,e,s,n;this.destroyed=!0;try{(t=this._worker)!=null&&t.port&&(this._worker._pendingDestroy=!0),await((e=this._transport)==null?void 0:e.destroy())}catch(r){throw(s=this._worker)!=null&&s.port&&delete this._worker._pendingDestroy,r}this._transport=null,(n=this._worker)==null||n.destroy(),this._worker=null}};uf=new WeakMap,y(hf,uf,0);let yg=hf;class cw{constructor(t,e,s=!1,n=null){this.length=t,this.initialData=e,this.progressiveDone=s,this.contentDispositionFilename=n,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=Promise.withResolvers()}addRangeListener(t){this._rangeListeners.push(t)}addProgressListener(t){this._progressListeners.push(t)}addProgressiveReadListener(t){this._progressiveReadListeners.push(t)}addProgressiveDoneListener(t){this._progressiveDoneListeners.push(t)}onDataRange(t,e){for(const s of this._rangeListeners)s(t,e)}onDataProgress(t,e){this._readyCapability.promise.then(()=>{for(const s of this._progressListeners)s(t,e)})}onDataProgressiveRead(t){this._readyCapability.promise.then(()=>{for(const e of this._progressiveReadListeners)e(t)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const t of this._progressiveDoneListeners)t()})}transportReady(){this._readyCapability.resolve()}requestDataRange(t,e){ae("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}class KE{constructor(t,e){this._pdfInfo=t,this._transport=e}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return Bt(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(t){return this._transport.getPage(t)}getPageIndex(t){return this._transport.getPageIndex(t)}getDestinations(){return this._transport.getDestinations()}getDestination(t){return this._transport.getDestination(t)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:t="display"}={}){const{renderingIntent:e}=this._transport.getRenderingIntent(t);return this._transport.getOptionalContentConfig(e)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(t=!1){return this._transport.startCleanup(t||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(t){return this._transport.cachedPageNumber(t)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}var $r,$n,hi,Wa,wd;class YE{constructor(t,e,s,n=!1){y(this,hi);y(this,$r,null);y(this,$n,!1);this._pageIndex=t,this._pageInfo=e,this._transport=s,this._stats=n?new rb:null,this._pdfBug=n,this.commonObjs=s.commonObjs,this.objs=new uw,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:t,rotation:e=this.rotate,offsetX:s=0,offsetY:n=0,dontFlip:r=!1}={}){return new jh({viewBox:this.view,userUnit:this.userUnit,scale:t,rotation:e,offsetX:s,offsetY:n,dontFlip:r})}getAnnotations({intent:t="display"}={}){const{renderingIntent:e}=this._transport.getRenderingIntent(t);return this._transport.getAnnotations(this._pageIndex,e)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return Bt(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var t;return((t=this._transport._htmlForXfa)==null?void 0:t.children[this._pageIndex])||null}render({canvasContext:t,viewport:e,intent:s="display",annotationMode:n=_r.ENABLE,transform:r=null,background:o=null,optionalContentConfigPromise:a=null,annotationCanvasMap:c=null,pageColors:u=null,printAnnotationStorage:h=null,isEditing:d=!1}){var C,T;(C=this._stats)==null||C.time("Overall");const f=this._transport.getRenderingIntent(s,n,h,d),{renderingIntent:p,cacheKey:m}=f;g(this,$n,!1),w(this,hi,wd).call(this),a||(a=this._transport.getOptionalContentConfig(p));let v=this._intentStates.get(m);v||(v=Object.create(null),this._intentStates.set(m,v)),v.streamReaderCancelTimeout&&(clearTimeout(v.streamReaderCancelTimeout),v.streamReaderCancelTimeout=null);const _=!!(p&Ks.PRINT);v.displayReadyCapability||(v.displayReadyCapability=Promise.withResolvers(),v.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(T=this._stats)==null||T.time("Page Request"),this._pumpOperatorList(f));const b=D=>{var P;v.renderTasks.delete(A),(this._maybeCleanupAfterRender||_)&&g(this,$n,!0),w(this,hi,Wa).call(this,!_),D?(A.capability.reject(D),this._abortOperatorList({intentState:v,reason:D instanceof Error?D:new Error(D)})):A.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),(P=globalThis.Stats)!=null&&P.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},A=new _g({callback:b,params:{canvasContext:t,viewport:e,transform:r,background:o},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:c,operatorList:v.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!_,pdfBug:this._pdfBug,pageColors:u});(v.renderTasks||(v.renderTasks=new Set)).add(A);const x=A.task;return Promise.all([v.displayReadyCapability.promise,a]).then(([D,P])=>{var j;if(this.destroyed){b();return}if((j=this._stats)==null||j.time("Rendering"),!(P.renderingIntent&p))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");A.initializeGraphics({transparency:D,optionalContentConfig:P}),A.operatorListChanged()}).catch(b),x}getOperatorList({intent:t="display",annotationMode:e=_r.ENABLE,printAnnotationStorage:s=null,isEditing:n=!1}={}){var u;function r(){a.operatorList.lastChunk&&(a.opListReadCapability.resolve(a.operatorList),a.renderTasks.delete(c))}const o=this._transport.getRenderingIntent(t,e,s,n,!0);let a=this._intentStates.get(o.cacheKey);a||(a=Object.create(null),this._intentStates.set(o.cacheKey,a));let c;return a.opListReadCapability||(c=Object.create(null),c.operatorListChanged=r,a.opListReadCapability=Promise.withResolvers(),(a.renderTasks||(a.renderTasks=new Set)).add(c),a.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(u=this._stats)==null||u.time("Page Request"),this._pumpOperatorList(o)),a.opListReadCapability.promise}streamTextContent({includeMarkedContent:t=!1,disableNormalization:e=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:t===!0,disableNormalization:e===!0},{highWaterMark:100,size(n){return n.items.length}})}getTextContent(t={}){if(this._transport._htmlForXfa)return this.getXfa().then(s=>cu.textContent(s));const e=this.streamTextContent(t);return new Promise(function(s,n){function r(){o.read().then(function({value:c,done:u}){if(u){s(a);return}a.lang??(a.lang=c.lang),Object.assign(a.styles,c.styles),a.items.push(...c.items),r()},n)}const o=e.getReader(),a={items:[],styles:Object.create(null),lang:null};r()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const t=[];for(const e of this._intentStates.values())if(this._abortOperatorList({intentState:e,reason:new Error("Page was destroyed."),force:!0}),!e.opListReadCapability)for(const s of e.renderTasks)t.push(s.completed),s.cancel();return this.objs.clear(),g(this,$n,!1),w(this,hi,wd).call(this),Promise.all(t)}cleanup(t=!1){g(this,$n,!0);const e=w(this,hi,Wa).call(this,!1);return t&&e&&this._stats&&(this._stats=new rb),e}_startRenderPage(t,e){var n,r;const s=this._intentStates.get(e);s&&((n=this._stats)==null||n.timeEnd("Page Request"),(r=s.displayReadyCapability)==null||r.resolve(t))}_renderPageChunk(t,e){for(let s=0,n=t.length;s<n;s++)e.operatorList.fnArray.push(t.fnArray[s]),e.operatorList.argsArray.push(t.argsArray[s]);e.operatorList.lastChunk=t.lastChunk,e.operatorList.separateAnnots=t.separateAnnots;for(const s of e.renderTasks)s.operatorListChanged();t.lastChunk&&w(this,hi,Wa).call(this,!0)}_pumpOperatorList({renderingIntent:t,cacheKey:e,annotationStorageSerializable:s,modifiedIds:n}){const{map:r,transfer:o}=s,c=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:t,cacheKey:e,annotationStorage:r,modifiedIds:n},o).getReader(),u=this._intentStates.get(e);u.streamReader=c;const h=()=>{c.read().then(({value:d,done:f})=>{if(f){u.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(d,u),h())},d=>{if(u.streamReader=null,!this._transport.destroyed){if(u.operatorList){u.operatorList.lastChunk=!0;for(const f of u.renderTasks)f.operatorListChanged();w(this,hi,Wa).call(this,!0)}if(u.displayReadyCapability)u.displayReadyCapability.reject(d);else if(u.opListReadCapability)u.opListReadCapability.reject(d);else throw d}})};h()}_abortOperatorList({intentState:t,reason:e,force:s=!1}){if(t.streamReader){if(t.streamReaderCancelTimeout&&(clearTimeout(t.streamReaderCancelTimeout),t.streamReaderCancelTimeout=null),!s){if(t.renderTasks.size>0)return;if(e instanceof Cm){let n=HE;e.extraDelay>0&&e.extraDelay<1e3&&(n+=e.extraDelay),t.streamReaderCancelTimeout=setTimeout(()=>{t.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:t,reason:e,force:!0})},n);return}}if(t.streamReader.cancel(new io(e.message)).catch(()=>{}),t.streamReader=null,!this._transport.destroyed){for(const[n,r]of this._intentStates)if(r===t){this._intentStates.delete(n);break}this.cleanup()}}}get stats(){return this._stats}}$r=new WeakMap,$n=new WeakMap,hi=new WeakSet,Wa=function(t=!1){if(w(this,hi,wd).call(this),!l(this,$n)||this.destroyed)return!1;if(t)return g(this,$r,setTimeout(()=>{g(this,$r,null),w(this,hi,Wa).call(this,!1)},jE)),!1;for(const{renderTasks:e,operatorList:s}of this._intentStates.values())if(e.size>0||!s.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),g(this,$n,!1),!0},wd=function(){l(this,$r)&&(clearTimeout(l(this,$r)),g(this,$r,null))};var Bn,df;class JE{constructor(){y(this,Bn,new Map);y(this,df,Promise.resolve())}postMessage(t,e){const s={data:structuredClone(t,e?{transfer:e}:null)};l(this,df).then(()=>{for(const[n]of l(this,Bn))n.call(this,s)})}addEventListener(t,e,s=null){let n=null;if((s==null?void 0:s.signal)instanceof AbortSignal){const{signal:r}=s;if(r.aborted){Dt("LoopbackPort - cannot use an `aborted` signal.");return}const o=()=>this.removeEventListener(t,e);n=()=>r.removeEventListener("abort",o),r.addEventListener("abort",o)}l(this,Bn).set(e,n)}removeEventListener(t,e){const s=l(this,Bn).get(e);s==null||s(),l(this,Bn).delete(e)}terminate(){for(const[,t]of l(this,Bn))t==null||t();l(this,Bn).clear()}}Bn=new WeakMap,df=new WeakMap;var ff,Yo,Jo,Tl,_d,Pl,Ad;const he=class he{constructor({name:t=null,port:e=null,verbosity:s=IC()}={}){y(this,Tl);var n;if(this.name=t,this.destroyed=!1,this.verbosity=s,this._readyCapability=Promise.withResolvers(),this._port=null,this._webWorker=null,this._messageHandler=null,e){if((n=l(he,Jo))!=null&&n.has(e))throw new Error("Cannot use more than one PDFWorker per port.");(l(he,Jo)||g(he,Jo,new WeakMap)).set(e,this),this._initializeFromPort(e);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(t){this._port=t,this._messageHandler=new Pc("main","worker",t),this._messageHandler.on("ready",function(){}),w(this,Tl,_d).call(this)}_initialize(){if(l(he,Yo)||l(he,Pl,Ad)){this._setupFakeWorker();return}let{workerSrc:t}=he;try{he._isSameOrigin(window.location.href,t)||(t=he._createCDNWrapper(new URL(t,window.location).href));const e=new Worker(t,{type:"module"}),s=new Pc("main","worker",e),n=()=>{r.abort(),s.destroy(),e.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},r=new AbortController;e.addEventListener("error",()=>{this._webWorker||n()},{signal:r.signal}),s.on("test",a=>{if(r.abort(),this.destroyed||!a){n();return}this._messageHandler=s,this._port=e,this._webWorker=e,w(this,Tl,_d).call(this)}),s.on("ready",a=>{if(r.abort(),this.destroyed){n();return}try{o()}catch{this._setupFakeWorker()}});const o=()=>{const a=new Uint8Array;s.send("test",a,[a.buffer])};o();return}catch{Vf("The worker has been disabled.")}this._setupFakeWorker()}_setupFakeWorker(){l(he,Yo)||(Dt("Setting up fake worker."),g(he,Yo,!0)),he._setupFakeWorkerGlobal.then(t=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const e=new JE;this._port=e;const s=`fake${ms(he,ff)._++}`,n=new Pc(s+"_worker",s,e);t.setup(n,e),this._messageHandler=new Pc(s,s+"_worker",e),w(this,Tl,_d).call(this)}).catch(t=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${t.message}".`))})}destroy(){var t,e,s;this.destroyed=!0,(t=this._webWorker)==null||t.terminate(),this._webWorker=null,(e=l(he,Jo))==null||e.delete(this._port),this._port=null,(s=this._messageHandler)==null||s.destroy(),this._messageHandler=null}static fromPort(t){var s;if(!(t!=null&&t.port))throw new Error("PDFWorker.fromPort - invalid method signature.");const e=(s=l(this,Jo))==null?void 0:s.get(t.port);if(e){if(e._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return e}return new he(t)}static get workerSrc(){if(sr.workerSrc)return sr.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return Bt(this,"_setupFakeWorkerGlobal",(async()=>l(this,Pl,Ad)?l(this,Pl,Ad):(await import(this.workerSrc)).WorkerMessageHandler)())}};ff=new WeakMap,Yo=new WeakMap,Jo=new WeakMap,Tl=new WeakSet,_d=function(){this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})},Pl=new WeakSet,Ad=function(){var t;try{return((t=globalThis.pdfjsWorker)==null?void 0:t.WorkerMessageHandler)||null}catch{return null}},y(he,Pl),y(he,ff,0),y(he,Yo,!1),y(he,Jo),gs&&(g(he,Yo,!0),sr.workerSrc||(sr.workerSrc="./pdf.worker.mjs")),he._isSameOrigin=(t,e)=>{let s;try{if(s=new URL(t),!s.origin||s.origin==="null")return!1}catch{return!1}const n=new URL(e,s);return s.origin===n.origin},he._createCDNWrapper=t=>{const e=`await import("${t}");`;return URL.createObjectURL(new Blob([e],{type:"text/javascript"}))};let sl=he;var Hn,an,Rl,Ml,jn,Qo,Dc;class QE{constructor(t,e,s,n,r){y(this,Qo);y(this,Hn,new Map);y(this,an,new Map);y(this,Rl,new Map);y(this,Ml,new Map);y(this,jn,null);this.messageHandler=t,this.loadingTask=e,this.commonObjs=new uw,this.fontLoader=new JC({ownerDocument:n.ownerDocument,styleElement:n.styleElement}),this.loadingParams=n.loadingParams,this._params=n,this.canvasFactory=r.canvasFactory,this.filterFactory=r.filterFactory,this.cMapReaderFactory=r.cMapReaderFactory,this.standardFontDataFactory=r.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=s,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.setupMessageHandler()}get annotationStorage(){return Bt(this,"annotationStorage",new Pm)}getRenderingIntent(t,e=_r.ENABLE,s=null,n=!1,r=!1){let o=Ks.DISPLAY,a=lg;switch(t){case"any":o=Ks.ANY;break;case"display":break;case"print":o=Ks.PRINT;break;default:Dt(`getRenderingIntent - invalid intent: ${t}`)}const c=o&Ks.PRINT&&s instanceof jy?s:this.annotationStorage;switch(e){case _r.DISABLE:o+=Ks.ANNOTATIONS_DISABLE;break;case _r.ENABLE:break;case _r.ENABLE_FORMS:o+=Ks.ANNOTATIONS_FORMS;break;case _r.ENABLE_STORAGE:o+=Ks.ANNOTATIONS_STORAGE,a=c.serializable;break;default:Dt(`getRenderingIntent - invalid annotationMode: ${e}`)}n&&(o+=Ks.IS_EDITING),r&&(o+=Ks.OPLIST);const{ids:u,hash:h}=c.modifiedIds,d=[o,a.hash,h];return{renderingIntent:o,cacheKey:d.join("_"),annotationStorageSerializable:a,modifiedIds:u}}destroy(){var s;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),(s=l(this,jn))==null||s.reject(new Error("Worker was destroyed during onPassword callback"));const t=[];for(const n of l(this,an).values())t.push(n._destroy());l(this,an).clear(),l(this,Rl).clear(),l(this,Ml).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const e=this.messageHandler.sendWithPromise("Terminate",null);return t.push(e),Promise.all(t).then(()=>{var n,r;this.commonObjs.clear(),this.fontLoader.clear(),l(this,Hn).clear(),this.filterFactory.destroy(),lu.cleanup(),(n=this._networkStream)==null||n.cancelAllRequests(new io("Worker was terminated.")),(r=this.messageHandler)==null||r.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:t,loadingTask:e}=this;t.on("GetReader",(s,n)=>{Ie(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=r=>{this._lastProgress={loaded:r.loaded,total:r.total}},n.onPull=()=>{this._fullReader.read().then(function({value:r,done:o}){if(o){n.close();return}Ie(r instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),n.enqueue(new Uint8Array(r),1,[r])}).catch(r=>{n.error(r)})},n.onCancel=r=>{this._fullReader.cancel(r),n.ready.catch(o=>{if(!this.destroyed)throw o})}}),t.on("ReaderHeadersReady",async s=>{var a;await this._fullReader.headersReady;const{isStreamingSupported:n,isRangeSupported:r,contentLength:o}=this._fullReader;return(!n||!r)&&(this._lastProgress&&((a=e.onProgress)==null||a.call(e,this._lastProgress)),this._fullReader.onProgress=c=>{var u;(u=e.onProgress)==null||u.call(e,{loaded:c.loaded,total:c.total})}),{isStreamingSupported:n,isRangeSupported:r,contentLength:o}}),t.on("GetRangeReader",(s,n)=>{Ie(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const r=this._networkStream.getRangeReader(s.begin,s.end);if(!r){n.close();return}n.onPull=()=>{r.read().then(function({value:o,done:a}){if(a){n.close();return}Ie(o instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),n.enqueue(new Uint8Array(o),1,[o])}).catch(o=>{n.error(o)})},n.onCancel=o=>{r.cancel(o),n.ready.catch(a=>{if(!this.destroyed)throw a})}}),t.on("GetDoc",({pdfInfo:s})=>{this._numPages=s.numPages,this._htmlForXfa=s.htmlForXfa,delete s.htmlForXfa,e._capability.resolve(new KE(s,this))}),t.on("DocException",s=>{e._capability.reject(Ms(s))}),t.on("PasswordRequest",s=>{g(this,jn,Promise.withResolvers());try{if(!e.onPassword)throw Ms(s);const n=r=>{r instanceof Error?l(this,jn).reject(r):l(this,jn).resolve({password:r})};e.onPassword(n,s.code)}catch(n){l(this,jn).reject(n)}return l(this,jn).promise}),t.on("DataLoaded",s=>{var n;(n=e.onProgress)==null||n.call(e,{loaded:s.length,total:s.length}),this.downloadInfoCapability.resolve(s)}),t.on("StartRenderPage",s=>{if(this.destroyed)return;l(this,an).get(s.pageIndex)._startRenderPage(s.transparency,s.cacheKey)}),t.on("commonobj",([s,n,r])=>{var o;if(this.destroyed||this.commonObjs.has(s))return null;switch(n){case"Font":const{disableFontFace:a,fontExtraProperties:c,pdfBug:u}=this._params;if("error"in r){const p=r.error;Dt(`Error during font loading: ${p}`),this.commonObjs.resolve(s,p);break}const h=u&&((o=globalThis.FontInspector)!=null&&o.enabled)?(p,m)=>globalThis.FontInspector.fontAdded(p,m):null,d=new QC(r,{disableFontFace:a,fontExtraProperties:c,inspectFont:h});this.fontLoader.bind(d).catch(()=>t.sendWithPromise("FontFallback",{id:s})).finally(()=>{!c&&d.data&&(d.data=null),this.commonObjs.resolve(s,d)});break;case"CopyLocalImage":const{imageRef:f}=r;Ie(f,"The imageRef must be defined.");for(const p of l(this,an).values())for(const[,m]of p.objs)if((m==null?void 0:m.ref)===f)return m.dataLen?(this.commonObjs.resolve(s,structuredClone(m)),m.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(s,r);break;default:throw new Error(`Got unknown common object type ${n}`)}return null}),t.on("obj",([s,n,r,o])=>{var c;if(this.destroyed)return;const a=l(this,an).get(n);if(!a.objs.has(s)){if(a._intentStates.size===0){(c=o==null?void 0:o.bitmap)==null||c.close();return}switch(r){case"Image":a.objs.resolve(s,o),(o==null?void 0:o.dataLen)>kC&&(a._maybeCleanupAfterRender=!0);break;case"Pattern":a.objs.resolve(s,o);break;default:throw new Error(`Got unknown object type ${r}`)}}}),t.on("DocProgress",s=>{var n;this.destroyed||(n=e.onProgress)==null||n.call(e,{loaded:s.loaded,total:s.total})}),t.on("FetchBuiltInCMap",async s=>{if(this.destroyed)throw new Error("Worker was destroyed.");if(!this.cMapReaderFactory)throw new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter.");return this.cMapReaderFactory.fetch(s)}),t.on("FetchStandardFontData",async s=>{if(this.destroyed)throw new Error("Worker was destroyed.");if(!this.standardFontDataFactory)throw new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.");return this.standardFontDataFactory.fetch(s)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var s;this.annotationStorage.size<=0&&Dt("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:t,transfer:e}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:t,filename:((s=this._fullReader)==null?void 0:s.filename)??null},e).finally(()=>{this.annotationStorage.resetModified()})}getPage(t){if(!Number.isInteger(t)||t<=0||t>this._numPages)return Promise.reject(new Error("Invalid page request."));const e=t-1,s=l(this,Rl).get(e);if(s)return s;const n=this.messageHandler.sendWithPromise("GetPage",{pageIndex:e}).then(r=>{if(this.destroyed)throw new Error("Transport destroyed");r.refStr&&l(this,Ml).set(r.refStr,t);const o=new YE(e,r,this,this._params.pdfBug);return l(this,an).set(e,o),o});return l(this,Rl).set(e,n),n}getPageIndex(t){return yb(t)?this.messageHandler.sendWithPromise("GetPageIndex",{num:t.num,gen:t.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(t,e){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:t,intent:e})}getFieldObjects(){return w(this,Qo,Dc).call(this,"GetFieldObjects")}hasJSActions(){return w(this,Qo,Dc).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(t){return typeof t!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:t})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return w(this,Qo,Dc).call(this,"GetDocJSActions")}getPageJSActions(t){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:t})}getStructTree(t){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:t})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(t){return w(this,Qo,Dc).call(this,"GetOptionalContentConfig").then(e=>new wE(e,t))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const t="GetMetadata",e=l(this,Hn).get(t);if(e)return e;const s=this.messageHandler.sendWithPromise(t,null).then(n=>{var r,o;return{info:n[0],metadata:n[1]?new bE(n[1]):null,contentDispositionFilename:((r=this._fullReader)==null?void 0:r.filename)??null,contentLength:((o=this._fullReader)==null?void 0:o.contentLength)??null}});return l(this,Hn).set(t,s),s}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(t=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const e of l(this,an).values())if(!e.cleanup())throw new Error(`startCleanup: Page ${e.pageNumber} is currently rendering.`);this.commonObjs.clear(),t||this.fontLoader.clear(),l(this,Hn).clear(),this.filterFactory.destroy(!0),lu.cleanup()}}cachedPageNumber(t){if(!yb(t))return null;const e=t.gen===0?`${t.num}R`:`${t.num}R${t.gen}`;return l(this,Ml).get(e)??null}}Hn=new WeakMap,an=new WeakMap,Rl=new WeakMap,Ml=new WeakMap,jn=new WeakMap,Qo=new WeakSet,Dc=function(t,e=null){const s=l(this,Hn).get(t);if(s)return s;const n=this.messageHandler.sendWithPromise(t,e);return l(this,Hn).set(t,n),n};const _c=Symbol("INITIAL_DATA");var Hs,Zu,wg;class uw{constructor(){y(this,Zu);y(this,Hs,Object.create(null))}get(t,e=null){if(e){const n=w(this,Zu,wg).call(this,t);return n.promise.then(()=>e(n.data)),null}const s=l(this,Hs)[t];if(!s||s.data===_c)throw new Error(`Requesting object that isn't resolved yet ${t}.`);return s.data}has(t){const e=l(this,Hs)[t];return!!e&&e.data!==_c}delete(t){const e=l(this,Hs)[t];return!e||e.data===_c?!1:(delete l(this,Hs)[t],!0)}resolve(t,e=null){const s=w(this,Zu,wg).call(this,t);s.data=e,s.resolve()}clear(){var t;for(const e in l(this,Hs)){const{data:s}=l(this,Hs)[e];(t=s==null?void 0:s.bitmap)==null||t.close()}g(this,Hs,Object.create(null))}*[Symbol.iterator](){for(const t in l(this,Hs)){const{data:e}=l(this,Hs)[t];e!==_c&&(yield[t,e])}}}Hs=new WeakMap,Zu=new WeakSet,wg=function(t){var e;return(e=l(this,Hs))[t]||(e[t]={...Promise.withResolvers(),data:_c})};var Br;class ZE{constructor(t){y(this,Br,null);g(this,Br,t),this.onContinue=null}get promise(){return l(this,Br).capability.promise}cancel(t=0){l(this,Br).cancel(null,t)}get separateAnnots(){const{separateAnnots:t}=l(this,Br).operatorList;if(!t)return!1;const{annotationCanvasMap:e}=l(this,Br);return t.form||t.canvas&&(e==null?void 0:e.size)>0}}Br=new WeakMap;var Hr,Zo;const yo=class yo{constructor({callback:t,params:e,objs:s,commonObjs:n,annotationCanvasMap:r,operatorList:o,pageIndex:a,canvasFactory:c,filterFactory:u,useRequestAnimationFrame:h=!1,pdfBug:d=!1,pageColors:f=null}){y(this,Hr,null);this.callback=t,this.params=e,this.objs=s,this.commonObjs=n,this.annotationCanvasMap=r,this.operatorListIdx=null,this.operatorList=o,this._pageIndex=a,this.canvasFactory=c,this.filterFactory=u,this._pdfBug=d,this.pageColors=f,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=h===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new ZE(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=e.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:t=!1,optionalContentConfig:e}){var a,c;if(this.cancelled)return;if(this._canvas){if(l(yo,Zo).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");l(yo,Zo).add(this._canvas)}this._pdfBug&&((a=globalThis.StepperManager)!=null&&a.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:s,viewport:n,transform:r,background:o}=this.params;this.gfx=new el(s,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:e},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:r,viewport:n,transparency:t,background:o}),this.operatorListIdx=0,this.graphicsReady=!0,(c=this.graphicsReadyCallback)==null||c.call(this)}cancel(t=null,e=0){var s;this.running=!1,this.cancelled=!0,(s=this.gfx)==null||s.endDrawing(),l(this,Hr)&&(window.cancelAnimationFrame(l(this,Hr)),g(this,Hr,null)),l(yo,Zo).delete(this._canvas),this.callback(t||new Cm(`Rendering cancelled, page ${this._pageIndex+1}`,e))}operatorListChanged(){var t;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(t=this.stepper)==null||t.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?g(this,Hr,window.requestAnimationFrame(()=>{g(this,Hr,null),this._nextBound().catch(this._cancelBound)})):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),l(yo,Zo).delete(this._canvas),this.callback())))}};Hr=new WeakMap,Zo=new WeakMap,y(yo,Zo,new WeakSet);let _g=yo;const t2="4.10.38",e2="f9bea397f";function wb(i){return Math.floor(Math.max(0,Math.min(1,i))*255).toString(16).padStart(2,"0")}function Ac(i){return Math.max(0,Math.min(255,255*i))}class _b{static CMYK_G([t,e,s,n]){return["G",1-Math.min(1,.3*t+.59*s+.11*e+n)]}static G_CMYK([t]){return["CMYK",0,0,0,1-t]}static G_RGB([t]){return["RGB",t,t,t]}static G_rgb([t]){return t=Ac(t),[t,t,t]}static G_HTML([t]){const e=wb(t);return`#${e}${e}${e}`}static RGB_G([t,e,s]){return["G",.3*t+.59*e+.11*s]}static RGB_rgb(t){return t.map(Ac)}static RGB_HTML(t){return`#${t.map(wb).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([t,e,s,n]){return["RGB",1-Math.min(1,t+n),1-Math.min(1,s+n),1-Math.min(1,e+n)]}static CMYK_rgb([t,e,s,n]){return[Ac(1-Math.min(1,t+n)),Ac(1-Math.min(1,s+n)),Ac(1-Math.min(1,e+n))]}static CMYK_HTML(t){const e=this.CMYK_RGB(t).slice(1);return this.RGB_HTML(e)}static RGB_CMYK([t,e,s]){const n=1-t,r=1-e,o=1-s,a=Math.min(n,r,o);return["CMYK",n,r,o,a]}}class s2{create(t,e,s=!1){if(t<=0||e<=0)throw new Error("Invalid SVG dimensions");const n=this._createSVG("svg:svg");return n.setAttribute("version","1.1"),s||(n.setAttribute("width",`${t}px`),n.setAttribute("height",`${e}px`)),n.setAttribute("preserveAspectRatio","none"),n.setAttribute("viewBox",`0 0 ${t} ${e}`),n}createElement(t){if(typeof t!="string")throw new Error("Invalid SVG element type");return this._createSVG(t)}_createSVG(t){ae("Abstract method `_createSVG` called.")}}class Mm extends s2{_createSVG(t){return document.createElementNS(_n,t)}}class hw{static setupStorage(t,e,s,n,r){const o=n.getValue(e,{value:null});switch(s.name){case"textarea":if(o.value!==null&&(t.textContent=o.value),r==="print")break;t.addEventListener("input",a=>{n.setValue(e,{value:a.target.value})});break;case"input":if(s.attributes.type==="radio"||s.attributes.type==="checkbox"){if(o.value===s.attributes.xfaOn?t.setAttribute("checked",!0):o.value===s.attributes.xfaOff&&t.removeAttribute("checked"),r==="print")break;t.addEventListener("change",a=>{n.setValue(e,{value:a.target.checked?a.target.getAttribute("xfaOn"):a.target.getAttribute("xfaOff")})})}else{if(o.value!==null&&t.setAttribute("value",o.value),r==="print")break;t.addEventListener("input",a=>{n.setValue(e,{value:a.target.value})})}break;case"select":if(o.value!==null){t.setAttribute("value",o.value);for(const a of s.children)a.attributes.value===o.value?a.attributes.selected=!0:a.attributes.hasOwnProperty("selected")&&delete a.attributes.selected}t.addEventListener("input",a=>{const c=a.target.options,u=c.selectedIndex===-1?"":c[c.selectedIndex].value;n.setValue(e,{value:u})});break}}static setAttributes({html:t,element:e,storage:s=null,intent:n,linkService:r}){const{attributes:o}=e,a=t instanceof HTMLAnchorElement;o.type==="radio"&&(o.name=`${o.name}-${n}`);for(const[c,u]of Object.entries(o))if(u!=null)switch(c){case"class":u.length&&t.setAttribute(c,u.join(" "));break;case"dataId":break;case"id":t.setAttribute("data-element-id",u);break;case"style":Object.assign(t.style,u);break;case"textContent":t.textContent=u;break;default:(!a||c!=="href"&&c!=="newWindow")&&t.setAttribute(c,u)}a&&r.addLinkAttributes(t,o.href,o.newWindow),s&&o.dataId&&this.setupStorage(t,o.dataId,e,s)}static render(t){var d,f;const e=t.annotationStorage,s=t.linkService,n=t.xfaHtml,r=t.intent||"display",o=document.createElement(n.name);n.attributes&&this.setAttributes({html:o,element:n,intent:r,linkService:s});const a=r!=="richText",c=t.div;if(c.append(o),t.viewport){const p=`matrix(${t.viewport.transform.join(",")})`;c.style.transform=p}a&&c.setAttribute("class","xfaLayer xfaFont");const u=[];if(n.children.length===0){if(n.value){const p=document.createTextNode(n.value);o.append(p),a&&cu.shouldBuildText(n.name)&&u.push(p)}return{textDivs:u}}const h=[[n,-1,o]];for(;h.length>0;){const[p,m,v]=h.at(-1);if(m+1===p.children.length){h.pop();continue}const _=p.children[++h.at(-1)[1]];if(_===null)continue;const{name:b}=_;if(b==="#text"){const x=document.createTextNode(_.value);u.push(x),v.append(x);continue}const A=(d=_==null?void 0:_.attributes)!=null&&d.xmlns?document.createElementNS(_.attributes.xmlns,b):document.createElement(b);if(v.append(A),_.attributes&&this.setAttributes({html:A,element:_,storage:e,intent:r,linkService:s}),((f=_.children)==null?void 0:f.length)>0)h.push([_,-1,A]);else if(_.value){const x=document.createTextNode(_.value);a&&cu.shouldBuildText(b)&&u.push(x),A.append(x)}}for(const p of c.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))p.setAttribute("readOnly",!0);return{textDivs:u}}static update(t){const e=`matrix(${t.viewport.transform.join(",")})`;t.div.style.transform=e,t.div.hidden=!1}}const Uh=1e3,i2=9,Ia=new WeakSet;function to(i){return{width:i[2]-i[0],height:i[3]-i[1]}}class n2{static create(t){switch(t.data.annotationType){case Ne.LINK:return new dw(t);case Ne.TEXT:return new r2(t);case Ne.WIDGET:switch(t.data.fieldType){case"Tx":return new o2(t);case"Btn":return t.data.radioButton?new gw(t):t.data.checkBox?new l2(t):new c2(t);case"Ch":return new u2(t);case"Sig":return new a2(t)}return new Da(t);case Ne.POPUP:return new Sg(t);case Ne.FREETEXT:return new ww(t);case Ne.LINE:return new d2(t);case Ne.SQUARE:return new f2(t);case Ne.CIRCLE:return new p2(t);case Ne.POLYLINE:return new _w(t);case Ne.CARET:return new m2(t);case Ne.INK:return new Im(t);case Ne.POLYGON:return new g2(t);case Ne.HIGHLIGHT:return new Aw(t);case Ne.UNDERLINE:return new v2(t);case Ne.SQUIGGLY:return new b2(t);case Ne.STRIKEOUT:return new y2(t);case Ne.STAMP:return new Sw(t);case Ne.FILEATTACHMENT:return new w2(t);default:return new Pe(t)}}}var ta,Il,Ll,th,Ag;const Fm=class Fm{constructor(t,{isRenderable:e=!1,ignoreBorder:s=!1,createQuadrilaterals:n=!1}={}){y(this,th);y(this,ta,null);y(this,Il,!1);y(this,Ll,null);this.isRenderable=e,this.data=t.data,this.layer=t.layer,this.linkService=t.linkService,this.downloadManager=t.downloadManager,this.imageResourcesPath=t.imageResourcesPath,this.renderForms=t.renderForms,this.svgFactory=t.svgFactory,this.annotationStorage=t.annotationStorage,this.enableScripting=t.enableScripting,this.hasJSActions=t.hasJSActions,this._fieldObjects=t.fieldObjects,this.parent=t.parent,e&&(this.container=this._createContainer(s)),n&&this._createQuadrilaterals()}static _hasPopupData({titleObj:t,contentsObj:e,richText:s}){return!!(t!=null&&t.str||e!=null&&e.str||s!=null&&s.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return Fm._hasPopupData(this.data)}updateEdited(t){var s;if(!this.container)return;l(this,ta)||g(this,ta,{rect:this.data.rect.slice(0)});const{rect:e}=t;e&&w(this,th,Ag).call(this,e),(s=l(this,Ll))==null||s.popup.updateEdited(t)}resetEdited(){var t;l(this,ta)&&(w(this,th,Ag).call(this,l(this,ta).rect),(t=l(this,Ll))==null||t.popup.resetEdited(),g(this,ta,null))}_createContainer(t){const{data:e,parent:{page:s,viewport:n}}=this,r=document.createElement("section");r.setAttribute("data-annotation-id",e.id),this instanceof Da||(r.tabIndex=Uh);const{style:o}=r;if(o.zIndex=this.parent.zIndex++,e.alternativeText&&(r.title=e.alternativeText),e.noRotate&&r.classList.add("norotate"),!e.rect||this instanceof Sg){const{rotation:v}=e;return!e.hasOwnCanvas&&v!==0&&this.setRotation(v,r),r}const{width:a,height:c}=to(e.rect);if(!t&&e.borderStyle.width>0){o.borderWidth=`${e.borderStyle.width}px`;const v=e.borderStyle.horizontalCornerRadius,_=e.borderStyle.verticalCornerRadius;if(v>0||_>0){const A=`calc(${v}px * var(--scale-factor)) / calc(${_}px * var(--scale-factor))`;o.borderRadius=A}else if(this instanceof gw){const A=`calc(${a}px * var(--scale-factor)) / calc(${c}px * var(--scale-factor))`;o.borderRadius=A}switch(e.borderStyle.style){case yc.SOLID:o.borderStyle="solid";break;case yc.DASHED:o.borderStyle="dashed";break;case yc.BEVELED:Dt("Unimplemented border style: beveled");break;case yc.INSET:Dt("Unimplemented border style: inset");break;case yc.UNDERLINE:o.borderBottomStyle="solid";break}const b=e.borderColor||null;b?(g(this,Il,!0),o.borderColor=bt.makeHexColor(b[0]|0,b[1]|0,b[2]|0)):o.borderWidth=0}const u=bt.normalizeRect([e.rect[0],s.view[3]-e.rect[1]+s.view[1],e.rect[2],s.view[3]-e.rect[3]+s.view[1]]),{pageWidth:h,pageHeight:d,pageX:f,pageY:p}=n.rawDims;o.left=`${100*(u[0]-f)/h}%`,o.top=`${100*(u[1]-p)/d}%`;const{rotation:m}=e;return e.hasOwnCanvas||m===0?(o.width=`${100*a/h}%`,o.height=`${100*c/d}%`):this.setRotation(m,r),r}setRotation(t,e=this.container){if(!this.data.rect)return;const{pageWidth:s,pageHeight:n}=this.parent.viewport.rawDims,{width:r,height:o}=to(this.data.rect);let a,c;t%180===0?(a=100*r/s,c=100*o/n):(a=100*o/s,c=100*r/n),e.style.width=`${a}%`,e.style.height=`${c}%`,e.setAttribute("data-main-rotation",(360-t)%360)}get _commonActions(){const t=(e,s,n)=>{const r=n.detail[e],o=r[0],a=r.slice(1);n.target.style[s]=_b[`${o}_HTML`](a),this.annotationStorage.setValue(this.data.id,{[s]:_b[`${o}_rgb`](a)})};return Bt(this,"_commonActions",{display:e=>{const{display:s}=e.detail,n=s%2===1;this.container.style.visibility=n?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:n,noPrint:s===1||s===2})},print:e=>{this.annotationStorage.setValue(this.data.id,{noPrint:!e.detail.print})},hidden:e=>{const{hidden:s}=e.detail;this.container.style.visibility=s?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:s,noView:s})},focus:e=>{setTimeout(()=>e.target.focus({preventScroll:!1}),0)},userName:e=>{e.target.title=e.detail.userName},readonly:e=>{e.target.disabled=e.detail.readonly},required:e=>{this._setRequired(e.target,e.detail.required)},bgColor:e=>{t("bgColor","backgroundColor",e)},fillColor:e=>{t("fillColor","backgroundColor",e)},fgColor:e=>{t("fgColor","color",e)},textColor:e=>{t("textColor","color",e)},borderColor:e=>{t("borderColor","borderColor",e)},strokeColor:e=>{t("strokeColor","borderColor",e)},rotation:e=>{const s=e.detail.rotation;this.setRotation(s),this.annotationStorage.setValue(this.data.id,{rotation:s})}})}_dispatchEventFromSandbox(t,e){const s=this._commonActions;for(const n of Object.keys(e.detail)){const r=t[n]||s[n];r==null||r(e)}}_setDefaultPropertiesFromJS(t){if(!this.enableScripting)return;const e=this.annotationStorage.getRawValue(this.data.id);if(!e)return;const s=this._commonActions;for(const[n,r]of Object.entries(e)){const o=s[n];if(o){const a={detail:{[n]:r},target:t};o(a),delete e[n]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:t}=this.data;if(!t)return;const[e,s,n,r]=this.data.rect.map(v=>Math.fround(v));if(t.length===8){const[v,_,b,A]=t.subarray(2,6);if(n===v&&r===_&&e===b&&s===A)return}const{style:o}=this.container;let a;if(l(this,Il)){const{borderColor:v,borderWidth:_}=o;o.borderWidth=0,a=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${v}" stroke-width="${_}">`],this.container.classList.add("hasBorder")}const c=n-e,u=r-s,{svgFactory:h}=this,d=h.createElement("svg");d.classList.add("quadrilateralsContainer"),d.setAttribute("width",0),d.setAttribute("height",0);const f=h.createElement("defs");d.append(f);const p=h.createElement("clipPath"),m=`clippath_${this.data.id}`;p.setAttribute("id",m),p.setAttribute("clipPathUnits","objectBoundingBox"),f.append(p);for(let v=2,_=t.length;v<_;v+=8){const b=t[v],A=t[v+1],x=t[v+2],C=t[v+3],T=h.createElement("rect"),D=(x-e)/c,P=(r-A)/u,j=(b-x)/c,L=(A-C)/u;T.setAttribute("x",D),T.setAttribute("y",P),T.setAttribute("width",j),T.setAttribute("height",L),p.append(T),a==null||a.push(`<rect vector-effect="non-scaling-stroke" x="${D}" y="${P}" width="${j}" height="${L}"/>`)}l(this,Il)&&(a.push("</g></svg>')"),o.backgroundImage=a.join("")),this.container.append(d),this.container.style.clipPath=`url(#${m})`}_createPopup(){const{data:t}=this,e=g(this,Ll,new Sg({data:{color:t.color,titleObj:t.titleObj,modificationDate:t.modificationDate,contentsObj:t.contentsObj,richText:t.richText,parentRect:t.rect,borderStyle:0,id:`popup_${t.id}`,rotation:t.rotation},parent:this.parent,elements:[this]}));this.parent.div.append(e.render())}render(){ae("Abstract method `AnnotationElement.render` called")}_getElementsByName(t,e=null){const s=[];if(this._fieldObjects){const n=this._fieldObjects[t];if(n)for(const{page:r,id:o,exportValues:a}of n){if(r===-1||o===e)continue;const c=typeof a=="string"?a:null,u=document.querySelector(`[data-element-id="${o}"]`);if(u&&!Ia.has(u)){Dt(`_getElementsByName - element not allowed: ${o}`);continue}s.push({id:o,exportValue:c,domElement:u})}return s}for(const n of document.getElementsByName(t)){const{exportValue:r}=n,o=n.getAttribute("data-element-id");o!==e&&Ia.has(n)&&s.push({id:o,exportValue:r,domElement:n})}return s}show(){var t;this.container&&(this.container.hidden=!1),(t=this.popup)==null||t.maybeShow()}hide(){var t;this.container&&(this.container.hidden=!0),(t=this.popup)==null||t.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const t=this.getElementsToTriggerPopup();if(Array.isArray(t))for(const e of t)e.classList.add("highlightArea");else t.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:t,data:{id:e}}=this;this.container.addEventListener("dblclick",()=>{var s;(s=this.linkService.eventBus)==null||s.dispatch("switchannotationeditormode",{source:this,mode:t,editId:e})})}};ta=new WeakMap,Il=new WeakMap,Ll=new WeakMap,th=new WeakSet,Ag=function(t){const{container:{style:e},data:{rect:s,rotation:n},parent:{viewport:{rawDims:{pageWidth:r,pageHeight:o,pageX:a,pageY:c}}}}=this;s==null||s.splice(0,4,...t);const{width:u,height:h}=to(t);e.left=`${100*(t[0]-a)/r}%`,e.top=`${100*(o-t[3]+c)/o}%`,n===0?(e.width=`${100*u/r}%`,e.height=`${100*h/o}%`):this.setRotation(n)};let Pe=Fm;var Ys,po,fw,pw;class dw extends Pe{constructor(e,s=null){super(e,{isRenderable:!0,ignoreBorder:!!(s!=null&&s.ignoreBorder),createQuadrilaterals:!0});y(this,Ys);this.isTooltipOnly=e.data.isTooltipOnly}render(){const{data:e,linkService:s}=this,n=document.createElement("a");n.setAttribute("data-element-id",e.id);let r=!1;return e.url?(s.addLinkAttributes(n,e.url,e.newWindow),r=!0):e.action?(this._bindNamedAction(n,e.action),r=!0):e.attachment?(w(this,Ys,fw).call(this,n,e.attachment,e.attachmentDest),r=!0):e.setOCGState?(w(this,Ys,pw).call(this,n,e.setOCGState),r=!0):e.dest?(this._bindLink(n,e.dest),r=!0):(e.actions&&(e.actions.Action||e.actions["Mouse Up"]||e.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(n,e),r=!0),e.resetForm?(this._bindResetFormAction(n,e.resetForm),r=!0):this.isTooltipOnly&&!r&&(this._bindLink(n,""),r=!0)),this.container.classList.add("linkAnnotation"),r&&this.container.append(n),this.container}_bindLink(e,s){e.href=this.linkService.getDestinationHash(s),e.onclick=()=>(s&&this.linkService.goToDestination(s),!1),(s||s==="")&&w(this,Ys,po).call(this)}_bindNamedAction(e,s){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeNamedAction(s),!1),w(this,Ys,po).call(this)}_bindJSAction(e,s){e.href=this.linkService.getAnchorUrl("");const n=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const r of Object.keys(s.actions)){const o=n.get(r);o&&(e[o]=()=>{var a;return(a=this.linkService.eventBus)==null||a.dispatch("dispatcheventinsandbox",{source:this,detail:{id:s.id,name:r}}),!1})}e.onclick||(e.onclick=()=>!1),w(this,Ys,po).call(this)}_bindResetFormAction(e,s){const n=e.onclick;if(n||(e.href=this.linkService.getAnchorUrl("")),w(this,Ys,po).call(this),!this._fieldObjects){Dt('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),n||(e.onclick=()=>!1);return}e.onclick=()=>{var d;n==null||n();const{fields:r,refs:o,include:a}=s,c=[];if(r.length!==0||o.length!==0){const f=new Set(o);for(const p of r){const m=this._fieldObjects[p]||[];for(const{id:v}of m)f.add(v)}for(const p of Object.values(this._fieldObjects))for(const m of p)f.has(m.id)===a&&c.push(m)}else for(const f of Object.values(this._fieldObjects))c.push(...f);const u=this.annotationStorage,h=[];for(const f of c){const{id:p}=f;switch(h.push(p),f.type){case"text":{const v=f.defaultValue||"";u.setValue(p,{value:v});break}case"checkbox":case"radiobutton":{const v=f.defaultValue===f.exportValues;u.setValue(p,{value:v});break}case"combobox":case"listbox":{const v=f.defaultValue||"";u.setValue(p,{value:v});break}default:continue}const m=document.querySelector(`[data-element-id="${p}"]`);if(m){if(!Ia.has(m)){Dt(`_bindResetFormAction - element not allowed: ${p}`);continue}}else continue;m.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((d=this.linkService.eventBus)==null||d.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:h,name:"ResetForm"}})),!1}}}Ys=new WeakSet,po=function(){this.container.setAttribute("data-internal-link","")},fw=function(e,s,n=null){e.href=this.linkService.getAnchorUrl(""),s.description&&(e.title=s.description),e.onclick=()=>{var r;return(r=this.downloadManager)==null||r.openOrDownloadData(s.content,s.filename,n),!1},w(this,Ys,po).call(this)},pw=function(e,s){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeSetOCGState(s),!1),w(this,Ys,po).call(this)};class r2 extends Pe{constructor(t){super(t,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const t=document.createElement("img");return t.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",t.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),t.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(t),this.container}}class Da extends Pe{render(){return this.container}showElementAndHideCanvas(t){var e;this.data.hasOwnCanvas&&(((e=t.previousSibling)==null?void 0:e.nodeName)==="CANVAS"&&(t.previousSibling.hidden=!0),t.hidden=!1)}_getKeyModifier(t){return Es.platform.isMac?t.metaKey:t.ctrlKey}_setEventListener(t,e,s,n,r){s.includes("mouse")?t.addEventListener(s,o=>{var a;(a=this.linkService.eventBus)==null||a.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:n,value:r(o),shift:o.shiftKey,modifier:this._getKeyModifier(o)}})}):t.addEventListener(s,o=>{var a;if(s==="blur"){if(!e.focused||!o.relatedTarget)return;e.focused=!1}else if(s==="focus"){if(e.focused)return;e.focused=!0}r&&((a=this.linkService.eventBus)==null||a.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:n,value:r(o)}}))})}_setEventListeners(t,e,s,n){var r,o,a;for(const[c,u]of s)(u==="Action"||(r=this.data.actions)!=null&&r[u])&&((u==="Focus"||u==="Blur")&&(e||(e={focused:!1})),this._setEventListener(t,e,c,u,n),u==="Focus"&&!((o=this.data.actions)!=null&&o.Blur)?this._setEventListener(t,e,"blur","Blur",null):u==="Blur"&&!((a=this.data.actions)!=null&&a.Focus)&&this._setEventListener(t,e,"focus","Focus",null))}_setBackgroundColor(t){const e=this.data.backgroundColor||null;t.style.backgroundColor=e===null?"transparent":bt.makeHexColor(e[0],e[1],e[2])}_setTextStyle(t){const e=["left","center","right"],{fontColor:s}=this.data.defaultAppearanceData,n=this.data.defaultAppearanceData.fontSize||i2,r=t.style;let o;const a=2,c=u=>Math.round(10*u)/10;if(this.data.multiLine){const u=Math.abs(this.data.rect[3]-this.data.rect[1]-a),h=Math.round(u/(gp*n))||1,d=u/h;o=Math.min(n,c(d/gp))}else{const u=Math.abs(this.data.rect[3]-this.data.rect[1]-a);o=Math.min(n,c(u/gp))}r.fontSize=`calc(${o}px * var(--scale-factor))`,r.color=bt.makeHexColor(s[0],s[1],s[2]),this.data.textAlignment!==null&&(r.textAlign=e[this.data.textAlignment])}_setRequired(t,e){e?t.setAttribute("required",!0):t.removeAttribute("required"),t.setAttribute("aria-required",e)}}class o2 extends Da{constructor(t){const e=t.renderForms||t.data.hasOwnCanvas||!t.data.hasAppearance&&!!t.data.fieldValue;super(t,{isRenderable:e})}setPropertyOnSiblings(t,e,s,n){const r=this.annotationStorage;for(const o of this._getElementsByName(t.name,t.id))o.domElement&&(o.domElement[e]=s),r.setValue(o.id,{[n]:s})}render(){var n,r;const t=this.annotationStorage,e=this.data.id;this.container.classList.add("textWidgetAnnotation");let s=null;if(this.renderForms){const o=t.getValue(e,{value:this.data.fieldValue});let a=o.value||"";const c=t.getValue(e,{charLimit:this.data.maxLen}).charLimit;c&&a.length>c&&(a=a.slice(0,c));let u=o.formattedValue||((n=this.data.textContent)==null?void 0:n.join(`
`))||null;u&&this.data.comb&&(u=u.replaceAll(/\s+/g,""));const h={userValue:a,formattedValue:u,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(s=document.createElement("textarea"),s.textContent=u??a,this.data.doNotScroll&&(s.style.overflowY="hidden")):(s=document.createElement("input"),s.type="text",s.setAttribute("value",u??a),this.data.doNotScroll&&(s.style.overflowX="hidden")),this.data.hasOwnCanvas&&(s.hidden=!0),Ia.add(s),s.setAttribute("data-element-id",e),s.disabled=this.data.readOnly,s.name=this.data.fieldName,s.tabIndex=Uh,this._setRequired(s,this.data.required),c&&(s.maxLength=c),s.addEventListener("input",f=>{t.setValue(e,{value:f.target.value}),this.setPropertyOnSiblings(s,"value",f.target.value,"value"),h.formattedValue=null}),s.addEventListener("resetform",f=>{const p=this.data.defaultFieldValue??"";s.value=h.userValue=p,h.formattedValue=null});let d=f=>{const{formattedValue:p}=h;p!=null&&(f.target.value=p),f.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){s.addEventListener("focus",p=>{var v;if(h.focused)return;const{target:m}=p;h.userValue&&(m.value=h.userValue),h.lastCommittedValue=m.value,h.commitKey=1,(v=this.data.actions)!=null&&v.Focus||(h.focused=!0)}),s.addEventListener("updatefromsandbox",p=>{this.showElementAndHideCanvas(p.target);const m={value(v){h.userValue=v.detail.value??"",t.setValue(e,{value:h.userValue.toString()}),v.target.value=h.userValue},formattedValue(v){const{formattedValue:_}=v.detail;h.formattedValue=_,_!=null&&v.target!==document.activeElement&&(v.target.value=_),t.setValue(e,{formattedValue:_})},selRange(v){v.target.setSelectionRange(...v.detail.selRange)},charLimit:v=>{var x;const{charLimit:_}=v.detail,{target:b}=v;if(_===0){b.removeAttribute("maxLength");return}b.setAttribute("maxLength",_);let A=h.userValue;!A||A.length<=_||(A=A.slice(0,_),b.value=h.userValue=A,t.setValue(e,{value:A}),(x=this.linkService.eventBus)==null||x.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:A,willCommit:!0,commitKey:1,selStart:b.selectionStart,selEnd:b.selectionEnd}}))}};this._dispatchEventFromSandbox(m,p)}),s.addEventListener("keydown",p=>{var _;h.commitKey=1;let m=-1;if(p.key==="Escape"?m=0:p.key==="Enter"&&!this.data.multiLine?m=2:p.key==="Tab"&&(h.commitKey=3),m===-1)return;const{value:v}=p.target;h.lastCommittedValue!==v&&(h.lastCommittedValue=v,h.userValue=v,(_=this.linkService.eventBus)==null||_.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:v,willCommit:!0,commitKey:m,selStart:p.target.selectionStart,selEnd:p.target.selectionEnd}}))});const f=d;d=null,s.addEventListener("blur",p=>{var v,_;if(!h.focused||!p.relatedTarget)return;(v=this.data.actions)!=null&&v.Blur||(h.focused=!1);const{value:m}=p.target;h.userValue=m,h.lastCommittedValue!==m&&((_=this.linkService.eventBus)==null||_.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:m,willCommit:!0,commitKey:h.commitKey,selStart:p.target.selectionStart,selEnd:p.target.selectionEnd}})),f(p)}),(r=this.data.actions)!=null&&r.Keystroke&&s.addEventListener("beforeinput",p=>{var T;h.lastCommittedValue=null;const{data:m,target:v}=p,{value:_,selectionStart:b,selectionEnd:A}=v;let x=b,C=A;switch(p.inputType){case"deleteWordBackward":{const D=_.substring(0,b).match(/\w*[^\w]*$/);D&&(x-=D[0].length);break}case"deleteWordForward":{const D=_.substring(b).match(/^[^\w]*\w*/);D&&(C+=D[0].length);break}case"deleteContentBackward":b===A&&(x-=1);break;case"deleteContentForward":b===A&&(C+=1);break}p.preventDefault(),(T=this.linkService.eventBus)==null||T.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:_,change:m||"",willCommit:!1,selStart:x,selEnd:C}})}),this._setEventListeners(s,h,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],p=>p.target.value)}if(d&&s.addEventListener("blur",d),this.data.comb){const p=(this.data.rect[2]-this.data.rect[0])/c;s.classList.add("comb"),s.style.letterSpacing=`calc(${p}px * var(--scale-factor) - 1ch)`}}else s=document.createElement("div"),s.textContent=this.data.fieldValue,s.style.verticalAlign="middle",s.style.display="table-cell",this.data.hasOwnCanvas&&(s.hidden=!0);return this._setTextStyle(s),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class a2 extends Da{constructor(t){super(t,{isRenderable:!!t.data.hasOwnCanvas})}}class l2 extends Da{constructor(t){super(t,{isRenderable:t.renderForms})}render(){const t=this.annotationStorage,e=this.data,s=e.id;let n=t.getValue(s,{value:e.exportValue===e.fieldValue}).value;typeof n=="string"&&(n=n!=="Off",t.setValue(s,{value:n})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const r=document.createElement("input");return Ia.add(r),r.setAttribute("data-element-id",s),r.disabled=e.readOnly,this._setRequired(r,this.data.required),r.type="checkbox",r.name=e.fieldName,n&&r.setAttribute("checked",!0),r.setAttribute("exportValue",e.exportValue),r.tabIndex=Uh,r.addEventListener("change",o=>{const{name:a,checked:c}=o.target;for(const u of this._getElementsByName(a,s)){const h=c&&u.exportValue===e.exportValue;u.domElement&&(u.domElement.checked=h),t.setValue(u.id,{value:h})}t.setValue(s,{value:c})}),r.addEventListener("resetform",o=>{const a=e.defaultFieldValue||"Off";o.target.checked=a===e.exportValue}),this.enableScripting&&this.hasJSActions&&(r.addEventListener("updatefromsandbox",o=>{const a={value(c){c.target.checked=c.detail.value!=="Off",t.setValue(s,{value:c.target.checked})}};this._dispatchEventFromSandbox(a,o)}),this._setEventListeners(r,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],o=>o.target.checked)),this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class gw extends Da{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const t=this.annotationStorage,e=this.data,s=e.id;let n=t.getValue(s,{value:e.fieldValue===e.buttonValue}).value;if(typeof n=="string"&&(n=n!==e.buttonValue,t.setValue(s,{value:n})),n)for(const o of this._getElementsByName(e.fieldName,s))t.setValue(o.id,{value:!1});const r=document.createElement("input");if(Ia.add(r),r.setAttribute("data-element-id",s),r.disabled=e.readOnly,this._setRequired(r,this.data.required),r.type="radio",r.name=e.fieldName,n&&r.setAttribute("checked",!0),r.tabIndex=Uh,r.addEventListener("change",o=>{const{name:a,checked:c}=o.target;for(const u of this._getElementsByName(a,s))t.setValue(u.id,{value:!1});t.setValue(s,{value:c})}),r.addEventListener("resetform",o=>{const a=e.defaultFieldValue;o.target.checked=a!=null&&a===e.buttonValue}),this.enableScripting&&this.hasJSActions){const o=e.buttonValue;r.addEventListener("updatefromsandbox",a=>{const c={value:u=>{const h=o===u.detail.value;for(const d of this._getElementsByName(u.target.name)){const f=h&&d.id===s;d.domElement&&(d.domElement.checked=f),t.setValue(d.id,{value:f})}}};this._dispatchEventFromSandbox(c,a)}),this._setEventListeners(r,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],a=>a.target.checked)}return this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class c2 extends dw{constructor(t){super(t,{ignoreBorder:t.data.hasAppearance})}render(){const t=super.render();t.classList.add("buttonWidgetAnnotation","pushButton");const e=t.lastChild;return this.enableScripting&&this.hasJSActions&&e&&(this._setDefaultPropertiesFromJS(e),e.addEventListener("updatefromsandbox",s=>{this._dispatchEventFromSandbox({},s)})),t}}class u2 extends Da{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const t=this.annotationStorage,e=this.data.id,s=t.getValue(e,{value:this.data.fieldValue}),n=document.createElement("select");Ia.add(n),n.setAttribute("data-element-id",e),n.disabled=this.data.readOnly,this._setRequired(n,this.data.required),n.name=this.data.fieldName,n.tabIndex=Uh;let r=this.data.combo&&this.data.options.length>0;this.data.combo||(n.size=this.data.options.length,this.data.multiSelect&&(n.multiple=!0)),n.addEventListener("resetform",h=>{const d=this.data.defaultFieldValue;for(const f of n.options)f.selected=f.value===d});for(const h of this.data.options){const d=document.createElement("option");d.textContent=h.displayValue,d.value=h.exportValue,s.value.includes(h.exportValue)&&(d.setAttribute("selected",!0),r=!1),n.append(d)}let o=null;if(r){const h=document.createElement("option");h.value=" ",h.setAttribute("hidden",!0),h.setAttribute("selected",!0),n.prepend(h),o=()=>{h.remove(),n.removeEventListener("input",o),o=null},n.addEventListener("input",o)}const a=h=>{const d=h?"value":"textContent",{options:f,multiple:p}=n;return p?Array.prototype.filter.call(f,m=>m.selected).map(m=>m[d]):f.selectedIndex===-1?null:f[f.selectedIndex][d]};let c=a(!1);const u=h=>{const d=h.target.options;return Array.prototype.map.call(d,f=>({displayValue:f.textContent,exportValue:f.value}))};return this.enableScripting&&this.hasJSActions?(n.addEventListener("updatefromsandbox",h=>{const d={value(f){o==null||o();const p=f.detail.value,m=new Set(Array.isArray(p)?p:[p]);for(const v of n.options)v.selected=m.has(v.value);t.setValue(e,{value:a(!0)}),c=a(!1)},multipleSelection(f){n.multiple=!0},remove(f){const p=n.options,m=f.detail.remove;p[m].selected=!1,n.remove(m),p.length>0&&Array.prototype.findIndex.call(p,_=>_.selected)===-1&&(p[0].selected=!0),t.setValue(e,{value:a(!0),items:u(f)}),c=a(!1)},clear(f){for(;n.length!==0;)n.remove(0);t.setValue(e,{value:null,items:[]}),c=a(!1)},insert(f){const{index:p,displayValue:m,exportValue:v}=f.detail.insert,_=n.children[p],b=document.createElement("option");b.textContent=m,b.value=v,_?_.before(b):n.append(b),t.setValue(e,{value:a(!0),items:u(f)}),c=a(!1)},items(f){const{items:p}=f.detail;for(;n.length!==0;)n.remove(0);for(const m of p){const{displayValue:v,exportValue:_}=m,b=document.createElement("option");b.textContent=v,b.value=_,n.append(b)}n.options.length>0&&(n.options[0].selected=!0),t.setValue(e,{value:a(!0),items:u(f)}),c=a(!1)},indices(f){const p=new Set(f.detail.indices);for(const m of f.target.options)m.selected=p.has(m.index);t.setValue(e,{value:a(!0)}),c=a(!1)},editable(f){f.target.disabled=!f.detail.editable}};this._dispatchEventFromSandbox(d,h)}),n.addEventListener("input",h=>{var p;const d=a(!0),f=a(!1);t.setValue(e,{value:d}),h.preventDefault(),(p=this.linkService.eventBus)==null||p.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:c,change:f,changeEx:d,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(n,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],h=>h.target.value)):n.addEventListener("input",function(h){t.setValue(e,{value:a(!0)})}),this.data.combo&&this._setTextStyle(n),this._setBackgroundColor(n),this._setDefaultPropertiesFromJS(n),this.container.append(n),this.container}}class Sg extends Pe{constructor(t){const{data:e,elements:s}=t;super(t,{isRenderable:Pe._hasPopupData(e)}),this.elements=s,this.popup=null}render(){this.container.classList.add("popupAnnotation");const t=this.popup=new h2({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),e=[];for(const s of this.elements)s.popup=t,s.container.ariaHasPopup="dialog",e.push(s.data.id),s.addHighlightArea();return this.container.setAttribute("aria-controls",e.map(s=>`${xm}${s}`).join(",")),this.container}}var Dl,pf,gf,Ol,ea,we,Vn,Nl,eh,sh,Fl,Un,Ci,Gn,ih,zn,nh,sa,ia,ne,Sd,xg,mw,vw,bw,yw,xd,Cd,Cg;class h2{constructor({container:t,color:e,elements:s,titleObj:n,modificationDate:r,contentsObj:o,richText:a,parent:c,rect:u,parentRect:h,open:d}){y(this,ne);y(this,Dl,w(this,ne,bw).bind(this));y(this,pf,w(this,ne,Cg).bind(this));y(this,gf,w(this,ne,Cd).bind(this));y(this,Ol,w(this,ne,xd).bind(this));y(this,ea,null);y(this,we,null);y(this,Vn,null);y(this,Nl,null);y(this,eh,null);y(this,sh,null);y(this,Fl,null);y(this,Un,!1);y(this,Ci,null);y(this,Gn,null);y(this,ih,null);y(this,zn,null);y(this,nh,null);y(this,sa,null);y(this,ia,!1);var f;g(this,we,t),g(this,nh,n),g(this,Vn,o),g(this,zn,a),g(this,sh,c),g(this,ea,e),g(this,ih,u),g(this,Fl,h),g(this,eh,s),g(this,Nl,km.toDateObject(r)),this.trigger=s.flatMap(p=>p.getElementsToTriggerPopup());for(const p of this.trigger)p.addEventListener("click",l(this,Ol)),p.addEventListener("mouseenter",l(this,gf)),p.addEventListener("mouseleave",l(this,pf)),p.classList.add("popupTriggerArea");for(const p of s)(f=p.container)==null||f.addEventListener("keydown",l(this,Dl));l(this,we).hidden=!0,d&&w(this,ne,xd).call(this)}render(){if(l(this,Ci))return;const t=g(this,Ci,document.createElement("div"));if(t.className="popup",l(this,ea)){const r=t.style.outlineColor=bt.makeHexColor(...l(this,ea));CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?t.style.backgroundColor=`color-mix(in srgb, ${r} 30%, white)`:t.style.backgroundColor=bt.makeHexColor(...l(this,ea).map(a=>Math.floor(.7*(255-a)+a)))}const e=document.createElement("span");e.className="header";const s=document.createElement("h1");if(e.append(s),{dir:s.dir,str:s.textContent}=l(this,nh),t.append(e),l(this,Nl)){const r=document.createElement("span");r.classList.add("popupDate"),r.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),r.setAttribute("data-l10n-args",JSON.stringify({dateObj:l(this,Nl).valueOf()})),e.append(r)}const n=l(this,ne,Sd);if(n)hw.render({xfaHtml:n,intent:"richText",div:t}),t.lastChild.classList.add("richText","popupContent");else{const r=this._formatContents(l(this,Vn));t.append(r)}l(this,we).append(t)}_formatContents({str:t,dir:e}){const s=document.createElement("p");s.classList.add("popupContent"),s.dir=e;const n=t.split(/(?:\r\n?|\n)/);for(let r=0,o=n.length;r<o;++r){const a=n[r];s.append(document.createTextNode(a)),r<o-1&&s.append(document.createElement("br"))}return s}updateEdited({rect:t,popupContent:e}){var s;l(this,sa)||g(this,sa,{contentsObj:l(this,Vn),richText:l(this,zn)}),t&&g(this,Gn,null),e&&(g(this,zn,w(this,ne,vw).call(this,e)),g(this,Vn,null)),(s=l(this,Ci))==null||s.remove(),g(this,Ci,null)}resetEdited(){var t;l(this,sa)&&({contentsObj:ms(this,Vn)._,richText:ms(this,zn)._}=l(this,sa),g(this,sa,null),(t=l(this,Ci))==null||t.remove(),g(this,Ci,null),g(this,Gn,null))}forceHide(){g(this,ia,this.isVisible),l(this,ia)&&(l(this,we).hidden=!0)}maybeShow(){l(this,ia)&&(l(this,Ci)||w(this,ne,Cd).call(this),g(this,ia,!1),l(this,we).hidden=!1)}get isVisible(){return l(this,we).hidden===!1}}Dl=new WeakMap,pf=new WeakMap,gf=new WeakMap,Ol=new WeakMap,ea=new WeakMap,we=new WeakMap,Vn=new WeakMap,Nl=new WeakMap,eh=new WeakMap,sh=new WeakMap,Fl=new WeakMap,Un=new WeakMap,Ci=new WeakMap,Gn=new WeakMap,ih=new WeakMap,zn=new WeakMap,nh=new WeakMap,sa=new WeakMap,ia=new WeakMap,ne=new WeakSet,Sd=function(){const t=l(this,zn),e=l(this,Vn);return t!=null&&t.str&&(!(e!=null&&e.str)||e.str===t.str)&&l(this,zn).html||null},xg=function(){var t,e,s;return((s=(e=(t=l(this,ne,Sd))==null?void 0:t.attributes)==null?void 0:e.style)==null?void 0:s.fontSize)||0},mw=function(){var t,e,s;return((s=(e=(t=l(this,ne,Sd))==null?void 0:t.attributes)==null?void 0:e.style)==null?void 0:s.color)||null},vw=function(t){const e=[],s={str:t,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:e}]}},n={style:{color:l(this,ne,mw),fontSize:l(this,ne,xg)?`calc(${l(this,ne,xg)}px * var(--scale-factor))`:""}};for(const r of t.split(`
`))e.push({name:"span",value:r,attributes:n});return s},bw=function(t){t.altKey||t.shiftKey||t.ctrlKey||t.metaKey||(t.key==="Enter"||t.key==="Escape"&&l(this,Un))&&w(this,ne,xd).call(this)},yw=function(){if(l(this,Gn)!==null)return;const{page:{view:t},viewport:{rawDims:{pageWidth:e,pageHeight:s,pageX:n,pageY:r}}}=l(this,sh);let o=!!l(this,Fl),a=o?l(this,Fl):l(this,ih);for(const m of l(this,eh))if(!a||bt.intersect(m.data.rect,a)!==null){a=m.data.rect,o=!0;break}const c=bt.normalizeRect([a[0],t[3]-a[1]+t[1],a[2],t[3]-a[3]+t[1]]),h=o?a[2]-a[0]+5:0,d=c[0]+h,f=c[1];g(this,Gn,[100*(d-n)/e,100*(f-r)/s]);const{style:p}=l(this,we);p.left=`${l(this,Gn)[0]}%`,p.top=`${l(this,Gn)[1]}%`},xd=function(){g(this,Un,!l(this,Un)),l(this,Un)?(w(this,ne,Cd).call(this),l(this,we).addEventListener("click",l(this,Ol)),l(this,we).addEventListener("keydown",l(this,Dl))):(w(this,ne,Cg).call(this),l(this,we).removeEventListener("click",l(this,Ol)),l(this,we).removeEventListener("keydown",l(this,Dl)))},Cd=function(){l(this,Ci)||this.render(),this.isVisible?l(this,Un)&&l(this,we).classList.add("focused"):(w(this,ne,yw).call(this),l(this,we).hidden=!1,l(this,we).style.zIndex=parseInt(l(this,we).style.zIndex)+1e3)},Cg=function(){l(this,we).classList.remove("focused"),!(l(this,Un)||!this.isVisible)&&(l(this,we).hidden=!0,l(this,we).style.zIndex=parseInt(l(this,we).style.zIndex)-1e3)};class ww extends Pe{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.textContent=t.data.textContent,this.textPosition=t.data.textPosition,this.annotationEditorType=Lt.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const t=document.createElement("div");t.classList.add("annotationTextContent"),t.setAttribute("role","comment");for(const e of this.textContent){const s=document.createElement("span");s.textContent=e,t.append(s)}this.container.append(t)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}var rh;class d2 extends Pe{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});y(this,rh,null)}render(){this.container.classList.add("lineAnnotation");const e=this.data,{width:s,height:n}=to(e.rect),r=this.svgFactory.create(s,n,!0),o=g(this,rh,this.svgFactory.createElement("svg:line"));return o.setAttribute("x1",e.rect[2]-e.lineCoordinates[0]),o.setAttribute("y1",e.rect[3]-e.lineCoordinates[1]),o.setAttribute("x2",e.rect[2]-e.lineCoordinates[2]),o.setAttribute("y2",e.rect[3]-e.lineCoordinates[3]),o.setAttribute("stroke-width",e.borderStyle.width||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),r.append(o),this.container.append(r),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return l(this,rh)}addHighlightArea(){this.container.classList.add("highlightArea")}}rh=new WeakMap;var oh;class f2 extends Pe{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});y(this,oh,null)}render(){this.container.classList.add("squareAnnotation");const e=this.data,{width:s,height:n}=to(e.rect),r=this.svgFactory.create(s,n,!0),o=e.borderStyle.width,a=g(this,oh,this.svgFactory.createElement("svg:rect"));return a.setAttribute("x",o/2),a.setAttribute("y",o/2),a.setAttribute("width",s-o),a.setAttribute("height",n-o),a.setAttribute("stroke-width",o||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),r.append(a),this.container.append(r),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return l(this,oh)}addHighlightArea(){this.container.classList.add("highlightArea")}}oh=new WeakMap;var ah;class p2 extends Pe{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});y(this,ah,null)}render(){this.container.classList.add("circleAnnotation");const e=this.data,{width:s,height:n}=to(e.rect),r=this.svgFactory.create(s,n,!0),o=e.borderStyle.width,a=g(this,ah,this.svgFactory.createElement("svg:ellipse"));return a.setAttribute("cx",s/2),a.setAttribute("cy",n/2),a.setAttribute("rx",s/2-o/2),a.setAttribute("ry",n/2-o/2),a.setAttribute("stroke-width",o||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),r.append(a),this.container.append(r),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return l(this,ah)}addHighlightArea(){this.container.classList.add("highlightArea")}}ah=new WeakMap;var lh;class _w extends Pe{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});y(this,lh,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:e,vertices:s,borderStyle:n,popupRef:r}}=this;if(!s)return this.container;const{width:o,height:a}=to(e),c=this.svgFactory.create(o,a,!0);let u=[];for(let d=0,f=s.length;d<f;d+=2){const p=s[d]-e[0],m=e[3]-s[d+1];u.push(`${p},${m}`)}u=u.join(" ");const h=g(this,lh,this.svgFactory.createElement(this.svgElementName));return h.setAttribute("points",u),h.setAttribute("stroke-width",n.width||1),h.setAttribute("stroke","transparent"),h.setAttribute("fill","transparent"),c.append(h),this.container.append(c),!r&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return l(this,lh)}addHighlightArea(){this.container.classList.add("highlightArea")}}lh=new WeakMap;class g2 extends _w{constructor(t){super(t),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class m2 extends Pe{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}var ch,na,uh,Eg;class Im extends Pe{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});y(this,uh);y(this,ch,null);y(this,na,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?Lt.HIGHLIGHT:Lt.INK}render(){this.container.classList.add(this.containerClassName);const{data:{rect:e,rotation:s,inkLists:n,borderStyle:r,popupRef:o}}=this,{transform:a,width:c,height:u}=w(this,uh,Eg).call(this,s,e),h=this.svgFactory.create(c,u,!0),d=g(this,ch,this.svgFactory.createElement("svg:g"));h.append(d),d.setAttribute("stroke-width",r.width||1),d.setAttribute("stroke-linecap","round"),d.setAttribute("stroke-linejoin","round"),d.setAttribute("stroke-miterlimit",10),d.setAttribute("stroke","transparent"),d.setAttribute("fill","transparent"),d.setAttribute("transform",a);for(let f=0,p=n.length;f<p;f++){const m=this.svgFactory.createElement(this.svgElementName);l(this,na).push(m),m.setAttribute("points",n[f].join(",")),d.append(m)}return!o&&this.hasPopupData&&this._createPopup(),this.container.append(h),this._editOnDoubleClick(),this.container}updateEdited(e){super.updateEdited(e);const{thickness:s,points:n,rect:r}=e,o=l(this,ch);if(s>=0&&o.setAttribute("stroke-width",s||1),n)for(let a=0,c=l(this,na).length;a<c;a++)l(this,na)[a].setAttribute("points",n[a].join(","));if(r){const{transform:a,width:c,height:u}=w(this,uh,Eg).call(this,this.data.rotation,r);o.parentElement.setAttribute("viewBox",`0 0 ${c} ${u}`),o.setAttribute("transform",a)}}getElementsToTriggerPopup(){return l(this,na)}addHighlightArea(){this.container.classList.add("highlightArea")}}ch=new WeakMap,na=new WeakMap,uh=new WeakSet,Eg=function(e,s){switch(e){case 90:return{transform:`rotate(90) translate(${-s[0]},${s[1]}) scale(1,-1)`,width:s[3]-s[1],height:s[2]-s[0]};case 180:return{transform:`rotate(180) translate(${-s[2]},${s[1]}) scale(1,-1)`,width:s[2]-s[0],height:s[3]-s[1]};case 270:return{transform:`rotate(270) translate(${-s[2]},${s[3]}) scale(1,-1)`,width:s[3]-s[1],height:s[2]-s[0]};default:return{transform:`translate(${-s[0]},${s[3]}) scale(1,-1)`,width:s[2]-s[0],height:s[3]-s[1]}}};class Aw extends Pe{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=Lt.HIGHLIGHT}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),this.container}}class v2 extends Pe{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class b2 extends Pe{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class y2 extends Pe{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class Sw extends Pe{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=Lt.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}var hh,dh,kg;class w2 extends Pe{constructor(e){var n;super(e,{isRenderable:!0});y(this,dh);y(this,hh,null);const{file:s}=this.data;this.filename=s.filename,this.content=s.content,(n=this.linkService.eventBus)==null||n.dispatch("fileattachmentannotation",{source:this,...s})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:e,data:s}=this;let n;s.hasAppearance||s.fillAlpha===0?n=document.createElement("div"):(n=document.createElement("img"),n.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(s.name)?"paperclip":"pushpin"}.svg`,s.fillAlpha&&s.fillAlpha<1&&(n.style=`filter: opacity(${Math.round(s.fillAlpha*100)}%);`)),n.addEventListener("dblclick",w(this,dh,kg).bind(this)),g(this,hh,n);const{isMac:r}=Es.platform;return e.addEventListener("keydown",o=>{o.key==="Enter"&&(r?o.metaKey:o.ctrlKey)&&w(this,dh,kg).call(this)}),!s.popupRef&&this.hasPopupData?this._createPopup():n.classList.add("popupTriggerArea"),e.append(n),e}getElementsToTriggerPopup(){return l(this,hh)}addHighlightArea(){this.container.classList.add("highlightArea")}}hh=new WeakMap,dh=new WeakSet,kg=function(){var e;(e=this.downloadManager)==null||e.openOrDownloadData(this.content,this.filename)};var fh,ra,oa,ph,La,xw,Tg;class _2{constructor({div:t,accessibilityManager:e,annotationCanvasMap:s,annotationEditorUIManager:n,page:r,viewport:o,structTreeLayer:a}){y(this,La);y(this,fh,null);y(this,ra,null);y(this,oa,new Map);y(this,ph,null);this.div=t,g(this,fh,e),g(this,ra,s),g(this,ph,a||null),this.page=r,this.viewport=o,this.zIndex=0,this._annotationEditorUIManager=n}hasEditableAnnotations(){return l(this,oa).size>0}async render(t){var o;const{annotations:e}=t,s=this.div;Ra(s,this.viewport);const n=new Map,r={data:null,layer:s,linkService:t.linkService,downloadManager:t.downloadManager,imageResourcesPath:t.imageResourcesPath||"",renderForms:t.renderForms!==!1,svgFactory:new Mm,annotationStorage:t.annotationStorage||new Pm,enableScripting:t.enableScripting===!0,hasJSActions:t.hasJSActions,fieldObjects:t.fieldObjects,parent:this,elements:null};for(const a of e){if(a.noHTML)continue;const c=a.annotationType===Ne.POPUP;if(c){const d=n.get(a.id);if(!d)continue;r.elements=d}else{const{width:d,height:f}=to(a.rect);if(d<=0||f<=0)continue}r.data=a;const u=n2.create(r);if(!u.isRenderable)continue;if(!c&&a.popupRef){const d=n.get(a.popupRef);d?d.push(u):n.set(a.popupRef,[u])}const h=u.render();a.hidden&&(h.style.visibility="hidden"),await w(this,La,xw).call(this,h,a.id),u._isEditable&&(l(this,oa).set(u.data.id,u),(o=this._annotationEditorUIManager)==null||o.renderAnnotationElement(u))}w(this,La,Tg).call(this)}update({viewport:t}){const e=this.div;this.viewport=t,Ra(e,{rotation:t.rotation}),w(this,La,Tg).call(this),e.hidden=!1}getEditableAnnotations(){return Array.from(l(this,oa).values())}getEditableAnnotation(t){return l(this,oa).get(t)}}fh=new WeakMap,ra=new WeakMap,oa=new WeakMap,ph=new WeakMap,La=new WeakSet,xw=async function(t,e){var o,a;const s=t.firstChild||t,n=s.id=`${xm}${e}`,r=await((o=l(this,ph))==null?void 0:o.getAriaAttributes(n));if(r)for(const[c,u]of r)s.setAttribute(c,u);this.div.append(t),(a=l(this,fh))==null||a.moveElementInDOM(this.div,t,s,!1)},Tg=function(){if(!l(this,ra))return;const t=this.div;for(const[e,s]of l(this,ra)){const n=t.querySelector(`[data-annotation-id="${e}"]`);if(!n)continue;s.className="annotationContent";const{firstChild:r}=n;r?r.nodeName==="CANVAS"?r.replaceWith(s):r.classList.contains("annotationContent")?r.after(s):r.before(s):n.append(s)}l(this,ra).clear()};const ed=/\r\n?|\n/g;var Ei,js,gh,aa,Vs,Le,Cw,Ew,kw,Ed,rr,kd,Td,Tw,Rg,Pw;const le=class le extends ye{constructor(e){super({...e,name:"freeTextEditor"});y(this,Le);y(this,Ei);y(this,js,"");y(this,gh,`${this.id}-editor`);y(this,aa,null);y(this,Vs);g(this,Ei,e.color||le._defaultColor||ye._defaultLineColor),g(this,Vs,e.fontSize||le._defaultFontSize)}static get _keyboardManager(){const e=le.prototype,s=o=>o.isEmpty(),n=Ma.TRANSLATE_SMALL,r=Ma.TRANSLATE_BIG;return Bt(this,"_keyboardManager",new Vh([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],e.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],e.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],e._translateEmpty,{args:[-n,0],checker:s}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e._translateEmpty,{args:[-r,0],checker:s}],[["ArrowRight","mac+ArrowRight"],e._translateEmpty,{args:[n,0],checker:s}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e._translateEmpty,{args:[r,0],checker:s}],[["ArrowUp","mac+ArrowUp"],e._translateEmpty,{args:[0,-n],checker:s}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e._translateEmpty,{args:[0,-r],checker:s}],[["ArrowDown","mac+ArrowDown"],e._translateEmpty,{args:[0,n],checker:s}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e._translateEmpty,{args:[0,r],checker:s}]]))}static initialize(e,s){ye.initialize(e,s);const n=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(n.getPropertyValue("--freetext-padding"))}static updateDefaultParams(e,s){switch(e){case Ut.FREETEXT_SIZE:le._defaultFontSize=s;break;case Ut.FREETEXT_COLOR:le._defaultColor=s;break}}updateParams(e,s){switch(e){case Ut.FREETEXT_SIZE:w(this,Le,Cw).call(this,s);break;case Ut.FREETEXT_COLOR:w(this,Le,Ew).call(this,s);break}}static get defaultPropertiesToUpdate(){return[[Ut.FREETEXT_SIZE,le._defaultFontSize],[Ut.FREETEXT_COLOR,le._defaultColor||ye._defaultLineColor]]}get propertiesToUpdate(){return[[Ut.FREETEXT_SIZE,l(this,Vs)],[Ut.FREETEXT_COLOR,l(this,Ei)]]}_translateEmpty(e,s){this._uiManager.translateSelectedEditors(e,s,!0)}getInitialTranslation(){const e=this.parentScale;return[-le._internalPadding*e,-(le._internalPadding+l(this,Vs))*e]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(this.isInEditMode())return;this.parent.setEditingState(!1),this.parent.updateToolbar(Lt.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),g(this,aa,new AbortController);const e=this._uiManager.combinedSignal(l(this,aa));this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:e}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:e}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:e}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:e}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:e})}disableEditMode(){var e;this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",l(this,gh)),this._isDraggable=!0,(e=l(this,aa))==null||e.abort(),g(this,aa,null),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"))}focusin(e){this._focusEventsAllowed&&(super.focusin(e),e.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(e){var s;this.width||(this.enableEditMode(),e&&this.editorDiv.focus(),(s=this._initialOptions)!=null&&s.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const e=l(this,js),s=g(this,js,w(this,Le,kw).call(this).trimEnd());if(e===s)return;const n=r=>{if(g(this,js,r),!r){this.remove();return}w(this,Le,Td).call(this),this._uiManager.rebuild(this),w(this,Le,Ed).call(this)};this.addCommands({cmd:()=>{n(s)},undo:()=>{n(e)},mustExec:!1}),w(this,Le,Ed).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(e){this.enterInEditMode()}keydown(e){e.target===this.div&&e.key==="Enter"&&(this.enterInEditMode(),e.preventDefault())}editorDivKeydown(e){le._keyboardManager.exec(this,e)}editorDivFocus(e){this.isEditing=!0}editorDivBlur(e){this.isEditing=!1}editorDivInput(e){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let e,s;this.width&&(e=this.x,s=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",l(this,gh)),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:n}=this.editorDiv;if(n.fontSize=`calc(${l(this,Vs)}px * var(--scale-factor))`,n.color=l(this,Ei),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),Xd(this,this.div,["dblclick","keydown"]),this.width){const[r,o]=this.parentDimensions;if(this.annotationElementId){const{position:a}=this._initialData;let[c,u]=this.getInitialTranslation();[c,u]=this.pageTranslationToScreen(c,u);const[h,d]=this.pageDimensions,[f,p]=this.pageTranslation;let m,v;switch(this.rotation){case 0:m=e+(a[0]-f)/h,v=s+this.height-(a[1]-p)/d;break;case 90:m=e+(a[0]-f)/h,v=s-(a[1]-p)/d,[c,u]=[u,-c];break;case 180:m=e-this.width+(a[0]-f)/h,v=s-(a[1]-p)/d,[c,u]=[-c,-u];break;case 270:m=e+(a[0]-f-this.height*d)/h,v=s+(a[1]-p-this.width*h)/d,[c,u]=[-u,c];break}this.setAt(m*r,v*o,c,u)}else this.setAt(e*r,s*o,this.width*r,this.height*o);w(this,Le,Td).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}editorDivPaste(e){var m,v,_;const s=e.clipboardData||window.clipboardData,{types:n}=s;if(n.length===1&&n[0]==="text/plain")return;e.preventDefault();const r=w(m=le,rr,Rg).call(m,s.getData("text")||"").replaceAll(ed,`
`);if(!r)return;const o=window.getSelection();if(!o.rangeCount)return;this.editorDiv.normalize(),o.deleteFromDocument();const a=o.getRangeAt(0);if(!r.includes(`
`)){a.insertNode(document.createTextNode(r)),this.editorDiv.normalize(),o.collapseToStart();return}const{startContainer:c,startOffset:u}=a,h=[],d=[];if(c.nodeType===Node.TEXT_NODE){const b=c.parentElement;if(d.push(c.nodeValue.slice(u).replaceAll(ed,"")),b!==this.editorDiv){let A=h;for(const x of this.editorDiv.childNodes){if(x===b){A=d;continue}A.push(w(v=le,rr,kd).call(v,x))}}h.push(c.nodeValue.slice(0,u).replaceAll(ed,""))}else if(c===this.editorDiv){let b=h,A=0;for(const x of this.editorDiv.childNodes)A++===u&&(b=d),b.push(w(_=le,rr,kd).call(_,x))}g(this,js,`${h.join(`
`)}${r}${d.join(`
`)}`),w(this,Le,Td).call(this);const f=new Range;let p=h.reduce((b,A)=>b+A.length,0);for(const{firstChild:b}of this.editorDiv.childNodes)if(b.nodeType===Node.TEXT_NODE){const A=b.nodeValue.length;if(p<=A){f.setStart(b,p),f.setEnd(b,p);break}p-=A}o.removeAllRanges(),o.addRange(f)}get contentDiv(){return this.editorDiv}static async deserialize(e,s,n){var a;let r=null;if(e instanceof ww){const{data:{defaultAppearanceData:{fontSize:c,fontColor:u},rect:h,rotation:d,id:f,popupRef:p},textContent:m,textPosition:v,parent:{page:{pageNumber:_}}}=e;if(!m||m.length===0)return null;r=e={annotationType:Lt.FREETEXT,color:Array.from(u),fontSize:c,value:m.join(`
`),position:v,pageIndex:_-1,rect:h.slice(0),rotation:d,id:f,deleted:!1,popupRef:p}}const o=await super.deserialize(e,s,n);return g(o,Vs,e.fontSize),g(o,Ei,bt.makeHexColor(...e.color)),g(o,js,w(a=le,rr,Rg).call(a,e.value)),o.annotationElementId=e.id||null,o._initialData=r,o}serialize(e=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const s=le._internalPadding*this.parentScale,n=this.getRect(s,s),r=ye._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:l(this,Ei)),o={annotationType:Lt.FREETEXT,color:r,fontSize:l(this,Vs),value:w(this,Le,Tw).call(this),pageIndex:this.pageIndex,rect:n,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return e?o:this.annotationElementId&&!w(this,Le,Pw).call(this,o)?null:(o.id=this.annotationElementId,o)}renderAnnotationElement(e){const s=super.renderAnnotationElement(e);if(this.deleted)return s;const{style:n}=s;n.fontSize=`calc(${l(this,Vs)}px * var(--scale-factor))`,n.color=l(this,Ei),s.replaceChildren();for(const o of l(this,js).split(`
`)){const a=document.createElement("div");a.append(o?document.createTextNode(o):document.createElement("br")),s.append(a)}const r=le._internalPadding*this.parentScale;return e.updateEdited({rect:this.getRect(r,r),popupContent:l(this,js)}),s}resetAnnotationElement(e){super.resetAnnotationElement(e),e.resetEdited()}};Ei=new WeakMap,js=new WeakMap,gh=new WeakMap,aa=new WeakMap,Vs=new WeakMap,Le=new WeakSet,Cw=function(e){const s=r=>{this.editorDiv.style.fontSize=`calc(${r}px * var(--scale-factor))`,this.translate(0,-(r-l(this,Vs))*this.parentScale),g(this,Vs,r),w(this,Le,Ed).call(this)},n=l(this,Vs);this.addCommands({cmd:s.bind(this,e),undo:s.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Ut.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},Ew=function(e){const s=r=>{g(this,Ei,this.editorDiv.style.color=r)},n=l(this,Ei);this.addCommands({cmd:s.bind(this,e),undo:s.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Ut.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},kw=function(){var n;const e=[];this.editorDiv.normalize();let s=null;for(const r of this.editorDiv.childNodes)(s==null?void 0:s.nodeType)===Node.TEXT_NODE&&r.nodeName==="BR"||(e.push(w(n=le,rr,kd).call(n,r)),s=r);return e.join(`
`)},Ed=function(){const[e,s]=this.parentDimensions;let n;if(this.isAttachedToDOM)n=this.div.getBoundingClientRect();else{const{currentLayer:r,div:o}=this,a=o.style.display,c=o.classList.contains("hidden");o.classList.remove("hidden"),o.style.display="hidden",r.div.append(this.div),n=o.getBoundingClientRect(),o.remove(),o.style.display=a,o.classList.toggle("hidden",c)}this.rotation%180===this.parentRotation%180?(this.width=n.width/e,this.height=n.height/s):(this.width=n.height/e,this.height=n.width/s),this.fixAndSetPosition()},rr=new WeakSet,kd=function(e){return(e.nodeType===Node.TEXT_NODE?e.nodeValue:e.innerText).replaceAll(ed,"")},Td=function(){if(this.editorDiv.replaceChildren(),!!l(this,js))for(const e of l(this,js).split(`
`)){const s=document.createElement("div");s.append(e?document.createTextNode(e):document.createElement("br")),this.editorDiv.append(s)}},Tw=function(){return l(this,js).replaceAll(""," ")},Rg=function(e){return e.replaceAll(" ","")},Pw=function(e){const{value:s,fontSize:n,color:r,pageIndex:o}=this._initialData;return this._hasBeenMoved||e.value!==s||e.fontSize!==n||e.color.some((a,c)=>a!==r[c])||e.pageIndex!==o},y(le,rr),pt(le,"_freeTextDefaultContent",""),pt(le,"_internalPadding",0),pt(le,"_defaultColor",null),pt(le,"_defaultFontSize",10),pt(le,"_type","freetext"),pt(le,"_editorType",Lt.FREETEXT);let Pg=le;class dt{toSVGPath(){ae("Abstract method `toSVGPath` must be implemented.")}get box(){ae("Abstract getter `box` must be implemented.")}serialize(t,e){ae("Abstract method `serialize` must be implemented.")}static _rescale(t,e,s,n,r,o){o||(o=new Float32Array(t.length));for(let a=0,c=t.length;a<c;a+=2)o[a]=e+t[a]*n,o[a+1]=s+t[a+1]*r;return o}static _rescaleAndSwap(t,e,s,n,r,o){o||(o=new Float32Array(t.length));for(let a=0,c=t.length;a<c;a+=2)o[a]=e+t[a+1]*n,o[a+1]=s+t[a]*r;return o}static _translate(t,e,s,n){n||(n=new Float32Array(t.length));for(let r=0,o=t.length;r<o;r+=2)n[r]=e+t[r],n[r+1]=s+t[r+1];return n}static svgRound(t){return Math.round(t*1e4)}static _normalizePoint(t,e,s,n,r){switch(r){case 90:return[1-e/s,t/n];case 180:return[1-t/s,1-e/n];case 270:return[e/s,1-t/n];default:return[t/s,e/n]}}static _normalizePagePoint(t,e,s){switch(s){case 90:return[1-e,t];case 180:return[1-t,1-e];case 270:return[e,1-t];default:return[t,e]}}static createBezierPoints(t,e,s,n,r,o){return[(t+5*s)/6,(e+5*n)/6,(5*s+r)/6,(5*n+o)/6,(s+r)/2,(n+o)/2]}}pt(dt,"PRECISION",1e-4);var Us,ki,$l,Bl,ln,$t,la,ca,mh,vh,Hl,jl,jr,bh,mf,vf,je,Oc,Rw,Mw,Iw,Lw,Dw,Ow;const En=class En{constructor({x:t,y:e},s,n,r,o,a=0){y(this,je);y(this,Us);y(this,ki,[]);y(this,$l);y(this,Bl);y(this,ln,[]);y(this,$t,new Float32Array(18));y(this,la);y(this,ca);y(this,mh);y(this,vh);y(this,Hl);y(this,jl);y(this,jr,[]);g(this,Us,s),g(this,jl,r*n),g(this,Bl,o),l(this,$t).set([NaN,NaN,NaN,NaN,t,e],6),g(this,$l,a),g(this,vh,l(En,bh)*n),g(this,mh,l(En,vf)*n),g(this,Hl,n),l(this,jr).push(t,e)}isEmpty(){return isNaN(l(this,$t)[8])}add({x:t,y:e}){var L;g(this,la,t),g(this,ca,e);const[s,n,r,o]=l(this,Us);let[a,c,u,h]=l(this,$t).subarray(8,12);const d=t-u,f=e-h,p=Math.hypot(d,f);if(p<l(this,mh))return!1;const m=p-l(this,vh),v=m/p,_=v*d,b=v*f;let A=a,x=c;a=u,c=h,u+=_,h+=b,(L=l(this,jr))==null||L.push(t,e);const C=-b/m,T=_/m,D=C*l(this,jl),P=T*l(this,jl);return l(this,$t).set(l(this,$t).subarray(2,8),0),l(this,$t).set([u+D,h+P],4),l(this,$t).set(l(this,$t).subarray(14,18),12),l(this,$t).set([u-D,h-P],16),isNaN(l(this,$t)[6])?(l(this,ln).length===0&&(l(this,$t).set([a+D,c+P],2),l(this,ln).push(NaN,NaN,NaN,NaN,(a+D-s)/r,(c+P-n)/o),l(this,$t).set([a-D,c-P],14),l(this,ki).push(NaN,NaN,NaN,NaN,(a-D-s)/r,(c-P-n)/o)),l(this,$t).set([A,x,a,c,u,h],6),!this.isEmpty()):(l(this,$t).set([A,x,a,c,u,h],6),Math.abs(Math.atan2(x-c,A-a)-Math.atan2(b,_))<Math.PI/2?([a,c,u,h]=l(this,$t).subarray(2,6),l(this,ln).push(NaN,NaN,NaN,NaN,((a+u)/2-s)/r,((c+h)/2-n)/o),[a,c,A,x]=l(this,$t).subarray(14,18),l(this,ki).push(NaN,NaN,NaN,NaN,((A+a)/2-s)/r,((x+c)/2-n)/o),!0):([A,x,a,c,u,h]=l(this,$t).subarray(0,6),l(this,ln).push(((A+5*a)/6-s)/r,((x+5*c)/6-n)/o,((5*a+u)/6-s)/r,((5*c+h)/6-n)/o,((a+u)/2-s)/r,((c+h)/2-n)/o),[u,h,a,c,A,x]=l(this,$t).subarray(12,18),l(this,ki).push(((A+5*a)/6-s)/r,((x+5*c)/6-n)/o,((5*a+u)/6-s)/r,((5*c+h)/6-n)/o,((a+u)/2-s)/r,((c+h)/2-n)/o),!0))}toSVGPath(){if(this.isEmpty())return"";const t=l(this,ln),e=l(this,ki);if(isNaN(l(this,$t)[6])&&!this.isEmpty())return w(this,je,Rw).call(this);const s=[];s.push(`M${t[4]} ${t[5]}`);for(let n=6;n<t.length;n+=6)isNaN(t[n])?s.push(`L${t[n+4]} ${t[n+5]}`):s.push(`C${t[n]} ${t[n+1]} ${t[n+2]} ${t[n+3]} ${t[n+4]} ${t[n+5]}`);w(this,je,Iw).call(this,s);for(let n=e.length-6;n>=6;n-=6)isNaN(e[n])?s.push(`L${e[n+4]} ${e[n+5]}`):s.push(`C${e[n]} ${e[n+1]} ${e[n+2]} ${e[n+3]} ${e[n+4]} ${e[n+5]}`);return w(this,je,Mw).call(this,s),s.join(" ")}newFreeDrawOutline(t,e,s,n,r,o){return new Nw(t,e,s,n,r,o)}getOutlines(){var d;const t=l(this,ln),e=l(this,ki),s=l(this,$t),[n,r,o,a]=l(this,Us),c=new Float32Array((((d=l(this,jr))==null?void 0:d.length)??0)+2);for(let f=0,p=c.length-2;f<p;f+=2)c[f]=(l(this,jr)[f]-n)/o,c[f+1]=(l(this,jr)[f+1]-r)/a;if(c[c.length-2]=(l(this,la)-n)/o,c[c.length-1]=(l(this,ca)-r)/a,isNaN(s[6])&&!this.isEmpty())return w(this,je,Lw).call(this,c);const u=new Float32Array(l(this,ln).length+24+l(this,ki).length);let h=t.length;for(let f=0;f<h;f+=2){if(isNaN(t[f])){u[f]=u[f+1]=NaN;continue}u[f]=t[f],u[f+1]=t[f+1]}h=w(this,je,Ow).call(this,u,h);for(let f=e.length-6;f>=6;f-=6)for(let p=0;p<6;p+=2){if(isNaN(e[f+p])){u[h]=u[h+1]=NaN,h+=2;continue}u[h]=e[f+p],u[h+1]=e[f+p+1],h+=2}return w(this,je,Dw).call(this,u,h),this.newFreeDrawOutline(u,c,l(this,Us),l(this,Hl),l(this,$l),l(this,Bl))}};Us=new WeakMap,ki=new WeakMap,$l=new WeakMap,Bl=new WeakMap,ln=new WeakMap,$t=new WeakMap,la=new WeakMap,ca=new WeakMap,mh=new WeakMap,vh=new WeakMap,Hl=new WeakMap,jl=new WeakMap,jr=new WeakMap,bh=new WeakMap,mf=new WeakMap,vf=new WeakMap,je=new WeakSet,Oc=function(){const t=l(this,$t).subarray(4,6),e=l(this,$t).subarray(16,18),[s,n,r,o]=l(this,Us);return[(l(this,la)+(t[0]-e[0])/2-s)/r,(l(this,ca)+(t[1]-e[1])/2-n)/o,(l(this,la)+(e[0]-t[0])/2-s)/r,(l(this,ca)+(e[1]-t[1])/2-n)/o]},Rw=function(){const[t,e,s,n]=l(this,Us),[r,o,a,c]=w(this,je,Oc).call(this);return`M${(l(this,$t)[2]-t)/s} ${(l(this,$t)[3]-e)/n} L${(l(this,$t)[4]-t)/s} ${(l(this,$t)[5]-e)/n} L${r} ${o} L${a} ${c} L${(l(this,$t)[16]-t)/s} ${(l(this,$t)[17]-e)/n} L${(l(this,$t)[14]-t)/s} ${(l(this,$t)[15]-e)/n} Z`},Mw=function(t){const e=l(this,ki);t.push(`L${e[4]} ${e[5]} Z`)},Iw=function(t){const[e,s,n,r]=l(this,Us),o=l(this,$t).subarray(4,6),a=l(this,$t).subarray(16,18),[c,u,h,d]=w(this,je,Oc).call(this);t.push(`L${(o[0]-e)/n} ${(o[1]-s)/r} L${c} ${u} L${h} ${d} L${(a[0]-e)/n} ${(a[1]-s)/r}`)},Lw=function(t){const e=l(this,$t),[s,n,r,o]=l(this,Us),[a,c,u,h]=w(this,je,Oc).call(this),d=new Float32Array(36);return d.set([NaN,NaN,NaN,NaN,(e[2]-s)/r,(e[3]-n)/o,NaN,NaN,NaN,NaN,(e[4]-s)/r,(e[5]-n)/o,NaN,NaN,NaN,NaN,a,c,NaN,NaN,NaN,NaN,u,h,NaN,NaN,NaN,NaN,(e[16]-s)/r,(e[17]-n)/o,NaN,NaN,NaN,NaN,(e[14]-s)/r,(e[15]-n)/o],0),this.newFreeDrawOutline(d,t,l(this,Us),l(this,Hl),l(this,$l),l(this,Bl))},Dw=function(t,e){const s=l(this,ki);return t.set([NaN,NaN,NaN,NaN,s[4],s[5]],e),e+=6},Ow=function(t,e){const s=l(this,$t).subarray(4,6),n=l(this,$t).subarray(16,18),[r,o,a,c]=l(this,Us),[u,h,d,f]=w(this,je,Oc).call(this);return t.set([NaN,NaN,NaN,NaN,(s[0]-r)/a,(s[1]-o)/c,NaN,NaN,NaN,NaN,u,h,NaN,NaN,NaN,NaN,d,f,NaN,NaN,NaN,NaN,(n[0]-r)/a,(n[1]-o)/c],e),e+=24},y(En,bh,8),y(En,mf,2),y(En,vf,l(En,bh)+l(En,mf));let Jd=En;var Vl,ua,Wn,yh,Gs,wh,Te,bf,Fw;class Nw extends dt{constructor(e,s,n,r,o,a){super();y(this,bf);y(this,Vl);y(this,ua,new Float32Array(4));y(this,Wn);y(this,yh);y(this,Gs);y(this,wh);y(this,Te);g(this,Te,e),g(this,Gs,s),g(this,Vl,n),g(this,wh,r),g(this,Wn,o),g(this,yh,a),this.lastPoint=[NaN,NaN],w(this,bf,Fw).call(this,a);const[c,u,h,d]=l(this,ua);for(let f=0,p=e.length;f<p;f+=2)e[f]=(e[f]-c)/h,e[f+1]=(e[f+1]-u)/d;for(let f=0,p=s.length;f<p;f+=2)s[f]=(s[f]-c)/h,s[f+1]=(s[f+1]-u)/d}toSVGPath(){const e=[`M${l(this,Te)[4]} ${l(this,Te)[5]}`];for(let s=6,n=l(this,Te).length;s<n;s+=6){if(isNaN(l(this,Te)[s])){e.push(`L${l(this,Te)[s+4]} ${l(this,Te)[s+5]}`);continue}e.push(`C${l(this,Te)[s]} ${l(this,Te)[s+1]} ${l(this,Te)[s+2]} ${l(this,Te)[s+3]} ${l(this,Te)[s+4]} ${l(this,Te)[s+5]}`)}return e.push("Z"),e.join(" ")}serialize([e,s,n,r],o){const a=n-e,c=r-s;let u,h;switch(o){case 0:u=dt._rescale(l(this,Te),e,r,a,-c),h=dt._rescale(l(this,Gs),e,r,a,-c);break;case 90:u=dt._rescaleAndSwap(l(this,Te),e,s,a,c),h=dt._rescaleAndSwap(l(this,Gs),e,s,a,c);break;case 180:u=dt._rescale(l(this,Te),n,s,-a,c),h=dt._rescale(l(this,Gs),n,s,-a,c);break;case 270:u=dt._rescaleAndSwap(l(this,Te),n,r,-a,-c),h=dt._rescaleAndSwap(l(this,Gs),n,r,-a,-c);break}return{outline:Array.from(u),points:[Array.from(h)]}}get box(){return l(this,ua)}newOutliner(e,s,n,r,o,a=0){return new Jd(e,s,n,r,o,a)}getNewOutline(e,s){const[n,r,o,a]=l(this,ua),[c,u,h,d]=l(this,Vl),f=o*h,p=a*d,m=n*h+c,v=r*d+u,_=this.newOutliner({x:l(this,Gs)[0]*f+m,y:l(this,Gs)[1]*p+v},l(this,Vl),l(this,wh),e,l(this,yh),s??l(this,Wn));for(let b=2;b<l(this,Gs).length;b+=2)_.add({x:l(this,Gs)[b]*f+m,y:l(this,Gs)[b+1]*p+v});return _.getOutlines()}}Vl=new WeakMap,ua=new WeakMap,Wn=new WeakMap,yh=new WeakMap,Gs=new WeakMap,wh=new WeakMap,Te=new WeakMap,bf=new WeakSet,Fw=function(e){const s=l(this,Te);let n=s[4],r=s[5],o=n,a=r,c=n,u=r,h=n,d=r;const f=e?Math.max:Math.min;for(let m=6,v=s.length;m<v;m+=6){if(isNaN(s[m]))o=Math.min(o,s[m+4]),a=Math.min(a,s[m+5]),c=Math.max(c,s[m+4]),u=Math.max(u,s[m+5]),d<s[m+5]?(h=s[m+4],d=s[m+5]):d===s[m+5]&&(h=f(h,s[m+4]));else{const _=bt.bezierBoundingBox(n,r,...s.slice(m,m+6));o=Math.min(o,_[0]),a=Math.min(a,_[1]),c=Math.max(c,_[2]),u=Math.max(u,_[3]),d<_[3]?(h=_[2],d=_[3]):d===_[3]&&(h=f(h,_[2]))}n=s[m+4],r=s[m+5]}const p=l(this,ua);p[0]=o-l(this,Wn),p[1]=a-l(this,Wn),p[2]=c-o+2*l(this,Wn),p[3]=u-a+2*l(this,Wn),this.lastPoint=[h,d]};var _h,Ah,Vr,Ti,Ts,$w,Pd,Bw,Hw,Ig;class Mg{constructor(t,e=0,s=0,n=!0){y(this,Ts);y(this,_h);y(this,Ah);y(this,Vr,[]);y(this,Ti,[]);let r=1/0,o=-1/0,a=1/0,c=-1/0;const u=10**-4;for(const{x:_,y:b,width:A,height:x}of t){const C=Math.floor((_-e)/u)*u,T=Math.ceil((_+A+e)/u)*u,D=Math.floor((b-e)/u)*u,P=Math.ceil((b+x+e)/u)*u,j=[C,D,P,!0],L=[T,D,P,!1];l(this,Vr).push(j,L),r=Math.min(r,C),o=Math.max(o,T),a=Math.min(a,D),c=Math.max(c,P)}const h=o-r+2*s,d=c-a+2*s,f=r-s,p=a-s,m=l(this,Vr).at(n?-1:-2),v=[m[0],m[2]];for(const _ of l(this,Vr)){const[b,A,x]=_;_[0]=(b-f)/h,_[1]=(A-p)/d,_[2]=(x-p)/d}g(this,_h,new Float32Array([f,p,h,d])),g(this,Ah,v)}getOutlines(){l(this,Vr).sort((e,s)=>e[0]-s[0]||e[1]-s[1]||e[2]-s[2]);const t=[];for(const e of l(this,Vr))e[3]?(t.push(...w(this,Ts,Ig).call(this,e)),w(this,Ts,Bw).call(this,e)):(w(this,Ts,Hw).call(this,e),t.push(...w(this,Ts,Ig).call(this,e)));return w(this,Ts,$w).call(this,t)}}_h=new WeakMap,Ah=new WeakMap,Vr=new WeakMap,Ti=new WeakMap,Ts=new WeakSet,$w=function(t){const e=[],s=new Set;for(const o of t){const[a,c,u]=o;e.push([a,c,o],[a,u,o])}e.sort((o,a)=>o[1]-a[1]||o[0]-a[0]);for(let o=0,a=e.length;o<a;o+=2){const c=e[o][2],u=e[o+1][2];c.push(u),u.push(c),s.add(c),s.add(u)}const n=[];let r;for(;s.size>0;){const o=s.values().next().value;let[a,c,u,h,d]=o;s.delete(o);let f=a,p=c;for(r=[a,u],n.push(r);;){let m;if(s.has(h))m=h;else if(s.has(d))m=d;else break;s.delete(m),[a,c,u,h,d]=m,f!==a&&(r.push(f,p,a,p===c?c:u),f=a),p=p===c?u:c}r.push(f,p)}return new A2(n,l(this,_h),l(this,Ah))},Pd=function(t){const e=l(this,Ti);let s=0,n=e.length-1;for(;s<=n;){const r=s+n>>1,o=e[r][0];if(o===t)return r;o<t?s=r+1:n=r-1}return n+1},Bw=function([,t,e]){const s=w(this,Ts,Pd).call(this,t);l(this,Ti).splice(s,0,[t,e])},Hw=function([,t,e]){const s=w(this,Ts,Pd).call(this,t);for(let n=s;n<l(this,Ti).length;n++){const[r,o]=l(this,Ti)[n];if(r!==t)break;if(r===t&&o===e){l(this,Ti).splice(n,1);return}}for(let n=s-1;n>=0;n--){const[r,o]=l(this,Ti)[n];if(r!==t)break;if(r===t&&o===e){l(this,Ti).splice(n,1);return}}},Ig=function(t){const[e,s,n]=t,r=[[e,s,n]],o=w(this,Ts,Pd).call(this,n);for(let a=0;a<o;a++){const[c,u]=l(this,Ti)[a];for(let h=0,d=r.length;h<d;h++){const[,f,p]=r[h];if(!(u<=f||p<=c)){if(f>=c){if(p>u)r[h][1]=u;else{if(d===1)return[];r.splice(h,1),h--,d--}continue}r[h][2]=c,p>u&&r.push([e,u,p])}}}return r};var Sh,Ul;class A2 extends dt{constructor(e,s,n){super();y(this,Sh);y(this,Ul);g(this,Ul,e),g(this,Sh,s),this.lastPoint=n}toSVGPath(){const e=[];for(const s of l(this,Ul)){let[n,r]=s;e.push(`M${n} ${r}`);for(let o=2;o<s.length;o+=2){const a=s[o],c=s[o+1];a===n?(e.push(`V${c}`),r=c):c===r&&(e.push(`H${a}`),n=a)}e.push("Z")}return e.join(" ")}serialize([e,s,n,r],o){const a=[],c=n-e,u=r-s;for(const h of l(this,Ul)){const d=new Array(h.length);for(let f=0;f<h.length;f+=2)d[f]=e+h[f]*c,d[f+1]=r-h[f+1]*u;a.push(d)}return a}get box(){return l(this,Sh)}get classNamesForOutlining(){return["highlightOutline"]}}Sh=new WeakMap,Ul=new WeakMap;class Lg extends Jd{newFreeDrawOutline(t,e,s,n,r,o){return new S2(t,e,s,n,r,o)}}class S2 extends Nw{newOutliner(t,e,s,n,r,o=0){return new Lg(t,e,s,n,r,o)}}var Pi,ha,Gl,Be,xh,zl,Ch,Eh,Ur,Ri,Wl,kh,ie,Dg,Og,Ng,go,jw,mr;const Is=class Is{constructor({editor:t=null,uiManager:e=null}){y(this,ie);y(this,Pi,null);y(this,ha,null);y(this,Gl);y(this,Be,null);y(this,xh,!1);y(this,zl,!1);y(this,Ch,null);y(this,Eh);y(this,Ur,null);y(this,Ri,null);y(this,Wl);var s;t?(g(this,zl,!1),g(this,Wl,Ut.HIGHLIGHT_COLOR),g(this,Ch,t)):(g(this,zl,!0),g(this,Wl,Ut.HIGHLIGHT_DEFAULT_COLOR)),g(this,Ri,(t==null?void 0:t._uiManager)||e),g(this,Eh,l(this,Ri)._eventBus),g(this,Gl,(t==null?void 0:t.color)||((s=l(this,Ri))==null?void 0:s.highlightColors.values().next().value)||"#FFFF98"),l(Is,kh)||g(Is,kh,Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"}))}static get _keyboardManager(){return Bt(this,"_keyboardManager",new Vh([[["Escape","mac+Escape"],Is.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],Is.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],Is.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],Is.prototype._moveToPrevious],[["Home","mac+Home"],Is.prototype._moveToBeginning],[["End","mac+End"],Is.prototype._moveToEnd]]))}renderButton(){const t=g(this,Pi,document.createElement("button"));t.className="colorPicker",t.tabIndex="0",t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),t.setAttribute("aria-haspopup",!0);const e=l(this,Ri)._signal;t.addEventListener("click",w(this,ie,go).bind(this),{signal:e}),t.addEventListener("keydown",w(this,ie,Ng).bind(this),{signal:e});const s=g(this,ha,document.createElement("span"));return s.className="swatch",s.setAttribute("aria-hidden",!0),s.style.backgroundColor=l(this,Gl),t.append(s),t}renderMainDropdown(){const t=g(this,Be,w(this,ie,Dg).call(this));return t.setAttribute("aria-orientation","horizontal"),t.setAttribute("aria-labelledby","highlightColorPickerLabel"),t}_colorSelectFromKeyboard(t){if(t.target===l(this,Pi)){w(this,ie,go).call(this,t);return}const e=t.target.getAttribute("data-color");e&&w(this,ie,Og).call(this,e,t)}_moveToNext(t){var e,s;if(!l(this,ie,mr)){w(this,ie,go).call(this,t);return}if(t.target===l(this,Pi)){(e=l(this,Be).firstChild)==null||e.focus();return}(s=t.target.nextSibling)==null||s.focus()}_moveToPrevious(t){var e,s;if(t.target===((e=l(this,Be))==null?void 0:e.firstChild)||t.target===l(this,Pi)){l(this,ie,mr)&&this._hideDropdownFromKeyboard();return}l(this,ie,mr)||w(this,ie,go).call(this,t),(s=t.target.previousSibling)==null||s.focus()}_moveToBeginning(t){var e;if(!l(this,ie,mr)){w(this,ie,go).call(this,t);return}(e=l(this,Be).firstChild)==null||e.focus()}_moveToEnd(t){var e;if(!l(this,ie,mr)){w(this,ie,go).call(this,t);return}(e=l(this,Be).lastChild)==null||e.focus()}hideDropdown(){var t,e;(t=l(this,Be))==null||t.classList.add("hidden"),(e=l(this,Ur))==null||e.abort(),g(this,Ur,null)}_hideDropdownFromKeyboard(){var t;if(!l(this,zl)){if(!l(this,ie,mr)){(t=l(this,Ch))==null||t.unselect();return}this.hideDropdown(),l(this,Pi).focus({preventScroll:!0,focusVisible:l(this,xh)})}}updateColor(t){if(l(this,ha)&&(l(this,ha).style.backgroundColor=t),!l(this,Be))return;const e=l(this,Ri).highlightColors.values();for(const s of l(this,Be).children)s.setAttribute("aria-selected",e.next().value===t)}destroy(){var t,e;(t=l(this,Pi))==null||t.remove(),g(this,Pi,null),g(this,ha,null),(e=l(this,Be))==null||e.remove(),g(this,Be,null)}};Pi=new WeakMap,ha=new WeakMap,Gl=new WeakMap,Be=new WeakMap,xh=new WeakMap,zl=new WeakMap,Ch=new WeakMap,Eh=new WeakMap,Ur=new WeakMap,Ri=new WeakMap,Wl=new WeakMap,kh=new WeakMap,ie=new WeakSet,Dg=function(){const t=document.createElement("div"),e=l(this,Ri)._signal;t.addEventListener("contextmenu",Vi,{signal:e}),t.className="dropdown",t.role="listbox",t.setAttribute("aria-multiselectable",!1),t.setAttribute("aria-orientation","vertical"),t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown");for(const[s,n]of l(this,Ri).highlightColors){const r=document.createElement("button");r.tabIndex="0",r.role="option",r.setAttribute("data-color",n),r.title=s,r.setAttribute("data-l10n-id",l(Is,kh)[s]);const o=document.createElement("span");r.append(o),o.className="swatch",o.style.backgroundColor=n,r.setAttribute("aria-selected",n===l(this,Gl)),r.addEventListener("click",w(this,ie,Og).bind(this,n),{signal:e}),t.append(r)}return t.addEventListener("keydown",w(this,ie,Ng).bind(this),{signal:e}),t},Og=function(t,e){e.stopPropagation(),l(this,Eh).dispatch("switchannotationeditorparams",{source:this,type:l(this,Wl),value:t})},Ng=function(t){Is._keyboardManager.exec(this,t)},go=function(t){if(l(this,ie,mr)){this.hideDropdown();return}if(g(this,xh,t.detail===0),l(this,Ur)||(g(this,Ur,new AbortController),window.addEventListener("pointerdown",w(this,ie,jw).bind(this),{signal:l(this,Ri).combinedSignal(l(this,Ur))})),l(this,Be)){l(this,Be).classList.remove("hidden");return}const e=g(this,Be,w(this,ie,Dg).call(this));l(this,Pi).append(e)},jw=function(t){var e;(e=l(this,Be))!=null&&e.contains(t.target)||this.hideDropdown()},mr=function(){return l(this,Be)&&!l(this,Be).classList.contains("hidden")},y(Is,kh,null);let Qd=Is;var ql,Th,qn,da,Xl,Os,Ph,Rh,fa,ai,zs,Je,Kl,Xn,ls,Yl,li,Mh,It,Fg,Rd,Vw,Uw,Gw,$g,mo,di,qa,zw,Md,Nc,Ww,qw,Xw,Kw,Yw;const Kt=class Kt extends ye{constructor(e){super({...e,name:"highlightEditor"});y(this,It);y(this,ql,null);y(this,Th,0);y(this,qn);y(this,da,null);y(this,Xl,null);y(this,Os,null);y(this,Ph,null);y(this,Rh,0);y(this,fa,null);y(this,ai,null);y(this,zs,null);y(this,Je,!1);y(this,Kl,null);y(this,Xn);y(this,ls,null);y(this,Yl,"");y(this,li);y(this,Mh,"");this.color=e.color||Kt._defaultColor,g(this,li,e.thickness||Kt._defaultThickness),g(this,Xn,e.opacity||Kt._defaultOpacity),g(this,qn,e.boxes||null),g(this,Mh,e.methodOfCreation||""),g(this,Yl,e.text||""),this._isDraggable=!1,e.highlightId>-1?(g(this,Je,!0),w(this,It,Rd).call(this,e),w(this,It,mo).call(this)):l(this,qn)&&(g(this,ql,e.anchorNode),g(this,Th,e.anchorOffset),g(this,Ph,e.focusNode),g(this,Rh,e.focusOffset),w(this,It,Fg).call(this),w(this,It,mo).call(this),this.rotate(this.rotation))}static get _keyboardManager(){const e=Kt.prototype;return Bt(this,"_keyboardManager",new Vh([[["ArrowLeft","mac+ArrowLeft"],e._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],e._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],e._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],e._moveCaret,{args:[3]}]]))}get telemetryInitialData(){return{action:"added",type:l(this,Je)?"free_highlight":"highlight",color:this._uiManager.highlightColorNames.get(this.color),thickness:l(this,li),methodOfCreation:l(this,Mh)}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.highlightColorNames.get(this.color)}}static computeTelemetryFinalData(e){return{numberOfColors:e.get("color").size}}static initialize(e,s){var n;ye.initialize(e,s),Kt._defaultColor||(Kt._defaultColor=((n=s.highlightColors)==null?void 0:n.values().next().value)||"#fff066")}static updateDefaultParams(e,s){switch(e){case Ut.HIGHLIGHT_DEFAULT_COLOR:Kt._defaultColor=s;break;case Ut.HIGHLIGHT_THICKNESS:Kt._defaultThickness=s;break}}translateInPage(e,s){}get toolbarPosition(){return l(this,Kl)}updateParams(e,s){switch(e){case Ut.HIGHLIGHT_COLOR:w(this,It,Vw).call(this,s);break;case Ut.HIGHLIGHT_THICKNESS:w(this,It,Uw).call(this,s);break}}static get defaultPropertiesToUpdate(){return[[Ut.HIGHLIGHT_DEFAULT_COLOR,Kt._defaultColor],[Ut.HIGHLIGHT_THICKNESS,Kt._defaultThickness]]}get propertiesToUpdate(){return[[Ut.HIGHLIGHT_COLOR,this.color||Kt._defaultColor],[Ut.HIGHLIGHT_THICKNESS,l(this,li)||Kt._defaultThickness],[Ut.HIGHLIGHT_FREE,l(this,Je)]]}async addEditToolbar(){const e=await super.addEditToolbar();return e?(this._uiManager.highlightColors&&(g(this,Xl,new Qd({editor:this})),e.addColorPicker(l(this,Xl))),e):null}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(w(this,It,Nc).call(this))}getBaseTranslation(){return[0,0]}getRect(e,s){return super.getRect(e,s,w(this,It,Nc).call(this))}onceAdded(e){this.annotationElementId||this.parent.addUndoableEditor(this),e&&this.div.focus()}remove(){w(this,It,$g).call(this),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(w(this,It,mo).call(this),this.isAttachedToDOM||this.parent.add(this)))}setParent(e){var n;let s=!1;this.parent&&!e?w(this,It,$g).call(this):e&&(w(this,It,mo).call(this,e),s=!this.parent&&((n=this.div)==null?void 0:n.classList.contains("selectedEditor"))),super.setParent(e),this.show(this._isVisible),s&&this.select()}rotate(e){var r,o,a;const{drawLayer:s}=this.parent;let n;l(this,Je)?(e=(e-this.rotation+360)%360,n=w(r=Kt,di,qa).call(r,l(this,ai).box,e)):n=w(o=Kt,di,qa).call(o,[this.x,this.y,this.width,this.height],e),s.updateProperties(l(this,zs),{bbox:n,root:{"data-main-rotation":e}}),s.updateProperties(l(this,ls),{bbox:w(a=Kt,di,qa).call(a,l(this,Os).box,e),root:{"data-main-rotation":e}})}render(){if(this.div)return this.div;const e=super.render();l(this,Yl)&&(e.setAttribute("aria-label",l(this,Yl)),e.setAttribute("role","mark")),l(this,Je)?e.classList.add("free"):this.div.addEventListener("keydown",w(this,It,zw).bind(this),{signal:this._uiManager._signal});const s=g(this,fa,document.createElement("div"));e.append(s),s.setAttribute("aria-hidden","true"),s.className="internal",s.style.clipPath=l(this,da);const[n,r]=this.parentDimensions;return this.setDims(this.width*n,this.height*r),Xd(this,l(this,fa),["pointerover","pointerleave"]),this.enableEditing(),e}pointerover(){var e;this.isSelected||(e=this.parent)==null||e.drawLayer.updateProperties(l(this,ls),{rootClass:{hovered:!0}})}pointerleave(){var e;this.isSelected||(e=this.parent)==null||e.drawLayer.updateProperties(l(this,ls),{rootClass:{hovered:!1}})}_moveCaret(e){switch(this.parent.unselect(this),e){case 0:case 2:w(this,It,Md).call(this,!0);break;case 1:case 3:w(this,It,Md).call(this,!1);break}}select(){var e;super.select(),l(this,ls)&&((e=this.parent)==null||e.drawLayer.updateProperties(l(this,ls),{rootClass:{hovered:!1,selected:!0}}))}unselect(){var e;super.unselect(),l(this,ls)&&((e=this.parent)==null||e.drawLayer.updateProperties(l(this,ls),{rootClass:{selected:!1}}),l(this,Je)||w(this,It,Md).call(this,!1))}get _mustFixPosition(){return!l(this,Je)}show(e=this._isVisible){super.show(e),this.parent&&(this.parent.drawLayer.updateProperties(l(this,zs),{rootClass:{hidden:!e}}),this.parent.drawLayer.updateProperties(l(this,ls),{rootClass:{hidden:!e}}))}static startHighlighting(e,s,{target:n,x:r,y:o}){const{x:a,y:c,width:u,height:h}=n.getBoundingClientRect(),d=new AbortController,f=e.combinedSignal(d),p=m=>{d.abort(),w(this,di,Kw).call(this,e,m)};window.addEventListener("blur",p,{signal:f}),window.addEventListener("pointerup",p,{signal:f}),window.addEventListener("pointerdown",Qs,{capture:!0,passive:!1,signal:f}),window.addEventListener("contextmenu",Vi,{signal:f}),n.addEventListener("pointermove",w(this,di,Xw).bind(this,e),{signal:f}),this._freeHighlight=new Lg({x:r,y:o},[a,c,u,h],e.scale,this._defaultThickness/2,s,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=e.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static async deserialize(e,s,n){var v,_,b,A;let r=null;if(e instanceof Aw){const{data:{quadPoints:x,rect:C,rotation:T,id:D,color:P,opacity:j,popupRef:L},parent:{page:{pageNumber:$}}}=e;r=e={annotationType:Lt.HIGHLIGHT,color:Array.from(P),opacity:j,quadPoints:x,boxes:null,pageIndex:$-1,rect:C.slice(0),rotation:T,id:D,deleted:!1,popupRef:L}}else if(e instanceof Im){const{data:{inkLists:x,rect:C,rotation:T,id:D,color:P,borderStyle:{rawWidth:j},popupRef:L},parent:{page:{pageNumber:$}}}=e;r=e={annotationType:Lt.HIGHLIGHT,color:Array.from(P),thickness:j,inkLists:x,boxes:null,pageIndex:$-1,rect:C.slice(0),rotation:T,id:D,deleted:!1,popupRef:L}}const{color:o,quadPoints:a,inkLists:c,opacity:u}=e,h=await super.deserialize(e,s,n);h.color=bt.makeHexColor(...o),g(h,Xn,u||1),c&&g(h,li,e.thickness),h.annotationElementId=e.id||null,h._initialData=r;const[d,f]=h.pageDimensions,[p,m]=h.pageTranslation;if(a){const x=g(h,qn,[]);for(let C=0;C<a.length;C+=8)x.push({x:(a[C]-p)/d,y:1-(a[C+1]-m)/f,width:(a[C+2]-a[C])/d,height:(a[C+1]-a[C+5])/f});w(v=h,It,Fg).call(v),w(_=h,It,mo).call(_),h.rotate(h.rotation)}else if(c){g(h,Je,!0);const x=c[0],C={x:x[0]-p,y:f-(x[1]-m)},T=new Lg(C,[0,0,d,f],1,l(h,li)/2,!0,.001);for(let j=0,L=x.length;j<L;j+=2)C.x=x[j]-p,C.y=f-(x[j+1]-m),T.add(C);const{id:D,clipPathId:P}=s.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:h.color,"fill-opacity":h._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:T.toSVGPath()}},!0,!0);w(b=h,It,Rd).call(b,{highlightOutlines:T.getOutlines(),highlightId:D,clipPathId:P}),w(A=h,It,mo).call(A)}return h}serialize(e=!1){if(this.isEmpty()||e)return null;if(this.deleted)return this.serializeDeleted();const s=this.getRect(0,0),n=ye._colorManager.convert(this.color),r={annotationType:Lt.HIGHLIGHT,color:n,opacity:l(this,Xn),thickness:l(this,li),quadPoints:w(this,It,Ww).call(this),outlines:w(this,It,qw).call(this,s),pageIndex:this.pageIndex,rect:s,rotation:w(this,It,Nc).call(this),structTreeParentId:this._structTreeParentId};return this.annotationElementId&&!w(this,It,Yw).call(this,r)?null:(r.id=this.annotationElementId,r)}renderAnnotationElement(e){return e.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}};ql=new WeakMap,Th=new WeakMap,qn=new WeakMap,da=new WeakMap,Xl=new WeakMap,Os=new WeakMap,Ph=new WeakMap,Rh=new WeakMap,fa=new WeakMap,ai=new WeakMap,zs=new WeakMap,Je=new WeakMap,Kl=new WeakMap,Xn=new WeakMap,ls=new WeakMap,Yl=new WeakMap,li=new WeakMap,Mh=new WeakMap,It=new WeakSet,Fg=function(){const e=new Mg(l(this,qn),.001);g(this,ai,e.getOutlines()),[this.x,this.y,this.width,this.height]=l(this,ai).box;const s=new Mg(l(this,qn),.0025,.001,this._uiManager.direction==="ltr");g(this,Os,s.getOutlines());const{lastPoint:n}=l(this,Os);g(this,Kl,[(n[0]-this.x)/this.width,(n[1]-this.y)/this.height])},Rd=function({highlightOutlines:e,highlightId:s,clipPathId:n}){var d,f;if(g(this,ai,e),g(this,Os,e.getNewOutline(l(this,li)/2+1.5,.0025)),s>=0)g(this,zs,s),g(this,da,n),this.parent.drawLayer.finalizeDraw(s,{bbox:e.box,path:{d:e.toSVGPath()}}),g(this,ls,this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:l(this,Os).box,path:{d:l(this,Os).toSVGPath()}},!0));else if(this.parent){const p=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(l(this,zs),{bbox:w(d=Kt,di,qa).call(d,l(this,ai).box,(p-this.rotation+360)%360),path:{d:e.toSVGPath()}}),this.parent.drawLayer.updateProperties(l(this,ls),{bbox:w(f=Kt,di,qa).call(f,l(this,Os).box,p),path:{d:l(this,Os).toSVGPath()}})}const[o,a,c,u]=e.box;switch(this.rotation){case 0:this.x=o,this.y=a,this.width=c,this.height=u;break;case 90:{const[p,m]=this.parentDimensions;this.x=a,this.y=1-o,this.width=c*m/p,this.height=u*p/m;break}case 180:this.x=1-o,this.y=1-a,this.width=c,this.height=u;break;case 270:{const[p,m]=this.parentDimensions;this.x=1-a,this.y=o,this.width=c*m/p,this.height=u*p/m;break}}const{lastPoint:h}=l(this,Os);g(this,Kl,[(h[0]-o)/c,(h[1]-a)/u])},Vw=function(e){const s=(o,a)=>{var c,u;this.color=o,g(this,Xn,a),(c=this.parent)==null||c.drawLayer.updateProperties(l(this,zs),{root:{fill:o,"fill-opacity":a}}),(u=l(this,Xl))==null||u.updateColor(o)},n=this.color,r=l(this,Xn);this.addCommands({cmd:s.bind(this,e,Kt._defaultOpacity),undo:s.bind(this,n,r),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Ut.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.highlightColorNames.get(e)},!0)},Uw=function(e){const s=l(this,li),n=r=>{g(this,li,r),w(this,It,Gw).call(this,r)};this.addCommands({cmd:n.bind(this,e),undo:n.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Ut.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:e},!0)},Gw=function(e){if(!l(this,Je))return;w(this,It,Rd).call(this,{highlightOutlines:l(this,ai).getNewOutline(e/2)}),this.fixAndSetPosition();const[s,n]=this.parentDimensions;this.setDims(this.width*s,this.height*n)},$g=function(){l(this,zs)===null||!this.parent||(this.parent.drawLayer.remove(l(this,zs)),g(this,zs,null),this.parent.drawLayer.remove(l(this,ls)),g(this,ls,null))},mo=function(e=this.parent){l(this,zs)===null&&({id:ms(this,zs)._,clipPathId:ms(this,da)._}=e.drawLayer.draw({bbox:l(this,ai).box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":l(this,Xn)},rootClass:{highlight:!0,free:l(this,Je)},path:{d:l(this,ai).toSVGPath()}},!1,!0),g(this,ls,e.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:l(this,Je)},bbox:l(this,Os).box,path:{d:l(this,Os).toSVGPath()}},l(this,Je))),l(this,fa)&&(l(this,fa).style.clipPath=l(this,da)))},di=new WeakSet,qa=function([e,s,n,r],o){switch(o){case 90:return[1-s-r,e,r,n];case 180:return[1-e-n,1-s-r,n,r];case 270:return[s,1-e-n,r,n]}return[e,s,n,r]},zw=function(e){Kt._keyboardManager.exec(this,e)},Md=function(e){if(!l(this,ql))return;const s=window.getSelection();e?s.setPosition(l(this,ql),l(this,Th)):s.setPosition(l(this,Ph),l(this,Rh))},Nc=function(){return l(this,Je)?this.rotation:0},Ww=function(){if(l(this,Je))return null;const[e,s]=this.pageDimensions,[n,r]=this.pageTranslation,o=l(this,qn),a=new Float32Array(o.length*8);let c=0;for(const{x:u,y:h,width:d,height:f}of o){const p=u*e+n,m=(1-h)*s+r;a[c]=a[c+4]=p,a[c+1]=a[c+3]=m,a[c+2]=a[c+6]=p+d*e,a[c+5]=a[c+7]=m-f*s,c+=8}return a},qw=function(e){return l(this,ai).serialize(e,w(this,It,Nc).call(this))},Xw=function(e,s){this._freeHighlight.add(s)&&e.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})},Kw=function(e,s){this._freeHighlight.isEmpty()?e.drawLayer.remove(this._freeHighlightId):e.createAndAddNewEditor(s,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""},Yw=function(e){const{color:s}=this._initialData;return e.color.some((n,r)=>n!==s[r])},y(Kt,di),pt(Kt,"_defaultColor",null),pt(Kt,"_defaultOpacity",1),pt(Kt,"_defaultThickness",12),pt(Kt,"_type","highlight"),pt(Kt,"_editorType",Lt.HIGHLIGHT),pt(Kt,"_freeHighlightId",-1),pt(Kt,"_freeHighlight",null),pt(Kt,"_freeHighlightClipId","");let Zd=Kt;var pa;class x2{constructor(){y(this,pa,Object.create(null))}updateProperty(t,e){this[t]=e,this.updateSVGProperty(t,e)}updateProperties(t){if(t)for(const[e,s]of Object.entries(t))this.updateProperty(e,s)}updateSVGProperty(t,e){l(this,pa)[t]=e}toSVGProperties(){const t=l(this,pa);return g(this,pa,Object.create(null)),{root:t}}reset(){g(this,pa,Object.create(null))}updateAll(t=this){this.updateProperties(t)}clone(){ae("Not implemented")}}pa=new WeakMap;var Ws,Jl,ze,ga,ma,Gr,zr,Wr,va,Wt,Hg,jg,Vg,Fc,Jw,Id,$c,Xa;const ft=class ft extends ye{constructor(e){super(e);y(this,Wt);y(this,Ws,null);y(this,Jl);pt(this,"_drawId",null);g(this,Jl,e.mustBeCommitted||!1),e.drawOutlines&&(w(this,Wt,Hg).call(this,e),w(this,Wt,Fc).call(this))}static _mergeSVGProperties(e,s){const n=new Set(Object.keys(e));for(const[r,o]of Object.entries(s))n.has(r)?Object.assign(e[r],o):e[r]=o;return e}static getDefaultDrawingOptions(e){ae("Not implemented")}static get typesMap(){ae("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(e,s){const n=this.typesMap.get(e);n&&this._defaultDrawingOptions.updateProperty(n,s),this._currentParent&&(l(ft,ze).updateProperty(n,s),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(e,s){const n=this.constructor.typesMap.get(e);n&&this._updateProperty(e,n,s)}static get defaultPropertiesToUpdate(){const e=[],s=this._defaultDrawingOptions;for(const[n,r]of this.typesMap)e.push([n,s[r]]);return e}get propertiesToUpdate(){const e=[],{_drawingOptions:s}=this;for(const[n,r]of this.constructor.typesMap)e.push([n,s[r]]);return e}_updateProperty(e,s,n){const r=this._drawingOptions,o=r[s],a=c=>{var h;r.updateProperty(s,c);const u=l(this,Ws).updateProperty(s,c);u&&w(this,Wt,$c).call(this,u),(h=this.parent)==null||h.drawLayer.updateProperties(this._drawId,r.toSVGProperties())};this.addCommands({cmd:a.bind(this,n),undo:a.bind(this,o),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:e,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){var e;(e=this.parent)==null||e.drawLayer.updateProperties(this._drawId,ft._mergeSVGProperties(l(this,Ws).getPathResizingSVGProperties(w(this,Wt,Id).call(this)),{bbox:w(this,Wt,Xa).call(this)}))}_onResized(){var e;(e=this.parent)==null||e.drawLayer.updateProperties(this._drawId,ft._mergeSVGProperties(l(this,Ws).getPathResizedSVGProperties(w(this,Wt,Id).call(this)),{bbox:w(this,Wt,Xa).call(this)}))}_onTranslating(e,s){var n;(n=this.parent)==null||n.drawLayer.updateProperties(this._drawId,{bbox:w(this,Wt,Xa).call(this,e,s)})}_onTranslated(){var e;(e=this.parent)==null||e.drawLayer.updateProperties(this._drawId,ft._mergeSVGProperties(l(this,Ws).getPathTranslatedSVGProperties(w(this,Wt,Id).call(this),this.parentDimensions),{bbox:w(this,Wt,Xa).call(this)}))}_onStartDragging(){var e;(e=this.parent)==null||e.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){var e;(e=this.parent)==null||e.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(e){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,l(this,Jl)&&(g(this,Jl,!1),this.commit(),this.parent.setSelected(this),e&&this.isOnScreen&&this.div.focus())}remove(){w(this,Wt,Vg).call(this),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(w(this,Wt,Fc).call(this),w(this,Wt,$c).call(this,l(this,Ws).box),this.isAttachedToDOM||this.parent.add(this)))}setParent(e){var n;let s=!1;this.parent&&!e?(this._uiManager.removeShouldRescale(this),w(this,Wt,Vg).call(this)):e&&(this._uiManager.addShouldRescale(this),w(this,Wt,Fc).call(this,e),s=!this.parent&&((n=this.div)==null?void 0:n.classList.contains("selectedEditor"))),super.setParent(e),s&&this.select()}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,ft._mergeSVGProperties({bbox:w(this,Wt,Xa).call(this)},l(this,Ws).updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&w(this,Wt,$c).call(this,l(this,Ws).updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;const e=super.render();e.classList.add("draw");const s=document.createElement("div");e.append(s),s.setAttribute("aria-hidden","true"),s.className="internal";const[n,r]=this.parentDimensions;return this.setDims(this.width*n,this.height*r),this._uiManager.addShouldRescale(this),this.disableEditing(),e}static createDrawerInstance(e,s,n,r,o){ae("Not implemented")}static startDrawing(e,s,n,r){var _;const{target:o,offsetX:a,offsetY:c,pointerId:u,pointerType:h}=r;if(l(ft,zr)&&l(ft,zr)!==h)return;const{viewport:{rotation:d}}=e,{width:f,height:p}=o.getBoundingClientRect(),m=g(ft,ga,new AbortController),v=e.combinedSignal(m);if(l(ft,Gr)||g(ft,Gr,u),l(ft,zr)??g(ft,zr,h),window.addEventListener("pointerup",b=>{var A;l(ft,Gr)===b.pointerId?this._endDraw(b):(A=l(ft,Wr))==null||A.delete(b.pointerId)},{signal:v}),window.addEventListener("pointercancel",b=>{var A;l(ft,Gr)===b.pointerId?this._currentParent.endDrawingSession():(A=l(ft,Wr))==null||A.delete(b.pointerId)},{signal:v}),window.addEventListener("pointerdown",b=>{l(ft,zr)===b.pointerType&&((l(ft,Wr)||g(ft,Wr,new Set)).add(b.pointerId),l(ft,ze).isCancellable()&&(l(ft,ze).removeLastElement(),l(ft,ze).isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:v}),window.addEventListener("contextmenu",Vi,{signal:v}),o.addEventListener("pointermove",this._drawMove.bind(this),{signal:v}),o.addEventListener("touchmove",b=>{b.timeStamp===l(ft,va)&&Qs(b)},{signal:v}),e.toggleDrawing(),(_=s._editorUndoBar)==null||_.hide(),l(ft,ze)){e.drawLayer.updateProperties(this._currentDrawId,l(ft,ze).startNew(a,c,f,p,d));return}s.updateUIForDefaultProperties(this),g(ft,ze,this.createDrawerInstance(a,c,f,p,d)),g(ft,ma,this.getDefaultDrawingOptions()),this._currentParent=e,{id:this._currentDrawId}=e.drawLayer.draw(this._mergeSVGProperties(l(ft,ma).toSVGProperties(),l(ft,ze).defaultSVGProperties),!0,!1)}static _drawMove(e){var o;if(g(ft,va,-1),!l(ft,ze))return;const{offsetX:s,offsetY:n,pointerId:r}=e;if(l(ft,Gr)===r){if(((o=l(ft,Wr))==null?void 0:o.size)>=1){this._endDraw(e);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,l(ft,ze).add(s,n)),g(ft,va,e.timeStamp),Qs(e)}}static _cleanup(e){e&&(this._currentDrawId=-1,this._currentParent=null,g(ft,ze,null),g(ft,ma,null),g(ft,zr,null),g(ft,va,NaN)),l(ft,ga)&&(l(ft,ga).abort(),g(ft,ga,null),g(ft,Gr,NaN),g(ft,Wr,null))}static _endDraw(e){const s=this._currentParent;if(s){if(s.toggleDrawing(!0),this._cleanup(!1),e&&s.drawLayer.updateProperties(this._currentDrawId,l(ft,ze).end(e.offsetX,e.offsetY)),this.supportMultipleDrawings){const n=l(ft,ze),r=this._currentDrawId,o=n.getLastElement();s.addCommands({cmd:()=>{s.drawLayer.updateProperties(r,n.setLastElement(o))},undo:()=>{s.drawLayer.updateProperties(r,n.removeLastElement())},mustExec:!1,type:Ut.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(e){const s=this._currentParent;if(!s)return null;if(s.toggleDrawing(!0),s.cleanUndoStack(Ut.DRAW_STEP),!l(ft,ze).isEmpty()){const{pageDimensions:[n,r],scale:o}=s,a=s.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:l(ft,ze).getOutlines(n*o,r*o,o,this._INNER_MARGIN),drawingOptions:l(ft,ma),mustBeCommitted:!e});return this._cleanup(!0),a}return s.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(e){}static deserializeDraw(e,s,n,r,o,a){ae("Not implemented")}static async deserialize(e,s,n){var d,f;const{rawDims:{pageWidth:r,pageHeight:o,pageX:a,pageY:c}}=s.viewport,u=this.deserializeDraw(a,c,r,o,this._INNER_MARGIN,e),h=await super.deserialize(e,s,n);return h.createDrawingOptions(e),w(d=h,Wt,Hg).call(d,{drawOutlines:u}),w(f=h,Wt,Fc).call(f),h.onScaleChanging(),h.rotate(),h}serializeDraw(e){const[s,n]=this.pageTranslation,[r,o]=this.pageDimensions;return l(this,Ws).serialize([s,n,r,o],e)}renderAnnotationElement(e){return e.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}};Ws=new WeakMap,Jl=new WeakMap,ze=new WeakMap,ga=new WeakMap,ma=new WeakMap,Gr=new WeakMap,zr=new WeakMap,Wr=new WeakMap,va=new WeakMap,Wt=new WeakSet,Hg=function({drawOutlines:e,drawId:s,drawingOptions:n}){g(this,Ws,e),this._drawingOptions||(this._drawingOptions=n),s>=0?(this._drawId=s,this.parent.drawLayer.finalizeDraw(s,e.defaultProperties)):this._drawId=w(this,Wt,jg).call(this,e,this.parent),w(this,Wt,$c).call(this,e.box)},jg=function(e,s){const{id:n}=s.drawLayer.draw(ft._mergeSVGProperties(this._drawingOptions.toSVGProperties(),e.defaultSVGProperties),!1,!1);return n},Vg=function(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())},Fc=function(e=this.parent){if(!(this._drawId!==null&&this.parent===e)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,e.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=w(this,Wt,jg).call(this,l(this,Ws),e)}},Jw=function([e,s,n,r]){const{parentDimensions:[o,a],rotation:c}=this;switch(c){case 90:return[s,1-e,n*(a/o),r*(o/a)];case 180:return[1-e,1-s,n,r];case 270:return[1-s,e,n*(a/o),r*(o/a)];default:return[e,s,n,r]}},Id=function(){const{x:e,y:s,width:n,height:r,parentDimensions:[o,a],rotation:c}=this;switch(c){case 90:return[1-s,e,n*(o/a),r*(a/o)];case 180:return[1-e,1-s,n,r];case 270:return[s,1-e,n*(o/a),r*(a/o)];default:return[e,s,n,r]}},$c=function(e){if([this.x,this.y,this.width,this.height]=w(this,Wt,Jw).call(this,e),this.div){this.fixAndSetPosition();const[s,n]=this.parentDimensions;this.setDims(this.width*s,this.height*n)}this._onResized()},Xa=function(){const{x:e,y:s,width:n,height:r,rotation:o,parentRotation:a,parentDimensions:[c,u]}=this;switch((o*4+a)/90){case 1:return[1-s-r,e,r,n];case 2:return[1-e-n,1-s-r,n,r];case 3:return[s,1-e-n,r,n];case 4:return[e,s-n*(c/u),r*(u/c),n*(c/u)];case 5:return[1-s,e,n*(c/u),r*(u/c)];case 6:return[1-e-r*(u/c),1-s,r*(u/c),n*(c/u)];case 7:return[s-n*(c/u),1-e-r*(u/c),n*(c/u),r*(u/c)];case 8:return[e-n,s-r,n,r];case 9:return[1-s,e-n,r,n];case 10:return[1-e,1-s,n,r];case 11:return[s-r,1-e,r,n];case 12:return[e-r*(u/c),s,r*(u/c),n*(c/u)];case 13:return[1-s-n*(c/u),e-r*(u/c),n*(c/u),r*(u/c)];case 14:return[1-e,1-s-n*(c/u),r*(u/c),n*(c/u)];case 15:return[s,1-e,n*(c/u),r*(u/c)];default:return[e,s,n,r]}},pt(ft,"_currentDrawId",-1),pt(ft,"_currentParent",null),y(ft,ze,null),y(ft,ga,null),y(ft,ma,null),y(ft,Gr,NaN),y(ft,zr,null),y(ft,Wr,null),y(ft,va,NaN),pt(ft,"_INNER_MARGIN",3);let Bg=ft;var cn,We,qe,ba,Ql,ws,Qe,ci,ya,wa,_a,Zl,Ld;class C2{constructor(t,e,s,n,r,o){y(this,Zl);y(this,cn,new Float64Array(6));y(this,We);y(this,qe);y(this,ba);y(this,Ql);y(this,ws);y(this,Qe,"");y(this,ci,0);y(this,ya,new tf);y(this,wa);y(this,_a);g(this,wa,s),g(this,_a,n),g(this,ba,r),g(this,Ql,o),[t,e]=w(this,Zl,Ld).call(this,t,e);const a=g(this,We,[NaN,NaN,NaN,NaN,t,e]);g(this,ws,[t,e]),g(this,qe,[{line:a,points:l(this,ws)}]),l(this,cn).set(a,0)}updateProperty(t,e){t==="stroke-width"&&g(this,Ql,e)}isEmpty(){return!l(this,qe)||l(this,qe).length===0}isCancellable(){return l(this,ws).length<=10}add(t,e){[t,e]=w(this,Zl,Ld).call(this,t,e);const[s,n,r,o]=l(this,cn).subarray(2,6),a=t-r,c=e-o;return Math.hypot(l(this,wa)*a,l(this,_a)*c)<=2?null:(l(this,ws).push(t,e),isNaN(s)?(l(this,cn).set([r,o,t,e],2),l(this,We).push(NaN,NaN,NaN,NaN,t,e),{path:{d:this.toSVGPath()}}):(isNaN(l(this,cn)[0])&&l(this,We).splice(6,6),l(this,cn).set([s,n,r,o,t,e],0),l(this,We).push(...dt.createBezierPoints(s,n,r,o,t,e)),{path:{d:this.toSVGPath()}}))}end(t,e){const s=this.add(t,e);return s||(l(this,ws).length===2?{path:{d:this.toSVGPath()}}:null)}startNew(t,e,s,n,r){g(this,wa,s),g(this,_a,n),g(this,ba,r),[t,e]=w(this,Zl,Ld).call(this,t,e);const o=g(this,We,[NaN,NaN,NaN,NaN,t,e]);g(this,ws,[t,e]);const a=l(this,qe).at(-1);return a&&(a.line=new Float32Array(a.line),a.points=new Float32Array(a.points)),l(this,qe).push({line:o,points:l(this,ws)}),l(this,cn).set(o,0),g(this,ci,0),this.toSVGPath(),null}getLastElement(){return l(this,qe).at(-1)}setLastElement(t){return l(this,qe)?(l(this,qe).push(t),g(this,We,t.line),g(this,ws,t.points),g(this,ci,0),{path:{d:this.toSVGPath()}}):l(this,ya).setLastElement(t)}removeLastElement(){if(!l(this,qe))return l(this,ya).removeLastElement();l(this,qe).pop(),g(this,Qe,"");for(let t=0,e=l(this,qe).length;t<e;t++){const{line:s,points:n}=l(this,qe)[t];g(this,We,s),g(this,ws,n),g(this,ci,0),this.toSVGPath()}return{path:{d:l(this,Qe)}}}toSVGPath(){const t=dt.svgRound(l(this,We)[4]),e=dt.svgRound(l(this,We)[5]);if(l(this,ws).length===2)return g(this,Qe,`${l(this,Qe)} M ${t} ${e} Z`),l(this,Qe);if(l(this,ws).length<=6){const n=l(this,Qe).lastIndexOf("M");g(this,Qe,`${l(this,Qe).slice(0,n)} M ${t} ${e}`),g(this,ci,6)}if(l(this,ws).length===4){const n=dt.svgRound(l(this,We)[10]),r=dt.svgRound(l(this,We)[11]);return g(this,Qe,`${l(this,Qe)} L ${n} ${r}`),g(this,ci,12),l(this,Qe)}const s=[];l(this,ci)===0&&(s.push(`M ${t} ${e}`),g(this,ci,6));for(let n=l(this,ci),r=l(this,We).length;n<r;n+=6){const[o,a,c,u,h,d]=l(this,We).slice(n,n+6).map(dt.svgRound);s.push(`C${o} ${a} ${c} ${u} ${h} ${d}`)}return g(this,Qe,l(this,Qe)+s.join(" ")),g(this,ci,l(this,We).length),l(this,Qe)}getOutlines(t,e,s,n){const r=l(this,qe).at(-1);return r.line=new Float32Array(r.line),r.points=new Float32Array(r.points),l(this,ya).build(l(this,qe),t,e,s,l(this,ba),l(this,Ql),n),g(this,cn,null),g(this,We,null),g(this,qe,null),g(this,Qe,null),l(this,ya)}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}cn=new WeakMap,We=new WeakMap,qe=new WeakMap,ba=new WeakMap,Ql=new WeakMap,ws=new WeakMap,Qe=new WeakMap,ci=new WeakMap,ya=new WeakMap,wa=new WeakMap,_a=new WeakMap,Zl=new WeakSet,Ld=function(t,e){return dt._normalizePoint(t,e,l(this,wa),l(this,_a),l(this,ba))};var _s,Ih,Lh,qs,un,hn,tc,ec,sc,ts,Sn,Qw,Zw,t1;const $m=class $m extends dt{constructor(){super(...arguments);y(this,ts);y(this,_s);y(this,Ih,0);y(this,Lh);y(this,qs);y(this,un);y(this,hn);y(this,tc);y(this,ec);y(this,sc)}build(e,s,n,r,o,a,c){g(this,un,s),g(this,hn,n),g(this,tc,r),g(this,ec,o),g(this,sc,a),g(this,Lh,c??0),g(this,qs,e),w(this,ts,Zw).call(this)}setLastElement(e){return l(this,qs).push(e),{path:{d:this.toSVGPath()}}}removeLastElement(){return l(this,qs).pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const e=[];for(const{line:s}of l(this,qs)){if(e.push(`M${dt.svgRound(s[4])} ${dt.svgRound(s[5])}`),s.length===6){e.push("Z");continue}if(s.length===12){e.push(`L${dt.svgRound(s[10])} ${dt.svgRound(s[11])}`);continue}for(let n=6,r=s.length;n<r;n+=6){const[o,a,c,u,h,d]=s.subarray(n,n+6).map(dt.svgRound);e.push(`C${o} ${a} ${c} ${u} ${h} ${d}`)}}return e.join("")}serialize([e,s,n,r],o){const a=[],c=[],[u,h,d,f]=w(this,ts,Qw).call(this);let p,m,v,_,b,A,x,C,T;switch(l(this,ec)){case 0:T=dt._rescale,p=e,m=s+r,v=n,_=-r,b=e+u*n,A=s+(1-h-f)*r,x=e+(u+d)*n,C=s+(1-h)*r;break;case 90:T=dt._rescaleAndSwap,p=e,m=s,v=n,_=r,b=e+h*n,A=s+u*r,x=e+(h+f)*n,C=s+(u+d)*r;break;case 180:T=dt._rescale,p=e+n,m=s,v=-n,_=r,b=e+(1-u-d)*n,A=s+h*r,x=e+(1-u)*n,C=s+(h+f)*r;break;case 270:T=dt._rescaleAndSwap,p=e+n,m=s+r,v=-n,_=-r,b=e+(1-h-f)*n,A=s+(1-u-d)*r,x=e+(1-h)*n,C=s+(1-u)*r;break}for(const{line:D,points:P}of l(this,qs))a.push(T(D,p,m,v,_,o?new Array(D.length):null)),c.push(T(P,p,m,v,_,o?new Array(P.length):null));return{lines:a,points:c,rect:[b,A,x,C]}}static deserialize(e,s,n,r,o,{paths:{lines:a,points:c},rotation:u,thickness:h}){const d=[];let f,p,m,v,_;switch(u){case 0:_=dt._rescale,f=-e/n,p=s/r+1,m=1/n,v=-1/r;break;case 90:_=dt._rescaleAndSwap,f=-s/r,p=-e/n,m=1/r,v=1/n;break;case 180:_=dt._rescale,f=e/n+1,p=-s/r,m=-1/n,v=1/r;break;case 270:_=dt._rescaleAndSwap,f=s/r+1,p=e/n+1,m=-1/r,v=-1/n;break}if(!a){a=[];for(const A of c){const x=A.length;if(x===2){a.push(new Float32Array([NaN,NaN,NaN,NaN,A[0],A[1]]));continue}if(x===4){a.push(new Float32Array([NaN,NaN,NaN,NaN,A[0],A[1],NaN,NaN,NaN,NaN,A[2],A[3]]));continue}const C=new Float32Array(3*(x-2));a.push(C);let[T,D,P,j]=A.subarray(0,4);C.set([NaN,NaN,NaN,NaN,T,D],0);for(let L=4;L<x;L+=2){const $=A[L],N=A[L+1];C.set(dt.createBezierPoints(T,D,P,j,$,N),(L-2)*3),[T,D,P,j]=[P,j,$,N]}}}for(let A=0,x=a.length;A<x;A++)d.push({line:_(a[A].map(C=>C??NaN),f,p,m,v),points:_(c[A].map(C=>C??NaN),f,p,m,v)});const b=new $m;return b.build(d,n,r,1,u,h,o),b}get box(){return l(this,_s)}updateProperty(e,s){return e==="stroke-width"?w(this,ts,t1).call(this,s):null}updateParentDimensions([e,s],n){const[r,o]=w(this,ts,Sn).call(this);g(this,un,e),g(this,hn,s),g(this,tc,n);const[a,c]=w(this,ts,Sn).call(this),u=a-r,h=c-o,d=l(this,_s);return d[0]-=u,d[1]-=h,d[2]+=2*u,d[3]+=2*h,d}updateRotation(e){return g(this,Ih,e),{path:{transform:this.rotationTransform}}}get viewBox(){return l(this,_s).map(dt.svgRound).join(" ")}get defaultProperties(){const[e,s]=l(this,_s);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${dt.svgRound(e)} ${dt.svgRound(s)}`}}}get rotationTransform(){const[,,e,s]=l(this,_s);let n=0,r=0,o=0,a=0,c=0,u=0;switch(l(this,Ih)){case 90:r=s/e,o=-e/s,c=e;break;case 180:n=-1,a=-1,c=e,u=s;break;case 270:r=-s/e,o=e/s,u=s;break;default:return""}return`matrix(${n} ${r} ${o} ${a} ${dt.svgRound(c)} ${dt.svgRound(u)})`}getPathResizingSVGProperties([e,s,n,r]){const[o,a]=w(this,ts,Sn).call(this),[c,u,h,d]=l(this,_s);if(Math.abs(h-o)<=dt.PRECISION||Math.abs(d-a)<=dt.PRECISION){const _=e+n/2-(c+h/2),b=s+r/2-(u+d/2);return{path:{"transform-origin":`${dt.svgRound(e)} ${dt.svgRound(s)}`,transform:`${this.rotationTransform} translate(${_} ${b})`}}}const f=(n-2*o)/(h-2*o),p=(r-2*a)/(d-2*a),m=h/n,v=d/r;return{path:{"transform-origin":`${dt.svgRound(c)} ${dt.svgRound(u)}`,transform:`${this.rotationTransform} scale(${m} ${v}) translate(${dt.svgRound(o)} ${dt.svgRound(a)}) scale(${f} ${p}) translate(${dt.svgRound(-o)} ${dt.svgRound(-a)})`}}}getPathResizedSVGProperties([e,s,n,r]){const[o,a]=w(this,ts,Sn).call(this),c=l(this,_s),[u,h,d,f]=c;if(c[0]=e,c[1]=s,c[2]=n,c[3]=r,Math.abs(d-o)<=dt.PRECISION||Math.abs(f-a)<=dt.PRECISION){const b=e+n/2-(u+d/2),A=s+r/2-(h+f/2);for(const{line:x,points:C}of l(this,qs))dt._translate(x,b,A,x),dt._translate(C,b,A,C);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${dt.svgRound(e)} ${dt.svgRound(s)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const p=(n-2*o)/(d-2*o),m=(r-2*a)/(f-2*a),v=-p*(u+o)+e+o,_=-m*(h+a)+s+a;if(p!==1||m!==1||v!==0||_!==0)for(const{line:b,points:A}of l(this,qs))dt._rescale(b,v,_,p,m,b),dt._rescale(A,v,_,p,m,A);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${dt.svgRound(e)} ${dt.svgRound(s)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([e,s],n){const[r,o]=n,a=l(this,_s),c=e-a[0],u=s-a[1];if(l(this,un)===r&&l(this,hn)===o)for(const{line:h,points:d}of l(this,qs))dt._translate(h,c,u,h),dt._translate(d,c,u,d);else{const h=l(this,un)/r,d=l(this,hn)/o;g(this,un,r),g(this,hn,o);for(const{line:f,points:p}of l(this,qs))dt._rescale(f,c,u,h,d,f),dt._rescale(p,c,u,h,d,p);a[2]*=h,a[3]*=d}return a[0]=e,a[1]=s,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${dt.svgRound(e)} ${dt.svgRound(s)}`}}}get defaultSVGProperties(){const e=l(this,_s);return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${dt.svgRound(e[0])} ${dt.svgRound(e[1])}`,transform:this.rotationTransform||null},bbox:e}}};_s=new WeakMap,Ih=new WeakMap,Lh=new WeakMap,qs=new WeakMap,un=new WeakMap,hn=new WeakMap,tc=new WeakMap,ec=new WeakMap,sc=new WeakMap,ts=new WeakSet,Sn=function(e=l(this,sc)){const s=l(this,Lh)+e/2*l(this,tc);return l(this,ec)%180===0?[s/l(this,un),s/l(this,hn)]:[s/l(this,hn),s/l(this,un)]},Qw=function(){const[e,s,n,r]=l(this,_s),[o,a]=w(this,ts,Sn).call(this,0);return[e+o,s+a,n-2*o,r-2*a]},Zw=function(){const e=g(this,_s,new Float32Array([1/0,1/0,-1/0,-1/0]));for(const{line:r}of l(this,qs)){if(r.length<=12){for(let c=4,u=r.length;c<u;c+=6){const[h,d]=r.subarray(c,c+2);e[0]=Math.min(e[0],h),e[1]=Math.min(e[1],d),e[2]=Math.max(e[2],h),e[3]=Math.max(e[3],d)}continue}let o=r[4],a=r[5];for(let c=6,u=r.length;c<u;c+=6){const[h,d,f,p,m,v]=r.subarray(c,c+6);bt.bezierBoundingBox(o,a,h,d,f,p,m,v,e),o=m,a=v}}const[s,n]=w(this,ts,Sn).call(this);e[0]=Math.min(1,Math.max(0,e[0]-s)),e[1]=Math.min(1,Math.max(0,e[1]-n)),e[2]=Math.min(1,Math.max(0,e[2]+s)),e[3]=Math.min(1,Math.max(0,e[3]+n)),e[2]-=e[0],e[3]-=e[1]},t1=function(e){const[s,n]=w(this,ts,Sn).call(this);g(this,sc,e);const[r,o]=w(this,ts,Sn).call(this),[a,c]=[r-s,o-n],u=l(this,_s);return u[0]-=a,u[1]-=c,u[2]+=2*a,u[3]+=2*c,u};let tf=$m;var ic;const Bm=class Bm extends x2{constructor(e){super();y(this,ic);g(this,ic,e),super.updateProperties({fill:"none",stroke:ye._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(e,s){e==="stroke-width"&&(s??(s=this["stroke-width"]),s*=l(this,ic).realScale),super.updateSVGProperty(e,s)}clone(){const e=new Bm(l(this,ic));return e.updateAll(this),e}};ic=new WeakMap;let Ug=Bm;var yf,e1;const Ya=class Ya extends Bg{constructor(e){super({...e,name:"inkEditor"});y(this,yf);this._willKeepAspectRatio=!0}static initialize(e,s){ye.initialize(e,s),this._defaultDrawingOptions=new Ug(s.viewParameters)}static getDefaultDrawingOptions(e){const s=this._defaultDrawingOptions.clone();return s.updateProperties(e),s}static get supportMultipleDrawings(){return!0}static get typesMap(){return Bt(this,"typesMap",new Map([[Ut.INK_THICKNESS,"stroke-width"],[Ut.INK_COLOR,"stroke"],[Ut.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(e,s,n,r,o){return new C2(e,s,n,r,o,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(e,s,n,r,o,a){return tf.deserialize(e,s,n,r,o,a)}static async deserialize(e,s,n){let r=null;if(e instanceof Im){const{data:{inkLists:a,rect:c,rotation:u,id:h,color:d,opacity:f,borderStyle:{rawWidth:p},popupRef:m},parent:{page:{pageNumber:v}}}=e;r=e={annotationType:Lt.INK,color:Array.from(d),thickness:p,opacity:f,paths:{points:a},boxes:null,pageIndex:v-1,rect:c.slice(0),rotation:u,id:h,deleted:!1,popupRef:m}}const o=await super.deserialize(e,s,n);return o.annotationElementId=e.id||null,o._initialData=r,o}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:e,_drawingOptions:s,parent:n}=this;s.updateSVGProperty("stroke-width"),n.drawLayer.updateProperties(e,s.toSVGProperties())}static onScaleChangingWhenDrawing(){const e=this._currentParent;e&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),e.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:e,thickness:s,opacity:n}){this._drawingOptions=Ya.getDefaultDrawingOptions({stroke:bt.makeHexColor(...e),"stroke-width":s,"stroke-opacity":n})}serialize(e=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:s,points:n,rect:r}=this.serializeDraw(e),{_drawingOptions:{stroke:o,"stroke-opacity":a,"stroke-width":c}}=this,u={annotationType:Lt.INK,color:ye._colorManager.convert(o),opacity:a,thickness:c,paths:{lines:s,points:n},pageIndex:this.pageIndex,rect:r,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return e?u:this.annotationElementId&&!w(this,yf,e1).call(this,u)?null:(u.id=this.annotationElementId,u)}renderAnnotationElement(e){const{points:s,rect:n}=this.serializeDraw(!1);return e.updateEdited({rect:n,thickness:this._drawingOptions["stroke-width"],points:s}),null}};yf=new WeakSet,e1=function(e){const{color:s,thickness:n,opacity:r,pageIndex:o}=this._initialData;return this._hasBeenMoved||this._hasBeenResized||e.color.some((a,c)=>a!==s[c])||e.thickness!==n||e.opacity!==r||e.pageIndex!==o},pt(Ya,"_type","ink"),pt(Ya,"_editorType",Lt.INK),pt(Ya,"_defaultDrawingOptions",null);let Gg=Ya;var be,Ze,qr,Kn,Xr,nc,dn,fn,Xs,rc,Xt,Bc,Hc,Dd,Wg,Od,qg,Nd,s1;const Jc=class Jc extends ye{constructor(e){super({...e,name:"stampEditor"});y(this,Xt);y(this,be,null);y(this,Ze,null);y(this,qr,null);y(this,Kn,null);y(this,Xr,null);y(this,nc,"");y(this,dn,null);y(this,fn,null);y(this,Xs,!1);y(this,rc,!1);g(this,Kn,e.bitmapUrl),g(this,Xr,e.bitmapFile)}static initialize(e,s){ye.initialize(e,s)}static get supportedTypes(){return Bt(this,"supportedTypes",["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"].map(s=>`image/${s}`))}static get supportedTypesStr(){return Bt(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(e){return this.supportedTypes.includes(e)}static paste(e,s){s.pasteEditor(Lt.STAMP,{bitmapFile:e.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){var e;return{type:"stamp",hasAltText:!!((e=this.altTextData)!=null&&e.altText)}}static computeTelemetryFinalData(e){const s=e.get("hasAltText");return{hasAltText:s.get(!0)??0,hasNoAltText:s.get(!1)??0}}async mlGuessAltText(e=null,s=!0){if(this.hasAltTextData())return null;const{mlManager:n}=this._uiManager;if(!n)throw new Error("No ML.");if(!await n.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:r,width:o,height:a}=e||this.copyCanvas(null,null,!0).imageData,c=await n.guess({name:"altText",request:{data:r,width:o,height:a,channels:r.length/(o*a)}});if(!c)throw new Error("No response from the AI service.");if(c.error)throw new Error("Error from the AI service.");if(c.cancel)return null;if(!c.output)throw new Error("No valid response from the AI service.");const u=c.output;return await this.setGuessedAltText(u),s&&!this.hasAltTextData()&&(this.altTextData={alt:u,decorative:!1}),u}remove(){var e;l(this,Ze)&&(g(this,be,null),this._uiManager.imageManager.deleteId(l(this,Ze)),(e=l(this,dn))==null||e.remove(),g(this,dn,null),l(this,fn)&&(clearTimeout(l(this,fn)),g(this,fn,null))),super.remove()}rebuild(){if(!this.parent){l(this,Ze)&&w(this,Xt,Dd).call(this);return}super.rebuild(),this.div!==null&&(l(this,Ze)&&l(this,dn)===null&&w(this,Xt,Dd).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(e){this._isDraggable=!0,e&&this.div.focus()}isEmpty(){return!(l(this,qr)||l(this,be)||l(this,Kn)||l(this,Xr)||l(this,Ze))}get isResizable(){return!0}render(){if(this.div)return this.div;let e,s;if(this.width&&(e=this.x,s=this.y),super.render(),this.div.hidden=!0,this.div.setAttribute("role","figure"),this.addAltTextButton(),l(this,be)?w(this,Xt,Wg).call(this):w(this,Xt,Dd).call(this),this.width&&!this.annotationElementId){const[n,r]=this.parentDimensions;this.setAt(e*n,s*r,this.width*n,this.height*r)}return this._uiManager.addShouldRescale(this),this.div}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;l(this,fn)!==null&&clearTimeout(l(this,fn)),g(this,fn,setTimeout(()=>{g(this,fn,null),w(this,Xt,qg).call(this)},200))}copyCanvas(e,s,n=!1){var p;e||(e=224);const{width:r,height:o}=l(this,be),a=new Up;let c=l(this,be),u=r,h=o,d=null;if(s){if(r>s||o>s){const j=Math.min(s/r,s/o);u=Math.floor(r*j),h=Math.floor(o*j)}d=document.createElement("canvas");const m=d.width=Math.ceil(u*a.sx),v=d.height=Math.ceil(h*a.sy);l(this,Xs)||(c=w(this,Xt,Od).call(this,m,v));const _=d.getContext("2d");_.filter=this._uiManager.hcmFilter;let b="white",A="#cfcfd8";this._uiManager.hcmFilter!=="none"?A="black":(p=window.matchMedia)!=null&&p.call(window,"(prefers-color-scheme: dark)").matches&&(b="#8f8f9d",A="#42414d");const x=15,C=x*a.sx,T=x*a.sy,D=new OffscreenCanvas(C*2,T*2),P=D.getContext("2d");P.fillStyle=b,P.fillRect(0,0,C*2,T*2),P.fillStyle=A,P.fillRect(0,0,C,T),P.fillRect(C,T,C,T),_.fillStyle=_.createPattern(D,"repeat"),_.fillRect(0,0,m,v),_.drawImage(c,0,0,c.width,c.height,0,0,m,v)}let f=null;if(n){let m,v;if(a.symmetric&&c.width<e&&c.height<e)m=c.width,v=c.height;else if(c=l(this,be),r>e||o>e){const A=Math.min(e/r,e/o);m=Math.floor(r*A),v=Math.floor(o*A),l(this,Xs)||(c=w(this,Xt,Od).call(this,m,v))}const b=new OffscreenCanvas(m,v).getContext("2d",{willReadFrequently:!0});b.drawImage(c,0,0,c.width,c.height,0,0,m,v),f={width:m,height:v,data:b.getImageData(0,0,m,v).data}}return{canvas:d,width:u,height:h,imageData:f}}getImageForAltText(){return l(this,dn)}static async deserialize(e,s,n){var v;let r=null;if(e instanceof Sw){const{data:{rect:_,rotation:b,id:A,structParent:x,popupRef:C},container:T,parent:{page:{pageNumber:D}}}=e,P=T.querySelector("canvas"),j=n.imageManager.getFromCanvas(T.id,P);P.remove();const L=((v=await s._structTree.getAriaAttributes(`${xm}${A}`))==null?void 0:v.get("aria-label"))||"";r=e={annotationType:Lt.STAMP,bitmapId:j.id,bitmap:j.bitmap,pageIndex:D-1,rect:_.slice(0),rotation:b,id:A,deleted:!1,accessibilityData:{decorative:!1,altText:L},isSvg:!1,structParent:x,popupRef:C}}const o=await super.deserialize(e,s,n),{rect:a,bitmap:c,bitmapUrl:u,bitmapId:h,isSvg:d,accessibilityData:f}=e;h&&n.imageManager.isValidId(h)?(g(o,Ze,h),c&&g(o,be,c)):g(o,Kn,u),g(o,Xs,d);const[p,m]=o.pageDimensions;return o.width=(a[2]-a[0])/p,o.height=(a[3]-a[1])/m,o.annotationElementId=e.id||null,f&&(o.altTextData=f),o._initialData=r,g(o,rc,!!r),o}serialize(e=!1,s=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const n={annotationType:Lt.STAMP,bitmapId:l(this,Ze),pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:l(this,Xs),structTreeParentId:this._structTreeParentId};if(e)return n.bitmapUrl=w(this,Xt,Nd).call(this,!0),n.accessibilityData=this.serializeAltText(!0),n;const{decorative:r,altText:o}=this.serializeAltText(!1);if(!r&&o&&(n.accessibilityData={type:"Figure",alt:o}),this.annotationElementId){const c=w(this,Xt,s1).call(this,n);if(c.isSame)return null;c.isSameAltText?delete n.accessibilityData:n.accessibilityData.structParent=this._initialData.structParent??-1}if(n.id=this.annotationElementId,s===null)return n;s.stamps||(s.stamps=new Map);const a=l(this,Xs)?(n.rect[2]-n.rect[0])*(n.rect[3]-n.rect[1]):null;if(!s.stamps.has(l(this,Ze)))s.stamps.set(l(this,Ze),{area:a,serialized:n}),n.bitmap=w(this,Xt,Nd).call(this,!1);else if(l(this,Xs)){const c=s.stamps.get(l(this,Ze));a>c.area&&(c.area=a,c.serialized.bitmap.close(),c.serialized.bitmap=w(this,Xt,Nd).call(this,!1))}return n}renderAnnotationElement(e){return e.updateEdited({rect:this.getRect(0,0)}),null}};be=new WeakMap,Ze=new WeakMap,qr=new WeakMap,Kn=new WeakMap,Xr=new WeakMap,nc=new WeakMap,dn=new WeakMap,fn=new WeakMap,Xs=new WeakMap,rc=new WeakMap,Xt=new WeakSet,Bc=function(e,s=!1){if(!e){this.remove();return}g(this,be,e.bitmap),s||(g(this,Ze,e.id),g(this,Xs,e.isSvg)),e.file&&g(this,nc,e.file.name),w(this,Xt,Wg).call(this)},Hc=function(){if(g(this,qr,null),this._uiManager.enableWaiting(!1),!!l(this,dn)){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&l(this,be)){this._editToolbar.hide(),this._uiManager.editAltText(this,!0);return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&l(this,be)){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}},Dd=function(){if(l(this,Ze)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(l(this,Ze)).then(n=>w(this,Xt,Bc).call(this,n,!0)).finally(()=>w(this,Xt,Hc).call(this));return}if(l(this,Kn)){const n=l(this,Kn);g(this,Kn,null),this._uiManager.enableWaiting(!0),g(this,qr,this._uiManager.imageManager.getFromUrl(n).then(r=>w(this,Xt,Bc).call(this,r)).finally(()=>w(this,Xt,Hc).call(this)));return}if(l(this,Xr)){const n=l(this,Xr);g(this,Xr,null),this._uiManager.enableWaiting(!0),g(this,qr,this._uiManager.imageManager.getFromFile(n).then(r=>w(this,Xt,Bc).call(this,r)).finally(()=>w(this,Xt,Hc).call(this)));return}const e=document.createElement("input");e.type="file",e.accept=Jc.supportedTypesStr;const s=this._uiManager._signal;g(this,qr,new Promise(n=>{e.addEventListener("change",async()=>{if(!e.files||e.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const r=await this._uiManager.imageManager.getFromFile(e.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),w(this,Xt,Bc).call(this,r)}n()},{signal:s}),e.addEventListener("cancel",()=>{this.remove(),n()},{signal:s})}).finally(()=>w(this,Xt,Hc).call(this))),e.click()},Wg=function(){var d;const{div:e}=this;let{width:s,height:n}=l(this,be);const[r,o]=this.pageDimensions,a=.75;if(this.width)s=this.width*r,n=this.height*o;else if(s>a*r||n>a*o){const f=Math.min(a*r/s,a*o/n);s*=f,n*=f}const[c,u]=this.parentDimensions;this.setDims(s*c/r,n*u/o),this._uiManager.enableWaiting(!1);const h=g(this,dn,document.createElement("canvas"));h.setAttribute("role","img"),this.addContainer(h),this.width=s/r,this.height=n/o,(d=this._initialOptions)!=null&&d.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(e.hidden=!1),w(this,Xt,qg).call(this),l(this,rc)||(this.parent.addUndoableEditor(this),g(this,rc,!0)),this._reportTelemetry({action:"inserted_image"}),l(this,nc)&&h.setAttribute("aria-label",l(this,nc))},Od=function(e,s){const{width:n,height:r}=l(this,be);let o=n,a=r,c=l(this,be);for(;o>2*e||a>2*s;){const u=o,h=a;o>2*e&&(o=o>=16384?Math.floor(o/2)-1:Math.ceil(o/2)),a>2*s&&(a=a>=16384?Math.floor(a/2)-1:Math.ceil(a/2));const d=new OffscreenCanvas(o,a);d.getContext("2d").drawImage(c,0,0,u,h,0,0,o,a),c=d.transferToImageBitmap()}return c},qg=function(){const[e,s]=this.parentDimensions,{width:n,height:r}=this,o=new Up,a=Math.ceil(n*e*o.sx),c=Math.ceil(r*s*o.sy),u=l(this,dn);if(!u||u.width===a&&u.height===c)return;u.width=a,u.height=c;const h=l(this,Xs)?l(this,be):w(this,Xt,Od).call(this,a,c),d=u.getContext("2d");d.filter=this._uiManager.hcmFilter,d.drawImage(h,0,0,h.width,h.height,0,0,a,c)},Nd=function(e){if(e){if(l(this,Xs)){const r=this._uiManager.imageManager.getSvgUrl(l(this,Ze));if(r)return r}const s=document.createElement("canvas");return{width:s.width,height:s.height}=l(this,be),s.getContext("2d").drawImage(l(this,be),0,0),s.toDataURL()}if(l(this,Xs)){const[s,n]=this.pageDimensions,r=Math.round(this.width*s*no.PDF_TO_CSS_UNITS),o=Math.round(this.height*n*no.PDF_TO_CSS_UNITS),a=new OffscreenCanvas(r,o);return a.getContext("2d").drawImage(l(this,be),0,0,l(this,be).width,l(this,be).height,0,0,r,o),a.transferToImageBitmap()}return structuredClone(l(this,be))},s1=function(e){var a;const{pageIndex:s,accessibilityData:{altText:n}}=this._initialData,r=e.pageIndex===s,o=(((a=e.accessibilityData)==null?void 0:a.alt)||"")===n;return{isSame:!this._hasBeenMoved&&!this._hasBeenResized&&r&&o,isSameAltText:o}},pt(Jc,"_type","stamp"),pt(Jc,"_editorType",Lt.STAMP);let zg=Jc;var Aa,oc,pn,Kr,Yn,ui,Yr,ac,Sa,Mi,Jn,cs,Qn,vt,Jr,ge,i1,Ki,Kg,Yg,Fd;const yi=class yi{constructor({uiManager:t,pageIndex:e,div:s,structTreeLayer:n,accessibilityManager:r,annotationLayer:o,drawLayer:a,textLayer:c,viewport:u,l10n:h}){y(this,ge);y(this,Aa);y(this,oc,!1);y(this,pn,null);y(this,Kr,null);y(this,Yn,null);y(this,ui,new Map);y(this,Yr,!1);y(this,ac,!1);y(this,Sa,!1);y(this,Mi,null);y(this,Jn,null);y(this,cs,null);y(this,Qn,null);y(this,vt);const d=[...l(yi,Jr).values()];if(!yi._initialized){yi._initialized=!0;for(const f of d)f.initialize(h,t)}t.registerEditorTypes(d),g(this,vt,t),this.pageIndex=e,this.div=s,g(this,Aa,r),g(this,pn,o),this.viewport=u,g(this,cs,c),this.drawLayer=a,this._structTree=n,l(this,vt).addLayer(this)}get isEmpty(){return l(this,ui).size===0}get isInvisible(){return this.isEmpty&&l(this,vt).getMode()===Lt.NONE}updateToolbar(t){l(this,vt).updateToolbar(t)}updateMode(t=l(this,vt).getMode()){switch(w(this,ge,Fd).call(this),t){case Lt.NONE:this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case Lt.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case Lt.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:e}=this.div;for(const s of l(yi,Jr).values())e.toggle(`${s._type}Editing`,t===s._editorType);this.div.hidden=!1}hasTextLayer(t){var e;return t===((e=l(this,cs))==null?void 0:e.div)}setEditingState(t){l(this,vt).setEditingState(t)}addCommands(t){l(this,vt).addCommands(t)}cleanUndoStack(t){l(this,vt).cleanUndoStack(t)}toggleDrawing(t=!1){this.div.classList.toggle("drawing",!t)}togglePointerEvents(t=!1){this.div.classList.toggle("disabled",!t)}toggleAnnotationLayerPointerEvents(t=!1){var e;(e=l(this,pn))==null||e.div.classList.toggle("disabled",!t)}async enable(){g(this,Sa,!0),this.div.tabIndex=0,this.togglePointerEvents(!0);const t=new Set;for(const s of l(this,ui).values())s.enableEditing(),s.show(!0),s.annotationElementId&&(l(this,vt).removeChangedExistingAnnotation(s),t.add(s.annotationElementId));if(!l(this,pn)){g(this,Sa,!1);return}const e=l(this,pn).getEditableAnnotations();for(const s of e){if(s.hide(),l(this,vt).isDeletedAnnotationElement(s.data.id)||t.has(s.data.id))continue;const n=await this.deserialize(s);n&&(this.addOrRebuild(n),n.enableEditing())}g(this,Sa,!1)}disable(){var n;g(this,ac,!0),this.div.tabIndex=-1,this.togglePointerEvents(!1);const t=new Map,e=new Map;for(const r of l(this,ui).values())if(r.disableEditing(),!!r.annotationElementId){if(r.serialize()!==null){t.set(r.annotationElementId,r);continue}else e.set(r.annotationElementId,r);(n=this.getEditableAnnotation(r.annotationElementId))==null||n.show(),r.remove()}if(l(this,pn)){const r=l(this,pn).getEditableAnnotations();for(const o of r){const{id:a}=o.data;if(l(this,vt).isDeletedAnnotationElement(a))continue;let c=e.get(a);if(c){c.resetAnnotationElement(o),c.show(!1),o.show();continue}c=t.get(a),c&&(l(this,vt).addChangedExistingAnnotation(c),c.renderAnnotationElement(o)&&c.show(!1)),o.show()}}w(this,ge,Fd).call(this),this.isEmpty&&(this.div.hidden=!0);const{classList:s}=this.div;for(const r of l(yi,Jr).values())s.remove(`${r._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),g(this,ac,!1)}getEditableAnnotation(t){var e;return((e=l(this,pn))==null?void 0:e.getEditableAnnotation(t))||null}setActiveEditor(t){l(this,vt).getActive()!==t&&l(this,vt).setActiveEditor(t)}enableTextSelection(){var t;if(this.div.tabIndex=-1,(t=l(this,cs))!=null&&t.div&&!l(this,Qn)){g(this,Qn,new AbortController);const e=l(this,vt).combinedSignal(l(this,Qn));l(this,cs).div.addEventListener("pointerdown",w(this,ge,i1).bind(this),{signal:e}),l(this,cs).div.classList.add("highlighting")}}disableTextSelection(){var t;this.div.tabIndex=0,(t=l(this,cs))!=null&&t.div&&l(this,Qn)&&(l(this,Qn).abort(),g(this,Qn,null),l(this,cs).div.classList.remove("highlighting"))}enableClick(){if(l(this,Kr))return;g(this,Kr,new AbortController);const t=l(this,vt).combinedSignal(l(this,Kr));this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:t});const e=this.pointerup.bind(this);this.div.addEventListener("pointerup",e,{signal:t}),this.div.addEventListener("pointercancel",e,{signal:t})}disableClick(){var t;(t=l(this,Kr))==null||t.abort(),g(this,Kr,null)}attach(t){l(this,ui).set(t.id,t);const{annotationElementId:e}=t;e&&l(this,vt).isDeletedAnnotationElement(e)&&l(this,vt).removeDeletedAnnotationElement(t)}detach(t){var e;l(this,ui).delete(t.id),(e=l(this,Aa))==null||e.removePointerInTextLayer(t.contentDiv),!l(this,ac)&&t.annotationElementId&&l(this,vt).addDeletedAnnotationElement(t)}remove(t){this.detach(t),l(this,vt).removeEditor(t),t.div.remove(),t.isAttachedToDOM=!1}changeParent(t){var e;t.parent!==this&&(t.parent&&t.annotationElementId&&(l(this,vt).addDeletedAnnotationElement(t.annotationElementId),ye.deleteAnnotationElement(t),t.annotationElementId=null),this.attach(t),(e=t.parent)==null||e.detach(t),t.setParent(this),t.div&&t.isAttachedToDOM&&(t.div.remove(),this.div.append(t.div)))}add(t){if(!(t.parent===this&&t.isAttachedToDOM)){if(this.changeParent(t),l(this,vt).addEditor(t),this.attach(t),!t.isAttachedToDOM){const e=t.render();this.div.append(e),t.isAttachedToDOM=!0}t.fixAndSetPosition(),t.onceAdded(!l(this,Sa)),l(this,vt).addToAnnotationStorage(t),t._reportTelemetry(t.telemetryInitialData)}}moveEditorInDOM(t){var s;if(!t.isAttachedToDOM)return;const{activeElement:e}=document;t.div.contains(e)&&!l(this,Yn)&&(t._focusEventsAllowed=!1,g(this,Yn,setTimeout(()=>{g(this,Yn,null),t.div.contains(document.activeElement)?t._focusEventsAllowed=!0:(t.div.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:l(this,vt)._signal}),e.focus())},0))),t._structTreeParentId=(s=l(this,Aa))==null?void 0:s.moveElementInDOM(this.div,t.div,t.contentDiv,!0)}addOrRebuild(t){t.needsToBeRebuilt()?(t.parent||(t.parent=this),t.rebuild(),t.show()):this.add(t)}addUndoableEditor(t){const e=()=>t._uiManager.rebuild(t),s=()=>{t.remove()};this.addCommands({cmd:e,undo:s,mustExec:!1})}getNextId(){return l(this,vt).getId()}combinedSignal(t){return l(this,vt).combinedSignal(t)}canCreateNewEmptyEditor(){var t;return(t=l(this,ge,Ki))==null?void 0:t.canCreateNewEmptyEditor()}pasteEditor(t,e){l(this,vt).updateToolbar(t),l(this,vt).updateMode(t);const{offsetX:s,offsetY:n}=w(this,ge,Yg).call(this),r=this.getNextId(),o=w(this,ge,Kg).call(this,{parent:this,id:r,x:s,y:n,uiManager:l(this,vt),isCentered:!0,...e});o&&this.add(o)}async deserialize(t){var e;return await((e=l(yi,Jr).get(t.annotationType??t.annotationEditorType))==null?void 0:e.deserialize(t,this,l(this,vt)))||null}createAndAddNewEditor(t,e,s={}){const n=this.getNextId(),r=w(this,ge,Kg).call(this,{parent:this,id:n,x:t.offsetX,y:t.offsetY,uiManager:l(this,vt),isCentered:e,...s});return r&&this.add(r),r}addNewEditor(){this.createAndAddNewEditor(w(this,ge,Yg).call(this),!0)}setSelected(t){l(this,vt).setSelected(t)}toggleSelected(t){l(this,vt).toggleSelected(t)}unselect(t){l(this,vt).unselect(t)}pointerup(t){var s;const{isMac:e}=Es.platform;if(!(t.button!==0||t.ctrlKey&&e)&&t.target===this.div&&l(this,Yr)&&(g(this,Yr,!1),!((s=l(this,ge,Ki))!=null&&s.isDrawer&&l(this,ge,Ki).supportMultipleDrawings))){if(!l(this,oc)){g(this,oc,!0);return}if(l(this,vt).getMode()===Lt.STAMP){l(this,vt).unselectAll();return}this.createAndAddNewEditor(t,!1)}}pointerdown(t){var n;if(l(this,vt).getMode()===Lt.HIGHLIGHT&&this.enableTextSelection(),l(this,Yr)){g(this,Yr,!1);return}const{isMac:e}=Es.platform;if(t.button!==0||t.ctrlKey&&e||t.target!==this.div)return;if(g(this,Yr,!0),(n=l(this,ge,Ki))!=null&&n.isDrawer){this.startDrawingSession(t);return}const s=l(this,vt).getActive();g(this,oc,!s||s.isEmpty())}startDrawingSession(t){if(this.div.focus(),l(this,Mi)){l(this,ge,Ki).startDrawing(this,l(this,vt),!1,t);return}l(this,vt).setCurrentDrawingSession(this),g(this,Mi,new AbortController);const e=l(this,vt).combinedSignal(l(this,Mi));this.div.addEventListener("blur",({relatedTarget:s})=>{s&&!this.div.contains(s)&&(g(this,Jn,null),this.commitOrRemove())},{signal:e}),l(this,ge,Ki).startDrawing(this,l(this,vt),!1,t)}pause(t){if(t){const{activeElement:e}=document;this.div.contains(e)&&g(this,Jn,e);return}l(this,Jn)&&setTimeout(()=>{var e;(e=l(this,Jn))==null||e.focus(),g(this,Jn,null)},0)}endDrawingSession(t=!1){return l(this,Mi)?(l(this,vt).setCurrentDrawingSession(null),l(this,Mi).abort(),g(this,Mi,null),g(this,Jn,null),l(this,ge,Ki).endDrawing(t)):null}findNewParent(t,e,s){const n=l(this,vt).findParent(e,s);return n===null||n===this?!1:(n.changeParent(t),!0)}commitOrRemove(){return l(this,Mi)?(this.endDrawingSession(),!0):!1}onScaleChanging(){l(this,Mi)&&l(this,ge,Ki).onScaleChangingWhenDrawing(this)}destroy(){var t,e;this.commitOrRemove(),((t=l(this,vt).getActive())==null?void 0:t.parent)===this&&(l(this,vt).commitOrRemove(),l(this,vt).setActiveEditor(null)),l(this,Yn)&&(clearTimeout(l(this,Yn)),g(this,Yn,null));for(const s of l(this,ui).values())(e=l(this,Aa))==null||e.removePointerInTextLayer(s.contentDiv),s.setParent(null),s.isAttachedToDOM=!1,s.div.remove();this.div=null,l(this,ui).clear(),l(this,vt).removeLayer(this)}render({viewport:t}){this.viewport=t,Ra(this.div,t);for(const e of l(this,vt).getEditors(this.pageIndex))this.add(e),e.rebuild();this.updateMode()}update({viewport:t}){l(this,vt).commitOrRemove(),w(this,ge,Fd).call(this);const e=this.viewport.rotation,s=t.rotation;if(this.viewport=t,Ra(this.div,{rotation:s}),e!==s)for(const n of l(this,ui).values())n.rotate(s)}get pageDimensions(){const{pageWidth:t,pageHeight:e}=this.viewport.rawDims;return[t,e]}get scale(){return l(this,vt).viewParameters.realScale}};Aa=new WeakMap,oc=new WeakMap,pn=new WeakMap,Kr=new WeakMap,Yn=new WeakMap,ui=new WeakMap,Yr=new WeakMap,ac=new WeakMap,Sa=new WeakMap,Mi=new WeakMap,Jn=new WeakMap,cs=new WeakMap,Qn=new WeakMap,vt=new WeakMap,Jr=new WeakMap,ge=new WeakSet,i1=function(t){l(this,vt).unselectAll();const{target:e}=t;if(e===l(this,cs).div||(e.getAttribute("role")==="img"||e.classList.contains("endOfContent"))&&l(this,cs).div.contains(e)){const{isMac:s}=Es.platform;if(t.button!==0||t.ctrlKey&&s)return;l(this,vt).showAllEditors("highlight",!0,!0),l(this,cs).div.classList.add("free"),this.toggleDrawing(),Zd.startHighlighting(this,l(this,vt).direction==="ltr",{target:l(this,cs).div,x:t.x,y:t.y}),l(this,cs).div.addEventListener("pointerup",()=>{l(this,cs).div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:l(this,vt)._signal}),t.preventDefault()}},Ki=function(){return l(yi,Jr).get(l(this,vt).getMode())},Kg=function(t){const e=l(this,ge,Ki);return e?new e.prototype.constructor(t):null},Yg=function(){const{x:t,y:e,width:s,height:n}=this.div.getBoundingClientRect(),r=Math.max(0,t),o=Math.max(0,e),a=Math.min(window.innerWidth,t+s),c=Math.min(window.innerHeight,e+n),u=(r+a)/2-t,h=(o+c)/2-e,[d,f]=this.viewport.rotation%180===0?[u,h]:[h,u];return{offsetX:d,offsetY:f}},Fd=function(){for(const t of l(this,ui).values())t.isEmpty()&&t.remove()},pt(yi,"_initialized",!1),y(yi,Jr,new Map([Pg,Gg,zg,Zd].map(t=>[t._editorType,t])));let Xg=yi;var Ii,Dh,As,xa,wf,n1,bn,Qg,r1,Zg;const rs=class rs{constructor({pageIndex:t}){y(this,bn);y(this,Ii,null);y(this,Dh,0);y(this,As,new Map);y(this,xa,new Map);this.pageIndex=t}setParent(t){if(!l(this,Ii)){g(this,Ii,t);return}if(l(this,Ii)!==t){if(l(this,As).size>0)for(const e of l(this,As).values())e.remove(),t.append(e);g(this,Ii,t)}}static get _svgFactory(){return Bt(this,"_svgFactory",new Mm)}draw(t,e=!1,s=!1){const n=ms(this,Dh)._++,r=w(this,bn,Qg).call(this),o=rs._svgFactory.createElement("defs");r.append(o);const a=rs._svgFactory.createElement("path");o.append(a);const c=`path_p${this.pageIndex}_${n}`;a.setAttribute("id",c),a.setAttribute("vector-effect","non-scaling-stroke"),e&&l(this,xa).set(n,a);const u=s?w(this,bn,r1).call(this,o,c):null,h=rs._svgFactory.createElement("use");return r.append(h),h.setAttribute("href",`#${c}`),this.updateProperties(r,t),l(this,As).set(n,r),{id:n,clipPathId:`url(#${u})`}}drawOutline(t,e){const s=ms(this,Dh)._++,n=w(this,bn,Qg).call(this),r=rs._svgFactory.createElement("defs");n.append(r);const o=rs._svgFactory.createElement("path");r.append(o);const a=`path_p${this.pageIndex}_${s}`;o.setAttribute("id",a),o.setAttribute("vector-effect","non-scaling-stroke");let c;if(e){const d=rs._svgFactory.createElement("mask");r.append(d),c=`mask_p${this.pageIndex}_${s}`,d.setAttribute("id",c),d.setAttribute("maskUnits","objectBoundingBox");const f=rs._svgFactory.createElement("rect");d.append(f),f.setAttribute("width","1"),f.setAttribute("height","1"),f.setAttribute("fill","white");const p=rs._svgFactory.createElement("use");d.append(p),p.setAttribute("href",`#${a}`),p.setAttribute("stroke","none"),p.setAttribute("fill","black"),p.setAttribute("fill-rule","nonzero"),p.classList.add("mask")}const u=rs._svgFactory.createElement("use");n.append(u),u.setAttribute("href",`#${a}`),c&&u.setAttribute("mask",`url(#${c})`);const h=u.cloneNode();return n.append(h),u.classList.add("mainOutline"),h.classList.add("secondaryOutline"),this.updateProperties(n,t),l(this,As).set(s,n),s}finalizeDraw(t,e){l(this,xa).delete(t),this.updateProperties(t,e)}updateProperties(t,e){var c;if(!e)return;const{root:s,bbox:n,rootClass:r,path:o}=e,a=typeof t=="number"?l(this,As).get(t):t;if(a){if(s&&w(this,bn,Zg).call(this,a,s),n&&w(c=rs,wf,n1).call(c,a,n),r){const{classList:u}=a;for(const[h,d]of Object.entries(r))u.toggle(h,d)}if(o){const h=a.firstChild.firstChild;w(this,bn,Zg).call(this,h,o)}}}updateParent(t,e){if(e===this)return;const s=l(this,As).get(t);s&&(l(e,Ii).append(s),l(this,As).delete(t),l(e,As).set(t,s))}remove(t){l(this,xa).delete(t),l(this,Ii)!==null&&(l(this,As).get(t).remove(),l(this,As).delete(t))}destroy(){g(this,Ii,null);for(const t of l(this,As).values())t.remove();l(this,As).clear(),l(this,xa).clear()}};Ii=new WeakMap,Dh=new WeakMap,As=new WeakMap,xa=new WeakMap,wf=new WeakSet,n1=function(t,[e,s,n,r]){const{style:o}=t;o.top=`${100*s}%`,o.left=`${100*e}%`,o.width=`${100*n}%`,o.height=`${100*r}%`},bn=new WeakSet,Qg=function(){const t=rs._svgFactory.create(1,1,!0);return l(this,Ii).append(t),t.setAttribute("aria-hidden",!0),t},r1=function(t,e){const s=rs._svgFactory.createElement("clipPath");t.append(s);const n=`clip_${e}`;s.setAttribute("id",n),s.setAttribute("clipPathUnits","objectBoundingBox");const r=rs._svgFactory.createElement("use");return s.append(r),r.setAttribute("href",`#${e}`),r.classList.add("clip"),n},Zg=function(t,e){for(const[s,n]of Object.entries(e))n===null?t.removeAttribute(s):t.setAttribute(s,n)},y(rs,wf);let Jg=rs;globalThis.pdfjsTestingUtils={HighlightOutliner:Mg};Tt.AbortException;Tt.AnnotationEditorLayer;Tt.AnnotationEditorParamsType;Tt.AnnotationEditorType;Tt.AnnotationEditorUIManager;Tt.AnnotationLayer;Tt.AnnotationMode;Tt.ColorPicker;Tt.DOMSVGFactory;Tt.DrawLayer;Tt.FeatureTest;var E2=Tt.GlobalWorkerOptions;Tt.ImageKind;Tt.InvalidPDFException;Tt.MissingPDFException;Tt.OPS;Tt.OutputScale;Tt.PDFDataRangeTransport;Tt.PDFDateString;Tt.PDFWorker;Tt.PasswordResponses;Tt.PermissionFlag;Tt.PixelsPerInch;Tt.RenderingCancelledException;Tt.TextLayer;Tt.TouchManager;Tt.UnexpectedResponseException;Tt.Util;Tt.VerbosityLevel;Tt.XfaLayer;Tt.build;Tt.createValidAbsoluteUrl;Tt.fetchData;var k2=Tt.getDocument;Tt.getFilenameFromUrl;Tt.getPdfFilenameFromUrl;Tt.getXfaPageViewport;Tt.isDataScheme;Tt.isPdfFile;Tt.noContextMenu;Tt.normalizeUnicode;Tt.setLayerDimensions;Tt.shadow;Tt.stopEvent;Tt.version;const T2="/assets/pdf.worker-BgryrOlp.mjs",P2={class:"pdf-viewer"},R2={class:"pdf-toolbar",style:{display:"flex",gap:"10px","align-items":"center","justify-content":"space-between","margin-bottom":"10px"}},M2={style:{display:"flex",gap:"8px","align-items":"center"}},I2={style:{color:"#9ca3af","font-size":"12px"}},L2={style:{display:"flex",gap:"10px","align-items":"center"}},D2={style:{display:"flex",gap:"8px","align-items":"center",color:"#9ca3af","font-size":"12px"}},O2={style:{display:"flex",gap:"8px","align-items":"center",color:"#9ca3af","font-size":"12px"}},N2=["width","height"],F2=["onClick","title"],$2={key:0,class:"bbox-text"},B2={class:"bbox-text-src"},H2={class:"bbox-text-tr"},j2=Gi({__name:"PdfCanvasViewer",props:{pdfUrl:{},pageWidth:{},pageHeight:{},blocks:{},activeBlockId:{},initialPageIndex:{}},emits:["select","page"],setup(i,{emit:t}){const e=i,s=t,n=tt(null),r=tt(null),o=tt(null),a=tt(e.initialPageIndex??0),c=tt(1),u=tt(!1),h=tt(""),d=tt(!1);E2.workerSrc=T2;const f=jt(()=>{var I;const N=((I=r.value)!=null&&I.clientWidth?r.value.clientWidth-6:900)/Math.max(1,e.pageWidth);return Math.min(1.6,Math.max(.6,N))}),p=jt(()=>Math.round(e.pageWidth*f.value)),m=jt(()=>Math.round(e.pageHeight*f.value)),v=jt(()=>e.blocks.filter($=>{var N;return(((N=$.bbox)==null?void 0:N.page)??0)===a.value})),_=jt(()=>{let $=v.value;return h.value&&($=$.filter(N=>N.type===h.value)),u.value&&($=$.filter(N=>!!N.translation_failed||(N.translation||"").startsWith("["))),$}),b=$=>{const N=$.bbox.x0*f.value,I=$.bbox.y0*f.value,F=($.bbox.x1-$.bbox.x0)*f.value,Q=($.bbox.y1-$.bbox.y0)*f.value;return{left:`${N}px`,top:`${I}px`,width:`${Math.max(1,F)}px`,height:`${Math.max(1,Q)}px`}},A=$=>$==="heading"?"c-heading":$==="caption"?"c-caption":$==="formula"?"c-formula":$==="figure"?"c-figure":$==="table"?"c-table":"c-paragraph",x=$=>{const N=($||"").trim().replace(/\s+/g," ");return N.length>80?N.slice(0,80)+"":N},C=$=>{var Q;const N=`p${(((Q=$.bbox)==null?void 0:Q.page)??0)+1}`,I=$.type||"block",F=$.translation_failed?`
ERROR: ${$.translation_error||""}`:"";return`${N}  ${I}
${x($.text)}${F}`},T=async()=>{if(!n.value||!o.value)return;const $=await o.value.getPage(a.value+1),N=$.getViewport({scale:f.value}),I=n.value;I.width=Math.round(N.width),I.height=Math.round(N.height);const F=I.getContext("2d");F&&(F.clearRect(0,0,I.width,I.height),await $.render({canvasContext:F,viewport:N}).promise,s("page",a.value))},D=async()=>{if(o.value)return;const $=k2({url:e.pdfUrl,withCredentials:!1});o.value=await $.promise,c.value=o.value.numPages||1},P=async()=>{a.value=Math.max(0,a.value-1),await T()},j=async()=>{a.value=Math.min(c.value-1,a.value+1),await T()},L=$=>{s("select",$)};return Ni(()=>e.activeBlockId,async $=>{var F;if(!$)return;const N=e.blocks.find(Q=>Q.id===$);if(!N)return;N.bbox.page!==a.value&&(a.value=N.bbox.page,await T());const I=N.bbox.y0*f.value;(F=r.value)==null||F.scrollTo({top:Math.max(0,I-120),behavior:"smooth"})}),Ni(f,async()=>{await T()}),Hi(async()=>{await D(),await T()}),($,N)=>(G(),q("div",P2,[S("div",R2,[S("div",M2,[kt(fe,{onClick:P,disabled:a.value<=0},{default:zt(()=>[...N[3]||(N[3]=[Nt("",-1)])]),_:1},8,["disabled"]),kt(fe,{onClick:j,disabled:a.value>=c.value-1},{default:zt(()=>[...N[4]||(N[4]=[Nt("",-1)])]),_:1},8,["disabled"]),S("div",I2," "+mt(a.value+1)+" / "+mt(c.value)+" ",1)]),S("div",L2,[S("label",D2,[pe(S("input",{type:"checkbox","onUpdate:modelValue":N[0]||(N[0]=I=>u.value=I)},null,512),[[ka,u.value]]),N[5]||(N[5]=Nt("  ",-1))]),pe(S("select",{class:"simple-input","onUpdate:modelValue":N[1]||(N[1]=I=>h.value=I),style:{padding:"8px 10px"}},[...N[6]||(N[6]=[nu('<option value="" data-v-bfab0164></option><option value="heading" data-v-bfab0164></option><option value="paragraph" data-v-bfab0164></option><option value="caption" data-v-bfab0164></option><option value="formula" data-v-bfab0164></option><option value="figure" data-v-bfab0164></option><option value="table" data-v-bfab0164></option>',7)])],512),[[G0,h.value]]),S("label",O2,[pe(S("input",{type:"checkbox","onUpdate:modelValue":N[2]||(N[2]=I=>d.value=I)},null,512),[[ka,d.value]]),N[7]||(N[7]=Nt("  ",-1))])])]),S("div",{ref_key:"scrollEl",ref:r,class:"pdf-scroll"},[S("div",{class:"pdf-page",style:Js({width:`${p.value}px`})},[S("div",{class:"canvas-wrap",style:Js({width:`${p.value}px`,height:`${m.value}px`})},[S("canvas",{ref_key:"canvasEl",ref:n,width:p.value,height:m.value},null,8,N2),S("div",{class:"overlay",style:Js({width:`${p.value}px`,height:`${m.value}px`})},[(G(!0),q(me,null,Qr(_.value,I=>(G(),q("div",{key:I.id,class:Yt(["bbox",[A(I.type),{active:I.id===i.activeBlockId}]]),style:Js(b(I)),onClick:Li(F=>L(I.id),["stop"]),title:C(I)},[d.value?(G(),q("div",$2,[S("div",B2,mt(x(I.text)),1),S("div",H2,mt(x(I.translation||"")),1)])):Et("",!0)],14,F2))),128))],4)],4)],4)],512)]))}}),V2=pc(j2,[["__scopeId","data-v-bfab0164"]]),U2={class:"workbench"},G2={class:"workbench-sidebar glass-card"},z2={key:0,style:{color:"#9ca3af"}},W2={key:1,style:{color:"#fb7185"}},q2={key:2},X2={style:{color:"#9ca3af","font-size":"12px","margin-bottom":"10px"}},K2={style:{display:"flex",gap:"10px","margin-bottom":"12px"}},Y2={style:{display:"flex",gap:"10px","align-items":"center","margin-bottom":"12px"}},J2={key:0,style:{color:"#9ca3af","font-size":"12px","margin-bottom":"12px"}},Q2={style:{display:"flex","justify-content":"space-between",gap:"10px","align-items":"center","flex-wrap":"wrap"}},Z2={style:{display:"flex",gap:"8px","align-items":"center"}},tk={style:{"max-height":"calc(100vh - 220px)",overflow:"auto","padding-right":"6px"}},ek=["onClick"],sk={style:{"font-size":"12px",color:"#9ca3af"}},ik={key:0,class:"tag-heading"},nk={key:1,class:"tag-caption"},rk={key:2,class:"tag-formula"},ok={key:3,class:"tag-figure"},ak={key:4,class:"tag-table"},lk={style:{"font-size":"13px","line-height":"1.5"}},ck={key:0,style:{"margin-top":"8px"}},uk={class:"workbench-main glass-card"},hk={class:"workbench-columns"},dk={class:"pane pane-original"},fk={style:{display:"flex","align-items":"center","justify-content":"space-between",gap:"10px"}},pk={key:0,style:{color:"#9ca3af","font-size":"12px"}},gk={key:0,style:{height:"calc(100% - 34px)"}},mk={key:1,class:"demo-block",style:{color:"#9ca3af"}},vk={class:"pane pane-translation"},bk={key:0,class:"demo-block"},yk={style:{"margin-bottom":"10px",color:"#9ca3af","font-size":"12px"}},wk={style:{display:"flex",gap:"8px","align-items":"center","margin-bottom":"10px",color:"#9ca3af","font-size":"12px"}},_k={style:{"margin-top":"10px",display:"flex",gap:"10px"}},Ak={class:"workbench-tools glass-card"},Sk={style:{display:"grid",gap:"10px"}},xk={style:{display:"grid","grid-template-columns":"1fr 1fr",gap:"8px"}},Ck={style:{display:"flex",gap:"10px","align-items":"center"}},Ek={key:0,style:{display:"flex","flex-wrap":"wrap",gap:"8px"}},kk=["title","onClick"],Tk={style:{"margin-top":"6px",padding:"10px","border-radius":"12px",border:"1px solid rgba(148,163,184,0.15)"}},Pk={style:{display:"flex",gap:"8px","align-items":"center",color:"#9ca3af","font-size":"12px","margin-bottom":"8px"}},Rk={style:{display:"grid","grid-template-columns":"1fr 1fr",gap:"8px","margin-bottom":"8px"}},Mk={style:{display:"flex",gap:"8px","align-items":"center",color:"#9ca3af","font-size":"12px"}},Ik=["href"],Lk={key:2,style:{display:"flex","flex-wrap":"wrap",gap:"8px"}},Dk=["title"],Ok={style:{display:"flex","justify-content":"space-between","align-items":"center",gap:"10px","margin-bottom":"10px"}},Nk={style:{"font-weight":"700"}},Fk={key:0,style:{color:"#9ca3af"}},$k={key:1,style:{color:"#9ca3af"}},Bk={key:2,style:{display:"grid","grid-template-columns":"1fr",gap:"10px","max-height":"70vh",overflow:"auto"}},Hk=["src"],jk=Gi({__name:"ProjectWorkbenchView",setup(i){const t=Bf(),e=jt(()=>String(t.params.id||"")),s=tt(null),n=tt(!0),r=tt(null),o=tt(null),a=tt(""),c=tt(!1),u=tt(""),h=tt(null),d=tt(null),f=tt(null),p=tt([]),m=tt(""),v=jt(()=>s.value?Bx(s.value.document.id):""),_=tt({}),b=tt(""),A=tt(""),x=tt(!1),C=tt(!1),T=tt("figure"),D=tt(!1),P=tt([]),j=tt("ollama"),L=tt(!0),$=tt(2),N=tt(!0),I=tt(!0),F=tt(""),Q=tt(!0),J=tt(!1),H=tt(""),V=tt("B"),Z=jt(()=>{var R;const Y=[];for(const st of((R=s.value)==null?void 0:R.pages)??[])Y.push(...st.blocks);return Y.sort((st,gt)=>st.reading_order-gt.reading_order)}),St=jt(()=>{const Y=F.value.trim().toLowerCase();return Y?Z.value.filter(R=>String(R.text||"").toLowerCase().includes(Y)||String(R.translation||"").toLowerCase().includes(Y)):Z.value}),wt=jt(()=>Z.value.find(Y=>Y.id===o.value)??null),_t=Y=>{var R;o.value=Y,a.value=((R=wt.value)==null?void 0:R.translation)??"",xe()},Pt=Y=>{Mt.value=Y,xe()},Mt=tt(0),Ht=jt(()=>`axiomflow_workbench_state__${e.value}`),xe=()=>{try{const Y={activeBlockId:o.value,lastCanvasPage:Mt.value,search:F.value,jobId:d.value,strategy:{useContext:L.value,contextWindowSize:$.value,useTermConsistency:N.value,useSmartBatching:I.value},export:{subsetFonts:Q.value,pdfaEnabled:J.value,pdfaPart:H.value,pdfaConformance:V.value},ts:Date.now()};localStorage.setItem(Ht.value,JSON.stringify(Y))}catch{}},qt=()=>{try{const Y=localStorage.getItem(Ht.value);if(!Y)return;const R=JSON.parse(Y);(R==null?void 0:R.search)!=null&&(F.value=String(R.search)),R!=null&&R.activeBlockId&&(o.value=String(R.activeBlockId)),typeof(R==null?void 0:R.lastCanvasPage)=="number"&&(Mt.value=R.lastCanvasPage),R!=null&&R.jobId&&(d.value=String(R.jobId)),R!=null&&R.strategy&&(typeof R.strategy.useContext=="boolean"&&(L.value=R.strategy.useContext),typeof R.strategy.contextWindowSize=="number"&&($.value=R.strategy.contextWindowSize),typeof R.strategy.useTermConsistency=="boolean"&&(N.value=R.strategy.useTermConsistency),typeof R.strategy.useSmartBatching=="boolean"&&(I.value=R.strategy.useSmartBatching)),R!=null&&R.export&&(typeof R.export.subsetFonts=="boolean"&&(Q.value=R.export.subsetFonts),typeof R.export.pdfaEnabled=="boolean"&&(J.value=R.export.pdfaEnabled),typeof R.export.pdfaPart=="string"&&(H.value=R.export.pdfaPart),typeof R.export.pdfaConformance=="string"&&(V.value=R.export.pdfaConformance))}catch{}},U=()=>{var Y;a.value=((Y=wt.value)==null?void 0:Y.translation)??""},nt=async()=>{var Y,R,st;n.value=!0,r.value=null;try{if(s.value=await xc(e.value),await et(),qt(),!o.value&&((R=(Y=s.value.pages[0])==null?void 0:Y.blocks[0])!=null&&R.id)?_t(s.value.pages[0].blocks[0].id):o.value&&(a.value=((st=wt.value)==null?void 0:st.translation)??""),d.value&&!f.value)try{f.value=await sb(d.value)}catch{}d.value&&f.value&&!["success","failed","canceled"].includes(String(f.value.stage))&&ht(d.value)}catch(gt){r.value=(gt==null?void 0:gt.message)??String(gt)}finally{n.value=!1}},ot=async()=>{if(!s.value)return;const{job_id:Y}=await Hx({document_id:s.value.document.id,lang_in:s.value.document.lang_in,lang_out:s.value.document.lang_out,provider:j.value,use_context:L.value,context_window_size:$.value,use_term_consistency:N.value,use_smart_batching:I.value});d.value=Y,xe(),await ht(Y),await nt()},ht=async Y=>{for(let R=0;R<240;R++){await new Promise(st=>setTimeout(st,800));try{const st=await sb(Y);f.value=st;const gt=Math.round(((st==null?void 0:st.progress)??0)*100),Ct=(st==null?void 0:st.eta_s)!=null?`  ETA ${Math.round(st.eta_s)}s`:"",Vt=(st==null?void 0:st.done)!=null&&(st==null?void 0:st.total)!=null?`  ${st.done}/${st.total}`:"";if(h.value=`${(st==null?void 0:st.stage)??"unknown"}  ${gt}%${Vt}${Ct}`,(st==null?void 0:st.stage)==="success"||(st==null?void 0:st.stage)==="failed"||(st==null?void 0:st.stage)==="canceled")break}catch{}}},Ft=async()=>{d.value&&(f.value=await jx(d.value))},E=async()=>{d.value&&(f.value=await Vx(d.value))},k=async()=>{d.value&&(f.value=await Ux(d.value),xe())},O=async()=>{d.value&&(await Gx(d.value),await ht(d.value),await nt())},z=async()=>{if(!(!s.value||!wt.value)){c.value=!0;try{await zx({document_id:s.value.document.id,block_id:wt.value.id,translation:a.value,apply_all_same_source:x.value}),await nt()}finally{c.value=!1}}},X=async Y=>{if(!s.value)return;const R=await fp({document_id:s.value.document.id,format:Y,bilingual:!0});u.value=R.content??""},W=async Y=>{if(!s.value)return;const R=(()=>{const Ct=H.value.trim();if(!Ct)return;const Vt=Number(Ct);return Vt===1||Vt===2||Vt===3?Vt:void 0})(),st=V.value.trim().toUpperCase()||"B",gt=await fp({document_id:s.value.document.id,format:Y,bilingual:!0,subset_fonts:Q.value,convert_to_pdfa:J.value,pdfa_part:R,pdfa_conformance:st});m.value=`http://localhost:8000${gt.download_url}`,u.value=m.value},rt=async Y=>{if(!s.value)return;const R=(()=>{const Ct=H.value.trim();if(!Ct)return;const Vt=Number(Ct);return Vt===1||Vt===2||Vt===3?Vt:void 0})(),st=V.value.trim().toUpperCase()||"B",gt=await fp({document_id:s.value.document.id,format:Y,bilingual:!0,subset_fonts:Q.value,convert_to_pdfa:J.value,pdfa_part:R,pdfa_conformance:st});gt!=null&&gt.download_url?(m.value=`http://localhost:8000${gt.download_url}`,u.value=m.value):u.value=(gt==null?void 0:gt.content)??""},it=async()=>{if(!s.value)return;const Y=await Wx({document_id:s.value.document.id,top_k:30});p.value=Y.terms??[]},et=async()=>{if(!s.value)return;const Y=await qx({project_id:s.value.document.project_id});_.value=Y.glossary??{}},K=async()=>{if(!s.value)return;const Y=b.value.trim(),R=A.value.trim();!Y||!R||(await Xx({project_id:s.value.document.project_id,term:Y,translation:R}),b.value="",A.value="",await et())},yt=async Y=>{s.value&&(await Kx({project_id:s.value.document.project_id,term:Y}),await et())},ct=async Y=>{if(s.value){T.value=Y,C.value=!0,D.value=!0,P.value=[];try{const st=((await Yx({document_id:s.value.document.id})).assets??[]).filter(gt=>gt.kind===Y).map(gt=>`http://localhost:8000${gt.download_url}`);P.value=st}finally{D.value=!1}}};return Hi(nt),Ni(e,nt),Hi(()=>{const Y=R=>{if(R.key==="/"&&!R.ctrlKey&&!R.metaKey&&!R.altKey){R.preventDefault();const gt=document.querySelector("input.simple-input");gt==null||gt.focus();return}if(R.key==="Escape"){F.value&&(F.value="",xe());return}const st=gt=>{const Ct=St.value;if(!Ct.length)return;const Vt=Ct.findIndex(Xe=>Xe.id===o.value),Ce=Vt<0?0:Math.min(Ct.length-1,Math.max(0,Vt+gt));_t(Ct[Ce].id)};(R.key==="j"||R.key==="ArrowDown")&&st(1),(R.key==="k"||R.key==="ArrowUp")&&st(-1)};window.addEventListener("keydown",Y),ao(()=>window.removeEventListener("keydown",Y))}),(Y,R)=>{var st,gt,Ct,Vt,Ce,Xe,Re,vi;return G(),q(me,null,[S("section",U2,[S("aside",G2,[R[24]||(R[24]=S("h3",null,"",-1)),n.value?(G(),q("div",z2,"")):r.value?(G(),q("div",W2,mt(r.value),1)):(G(),q("div",q2,[S("div",X2,mt((st=s.value)==null?void 0:st.document.title)+"  "+mt((gt=s.value)==null?void 0:gt.document.lang_in)+""+mt((Ct=s.value)==null?void 0:Ct.document.lang_out),1),S("div",K2,[kt(fe,{primary:"",onClick:ot,disabled:!s.value},{default:zt(()=>[...R[19]||(R[19]=[Nt("Ollama",-1)])]),_:1},8,["disabled"])]),S("div",Y2,[pe(S("input",{class:"simple-input","onUpdate:modelValue":R[0]||(R[0]=B=>F.value=B),placeholder:"/ Esc ",style:{width:"100%"}},null,512),[[es,F.value]])]),h.value?(G(),q("div",J2,[S("div",Q2,[S("div",null,""+mt(h.value),1),S("div",Z2,[((Vt=f.value)==null?void 0:Vt.control)==="running"?(G(),vn(fe,{key:0,onClick:Ft},{default:zt(()=>[...R[20]||(R[20]=[Nt("",-1)])]),_:1})):((Ce=f.value)==null?void 0:Ce.control)==="paused"?(G(),vn(fe,{key:1,onClick:E},{default:zt(()=>[...R[21]||(R[21]=[Nt("",-1)])]),_:1})):Et("",!0),kt(fe,{onClick:k},{default:zt(()=>[...R[22]||(R[22]=[Nt("",-1)])]),_:1}),((Xe=f.value)==null?void 0:Xe.stage)==="failed"?(G(),vn(fe,{key:2,onClick:O},{default:zt(()=>[...R[23]||(R[23]=[Nt("",-1)])]),_:1})):Et("",!0)])])])):Et("",!0),S("div",tk,[(G(!0),q(me,null,Qr(St.value,B=>(G(),q("div",{key:B.id,class:Yt(["block-item",{active:B.id===o.value}]),onClick:M=>_t(B.id)},[S("div",sk,[B.type==="heading"?(G(),q("span",ik,"")):B.type==="caption"?(G(),q("span",nk,"")):B.type==="formula"?(G(),q("span",rk,"")):B.type==="figure"?(G(),q("span",ok,"")):B.type==="table"?(G(),q("span",ak,"")):Et("",!0),Nt(" #"+mt(B.reading_order)+"   "+mt((B.column_index??0)+1),1)]),S("div",lk,mt(B.text.slice(0,64))+mt(B.text.length>64?"":""),1),B.type==="figure"||B.type==="table"?(G(),q("div",ck,[kt(fe,{onClick:Li(M=>ct(B.type),["stop"])},{default:zt(()=>[Nt(""+mt(B.type==="figure"?"":""),1)]),_:2},1032,["onClick"])])):Et("",!0)],10,ek))),128))])]))]),S("div",uk,[S("div",hk,[S("div",dk,[S("h3",fk,[R[25]||(R[25]=S("span",null,"",-1)),wt.value?(G(),q("span",pk,"#"+mt(wt.value.reading_order),1)):Et("",!0)]),s.value?(G(),q("div",gk,[kt(V2,{"pdf-url":v.value,"page-width":((Re=s.value.pages[0])==null?void 0:Re.width)||1e3,"page-height":((vi=s.value.pages[0])==null?void 0:vi.height)||1e3,blocks:Z.value,"active-block-id":o.value,onSelect:_t,onPage:Pt},null,8,["pdf-url","page-width","page-height","blocks","active-block-id"])])):(G(),q("p",mk," bbox "))]),S("div",vk,[R[29]||(R[29]=S("h3",null,"",-1)),wt.value?(G(),q("div",bk,[S("div",yk,mt(wt.value.translation?"":""),1),S("label",wk,[pe(S("input",{type:"checkbox","onUpdate:modelValue":R[1]||(R[1]=B=>x.value=B)},null,512),[[ka,x.value]]),R[26]||(R[26]=Nt("  ",-1))]),pe(S("textarea",{class:"simple-input",style:{width:"100%","min-height":"180px",resize:"vertical"},"onUpdate:modelValue":R[2]||(R[2]=B=>a.value=B),placeholder:""},null,512),[[es,a.value]]),S("div",_k,[kt(fe,{primary:"",onClick:z,disabled:c.value},{default:zt(()=>[...R[27]||(R[27]=[Nt("",-1)])]),_:1},8,["disabled"]),kt(fe,{onClick:U,disabled:c.value},{default:zt(()=>[...R[28]||(R[28]=[Nt("",-1)])]),_:1},8,["disabled"])])])):Et("",!0)])])]),S("aside",Ak,[R[44]||(R[44]=S("h3",null,"",-1)),S("div",Sk,[R[42]||(R[42]=S("div",{style:{color:"#9ca3af","font-size":"12px"}},"",-1)),S("div",xk,[pe(S("input",{class:"simple-input","onUpdate:modelValue":R[3]||(R[3]=B=>b.value=B),placeholder:""},null,512),[[es,b.value]]),pe(S("input",{class:"simple-input","onUpdate:modelValue":R[4]||(R[4]=B=>A.value=B),placeholder:""},null,512),[[es,A.value]])]),S("div",Ck,[kt(fe,{primary:"",onClick:K,disabled:!s.value},{default:zt(()=>[...R[30]||(R[30]=[Nt("/",-1)])]),_:1},8,["disabled"]),kt(fe,{onClick:et,disabled:!s.value},{default:zt(()=>[...R[31]||(R[31]=[Nt("",-1)])]),_:1},8,["disabled"])]),Object.keys(_.value).length?(G(),q("div",Ek,[(G(!0),q(me,null,Qr(_.value,(B,M)=>(G(),q("span",{key:M,class:"tag-caption",style:{cursor:"pointer"},title:`${M} => ${B}`,onClick:lt=>yt(M)},mt(M)+" => "+mt(B),9,kk))),128))])):Et("",!0),R[43]||(R[43]=S("div",{style:{color:"#9ca3af","font-size":"12px"}},"MVP",-1)),kt(fe,{onClick:R[5]||(R[5]=B=>X("markdown")),disabled:!s.value},{default:zt(()=>[...R[32]||(R[32]=[Nt(" Markdown",-1)])]),_:1},8,["disabled"]),kt(fe,{onClick:R[6]||(R[6]=B=>X("html")),disabled:!s.value},{default:zt(()=>[...R[33]||(R[33]=[Nt(" HTML",-1)])]),_:1},8,["disabled"]),kt(fe,{onClick:R[7]||(R[7]=B=>X("html-hifi")),disabled:!s.value},{default:zt(()=>[...R[34]||(R[34]=[Nt(" HTML",-1)])]),_:1},8,["disabled"]),kt(fe,{onClick:R[8]||(R[8]=B=>rt("docx")),disabled:!s.value},{default:zt(()=>[...R[35]||(R[35]=[Nt(" DOCX",-1)])]),_:1},8,["disabled"]),kt(fe,{onClick:R[9]||(R[9]=B=>W("pdf-mono")),disabled:!s.value},{default:zt(()=>[...R[36]||(R[36]=[Nt(" PDF",-1)])]),_:1},8,["disabled"]),kt(fe,{onClick:R[10]||(R[10]=B=>W("pdf-dual")),disabled:!s.value},{default:zt(()=>[...R[37]||(R[37]=[Nt(" PDF",-1)])]),_:1},8,["disabled"]),S("div",Tk,[R[40]||(R[40]=S("div",{style:{color:"#9ca3af","font-size":"12px","margin-bottom":"8px"}},"PDF/A",-1)),S("label",Pk,[pe(S("input",{type:"checkbox","onUpdate:modelValue":R[11]||(R[11]=B=>J.value=B)},null,512),[[ka,J.value]]),R[38]||(R[38]=Nt("  PDF/A ",-1))]),S("div",Rk,[pe(S("input",{class:"simple-input","onUpdate:modelValue":R[12]||(R[12]=B=>H.value=B),placeholder:"part1/2/3"},null,512),[[es,H.value]]),pe(S("input",{class:"simple-input","onUpdate:modelValue":R[13]||(R[13]=B=>V.value=B),placeholder:"conformanceA/B/UB"},null,512),[[es,V.value]])]),S("label",Mk,[pe(S("input",{type:"checkbox","onUpdate:modelValue":R[14]||(R[14]=B=>Q.value=B)},null,512),[[ka,Q.value]]),R[39]||(R[39]=Nt(" PDF  ",-1))])]),m.value?(G(),q("a",{key:1,class:"nav-link",href:m.value,target:"_blank",rel:"noreferrer"},"  ",8,Ik)):Et("",!0),kt(fe,{onClick:it,disabled:!s.value},{default:zt(()=>[...R[41]||(R[41]=[Nt("Top 30",-1)])]),_:1},8,["disabled"]),p.value.length?(G(),q("div",Lk,[(G(!0),q(me,null,Qr(p.value,B=>(G(),q("span",{key:B.term,class:"tag-heading",style:{cursor:"default"},title:`${B.count}`},mt(B.term)+"  "+mt(B.count),9,Dk))),128))])):Et("",!0),pe(S("textarea",{class:"simple-input",style:{width:"100%","min-height":"180px",resize:"vertical"},"onUpdate:modelValue":R[15]||(R[15]=B=>u.value=B),placeholder:""},null,512),[[es,u.value]])])])]),C.value?(G(),q("div",{key:0,class:"preview-backdrop",onClick:R[18]||(R[18]=B=>C.value=!1)},[S("div",{class:"preview-modal glass-card",onClick:R[17]||(R[17]=Li(()=>{},["stop"]))},[S("div",Ok,[S("div",Nk,""+mt(T.value==="figure"?"":""),1),kt(fe,{onClick:R[16]||(R[16]=B=>C.value=!1)},{default:zt(()=>[...R[45]||(R[45]=[Nt("",-1)])]),_:1})]),D.value?(G(),q("div",Fk,"")):P.value.length===0?(G(),q("div",$k," regions")):(G(),q("div",Bk,[(G(!0),q(me,null,Qr(P.value,B=>(G(),q("img",{key:B,src:B,style:{width:"100%","border-radius":"12px",border:"1px solid rgba(148,163,184,0.25)"}},null,8,Hk))),128))]))])])):Et("",!0)],64)}}}),Vk={},Uk={class:"settings glass-card"};function Gk(i,t){return G(),q("section",Uk,[...t[0]||(t[0]=[S("h2",null,"",-1),S("p",null,"//",-1)])])}const zk=pc(Vk,[["render",Gk]]),Wk={class:"glass-card",style:{padding:"18px"}},qk={style:{display:"flex","justify-content":"space-between","align-items":"center",gap:"12px"}},Xk={style:{color:"#9ca3af","font-size":"12px","margin-top":"6px"}},Kk={key:0,style:{color:"#9ca3af","margin-top":"14px"}},Yk={key:1,style:{color:"#fb7185","margin-top":"14px"}},Jk={key:2,style:{"margin-top":"14px"}},Qk={style:{display:"grid",gap:"10px"}},Zk={style:{"min-width":"0"}},tT={style:{"font-weight":"700","white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis"}},eT={style:{color:"#9ca3af","font-size":"12px","margin-top":"4px"}},sT={style:{display:"flex",gap:"10px","align-items":"center"}},iT=Gi({__name:"BatchProgressView",setup(i){const t=Bf(),e=Hh(),s=jt(()=>String(t.params.id||"")),n=tt(!0),r=tt(null),o=tt([]);let a=null;const c=async()=>{n.value=!0,r.value=null;try{const h=await Qx({batch_id:s.value});o.value=h.items??[]}catch(h){r.value=(h==null?void 0:h.message)??String(h)}finally{n.value=!1}},u=h=>{e.push(`/project/${h}`)};return Hi(async()=>{await c(),a=setInterval(c,1500)}),ao(()=>{a&&clearInterval(a)}),(h,d)=>(G(),q("section",Wk,[S("div",qk,[S("div",null,[d[0]||(d[0]=S("h2",{style:{margin:"0"}},"",-1)),S("div",Xk,"batch_id: "+mt(s.value),1)]),kt(fe,{onClick:c},{default:zt(()=>[...d[1]||(d[1]=[Nt("",-1)])]),_:1})]),n.value?(G(),q("div",Kk,"")):r.value?(G(),q("div",Yk,mt(r.value),1)):(G(),q("div",Jk,[S("div",Qk,[(G(!0),q(me,null,Qr(o.value,f=>{var p,m;return G(),q("div",{key:f.document_id,class:"glass-card",style:{padding:"12px",display:"flex","justify-content":"space-between","align-items":"center",gap:"12px"}},[S("div",Zk,[S("div",tT,mt(f.title||f.document_id),1),S("div",eT,mt(((p=f.job)==null?void 0:p.stage)||"pending")+"  "+mt(Math.round((((m=f.job)==null?void 0:m.progress)||0)*100))+"% ",1)]),S("div",sT,[kt(fe,{primary:"",onClick:v=>u(f.document_id)},{default:zt(()=>[...d[2]||(d[2]=[Nt("",-1)])]),_:1},8,["onClick"])])])}),128))])]))]))}}),nT={class:"auth-container"},rT={class:"auth-card glass-card"},oT={class:"auth-header"},aT={class:"auth-title"},lT={class:"auth-subtitle"},cT={class:"auth-form"},uT={key:0,class:"form-group"},hT={class:"input-wrapper"},dT={key:0,class:"input-status-icon input-status-success"},fT={key:1,class:"input-status-icon input-status-error"},pT={key:0,id:"name-error",class:"field-error",role:"alert"},gT={class:"form-group"},mT={class:"input-wrapper"},vT={key:0,class:"input-status-icon input-status-success"},bT={key:1,class:"input-status-icon input-status-error"},yT={key:0,id:"email-error",class:"field-error",role:"alert"},wT={class:"form-label password-label-row"},_T=["aria-expanded"],AT={class:"password-input-wrapper"},ST=["type","minlength"],xT={key:0,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},CT={key:1,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},ET={key:0,id:"password-error",class:"field-error",role:"alert"},kT={key:1,class:"password-strength"},TT={class:"strength-text"},PT={class:"password-tips-head"},RT={class:"password-tips-list"},MT={class:"rule-meter","aria-hidden":"true"},IT={class:"rule-meter","aria-hidden":"true"},LT={class:"rule-meter","aria-hidden":"true"},DT={class:"rule-meter","aria-hidden":"true"},OT={class:"password-tips-foot"},NT={key:2,class:"login-security-message",role:"alert"},FT={key:1,class:"form-group"},$T={class:"password-input-wrapper"},BT=["type"],HT={key:0,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},jT={key:1,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},VT={key:0,id:"confirm-password-error",class:"field-error",role:"alert"},UT={key:2,class:"error-message"},GT={class:"form-group"},zT={class:"captcha-wrapper"},WT={class:"input-wrapper",style:{flex:"1"}},qT={key:0,class:"input-status-icon input-status-success"},XT={key:1,class:"input-status-icon input-status-error"},KT={class:"captcha-image-wrapper"},YT=["src"],JT={key:0,class:"captcha-loading",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},QT={key:1},ZT=["disabled"],tP={key:0,class:"field-error"},eP={key:3,class:"form-options"},sP={class:"checkbox-label"},iP=["disabled"],nP=["disabled","aria-busy"],rP={key:0,class:"loading-spinner","aria-hidden":"true"},oP={class:"social-login"},aP=["disabled"],lP=["disabled"],cP={class:"auth-footer"},uP=["disabled"],hP={class:"modal-content glass-card"},dP={class:"modal-body"},fP={key:0},pP={class:"form-group"},gP={class:"input-wrapper"},mP={key:0,class:"input-status-icon input-status-error"},vP={key:0,class:"field-error",role:"alert"},bP=["disabled"],yP={key:0,class:"loading-spinner"},wP={key:1},_P={class:"modal-description"},AP={class:"form-group"},SP={class:"input-wrapper"},xP={key:0,class:"input-status-icon input-status-error"},CP={key:0,class:"field-error",role:"alert"},EP={class:"form-options",style:{"justify-content":"space-between","margin-top":"16px"}},kP=["disabled"],TP=["disabled"],PP=["disabled"],RP={key:0,class:"loading-spinner"},MP={key:2,class:"forgot-password-success"},IP={class:"modal-content glass-card"},LP={class:"modal-header"},DP={class:"modal-body"},OP={class:"form-group"},NP={class:"password-input-wrapper"},FP={class:"form-group"},$P={class:"password-input-wrapper"},BP=["disabled"],HP={key:0,class:"loading-spinner"},jP=Gi({__name:"AuthView",setup(i){const t=Hh(),e=Am(),s=tt(!0),n=tt(!1),r=tt(""),o=tt(!1),a=tt(!1),c=tt(!0),u=tt(""),h=tt(null),d=tt(""),f=tt(""),p=tt(""),m=tt(!1),v=tt(!1),_=tt("email"),b=tt(""),A=tt(""),x=tt(!1),C=tt(""),T=tt(""),D=tt(""),P=tt(!1),j=tt(""),L=tt(!1),$=tt({password:"",confirmPassword:""}),N=tt(!1),I=tt({name:"",email:"",password:"",confirmPassword:""}),F=tt(""),Q=tt(""),J=tt(""),H=tt(""),V="432136405317-plillpgq2pvskbfe5o169cdrqmq33q7p.apps.googleusercontent.com",Z=(B,M,lt)=>{const Ee=new CustomEvent("show-toast",{detail:{type:B,title:M,message:lt}});window.dispatchEvent(Ee)},St=()=>{if(!s.value){const B=I.value.name.trim();return B?B.length<2?(F.value="2",!1):B.length>50?(F.value="50",!1):(F.value="",!0):(F.value="",!1)}return!0},wt=()=>{const B=I.value.email.trim();return B?/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(B)?(Q.value="",!0):(Q.value="",!1):(Q.value="",!1)},_t=()=>{const B=I.value.password;if(!B)return J.value="",!1;if(!s.value){if(B.length<8)return J.value="8",!1;if(B.length>128)return J.value="128",!1}return J.value="",!0},Pt=tt(null),Mt=tt(null),Ht=tt(!1),xe=()=>{Ht.value=!Ht.value},qt=tt("right"),U=tt({}),nt=jt(()=>{const B=I.value.password||"";return s.value?{len8:!1,cases:!1,digit:!1,symbol:!1}:{len8:B.length>=8,cases:/[a-z]/.test(B)&&/[A-Z]/.test(B),digit:/\d/.test(B),symbol:/[^a-zA-Z0-9]/.test(B)}}),ot=jt(()=>{const B=I.value.password||"";if(s.value)return{len8:0,cases:0,digit:0,symbol:0};const M=/[a-z]/.test(B),lt=/[A-Z]/.test(B),Ee=/\d/.test(B),Ps=/[^a-zA-Z0-9]/.test(B);return{len8:Math.max(0,Math.min(1,B.length/8)),cases:(M?.5:0)+(lt?.5:0),digit:Ee?1:0,symbol:Ps?1:0}}),ht=async()=>{if(s.value||!Ht.value)return;const B=Pt.value,M=Mt.value;if(!B||!M)return;await $h();const lt=B.getBoundingClientRect(),Ee=M.getBoundingClientRect(),Ps=B.querySelector(".password-input-wrapper input");if(!Ps)return;const Zt=Ps.getBoundingClientRect(),Oa=14,Na=10,Hm=26,jm=window.innerWidth,Vm=window.innerHeight,o1=jm-Zt.right,a1=Zt.left;let Fa="right";o1>=Ee.width+Oa?Fa="right":a1>=Ee.width+Oa?Fa="left":Fa="bottom";let Gh=0,zh=0;if(Fa==="right"){Gh=Zt.right-lt.left+Oa;const gc=Zt.top+Zt.height/2-Hm;zh=Math.max(Na,Math.min(Vm-Ee.height-Na,gc))-lt.top}else if(Fa==="left"){Gh=Zt.left-lt.left-Oa-Ee.width;const gc=Zt.top+Zt.height/2-Hm;zh=Math.max(Na,Math.min(Vm-Ee.height-Na,gc))-lt.top}else{const gc=Zt.left+Zt.width/2-Ee.width/2;Gh=Math.max(Na,Math.min(jm-Ee.width-Na,gc))-lt.left,zh=Zt.bottom-lt.top+12}qt.value=Fa,U.value={left:`${Gh}px`,top:`${zh}px`}},Ft=B=>{if(s.value||!Ht.value)return;const M=Pt.value,lt=B.target;!M||!lt||M.contains(lt)||(Ht.value=!1)};Hi(()=>{document.addEventListener("pointerdown",Ft,{capture:!0}),window.addEventListener("resize",ht,{passive:!0}),window.addEventListener("scroll",ht,{passive:!0,capture:!0})}),fm(()=>{document.removeEventListener("pointerdown",Ft,{capture:!0}),window.removeEventListener("resize",ht),window.removeEventListener("scroll",ht,{capture:!0})}),Ni(Ht,B=>{B&&ht()}),Ni(()=>I.value.password,()=>{Ht.value&&ht()});const E=()=>{if(!s.value){const B=I.value.password,M=I.value.confirmPassword;return M?B!==M?(H.value="",!1):(H.value="",!0):(H.value="",!1)}return!0},k=jt(()=>!F.value&&I.value.name.trim().length>=2),O=jt(()=>!Q.value&&I.value.email.trim().length>0),z=jt(()=>s.value?!J.value&&I.value.password.length>0:!J.value&&I.value.password.length>=8),X=jt(()=>s.value?!0:!H.value&&I.value.password===I.value.confirmPassword&&I.value.confirmPassword.length>0),W=jt(()=>{const B=I.value.password;if(!B||s.value)return{level:0,text:""};let M=0;return B.length>=8&&M++,B.length>=12&&M++,/[a-z]/.test(B)&&/[A-Z]/.test(B)&&M++,/\d/.test(B)&&M++,/[^a-zA-Z0-9]/.test(B)&&M++,M<=2?{level:1,text:""}:M<=3?{level:2,text:""}:{level:3,text:""}}),rt=jt(()=>{const B=W.value.level;return B===1?"weak":B===2?"medium":B===3?"strong":""}),it=jt(()=>W.value.text),et=jt(()=>s.value?O.value&&z.value:k.value&&O.value&&z.value&&X.value),K=async()=>{m.value=!0,p.value="";try{const B=await tC();h.value=B.image,d.value=B.session_id,f.value=""}catch(B){p.value=B.message||"",Z("error","",B.message)}finally{m.value=!1}},yt=async()=>{if(A.value="",!b.value.trim()){A.value="";return}if(!/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(b.value.trim())){A.value="";return}x.value=!0;try{const B=await iC({email:b.value.trim()});C.value=B.session_id,B.code?Z("info","",`${B.code}`):Z("success","",B.message),_.value="verify",T.value=""}catch(B){A.value=B.message||"",Z("error","",B.message)}finally{x.value=!1}},ct=async()=>{await yt()},Y=async()=>{if(D.value="",!T.value.trim()){D.value="";return}if(T.value.length!==6){D.value="6+";return}if(!/^[A-Z0-9]{6}$/.test(T.value)){D.value="6";return}P.value=!0;try{const B=await nC({email:b.value.trim(),code:T.value.trim(),session_id:C.value});j.value=B.token,_.value="success",Z("success","",B.message)}catch(B){D.value=B.message||"",Z("error","",B.message)}finally{P.value=!1}},R=()=>{_.value="email",b.value="",A.value="",T.value="",D.value="",C.value="",x.value=!1,P.value=!1,v.value=!0},st=()=>{v.value=!1,setTimeout(()=>{_.value="email",b.value="",A.value="",T.value="",D.value="",C.value="",x.value=!1,P.value=!1},300)},gt=()=>{v.value=!1,L.value=!0},Ct=async()=>{if(!$.value.password){Z("error","");return}if($.value.password.length<8){Z("error","8");return}if($.value.password!==$.value.confirmPassword){Z("error","");return}N.value=!0;try{await rC({token:j.value,new_password:$.value.password}),Z("success","",""),L.value=!1,$.value={password:"",confirmPassword:""},j.value="",_.value="email",b.value="",T.value="",C.value="",s.value=!0}catch(B){Z("error","",B.message)}finally{N.value=!1}};Hi(()=>{if(typeof window<"u"){const B=new URL(window.location.href),M=B.searchParams.get("token");M&&(j.value=M,L.value=!0,B.searchParams.delete("token"),window.history.replaceState({},"",B.toString()))}if(typeof window<"u")try{const B=new URL(window.location.href),M=B.searchParams.get("auth_token"),lt=B.searchParams.get("user");if(B.searchParams.get("provider")==="github"&&M&&lt){const Ps=decodeURIComponent(escape(atob(lt))),Zt=JSON.parse(Ps);e.login(Zt,M),B.searchParams.delete("auth_token"),B.searchParams.delete("user"),B.searchParams.delete("provider"),window.history.replaceState({},"",B.toString());const Oa=B.searchParams.get("redirect")||t.currentRoute.value.query.redirect||"/";Z("success","",""),t.push(Oa);return}}catch(B){console.warn("Failed to parse github auth callback params",B)}if(typeof window<"u"&&window.google)Vt();else{const B=setInterval(()=>{window.google&&(clearInterval(B),Vt())},100);setTimeout(()=>{clearInterval(B)},1e4)}K()}),ao(()=>{});const Vt=()=>{if(window.google)try{window.google.accounts.id.initialize({client_id:V,callback:Ce})}catch(B){console.error("Failed to initialize Google Sign-In:",B)}},Ce=async B=>{n.value=!0,r.value="";try{const M=await Zx(B.credential);e.login(M.user,M.token,c.value);const lt=t.currentRoute.value.query.redirect||"/";Z("success","",`${M.user.name||M.user.email}`),t.push(lt)}catch(M){console.error("Google login error:",M);let lt="Google";if(M.message)try{lt=JSON.parse(M.message).detail||lt}catch{lt=M.message}r.value=lt,Z("error","",lt)}finally{n.value=!1}},Xe=()=>{s.value=!s.value,r.value="",F.value="",Q.value="",J.value="",H.value="",p.value="",f.value="",I.value={name:"",email:"",password:"",confirmPassword:""},s.value,K()},Re=async()=>{r.value="",u.value="";const B=s.value||St(),M=wt(),lt=_t(),Ee=s.value||E();if(!B||!M||!lt||!Ee){r.value="";return}if(!s.value){if(I.value.password!==I.value.confirmPassword){r.value="";return}if(I.value.password.length<8){r.value="8";return}}n.value=!0;try{if(s.value){const Zt=await sC({email:I.value.email.trim(),password:I.value.password,captcha_code:f.value.trim(),captcha_session:d.value});e.login(Zt.user,Zt.token,c.value),Zt.user&&Zt.user.email_verified===!1?Z("info","",""):Z("success","",`${Zt.user.name||Zt.user.email}`)}else{const Zt=await eC({name:I.value.name.trim(),email:I.value.email.trim(),password:I.value.password,captcha_code:f.value.trim(),captcha_session:d.value});e.login(Zt.user,Zt.token,!0),Z("success","","")}const Ps=t.currentRoute.value.query.redirect||"/";t.push(Ps)}catch(Ps){console.error("Auth error:",Ps);const Zt=Ps.message||(s.value?"":"");r.value=Zt,s.value&&(Zt.includes("")||Zt.includes(""))&&(u.value=Zt),Z("error",s.value?"":"",Zt)}finally{n.value=!1}},vi=async B=>{if(B==="google"){if(!window.google){Z("error","","Google");return}n.value=!0,r.value="";try{const M=document.createElement("div");M.style.position="fixed",M.style.left="-9999px",M.style.top="-9999px",document.body.appendChild(M),window.google.accounts.id.renderButton(M,{theme:"outline",size:"large",type:"standard",text:"signin_with",shape:"rectangular",logo_alignment:"left"}),setTimeout(()=>{const lt=M.querySelector('div[role="button"]');lt?lt.click():setTimeout(()=>{const Ee=M.querySelector('div[role="button"]');Ee?Ee.click():(n.value=!1,Z("error","","Google"))},500),setTimeout(()=>{document.body.contains(M)&&document.body.removeChild(M)},2e3)},200)}catch(M){r.value="Google",console.error("Google login error:",M),n.value=!1,Z("error","","Google")}}else if(B==="github"){const M=t.currentRoute.value.query.redirect||"/",lt=new URL(`${se}/auth/github/start`);lt.searchParams.set("redirect",M),window.location.href=lt.toString()}};return(B,M)=>(G(),q("div",nT,[S("div",rT,[S("div",oT,[M[23]||(M[23]=S("div",{class:"auth-logo"},[S("img",{src:ym,alt:"AxiomFlow",class:"auth-logo-image"}),S("div",{class:"auth-logo-text"},"AxiomFlow")],-1)),S("h1",aT,mt(s.value?"":""),1),S("p",lT,mt(s.value?"":""),1)]),S("div",cT,[S("form",{onSubmit:Li(Re,["prevent"])},[s.value?Et("",!0):(G(),q("div",uT,[M[26]||(M[26]=S("label",{class:"form-label"},"",-1)),S("div",hT,[pe(S("input",{"onUpdate:modelValue":M[0]||(M[0]=lt=>I.value.name=lt),type:"text",class:Yt(["form-input",{"input-error":F.value,"input-valid":k.value}]),placeholder:"",autocomplete:"username","aria-required":"true","aria-invalid":"!!nameError","aria-describedby":"name-error",onBlur:St,onInput:St,onKeyup:bi(Re,["enter"]),required:""},null,34),[[es,I.value.name]]),k.value&&I.value.name?(G(),q("div",dT,[...M[24]||(M[24]=[S("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[S("path",{d:"M20 6L9 17l-5-5",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)])])):Et("",!0),F.value?(G(),q("div",fT,[...M[25]||(M[25]=[S("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[S("path",{d:"M18 6L6 18M6 6l12 12",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)])])):Et("",!0)]),F.value?(G(),q("div",pT,mt(F.value),1)):Et("",!0)])),S("div",gT,[M[29]||(M[29]=S("label",{class:"form-label"},"",-1)),S("div",mT,[pe(S("input",{"onUpdate:modelValue":M[1]||(M[1]=lt=>I.value.email=lt),type:"email",class:Yt(["form-input",{"input-error":Q.value,"input-valid":O.value}]),placeholder:"",autocomplete:"email","aria-required":"true","aria-invalid":"!!emailError","aria-describedby":"email-error",onBlur:wt,onInput:wt,onKeyup:bi(Re,["enter"]),required:""},null,34),[[es,I.value.email]]),O.value&&I.value.email?(G(),q("div",vT,[...M[27]||(M[27]=[S("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[S("path",{d:"M20 6L9 17l-5-5",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)])])):Et("",!0),Q.value?(G(),q("div",bT,[...M[28]||(M[28]=[S("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[S("path",{d:"M18 6L6 18M6 6l12 12",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)])])):Et("",!0)]),Q.value?(G(),q("div",yT,mt(Q.value),1)):Et("",!0)]),S("div",{class:"form-group password-group",ref_key:"passwordGroupRef",ref:Pt},[S("label",wT,[M[31]||(M[31]=S("span",null,"",-1)),s.value?Et("",!0):(G(),q("button",{key:0,type:"button",class:"password-tips-trigger",onClick:xe,"aria-expanded":Ht.value?"true":"false","aria-label":"",title:""},[...M[30]||(M[30]=[S("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true"},[S("path",{d:"M12 17h.01M12 13a3 3 0 1 0-3-3",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}),S("path",{d:"M12 22c5.523 0 10-4.477 10-10S17.523 2 12 2 2 6.477 2 12s4.477 10 10 10Z",stroke:"currentColor","stroke-width":"2"})],-1)])],8,_T))]),S("div",AT,[pe(S("input",{"onUpdate:modelValue":M[2]||(M[2]=lt=>I.value.password=lt),type:o.value?"text":"password",class:Yt(["form-input",{"input-error":J.value,"input-valid":z.value&&I.value.password}]),placeholder:"",autocomplete:"current-password","aria-required":"true","aria-invalid":"!!passwordError","aria-describedby":"password-error",onBlur:_t,onInput:_t,onFocus:M[3]||(M[3]=lt=>!s.value&&(Ht.value=!0)),onKeydown:M[4]||(M[4]=bi(Li(lt=>Ht.value=!1,["prevent"]),["esc"])),onKeyup:bi(Re,["enter"]),required:"",minlength:s.value?0:8},null,42,ST),[[Ov,I.value.password]]),S("button",{type:"button",class:"password-toggle",onClick:M[5]||(M[5]=lt=>o.value=!o.value),tabindex:"-1"},[o.value?(G(),q("svg",xT,[...M[32]||(M[32]=[S("path",{d:"M1 12S5 4 12 4S23 12 23 12S19 20 12 20S1 12 1 12Z",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),S("circle",{cx:"12",cy:"12",r:"3",stroke:"currentColor","stroke-width":"2"},null,-1)])])):(G(),q("svg",CT,[...M[33]||(M[33]=[S("path",{d:"M17.94 17.94A10.07 10.07 0 0 1 12 20C7 20 2.73 16.39 1 12C2.73 7.61 7 4 12 4C13.5 4 14.9 4.35 16.12 4.95L17.94 3.13M17.94 17.94L3.13 3.13M17.94 17.94L20.87 20.87M3.13 3.13L1 1M20.87 20.87L23 23",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},null,-1)])]))])]),J.value?(G(),q("div",ET,mt(J.value),1)):Et("",!0),!s.value&&I.value.password?(G(),q("div",kT,[S("div",{class:Yt(["strength-bar",rt.value])},null,2),S("span",TT,mt(it.value),1)])):Et("",!0),kt(ip,{name:"fade-pop"},{default:zt(()=>[!s.value&&Ht.value?(G(),q("div",{key:0,ref_key:"passwordPopoverRef",ref:Mt,class:Yt(["password-tips-popover",`place-${qt.value}`]),style:Js(U.value),role:"dialog","aria-label":"",onMousedown:M[7]||(M[7]=Li(()=>{},["prevent"]))},[S("div",PT,[M[34]||(M[34]=S("div",{class:"password-tips-title"},"",-1)),I.value.password?(G(),q("div",{key:0,class:Yt(["password-strength-pill",rt.value])}," "+mt(it.value||""),3)):Et("",!0)]),S("ul",RT,[S("li",{class:Yt({met:nt.value.len8})},[M[35]||(M[35]=S("span",{class:"tip-text"},[Nt(" "),S("strong",null,"8 ")],-1)),S("span",MT,[S("span",{class:Yt(["rule-meter-fill",rt.value]),style:Js({width:`${Math.round(ot.value.len8*100)}%`})},null,6)])],2),S("li",{class:Yt({met:nt.value.cases})},[M[36]||(M[36]=S("span",{class:"tip-text"},[Nt(" "),S("strong",null,""),Nt("  "),S("strong",null,"")],-1)),S("span",IT,[S("span",{class:Yt(["rule-meter-fill",rt.value]),style:Js({width:`${Math.round(ot.value.cases*100)}%`})},null,6)])],2),S("li",{class:Yt({met:nt.value.digit})},[M[37]||(M[37]=S("span",{class:"tip-text"},[Nt(" "),S("strong",null,"")],-1)),S("span",LT,[S("span",{class:Yt(["rule-meter-fill",rt.value]),style:Js({width:`${Math.round(ot.value.digit*100)}%`})},null,6)])],2),S("li",{class:Yt(["recommended",{met:nt.value.symbol}])},[M[38]||(M[38]=S("span",{class:"tip-text"},[Nt(" "),S("strong",null,""),Nt("")],-1)),S("span",DT,[S("span",{class:Yt(["rule-meter-fill",rt.value]),style:Js({width:`${Math.round(ot.value.symbol*100)}%`})},null,6)])],2)]),S("div",OT,[M[39]||(M[39]=S("span",{class:"tips-foot-left"},"",-1)),S("button",{type:"button",class:"tips-foot-close",onClick:M[6]||(M[6]=lt=>Ht.value=!1)},"")])],38)):Et("",!0)]),_:1}),s.value&&u.value?(G(),q("div",NT,mt(u.value),1)):Et("",!0)],512),s.value?Et("",!0):(G(),q("div",FT,[M[42]||(M[42]=S("label",{class:"form-label"},"",-1)),S("div",$T,[pe(S("input",{"onUpdate:modelValue":M[8]||(M[8]=lt=>I.value.confirmPassword=lt),type:a.value?"text":"password",class:Yt(["form-input",{"input-error":H.value,"input-valid":X.value&&I.value.confirmPassword}]),placeholder:"",autocomplete:"new-password","aria-required":"true","aria-invalid":"!!confirmPasswordError","aria-describedby":"confirm-password-error",onBlur:E,onInput:E,onKeyup:bi(Re,["enter"]),required:""},null,42,BT),[[Ov,I.value.confirmPassword]]),S("button",{type:"button",class:"password-toggle",onClick:M[9]||(M[9]=lt=>a.value=!a.value),tabindex:"-1"},[a.value?(G(),q("svg",HT,[...M[40]||(M[40]=[S("path",{d:"M1 12S5 4 12 4S23 12 23 12S19 20 12 20S1 12 1 12Z",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),S("circle",{cx:"12",cy:"12",r:"3",stroke:"currentColor","stroke-width":"2"},null,-1)])])):(G(),q("svg",jT,[...M[41]||(M[41]=[S("path",{d:"M17.94 17.94A10.07 10.07 0 0 1 12 20C7 20 2.73 16.39 1 12C2.73 7.61 7 4 12 4C13.5 4 14.9 4.35 16.12 4.95L17.94 3.13M17.94 17.94L3.13 3.13M17.94 17.94L20.87 20.87M3.13 3.13L1 1M20.87 20.87L23 23",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},null,-1)])]))])]),H.value?(G(),q("div",VT,mt(H.value),1)):Et("",!0)])),r.value?(G(),q("div",UT,mt(r.value),1)):Et("",!0),S("div",GT,[M[47]||(M[47]=S("label",{class:"form-label"},"",-1)),S("div",zT,[S("div",WT,[pe(S("input",{"onUpdate:modelValue":M[10]||(M[10]=lt=>f.value=lt),type:"text",class:Yt(["form-input",{"input-error":p.value,"input-valid":f.value&&!p.value}]),placeholder:"",maxlength:"4",autocomplete:"off","aria-label":"",onKeyup:bi(Re,["enter"])},null,34),[[es,f.value]]),f.value&&!p.value?(G(),q("div",qT,[...M[43]||(M[43]=[S("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[S("path",{d:"M20 6L9 17l-5-5",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)])])):Et("",!0),p.value?(G(),q("div",XT,[...M[44]||(M[44]=[S("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[S("path",{d:"M18 6L6 18M6 6l12 12",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)])])):Et("",!0)]),S("div",KT,[h.value?(G(),q("img",{key:0,src:h.value,alt:"",class:"captcha-image",onClick:K,role:"button",tabindex:"0","aria-label":"",onKeyup:bi(K,["enter"])},null,40,YT)):(G(),q("div",{key:1,class:"captcha-placeholder",onClick:K,role:"button",tabindex:"0","aria-label":""},[m.value?(G(),q("svg",JT,[...M[45]||(M[45]=[S("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"2","stroke-dasharray":"31.416","stroke-dashoffset":"31.416"},[S("animate",{attributeName:"stroke-dasharray",dur:"2s",values:"0 31.416;15.708 15.708;0 31.416;0 31.416",repeatCount:"indefinite"}),S("animate",{attributeName:"stroke-dashoffset",dur:"2s",values:"0;-15.708;-31.416;-31.416",repeatCount:"indefinite"})],-1)])])):(G(),q("span",QT,""))])),S("button",{type:"button",class:"captcha-refresh",onClick:K,disabled:m.value,"aria-label":"",title:""},[...M[46]||(M[46]=[S("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[S("path",{d:"M3 12C3 7.03 7.03 3 12 3C16.97 3 21 7.03 21 12M21 12L17 8M21 12L17 16",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)])],8,ZT)])]),p.value?(G(),q("div",tP,mt(p.value),1)):Et("",!0)]),s.value?(G(),q("div",eP,[S("label",sP,[pe(S("input",{type:"checkbox","onUpdate:modelValue":M[11]||(M[11]=lt=>c.value=lt),class:"checkbox-input","aria-label":""},null,512),[[ka,c.value]]),M[48]||(M[48]=S("span",{class:"checkbox-custom"},null,-1)),M[49]||(M[49]=S("span",{class:"checkbox-text"},"",-1))]),S("button",{type:"button",class:"forgot-password-link",onClick:R,disabled:n.value,"aria-label":""},"  ",8,iP)])):Et("",!0),S("button",{type:"submit",class:"auth-button",disabled:n.value||!et.value,"aria-busy":n.value,"aria-label":""},[n.value?(G(),q("span",rP)):Et("",!0),S("span",null,mt(n.value?s.value?"...":"...":s.value?"":""),1)],8,nP)],32),M[52]||(M[52]=S("div",{class:"auth-divider"},[S("span",null,"")],-1)),S("div",oP,[S("button",{class:"social-button social-github",onClick:M[12]||(M[12]=lt=>vi("github")),disabled:n.value},[...M[50]||(M[50]=[S("svg",{viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"},[S("path",{d:"M12 2C6.477 2 2 6.477 2 12c0 4.42 2.865 8.17 6.839 9.49.5.092.682-.217.682-.482 0-.237-.01-1.023-.014-1.856-2.782.604-3.369-1.18-3.369-1.18-.455-1.157-1.11-1.466-1.11-1.466-.907-.62.068-.607.068-.607 1.003.07 1.53 1.03 1.53 1.03.892 1.53 2.341 1.088 2.91.832.09-.647.35-1.088.636-1.338-2.22-.252-4.555-1.11-4.555-4.943 0-1.092.39-1.986 1.03-2.685-.103-.253-.446-1.27.098-2.646 0 0 .84-.269 2.75 1.026A9.56 9.56 0 0 1 12 6.844c.85.004 1.705.115 2.505.336 1.909-1.295 2.748-1.026 2.748-1.026.546 1.376.202 2.393.1 2.646.64.699 1.028 1.593 1.028 2.685 0 3.842-2.339 4.688-4.566 4.935.359.309.678.92.678 1.855 0 1.338-.012 2.416-.012 2.744 0 .267.18.578.688.48A10.02 10.02 0 0 0 22 12c0-5.523-4.477-10-10-10z"})],-1),S("span",null,"GitHub",-1)])],8,aP),S("button",{class:"social-button social-google",onClick:M[13]||(M[13]=lt=>vi("google")),disabled:n.value},[...M[51]||(M[51]=[nu('<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z" fill="#4285F4"></path><path d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z" fill="#34A853"></path><path d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z" fill="#FBBC05"></path><path d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z" fill="#EA4335"></path></svg><span>Google</span>',2)])],8,lP)]),S("div",cP,[S("span",null,mt(s.value?"":""),1),S("button",{class:"auth-link",onClick:Xe,disabled:n.value,"aria-label":"/"},mt(s.value?"":""),9,uP)])])]),(G(),vn(Zm,{to:"body"},[kt(ip,{name:"modal"},{default:zt(()=>[v.value?(G(),q("div",{key:0,class:"modal-overlay",onClick:Li(st,["self"]),role:"dialog","aria-labelledby":"forgot-password-title","aria-modal":"true"},[S("div",hP,[S("div",{class:"modal-header"},[M[54]||(M[54]=S("h2",{id:"forgot-password-title"},"",-1)),S("button",{class:"modal-close",onClick:st,"aria-label":""},[...M[53]||(M[53]=[S("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[S("path",{d:"M18 6L6 18M6 6l12 12",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)])])]),S("div",dP,[_.value==="email"?(G(),q("div",fP,[M[57]||(M[57]=S("p",{class:"modal-description"},"",-1)),S("div",pP,[M[56]||(M[56]=S("label",{class:"form-label",for:"forgot-email"},"",-1)),S("div",gP,[pe(S("input",{id:"forgot-email","onUpdate:modelValue":M[14]||(M[14]=lt=>b.value=lt),type:"email",class:Yt(["form-input",{"input-error":A.value}]),placeholder:"",autocomplete:"email","aria-required":"true","aria-invalid":"!!forgotPasswordEmailError",onKeyup:bi(yt,["enter"]),onInput:M[15]||(M[15]=lt=>A.value="")},null,34),[[es,b.value]]),A.value?(G(),q("div",mP,[...M[55]||(M[55]=[S("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[S("path",{d:"M18 6L6 18M6 6l12 12",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)])])):Et("",!0)]),A.value?(G(),q("div",vP,mt(A.value),1)):Et("",!0)]),S("button",{class:"auth-button",onClick:yt,disabled:x.value||!b.value.trim(),style:{width:"100%","margin-top":"20px"}},[x.value?(G(),q("span",yP)):Et("",!0),S("span",null,mt(x.value?"...":""),1)],8,bP)])):_.value==="verify"?(G(),q("div",wP,[S("p",_P,[M[58]||(M[58]=Nt(" ",-1)),S("strong",null,mt(b.value),1),M[59]||(M[59]=Nt("6+",-1))]),S("div",AP,[M[61]||(M[61]=S("label",{class:"form-label",for:"verification-code"},"",-1)),S("div",SP,[pe(S("input",{id:"verification-code","onUpdate:modelValue":M[16]||(M[16]=lt=>T.value=lt),type:"text",class:Yt(["form-input",{"input-error":D.value}]),placeholder:"6+",maxlength:"6",autocomplete:"off","aria-required":"true","aria-invalid":"!!emailVerificationCodeError",onKeyup:bi(Y,["enter"]),onInput:M[17]||(M[17]=lt=>{D.value="",T.value=T.value.replace(/[^A-Za-z0-9]/g,"").toUpperCase()})},null,34),[[es,T.value]]),D.value?(G(),q("div",xP,[...M[60]||(M[60]=[S("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[S("path",{d:"M18 6L6 18M6 6l12 12",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)])])):Et("",!0)]),D.value?(G(),q("div",CP,mt(D.value),1)):Et("",!0)]),S("div",EP,[S("button",{type:"button",class:"forgot-password-link",onClick:M[18]||(M[18]=lt=>_.value="email"),disabled:P.value},"   ",8,kP),S("button",{type:"button",class:"forgot-password-link",onClick:ct,disabled:x.value||P.value},"  ",8,TP)]),S("button",{class:"auth-button",onClick:Y,disabled:P.value||T.value.length!==6,style:{width:"100%","margin-top":"20px"}},[P.value?(G(),q("span",RP)):Et("",!0),S("span",null,mt(P.value?"...":""),1)],8,PP)])):_.value==="success"?(G(),q("div",MP,[M[62]||(M[62]=S("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",class:"success-icon"},[S("path",{d:"M20 6L9 17l-5-5",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}),S("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"2"})],-1)),M[63]||(M[63]=S("p",null,"",-1)),M[64]||(M[64]=S("p",{class:"success-hint"},"",-1)),S("button",{class:"auth-button",onClick:gt,style:{width:"100%","margin-top":"20px"}},"  ")])):Et("",!0)])])])):Et("",!0)]),_:1})])),(G(),vn(Zm,{to:"body"},[kt(ip,{name:"modal"},{default:zt(()=>[L.value?(G(),q("div",{key:0,class:"modal-overlay",onClick:M[22]||(M[22]=Li(lt=>L.value=!1,["self"])),role:"dialog","aria-labelledby":"reset-password-title","aria-modal":"true"},[S("div",IP,[S("div",LP,[M[66]||(M[66]=S("h2",{id:"reset-password-title"},"",-1)),S("button",{class:"modal-close",onClick:M[19]||(M[19]=lt=>L.value=!1),"aria-label":""},[...M[65]||(M[65]=[S("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[S("path",{d:"M18 6L6 18M6 6l12 12",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)])])]),S("div",DP,[S("div",OP,[M[67]||(M[67]=S("label",{class:"form-label",for:"reset-password"},"",-1)),S("div",NP,[pe(S("input",{id:"reset-password","onUpdate:modelValue":M[20]||(M[20]=lt=>$.value.password=lt),type:"password",class:"form-input",placeholder:"8",autocomplete:"new-password","aria-required":"true",minlength:"8",onKeyup:bi(Ct,["enter"])},null,544),[[es,$.value.password]])])]),S("div",FP,[M[68]||(M[68]=S("label",{class:"form-label",for:"reset-confirm-password"},"",-1)),S("div",$P,[pe(S("input",{id:"reset-confirm-password","onUpdate:modelValue":M[21]||(M[21]=lt=>$.value.confirmPassword=lt),type:"password",class:"form-input",placeholder:"",autocomplete:"new-password","aria-required":"true",onKeyup:bi(Ct,["enter"])},null,544),[[es,$.value.confirmPassword]])])]),S("button",{class:"auth-button",onClick:Ct,disabled:N.value||!$.value.password||!$.value.confirmPassword,style:{width:"100%","margin-top":"20px"}},[N.value?(G(),q("span",HP)):Et("",!0),S("span",null,mt(N.value?"...":""),1)],8,BP)])])])):Et("",!0)]),_:1})]))]))}}),VP=[{path:"/",name:"landing",component:Ix},{path:"/auth",name:"auth",component:jP},{path:"/app",name:"dashboard",component:EC},{path:"/batch/:id",name:"batch",component:iT,props:!0},{path:"/project/:id",name:"project",component:jk,props:!0},{path:"/settings",name:"settings",component:zk}],UP=ix({history:OS(),routes:VP}),Lm=VA(Px);Lm.use(zA());Lm.use(UP);Lm.mount("#app");
